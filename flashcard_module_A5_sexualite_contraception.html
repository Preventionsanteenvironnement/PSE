<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©vision A.5 - La sexualit√© - La contraception - Bac Pro Seconde</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #A23B72 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .btn-back {
            background: rgba(0,0,0,0.4);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.2);
            cursor: pointer;
        }
        
        .btn-back:hover {
            background: rgba(0,0,0,0.6);
            transform: translateY(-2px);
        }
        
        .score-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(0,0,0,0.4);
            padding: 10px 20px;
            border-radius: 50px;
        }
        
        .score-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .score-item .icon {
            font-size: 18px;
        }
        
        /* √âcrans */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* √âcran d'accueil */
        .welcome-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .welcome-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ff9a9e, #fecfef, #84fab0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 30px;
        }
        
        /* Objectifs - FOND OPAQUE */
        .objectifs-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            border: 2px solid rgba(255, 154, 158, 0.5);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: left;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        
        .objectifs-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .objectif-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
            line-height: 1.5;
        }
        
        .objectif-item:last-child {
            border-bottom: none;
        }
        
        .objectif-item .check {
            color: #4CAF50;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .competences-row {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .comp-badge {
            background: rgba(255,255,255,0.15);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .comp-badge.c1 { background: rgba(16, 185, 129, 0.3); border: 1px solid #10b981; }
        .comp-badge.c2 { background: rgba(102, 126, 234, 0.3); border: 1px solid #667eea; }
        .comp-badge.c3 { background: rgba(245, 158, 11, 0.3); border: 1px solid #f59e0b; }
        .comp-badge.c4 { background: rgba(239, 68, 68, 0.3); border: 1px solid #ef4444; }
        .comp-badge.c5 { background: rgba(168, 85, 247, 0.3); border: 1px solid #a855f7; }
        .comp-badge.c6 { background: rgba(34, 197, 94, 0.3); border: 1px solid #22c55e; }
        
        /* Niveaux */
        .niveaux-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .niveau-card {
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .niveau-card:hover:not(.locked) {
            background: rgba(0,0,0,0.5);
            transform: translateX(5px);
            border-color: rgba(255, 154, 158, 0.5);
        }
        
        .niveau-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .niveau-card.completed {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }
        
        .niveau-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 900;
            flex-shrink: 0;
        }
        
        .niveau-icon.n1 { background: linear-gradient(135deg, #ff9a9e, #fecfef); }
        .niveau-icon.n2 { background: linear-gradient(135deg, #a8edea, #fed6e3); }
        .niveau-icon.n3 { background: linear-gradient(135deg, #ffecd2, #fcb69f); }
        .niveau-icon.n4 { background: linear-gradient(135deg, #ff8a80, #ea4c89); }
        .niveau-icon.n5 { background: linear-gradient(135deg, #667eea, #764ba2); }
        
        .niveau-content {
            flex-grow: 1;
        }
        
        .niveau-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .niveau-desc {
            font-size: 14px;
            color: rgba(255,255,255,0.7);
            line-height: 1.4;
            margin-bottom: 10px;
        }
        
        .niveau-progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-bar {
            flex-grow: 1;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #81C784);
            transition: width 0.5s ease;
        }
        
        .progress-text {
            font-size: 14px;
            font-weight: 600;
            min-width: 40px;
        }
        
        /* Bouton commencer */
        .btn-start {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        
        .btn-start:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }
        
        /* √âcran de jeu */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .level-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .level-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            background: rgba(0,0,0,0.4);
            border: 2px solid rgba(255,255,255,0.2);
        }
        
        .card-counter {
            font-size: 14px;
            font-weight: 600;
            color: rgba(255,255,255,0.7);
        }
        
        .progress-game {
            flex-grow: 1;
            min-width: 200px;
            max-width: 300px;
        }
        
        /* Carte */
        .flashcard {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 2px solid rgba(255,255,255,0.1);
        }
        
        .card-type {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 20px;
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid #667eea;
        }
        
        .card-keyword {
            font-size: 28px;
            font-weight: 900;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Questions */
        .question-section {
            margin-top: 20px;
        }
        
        .question-text {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 25px;
            line-height: 1.4;
        }
        
        .input-container {
            position: relative;
            margin-bottom: 20px;
        }
        
        .keyword-input {
            width: 100%;
            padding: 15px 20px;
            border: 3px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            background: rgba(0,0,0,0.3);
            color: white;
            font-size: 16px;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .keyword-input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(0,0,0,0.5);
        }
        
        .keyword-input::placeholder {
            color: rgba(255,255,255,0.5);
        }
        
        /* Options QCM */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .option-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            background: rgba(0,0,0,0.3);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .option-btn:hover {
            border-color: #667eea;
            background: rgba(0,0,0,0.5);
        }
        
        .option-btn.selected {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.2);
        }
        
        .option-letter {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            flex-shrink: 0;
        }
        
        .option-btn.selected .option-letter {
            background: #4CAF50;
        }
        
        /* Vrai/Faux */
        .vf-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .vf-btn {
            padding: 15px 25px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            background: rgba(0,0,0,0.3);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 700;
            min-width: 120px;
        }
        
        .vf-btn.vrai:hover {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.2);
        }
        
        .vf-btn.faux:hover {
            border-color: #f44336;
            background: rgba(244, 67, 54, 0.2);
        }
        
        .vf-btn.selected.vrai {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.3);
        }
        
        .vf-btn.selected.faux {
            border-color: #f44336;
            background: rgba(244, 67, 54, 0.3);
        }
        
        /* Boutons action */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .btn-hint, .btn-validate {
            padding: 12px 24px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            background: rgba(0,0,0,0.3);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
        }
        
        .btn-hint:hover {
            border-color: #FF9800;
            background: rgba(255, 152, 0, 0.2);
        }
        
        .btn-validate {
            background: linear-gradient(135deg, #4CAF50, #81C784);
            border-color: #4CAF50;
        }
        
        .btn-validate:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(76, 175, 80, 0.3);
        }
        
        .hint-text {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 152, 0, 0.2);
            border: 2px solid #FF9800;
            border-radius: 15px;
            font-size: 14px;
            line-height: 1.4;
            display: none;
        }
        
        .hint-text.visible {
            display: block;
        }
        
        /* Overlay feedback - FOND OPAQUE */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .feedback-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .feedback-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            transform: scale(0.8);
            transition: all 0.3s ease;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            border: 2px solid rgba(255,255,255,0.1);
        }
        
        .feedback-overlay.visible .feedback-card {
            transform: scale(1);
        }
        
        .feedback-card.correct {
            border-color: #4CAF50;
        }
        
        .feedback-card.incorrect {
            border-color: #f44336;
        }
        
        .feedback-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }
        
        .feedback-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .feedback-points {
            font-size: 16px;
            font-weight: 600;
            color: #4CAF50;
            margin-bottom: 20px;
        }
        
        .feedback-explanation {
            background: rgba(0, 0, 0, 0.6);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
        }
        
        .feedback-explanation h4 {
            margin-bottom: 15px;
            color: #81C784;
        }
        
        .keyword-box {
            background: rgba(102, 126, 234, 0.3);
            border: 2px solid #667eea;
            padding: 10px 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: 600;
            text-align: center;
        }
        
        .tip-box {
            background: rgba(255, 193, 7, 0.2);
            border: 2px solid #FFC107;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .tip-box h5 {
            color: #FFC107;
            margin-bottom: 8px;
        }
        
        .btn-next {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        
        .btn-next:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        /* √âcran r√©sultats */
        .results-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .results-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }
        
        .results-title {
            font-size: 32px;
            font-weight: 900;
            margin-bottom: 15px;
        }
        
        .results-score {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #4CAF50, #81C784);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(0,0,0,0.4);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: 900;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            color: rgba(255,255,255,0.7);
            text-transform: uppercase;
            font-weight: 600;
        }
        
        .errors-recap {
            background: rgba(244, 67, 54, 0.1);
            border: 2px solid #f44336;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: left;
            display: none;
        }
        
        .errors-recap h4 {
            color: #f44336;
            margin-bottom: 15px;
        }
        
        .errors-recap ul {
            list-style: none;
        }
        
        .errors-recap li {
            padding: 5px 0;
            border-bottom: 1px solid rgba(244, 67, 54, 0.2);
            font-size: 14px;
        }
        
        .errors-recap li:last-child {
            border-bottom: none;
        }
        
        .results-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn-home, .btn-retry, .btn-next-level {
            padding: 12px 24px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            background: rgba(0,0,0,0.3);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-home:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.2);
        }
        
        .btn-retry:hover {
            border-color: #FF9800;
            background: rgba(255, 152, 0, 0.2);
        }
        
        .btn-next-level {
            background: linear-gradient(135deg, #4CAF50, #81C784);
            border-color: #4CAF50;
        }
        
        .btn-next-level:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(76, 175, 80, 0.3);
        }
        
        /* Streak popup */
        .streak-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #FF6B6B, #4ECDC4);
            color: white;
            padding: 20px 30px;
            border-radius: 20px;
            font-size: 20px;
            font-weight: 900;
            z-index: 1001;
            display: none;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        
        /* Confettis */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            top: -10px;
            z-index: 999;
            animation: confetti-fall 3s linear;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .welcome-title {
                font-size: 32px;
            }
            
            .objectifs-card, .flashcard, .feedback-card {
                padding: 20px;
            }
            
            .card-keyword {
                font-size: 24px;
            }
            
            .question-text {
                font-size: 16px;
            }
            
            .niveau-card {
                padding: 15px;
            }
            
            .niveau-title {
                font-size: 16px;
            }
            
            .vf-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .vf-btn {
                min-width: auto;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .results-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .game-header {
                flex-direction: column;
                text-align: center;
            }
            
            .progress-game {
                min-width: auto;
                max-width: none;
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .welcome-title {
                font-size: 28px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .score-bar {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <a href="javascript:history.back()" class="btn-back">‚Üê Retour</a>
            <div class="score-bar">
                <div class="score-item">
                    <span class="icon">üíé</span>
                    <span id="totalPoints">0</span>
                </div>
                <div class="score-item">
                    <span class="icon">üî•</span>
                    <span id="currentStreak">0</span>
                </div>
            </div>
        </div>

        <!-- √âcran d'accueil -->
        <div class="screen active" id="homeScreen">
            <div class="welcome-screen">
                <div class="welcome-title">üß¨ Module A.5</div>
                <div class="welcome-subtitle">La sexualit√© - La contraception</div>
                
                <!-- Objectifs -->
                <div class="objectifs-card">
                    <h3>üéØ Objectifs de r√©vision</h3>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Ma√Ætriser l'anatomie des appareils reproducteurs masculin et f√©minin</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Comprendre le processus de reproduction (cycles, f√©condation, nidation)</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Conna√Ætre toutes les m√©thodes contraceptives et leurs modes d'action</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Identifier les IST et les mesures de pr√©vention</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Appliquer les connaissances √† des situations professionnelles</span>
                    </div>
                    
                    <div class="competences-row">
                        <span class="comp-badge c1">C1 - Traiter info</span>
                        <span class="comp-badge c2">C2 - Analyse</span>
                        <span class="comp-badge c3">C3 - Expliquer</span>
                        <span class="comp-badge c4">C4 - Proposer</span>
                        <span class="comp-badge c5">C5 - Argumenter</span>
                        <span class="comp-badge c6">C6 - Communiquer</span>
                    </div>
                </div>
                
                <!-- Niveaux -->
                <div class="niveaux-grid">
                    <div class="niveau-card" onclick="startLevel(1)">
                        <div class="niveau-icon n1">1</div>
                        <div class="niveau-content">
                            <div class="niveau-title">Anatomie & Reproduction</div>
                            <div class="niveau-desc">Appareils g√©nitaux, gam√®tes, f√©condation et nidation</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level1Bar" style="width: 0%;"></div>
                                </div>
                                <div class="progress-text" id="level1Percent">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card locked" onclick="startLevel(2)">
                        <div class="niveau-icon n2">2</div>
                        <div class="niveau-content">
                            <div class="niveau-title">Cycles & Hormones</div>
                            <div class="niveau-desc">Cycle menstruel, ovulation et r√©gulation hormonale</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level2Bar" style="width: 0%;"></div>
                                </div>
                                <div class="progress-text" id="level2Percent">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card locked" onclick="startLevel(3)">
                        <div class="niveau-icon n3">3</div>
                        <div class="niveau-content">
                            <div class="niveau-title">Contraception</div>
                            <div class="niveau-desc">M√©thodes m√©caniques, hormonales et d'urgence</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level3Bar" style="width: 0%;"></div>
                                </div>
                                <div class="progress-text" id="level3Percent">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card locked" onclick="startLevel(4)">
                        <div class="niveau-icon n4">4</div>
                        <div class="niveau-content">
                            <div class="niveau-title">IST & Pr√©vention</div>
                            <div class="niveau-desc">Infections sexuellement transmissibles et d√©pistage</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level4Bar" style="width: 0%;"></div>
                                </div>
                                <div class="progress-text" id="level4Percent">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card locked" onclick="startLevel(5)">
                        <div class="niveau-icon n5">5</div>
                        <div class="niveau-content">
                            <div class="niveau-title">Synth√®se & Cas Pro</div>
                            <div class="niveau-desc">Situations complexes et conseil personnalis√©</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level5Bar" style="width: 0%;"></div>
                                </div>
                                <div class="progress-text" id="level5Percent">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="btn-start" onclick="startLevel(1)">üöÄ Commencer la r√©vision</button>
            </div>
        </div>

        <!-- √âcran de jeu -->
        <div class="screen" id="gameScreen">
            <div class="game-header">
                <div class="level-info">
                    <div class="level-badge" id="levelBadge">Niveau 1</div>
                    <div class="card-counter" id="cardCounter">1/15</div>
                </div>
                <div class="progress-game">
                    <div class="progress-bar">
                        <div class="progress-fill" id="gameProgress" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
            
            <div class="flashcard">
                <div class="card-type" id="cardType">MOT-CL√â</div>
                <div class="card-keyword" id="cardKeyword">Mot √† deviner</div>
                <div class="question-section" id="questionSection">
                    <!-- Contenu dynamique -->
                </div>
                <div class="action-buttons">
                    <button class="btn-hint" onclick="showHint()" id="hintBtn">üí° Indice</button>
                    <button class="btn-validate" onclick="validateAnswer()">‚úÖ Valider</button>
                </div>
                <div class="hint-text" id="hintText"></div>
            </div>
        </div>

        <!-- Overlay feedback -->
        <div class="feedback-overlay" id="feedbackOverlay">
            <div class="feedback-card" id="feedbackCard">
                <div class="feedback-icon" id="feedbackIcon">‚úÖ</div>
                <div class="feedback-title" id="feedbackTitle">Bravo !</div>
                <div class="feedback-points" id="feedbackPoints">+10 points</div>
                <div class="feedback-explanation" id="feedbackExplanation">
                    <!-- Contenu dynamique -->
                </div>
                <button class="btn-next" onclick="nextCard()">Suivant ‚Üí</button>
            </div>
        </div>

        <!-- √âcran r√©sultats -->
        <div class="screen" id="resultsScreen">
            <div class="results-screen">
                <div class="results-icon" id="resultsIcon">üéâ</div>
                <div class="results-title" id="resultsTitle">Niveau r√©ussi !</div>
                <div class="results-score" id="resultsScore">85%</div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="correctCount">12/15</div>
                        <div class="stat-label">Bonnes r√©ponses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="pointsEarned">+120</div>
                        <div class="stat-label">Points gagn√©s</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="bestStreak">7</div>
                        <div class="stat-label">Meilleure s√©rie</div>
                    </div>
                </div>
                
                <div class="errors-recap" id="errorsRecap">
                    <h4>üìù √Ä revoir</h4>
                    <ul id="errorsList">
                        <!-- Erreurs dynamiques -->
                    </ul>
                </div>
                
                <div class="results-buttons">
                    <button class="btn-home" onclick="goHome()">üè† Accueil</button>
                    <button class="btn-retry" onclick="retryLevel()">üîÑ Recommencer</button>
                    <button class="btn-next-level" id="nextLevelBtn" onclick="nextLevel()">‚ú® Niveau suivant</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup streak -->
    <div class="streak-popup" id="streakPopup">üî• 3 de suite !</div>

    <script>
        // Variables globales
        let currentLevel = 1;
        let currentCardIndex = 0;
        let levelCorrect = 0;
        let levelPoints = 0;
        let levelErrors = [];
        let hintUsed = false;
        let totalPoints = 0;
        let currentStreak = 0;
        let bestStreak = 0;
        let levelProgress = [0, 0, 0, 0, 0, 0]; // Index 0 inutilis√©

        // Donn√©es des niveaux
        const levels = {
            1: {
                title: "Anatomie & Reproduction",
                cards: [
                    {
                        type: "keyword",
                        keyword: "Ut√©rus",
                        question: "Organe f√©minin qui accueille l'embryon et permet le d√©veloppement du f≈ìtus pendant la grossesse.",
                        answer: "uterus",
                        hint: "Cet organe se contracte lors de l'accouchement",
                        explanation: "L'ut√©rus est l'organe de la gestation. Sa paroi interne (endom√®tre) s'√©paissit chaque mois pour accueillir un √©ventuel embryon.",
                        tip: "√Ä l'examen : Distinguer ut√©rus (gestation) et ovaires (production d'ovules)"
                    },
                    {
                        type: "qcm",
                        keyword: "F√©condation",
                        question: "O√π se d√©roule normalement la f√©condation ?",
                        options: ["Dans l'ovaire", "Dans la trompe de Fallope", "Dans l'ut√©rus", "Dans le vagin"],
                        answer: 1,
                        hint: "Pensez au trajet des spermatozo√Ødes vers l'ovule",
                        explanation: "La f√©condation a lieu dans le tiers externe de la trompe de Fallope. L'ovule y rencontre les spermatozo√Ødes.",
                        tip: "M√©moriser : F√©condation = trompe / Nidation = ut√©rus"
                    },
                    {
                        type: "keyword",
                        keyword: "Nidation",
                        question: "Processus d'implantation de l'embryon dans la paroi ut√©rine, environ 7 jours apr√®s la f√©condation.",
                        answer: "nidation",
                        hint: "Ce mot vient de 'nid'",
                        explanation: "La nidation marque le d√©but de la grossesse clinique. L'embryon s'implante dans l'endom√®tre pr√©par√© par les hormones.",
                        tip: "Nidation = d√©but grossesse (‚â† f√©condation qui pr√©c√®de)"
                    },
                    {
                        type: "vf",
                        keyword: "Spermatogen√®se",
                        question: "La production de spermatozo√Ødes est continue chez l'homme adulte.",
                        answer: true,
                        hint: "Contrairement au cycle f√©minin...",
                        explanation: "La spermatogen√®se est un processus continu durant environ 74 jours, contrairement au cycle menstruel f√©minin qui est cyclique.",
                        tip: "Homme = production continue / Femme = production cyclique"
                    },
                    {
                        type: "qcm",
                        keyword: "Ovulation",
                        question: "√Ä quel moment du cycle menstruel (28 jours) se produit l'ovulation ?",
                        options: ["Jour 5", "Jour 14", "Jour 21", "Jour 28"],
                        answer: 1,
                        hint: "Au milieu du cycle...",
                        explanation: "L'ovulation survient vers J14 d'un cycle de 28 jours, d√©clench√©e par le pic de LH (hormone lut√©inisante).",
                        tip: "Retenir : J14 = ovulation (¬±2 jours selon les femmes)"
                    },
                    {
                        type: "keyword",
                        keyword: "Endom√®tre",
                        question: "Muqueuse interne de l'ut√©rus qui s'√©paissit chaque mois et est √©vacu√©e lors des r√®gles si il n'y a pas de grossesse.",
                        answer: "endometre",
                        hint: "Endo = dedans, m√®tre = ut√©rus",
                        explanation: "L'endom√®tre se renouvelle chaque cycle : √©paississement (≈ìstrog√®nes) puis maintien (progest√©rone) ou √©limination (r√®gles).",
                        tip: "Endom√®tre = 'tapisserie' de l'ut√©rus qui change chaque mois"
                    },
                    {
                        type: "vf",
                        keyword: "Gam√®tes",
                        question: "L'ovule est beaucoup plus volumineux que le spermatozo√Øde.",
                        answer: true,
                        hint: "Pensez √† leurs r√¥les respectifs",
                        explanation: "L'ovule est environ 100 fois plus volumineux que le spermatozo√Øde. Il contient les r√©serves nutritives pour les premiers stades du d√©veloppement.",
                        tip: "Ovule = gros et immobile / Spermatozo√Øde = petit et mobile"
                    },
                    {
                        type: "qcm",
                        keyword: "Hormones reproduction",
                        question: "Quelle hormone d√©clenche l'ovulation ?",
                        options: ["FSH", "LH", "≈ístrog√®nes", "Progest√©rone"],
                        answer: 1,
                        hint: "Hormone Lut√©inisante...",
                        explanation: "La LH (hormone lut√©inisante) provoque la rupture du follicule et la lib√©ration de l'ovule. Son pic marque l'ovulation.",
                        tip: "LH = pic ovulatoire (m√©moriser avec 'Lib√©ration')"
                    },
                    {
                        type: "keyword",
                        keyword: "Trompes de Fallope",
                        question: "Conduits qui relient les ovaires √† l'ut√©rus et o√π se d√©roule normalement la f√©condation.",
                        answer: "trompes",
                        hint: "Du nom d'un anatomiste italien",
                        explanation: "Les trompes de Fallope transportent l'ovule vers l'ut√©rus gr√¢ce aux cils vibratiles et aux contractions musculaires.",
                        tip: "Trompes = 'autoroute' ovule ‚Üí ut√©rus + lieu f√©condation"
                    },
                    {
                        type: "vf",
                        keyword: "Cycle menstruel",
                        question: "Un cycle menstruel dure toujours exactement 28 jours.",
                        answer: false,
                        hint: "Les femmes ne sont pas toutes identiques...",
                        explanation: "Un cycle normal varie de 21 √† 35 jours. La dur√©e de 28 jours n'est qu'une moyenne statistique.",
                        tip: "Cycle normal = 21 √† 35 jours (pas forc√©ment 28)"
                    },
                    {
                        type: "keyword",
                        keyword: "Prostate",
                        question: "Glande masculine qui produit une partie du liquide s√©minal pour nourrir et prot√©ger les spermatozo√Ødes.",
                        answer: "prostate",
                        hint: "Probl√®mes fr√©quents chez l'homme √¢g√©",
                        explanation: "La prostate s√©cr√®te un liquide alcalin qui neutralise l'acidit√© vaginale et facilite la survie des spermatozo√Ødes.",
                        tip: "Prostate = 'carburant' pour les spermatozo√Ødes"
                    },
                    {
                        type: "qcm",
                        keyword: "Dur√©e de vie gam√®tes",
                        question: "Combien de temps les spermatozo√Ødes peuvent-ils survivre dans les voies g√©nitales f√©minines ?",
                        options: ["6 heures", "24 heures", "3 jours", "1 semaine"],
                        answer: 2,
                        hint: "Assez longtemps pour attendre l'ovulation",
                        explanation: "Les spermatozo√Ødes survivent 2-3 jours dans les voies g√©nitales f√©minines, d'o√π une p√©riode fertile √©tendue.",
                        tip: "Spermatozo√Ødes = 3 jours / Ovule = 24h (√† retenir)"
                    },
                    {
                        type: "vf",
                        keyword: "Testicules",
                        question: "Les testicules produisent √† la fois les spermatozo√Ødes et la testost√©rone.",
                        answer: true,
                        hint: "Double fonction de ces organes",
                        explanation: "Les testicules ont une fonction mixte : gam√©tique (spermatozo√Ødes dans tubes s√©minif√®res) et hormonale (testost√©rone dans cellules de Leydig).",
                        tip: "Testicules = usine √† spermatozo√Ødes + hormones masculines"
                    },
                    {
                        type: "keyword",
                        keyword: "Ovaires",
                        question: "Gonades f√©minines qui produisent les ovules et s√©cr√®tent les hormones sexuelles f√©minines.",
                        answer: "ovaires",
                        hint: "√âquivalent f√©minin des testicules",
                        explanation: "Les ovaires lib√®rent un ovule par mois (ovulation) et s√©cr√®tent ≈ìstrog√®nes et progest√©rone selon le cycle.",
                        tip: "Ovaires = ovules + ≈ìstrog√®nes/progest√©rone"
                    },
                    {
                        type: "qcm",
                        keyword: "F√©condation processus",
                        question: "Que se passe-t-il imm√©diatement apr√®s la p√©n√©tration du spermatozo√Øde dans l'ovule ?",
                        options: ["L'ovule se divise", "Formation d'une barri√®re", "Fusion des noyaux", "D√©but de la nidation"],
                        answer: 1,
                        hint: "Protection contre les autres spermatozo√Ødes",
                        explanation: "D√®s qu'un spermatozo√Øde p√©n√®tre, l'ovule forme une barri√®re pour emp√™cher la polyspermie, puis les noyaux fusionnent.",
                        tip: "1 seul spermatozo√Øde par ovule = m√©canisme de protection"
                    }
                ]
            },
            2: {
                title: "Cycles & Hormones",
                cards: [
                    {
                        type: "keyword",
                        keyword: "FSH",
                        question: "Hormone Follicule Stimulante. Stimule la maturation des follicules ovariens et la production d'≈ìstrog√®nes.",
                        answer: "FSH",
                        hint: "Premi√®re hormone du cycle, vient de l'hypophyse",
                        explanation: "La FSH (Follicle Stimulating Hormone) est s√©cr√©t√©e par l'hypophyse ant√©rieure et d√©clenche le d√©veloppement folliculaire.",
                        tip: "FSH = Follicule Stimulante = d√©but du cycle"
                    },
                    {
                        type: "qcm",
                        keyword: "Phase lut√©ale",
                        question: "Que caract√©rise principalement la phase lut√©ale du cycle ?",
                        options: ["Maturation folliculaire", "Production de progest√©rone", "Menstruation", "Pic de LH"],
                        answer: 1,
                        hint: "Apr√®s l'ovulation, le corps jaune...",
                        explanation: "La phase lut√©ale (J15-J28) est domin√©e par la progest√©rone s√©cr√©t√©e par le corps jaune, qui pr√©pare l'ut√©rus √† la nidation.",
                        tip: "Phase lut√©ale = progest√©rone = pr√©paration nidation"
                    },
                    {
                        type: "keyword",
                        keyword: "≈ístrog√®nes",
                        question: "Hormones f√©minines qui provoquent l'√©paississement de l'endom√®tre en premi√®re partie de cycle.",
                        answer: "oestrogenes",
                        hint: "Hormone de la f√©minit√©, maximale avant ovulation",
                        explanation: "Les ≈ìstrog√®nes (estradiol notamment) sont produits par les follicules en croissance et pr√©parent l'endom√®tre.",
                        tip: "≈ístrog√®nes = √©paississement endom√®tre = 1√®re partie cycle"
                    },
                    {
                        type: "vf",
                        keyword: "Progest√©rone",
                        question: "La progest√©rone est principalement s√©cr√©t√©e apr√®s l'ovulation.",
                        answer: true,
                        hint: "Hormone de la deuxi√®me partie du cycle",
                        explanation: "La progest√©rone est s√©cr√©t√©e par le corps jaune (follicule transform√©) apr√®s l'ovulation. Elle maintient l'endom√®tre.",
                        tip: "Progest√©rone = apr√®s ovulation = maintien endom√®tre"
                    },
                    {
                        type: "qcm",
                        keyword: "R√©gulation hormonale",
                        question: "Quel m√©canisme r√©gule les hormones du cycle menstruel ?",
                        options: ["Syst√®me nerveux", "R√©trocontr√¥le", "Digestion", "Respiration"],
                        answer: 1,
                        hint: "Les hormones se r√©gulent entre elles",
                        explanation: "Le r√©trocontr√¥le (feedback) permet aux hormones ovariennes de r√©guler la production des hormones hypophysaires.",
                        tip: "R√©trocontr√¥le = hormones qui se 'parlent' entre elles"
                    },
                    {
                        type: "keyword",
                        keyword: "Corps jaune",
                        question: "Structure qui se forme apr√®s l'ovulation √† partir du follicule rompu et qui s√©cr√®te la progest√©rone.",
                        answer: "corps jaune",
                        hint: "Sa couleur lui donne son nom",
                        explanation: "Le corps jaune (corpus luteum) se forme √† partir du follicule apr√®s expulsion de l'ovule. Il s√©cr√®te progest√©rone et ≈ìstrog√®nes.",
                        tip: "Corps jaune = follicule transform√© = usine √† progest√©rone"
                    },
                    {
                        type: "vf",
                        keyword: "Phase folliculaire",
                        question: "La phase folliculaire a toujours la m√™me dur√©e chez toutes les femmes.",
                        answer: false,
                        hint: "C'est la phase qui varie le plus",
                        explanation: "La phase folliculaire (J1-J14) varie selon les femmes et peut durer de 10 √† 20 jours. La phase lut√©ale est plus stable (14 jours).",
                        tip: "Phase folliculaire = variable / Phase lut√©ale = stable (14j)"
                    },
                    {
                        type: "qcm",
                        keyword: "LH",
                        question: "Le pic de LH (hormone Lut√©inisante) d√©clenche :",
                        options: ["Les r√®gles", "L'ovulation", "La f√©condation", "La nidation"],
                        answer: 1,
                        hint: "Event majeur du milieu de cycle",
                        explanation: "Le pic de LH vers J14 provoque la rupture du follicule dominant et la lib√©ration de l'ovule = ovulation.",
                        tip: "Pic LH = d√©clencheur ovulation = J14"
                    },
                    {
                        type: "keyword",
                        keyword: "Hypophyse",
                        question: "Glande endocrine situ√©e dans le cerveau qui s√©cr√®te FSH et LH pour contr√¥ler le cycle ovarien.",
                        answer: "hypophyse",
                        hint: "Glande ma√Ætre du syst√®me hormonal",
                        explanation: "L'hypophyse ant√©rieure s√©cr√®te FSH et LH sous le contr√¥le de l'hypothalamus via la GnRH.",
                        tip: "Hypophyse = chef d'orchestre des hormones reproductrices"
                    },
                    {
                        type: "vf",
                        keyword: "Cycle ut√©rin",
                        question: "L'endom√®tre s'√©paissit uniquement gr√¢ce aux ≈ìstrog√®nes.",
                        answer: false,
                        hint: "Deux hormones agissent sur l'endom√®tre",
                        explanation: "L'endom√®tre s'√©paissit d'abord sous l'action des ≈ìstrog√®nes (prolif√©ration) puis se structure gr√¢ce √† la progest√©rone (s√©cr√©tion).",
                        tip: "Endom√®tre = ≈ìstrog√®nes (√©paissir) + progest√©rone (structurer)"
                    },
                    {
                        type: "qcm",
                        keyword: "Menstruation",
                        question: "Pourquoi surviennent les r√®gles en l'absence de grossesse ?",
                        options: ["Exc√®s d'≈ìstrog√®nes", "Chute hormonale", "Pic de FSH", "Manque d'ovulation"],
                        answer: 1,
                        hint: "Arr√™t du 'soutien' hormonal",
                        explanation: "Sans grossesse, le corps jaune d√©g√©n√®re, la progest√©rone chute brutalement, l'endom√®tre se d√©tache = r√®gles.",
                        tip: "R√®gles = chute progest√©rone = endom√®tre qui tombe"
                    },
                    {
                        type: "keyword",
                        keyword: "GnRH",
                        question: "Hormone de lib√©ration des gonadotrophines s√©cr√©t√©e par l'hypothalamus pour stimuler l'hypophyse.",
                        answer: "GnRH",
                        hint: "Hormone du cerveau qui commande le cycle",
                        explanation: "La GnRH (Gonadotropin Releasing Hormone) contr√¥le la s√©cr√©tion de FSH et LH par l'hypophyse.",
                        tip: "GnRH = hypothalamus commande hypophyse"
                    },
                    {
                        type: "vf",
                        keyword: "Temp√©rature corporelle",
                        question: "La temp√©rature corporelle augmente l√©g√®rement apr√®s l'ovulation.",
                        answer: true,
                        hint: "Effect d'une hormone thermog√®ne",
                        explanation: "La progest√©rone a un effet thermog√®ne : la temp√©rature augmente de 0,2-0,5¬∞C apr√®s l'ovulation et reste √©lev√©e.",
                        tip: "Temp√©rature ‚Üó apr√®s ovulation = effet progest√©rone"
                    },
                    {
                        type: "qcm",
                        keyword: "P√©riode fertile",
                        question: "La p√©riode fertile s'√©tend approximativement :",
                        options: ["J1 √† J5", "J10 √† J17", "J20 √† J25", "Tout le cycle"],
                        answer: 1,
                        hint: "Autour de l'ovulation + survie gam√®tes",
                        explanation: "P√©riode fertile = J10-J17 (ovule 24h + spermatozo√Ødes 3 jours avant et apr√®s ovulation J14).",
                        tip: "P√©riode fertile = J10-J17 = 8 jours autour ovulation"
                    },
                    {
                        type: "keyword",
                        keyword: "Glaire cervicale",
                        question: "S√©cr√©tion du col de l'ut√©rus qui se modifie selon le cycle et facilite ou freine la remont√©e des spermatozo√Ødes.",
                        answer: "glaire cervicale",
                        hint: "Barom√®tre de la fertilit√©",
                        explanation: "La glaire cervicale devient filante et abondante avant l'ovulation (≈ìstrog√®nes) puis √©paisse apr√®s (progest√©rone).",
                        tip: "Glaire = ≈ìstrog√®nes (fluide) puis progest√©rone (√©paisse)"
                    }
                ]
            },
            3: {
                title: "Contraception",
                cards: [
                    {
                        type: "keyword",
                        keyword: "Pilule contraceptive",
                        question: "M√©thode hormonale qui bloque l'ovulation par la prise quotidienne d'hormones de synth√®se.",
                        answer: "pilule",
                        hint: "Contraception la plus connue en France",
                        explanation: "La pilule combin√©e contient ≈ìstrog√®nes et progestatifs de synth√®se qui inhibent FSH et LH, bloquant l'ovulation.",
                        tip: "Pilule = blocage ovulation = pas d'≈ìuf = pas de b√©b√©"
                    },
                    {
                        type: "qcm",
                        keyword: "Pr√©servatif",
                        question: "Quel est le principal avantage du pr√©servatif par rapport aux autres contraceptifs ?",
                        options: ["100% efficace", "Protection IST", "Pas d'hormones", "D√©finitif"],
                        answer: 1,
                        hint: "Double protection",
                        explanation: "Le pr√©servatif est le seul contraceptif qui prot√®ge √† la fois des grossesses et des IST (infections sexuellement transmissibles).",
                        tip: "Pr√©servatif = seule protection IST + grossesse"
                    },
                    {
                        type: "keyword",
                        keyword: "DIU",
                        question: "Dispositif Intra-Ut√©rin. Objet plac√© dans l'ut√©rus pour emp√™cher la nidation. Existe au cuivre ou avec hormones.",
                        answer: "DIU",
                        hint: "Anciennement appel√© 'st√©rilet'",
                        explanation: "Le DIU au cuivre a un effet spermicide et emp√™che la nidation. Le DIU hormonal diffuse un progestatif localement.",
                        tip: "DIU = dans l'ut√©rus = longue dur√©e (5-10 ans)"
                    },
                    {
                        type: "vf",
                        keyword: "Efficacit√© contraceptive",
                        question: "Toutes les m√©thodes contraceptives ont la m√™me efficacit√©.",
                        answer: false,
                        hint: "L'efficacit√© varie selon la m√©thode et l'usage",
                        explanation: "L'efficacit√© varie de 70% (spermicides) √† >99% (pilule bien prise, DIU, implant). L'usage parfait vs typique diff√®re.",
                        tip: "Efficacit√© = DIU/implant > pilule > pr√©servatifs > m√©thodes naturelles"
                    },
                    {
                        type: "qcm",
                        keyword: "Contraception d'urgence",
                        question: "Dans quel d√©lai la pilule du lendemain est-elle efficace ?",
                        options: ["12 heures", "72 heures", "1 semaine", "15 jours"],
                        answer: 1,
                        hint: "Plus c'est t√¥t, plus c'est efficace",
                        explanation: "La pilule du lendemain (l√©vonorgestrel) est efficace jusqu'√† 72h apr√®s le rapport, avec efficacit√© d√©croissante.",
                        tip: "Pilule lendemain = 72h max = plus t√¥t = plus efficace"
                    },
                    {
                        type: "keyword",
                        keyword: "Implant contraceptif",
                        question: "B√¢tonnet souple ins√©r√© sous la peau du bras qui lib√®re des hormones pendant 3 ans.",
                        answer: "implant",
                        hint: "Contraception 'invisible' longue dur√©e",
                        explanation: "L'implant lib√®re de l'√©tonogestrel (progestatif) qui bloque l'ovulation pendant 3 ans avec une efficacit√© >99%.",
                        tip: "Implant = 3 ans d'efficacit√© = hormones continues"
                    },
                    {
                        type: "vf",
                        keyword: "Diaphragme",
                        question: "Le diaphragme doit obligatoirement √™tre associ√© √† un spermicide.",
                        answer: true,
                        hint: "Barri√®re physique + chimique",
                        explanation: "Le diaphragme seul n'est pas suffisant. Il doit √™tre enduit de spermicide et pos√© avant chaque rapport.",
                        tip: "Diaphragme = toujours + spermicide = double barri√®re"
                    },
                    {
                        type: "qcm",
                        keyword: "Patch contraceptif",
                        question: "√Ä quelle fr√©quence faut-il changer le patch contraceptif ?",
                        options: ["Chaque jour", "Chaque semaine", "Chaque mois", "Chaque trimestre"],
                        answer: 1,
                        hint: "Changement hebdomadaire",
                        explanation: "Le patch se change chaque semaine pendant 3 semaines, puis 1 semaine d'arr√™t (comme la pilule 21 jours).",
                        tip: "Patch = 1 semaine = 3 patchs + 1 semaine pause"
                    },
                    {
                        type: "keyword",
                        keyword: "Vasectomie",
                        question: "St√©rilisation masculine d√©finitive par section des canaux d√©f√©rents emp√™chant les spermatozo√Ødes de sortir.",
                        answer: "vasectomie",
                        hint: "Contraception masculine d√©finitive",
                        explanation: "La vasectomie coupe les canaux d√©f√©rents. L'√©jaculation persiste mais sans spermatozo√Ødes (liquide des v√©sicules et prostate).",
                        tip: "Vasectomie = coupure canaux = sperme sans spermatozo√Ødes"
                    },
                    {
                        type: "vf",
                        keyword: "M√©thodes naturelles",
                        question: "Les m√©thodes naturelles de contraception sont aussi efficaces que la pilule.",
                        answer: false,
                        hint: "Plus difficiles √† ma√Ætriser",
                        explanation: "Les m√©thodes naturelles (temp√©ratures, glaire, calendrier) ont une efficacit√© moindre (70-80%) et demandent une formation.",
                        tip: "M√©thodes naturelles = moins efficaces = observance difficile"
                    },
                    {
                        type: "qcm",
                        keyword: "Anneau vaginal",
                        question: "Combien de temps l'anneau contraceptif reste-t-il en place ?",
                        options: ["1 semaine", "3 semaines", "1 mois", "3 mois"],
                        answer: 1,
                        hint: "Comme le patch, cycle de 4 semaines",
                        explanation: "L'anneau se porte 3 semaines puis s'enl√®ve 1 semaine pour les 'r√®gles'. Il diffuse hormones localement.",
                        tip: "Anneau = 3 semaines en place + 1 semaine pause"
                    },
                    {
                        type: "keyword",
                        keyword: "Spermicides",
                        question: "Produits chimiques qui d√©truisent les spermatozo√Ødes, utilis√©s seuls ou avec barri√®res m√©caniques.",
                        answer: "spermicides",
                        hint: "Destruction chimique des gam√®tes m√¢les",
                        explanation: "Les spermicides (nonoxynol-9) d√©truisent la membrane des spermatozo√Ødes. Efficacit√© limit√©e seuls (70%).",
                        tip: "Spermicides = d√©truisent spermatozo√Ødes = mieux avec barri√®re"
                    },
                    {
                        type: "vf",
                        keyword: "Ligature des trompes",
                        question: "La ligature des trompes emp√™che d√©finitivement la f√©condation.",
                        answer: true,
                        hint: "St√©rilisation f√©minine",
                        explanation: "La ligature (ou section) des trompes emp√™che la rencontre ovule-spermatozo√Ødes. St√©rilisation d√©finitive f√©minine.",
                        tip: "Ligature trompes = pas de rencontre = st√©rilisation ‚ôÄ"
                    },
                    {
                        type: "qcm",
                        keyword: "Contraception masculine",
                        question: "Quelles sont actuellement les seules m√©thodes contraceptives masculines disponibles ?",
                        options: ["Pilule masculine", "Pr√©servatif et vasectomie", "Implant masculin", "Injection"],
                        answer: 1,
                        hint: "Choix limit√©s pour les hommes",
                        explanation: "Actuellement : pr√©servatifs (r√©versible) et vasectomie (d√©finitive). La contraception masculine hormonale est encore exp√©rimentale.",
                        tip: "Contraception ‚ôÇ = pr√©servatif OU vasectomie (c'est tout !)"
                    },
                    {
                        type: "keyword",
                        keyword: "Progestatifs",
                        question: "Hormones de synth√®se qui imitent l'action de la progest√©rone et bloquent l'ovulation.",
                        answer: "progestatifs",
                        hint: "Hormones artificielles contraceptives",
                        explanation: "Les progestatifs de synth√®se (l√©vonorgestrel, d√©sogestrel...) bloquent FSH/LH et modifient glaire et endom√®tre.",
                        tip: "Progestatifs = progest√©rone artificielle = pilule/implant/DIU"
                    }
                ]
            },
            4: {
                title: "IST & Pr√©vention",
                cards: [
                    {
                        type: "keyword",
                        keyword: "IST",
                        question: "Infections Sexuellement Transmissibles. Maladies qui se transmettent lors des rapports sexuels non prot√©g√©s.",
                        answer: "IST",
                        hint: "Nouveau nom des MST",
                        explanation: "Les IST remplacent le terme MST (maladies). Elles se transmettent par contacts sexuels : p√©n√©tration, sexe oral, contacts g√©nitaux.",
                        tip: "IST = Infections (pas maladies) = transmission sexuelle"
                    },
                    {
                        type: "qcm",
                        keyword: "VIH",
                        question: "Comment se transmet principalement le VIH ?",
                        options: ["Salive", "Sang et s√©cr√©tions", "Air", "Contact peau"],
                        answer: 1,
                        hint: "Virus de l'Immunod√©ficience Humaine",
                        explanation: "Le VIH se transmet par sang, sperme, s√©cr√©tions vaginales et lait maternel. Pas par salive, sueur ou contacts sociaux.",
                        tip: "VIH = sang + s√©cr√©tions sexuelles = pas salive/sueur"
                    },
                    {
                        type: "keyword",
                        keyword: "Chlamydia",
                        question: "IST bact√©rienne tr√®s fr√©quente, souvent asymptomatique, qui peut causer la st√©rilit√© si non trait√©e.",
                        answer: "chlamydia",
                        hint: "IST silencieuse la plus r√©pandue",
                        explanation: "Chlamydia trachomatis provoque ur√©trites et cervicites. Sans traitement, elle peut causer salpingites et st√©rilit√©.",
                        tip: "Chlamydia = fr√©quente + silencieuse = risque st√©rilit√©"
                    },
                    {
                        type: "vf",
                        keyword: "D√©pistage IST",
                        question: "Le d√©pistage des IST se fait uniquement en pr√©sence de sympt√¥mes.",
                        answer: false,
                        hint: "Beaucoup d'IST sont asymptomatiques",
                        explanation: "Le d√©pistage doit √™tre syst√©matique chez les personnes sexuellement actives car beaucoup d'IST sont silencieuses.",
                        tip: "D√©pistage = m√™me sans sympt√¥mes = IST souvent silencieuses"
                    },
                    {
                        type: "qcm",
                        keyword: "Pr√©servatif et IST",
                        question: "Le pr√©servatif prot√®ge de toutes les IST √† quel pourcentage ?",
                        options: ["100%", "85-95%", "70%", "50%"],
                        answer: 1,
                        hint: "Tr√®s efficace mais pas parfait",
                        explanation: "Le pr√©servatif bien utilis√© prot√®ge √† 85-95% des IST. Moins efficace pour herp√®s/HPV (contact peau √† peau possible).",
                        tip: "Pr√©servatif = 85-95% protection IST = tr√®s bon mais pas 100%"
                    },
                    {
                        type: "keyword",
                        keyword: "Syphilis",
                        question: "IST bact√©rienne grave qui √©volue en plusieurs stades et peut atteindre le syst√®me nerveux si non trait√©e.",
                        answer: "syphilis",
                        hint: "Anciennement appel√©e 'mal fran√ßais'",
                        explanation: "La syphilis (Treponema pallidum) √©volue en 3 stades : chancre, ros√©ole, complications neurologiques. Curable par antibiotiques.",
                        tip: "Syphilis = 3 stades = grave si non trait√©e = antibiotiques"
                    },
                    {
                        type: "vf",
                        keyword: "HPV",
                        question: "Le papillomavirus humain (HPV) peut causer des cancers.",
                        answer: true,
                        hint: "Virus tr√®s fr√©quent, parfois dangereux",
                        explanation: "Certains HPV √† haut risque (16, 18) peuvent provoquer cancers du col ut√©rin, vulve, vagin, anus, p√©nis, ORL.",
                        tip: "HPV = fr√©quent + certains types = risque cancer"
                    },
                    {
                        type: "qcm",
                        keyword: "H√©patite B",
                        question: "L'h√©patite B se transmet par :",
                        options: ["Eau contamin√©e", "Rapports sexuels", "Moustiques", "Aliments"],
                        answer: 1,
                        hint: "Virus qui attaque le foie",
                        explanation: "L'h√©patite B se transmet par sang, rapports sexuels et de m√®re √† enfant. Elle peut devenir chronique et causer cirrhose/cancer.",
                        tip: "H√©patite B = sang + sexuel = chronique possible = vaccin existe"
                    },
                    {
                        type: "keyword",
                        keyword: "Gonorrh√©e",
                        question: "IST bact√©rienne appel√©e aussi 'chaude-pisse' qui provoque √©coulements et br√ªlures urinaires.",
                        answer: "gonorrhee",
                        hint: "Sympt√¥mes urinaires typiques",
                        explanation: "La gonorrh√©e (Neisseria gonorrhoeae) cause ur√©trites avec √©coulement purulent et br√ªlures. Complications possibles : st√©rilit√©.",
                        tip: "Gonorrh√©e = br√ªlures + √©coulement = 'chaude-pisse'"
                    },
                    {
                        type: "vf",
                        keyword: "Traitement IST",
                        question: "Toutes les IST peuvent √™tre gu√©ries avec des antibiotiques.",
                        answer: false,
                        hint: "Bact√©ries oui, virus non",
                        explanation: "Les IST bact√©riennes gu√©rissent avec antibiotiques. Les IST virales (herp√®s, VIH, HPV) se contr√¥lent mais ne gu√©rissent pas.",
                        tip: "Antibiotiques = bact√©ries ‚úì / Virus = contr√¥le mais pas gu√©rison"
                    },
                    {
                        type: "qcm",
                        keyword: "Herp√®s g√©nital",
                        question: "Le virus de l'herp√®s g√©nital :",
                        options: ["Gu√©rit spontan√©ment", "Reste √† vie", "Se transmet par l'air", "N'est jamais grave"],
                        answer: 1,
                        hint: "Infection chronique avec pouss√©es",
                        explanation: "L'herp√®s HSV-1 ou HSV-2 persiste √† vie avec des pouss√©es r√©currentes. Traitement antiviral pour r√©duire sympt√¥mes et transmission.",
                        tip: "Herp√®s = √† vie = pouss√©es r√©currentes = antiviraux"
                    },
                    {
                        type: "keyword",
                        keyword: "PrEP",
                        question: "Prophylaxie Pr√©-Exposition. Traitement pr√©ventif contre le VIH pour personnes √† haut risque.",
                        answer: "PrEP",
                        hint: "Pr√©vention VIH avant exposition",
                        explanation: "La PrEP (Truvada) prise quotidiennement r√©duit le risque VIH de >90% chez les personnes √† haut risque (HSH, partenaires VIH+).",
                        tip: "PrEP = pilule anti-VIH pr√©ventive = haut risque = >90% efficacit√©"
                    },
                    {
                        type: "vf",
                        keyword: "SIDA",
                        question: "Le SIDA est le stade final de l'infection par le VIH.",
                        answer: true,
                        hint: "Syndrome d'immunod√©ficience acquise",
                        explanation: "Le SIDA survient quand le VIH a d√©truit suffisamment de CD4+ (d√©fenses immunitaires) pour laisser place aux infections opportunistes.",
                        tip: "SIDA = phase finale VIH = immunit√© d√©truite = infections opportunistes"
                    },
                    {
                        type: "qcm",
                        keyword: "D√©pistage VIH",
                        question: "Le test VIH peut d√©tecter l'infection d√®s :",
                        options: ["Imm√©diatement", "3 jours", "3 semaines", "3 mois"],
                        answer: 2,
                        hint: "P√©riode fen√™tre √† respecter",
                        explanation: "Les tests VIH de 4√®me g√©n√©ration d√©tectent l'infection d√®s 15 jours, mais s√©curit√© √† 6 semaines. TROD : 3 mois.",
                        tip: "Test VIH = 3 semaines (labo) √† 3 mois (TROD) = p√©riode fen√™tre"
                    },
                    {
                        type: "keyword",
                        keyword: "CeGIDD",
                        question: "Centre Gratuit d'Information, de D√©pistage et de Diagnostic des infections par le VIH et les IST.",
                        answer: "CeGIDD",
                        hint: "Ex-CDAG, centres de d√©pistage",
                        explanation: "Les CeGIDD proposent d√©pistage gratuit et anonyme du VIH et IST, conseil, vaccination, orientation. Remplacent CDAG/CIDDIST.",
                        tip: "CeGIDD = d√©pistage gratuit + anonyme + conseil IST/VIH"
                    }
                ]
            },
            5: {
                title: "Synth√®se & Cas Pro",
                cards: [
                    {
                        type: "qcm",
                        keyword: "Conseil contraceptif",
                        question: "Une apprentie de 17 ans en horaires d√©cal√©s souhaite une contraception. Vous recommandez prioritairement :",
                        options: ["Pilule quotidienne", "Pr√©servatifs seuls", "Implant ou DIU", "M√©thodes naturelles"],
                        answer: 2,
                        hint: "Horaires irr√©guliers = m√©thode longue dur√©e",
                        explanation: "Les horaires d√©cal√©s compliquent la prise r√©guli√®re de pilule. L'implant ou DIU conviennent mieux (efficacit√© ind√©pendante de l'observance).",
                        tip: "Horaires d√©cal√©s = oublis pilule = privil√©gier longue dur√©e"
                    },
                    {
                        type: "vf",
                        keyword: "Secret m√©dical mineure",
                        question: "Une mineure peut consulter pour une contraception sans accord parental.",
                        answer: true,
                        hint: "Protection du secret m√©dical",
                        explanation: "Le secret m√©dical prot√®ge les mineures pour la contraception. Consultation et d√©livrance possibles sans autorisation parentale.",
                        tip: "Mineure + contraception = secret m√©dical = pas besoin parents"
                    },
                    {
                        type: "keyword",
                        keyword: "Double protection",
                        question: "Strat√©gie associant contraception efficace ET protection contre les IST, recommand√©e aux jeunes.",
                        answer: "double protection",
                        hint: "Le meilleur des deux mondes",
                        explanation: "Double protection = contraception hormonale (efficacit√©) + pr√©servatif (IST). Id√©al pour couples non stables ou jeunes.",
                        tip: "Double protection = pilule/implant + pr√©servatif = grossesse + IST"
                    },
                    {
                        type: "qcm",
                        keyword: "P√©riode fertile",
                        question: "Une femme avec un cycle irr√©gulier de 25-35 jours a sa p√©riode fertile approximativement :",
                        options: ["Fixe J12-J16", "Variable selon cycle", "Impossible √† d√©terminer", "Tout le cycle"],
                        answer: 1,
                        hint: "Ovulation = 14 jours avant r√®gles suivantes",
                        explanation: "L'ovulation survient 14 jours avant les r√®gles suivantes. Cycle de 25j : ovulation J11, cycle de 35j : ovulation J21.",
                        tip: "Cycle irr√©gulier = ovulation variable = -14j avant r√®gles"
                    },
                    {
                        type: "vf",
                        keyword: "Efficacit√© th√©orique",
                        question: "L'efficacit√© th√©orique d'une contraception est toujours inf√©rieure √† l'efficacit√© pratique.",
                        answer: false,
                        hint: "Th√©orie vs pratique",
                        explanation: "Efficacit√© th√©orique (usage parfait) > efficacit√© pratique (usage courant). Ex: pilule 99% th√©orique vs 91% pratique (oublis).",
                        tip: "Th√©orique (parfait) > pratique (r√©el) = facteur humain"
                    },
                    {
                        type: "keyword",
                        keyword: "IVG",
                        question: "Interruption Volontaire de Grossesse. Acte m√©dical l√©gal en France jusqu'√† 14 semaines de grossesse.",
                        answer: "IVG",
                        hint: "Recours en cas d'√©chec contraceptif",
                        explanation: "L'IVG est autoris√©e en France jusqu'√† 14 SA (semaines d'am√©norrh√©e). D√©lai de r√©flexion supprim√©, gratuit pour mineures.",
                        tip: "IVG = l√©gal France = 14 SA max = gratuit mineures"
                    },
                    {
                        type: "qcm",
                        keyword: "Contraception d'urgence",
                        question: "En cas de rapport non prot√©g√©, la solution la plus efficace est :",
                        options: ["Attendre les r√®gles", "Pilule lendemain", "DIU cuivre d'urgence", "Test de grossesse"],
                        answer: 2,
                        hint: "DIU = plus efficace que pilule d'urgence",
                        explanation: "Le DIU au cuivre pos√© dans les 5 jours est plus efficace (99%) que la pilule du lendemain (85%) et reste contraceptif apr√®s.",
                        tip: "Urgence = DIU cuivre (99%) > pilule lendemain (85%)"
                    },
                    {
                        type: "vf",
                        keyword: "Allaitement contraceptif",
                        question: "L'allaitement maternel exclusif peut servir de contraception naturelle.",
                        answer: true,
                        hint: "MAMA : M√©thode d'Am√©norrh√©e Lactation",
                        explanation: "La MAMA (allaitement exclusif, am√©norrh√©e, <6 mois post-partum) a 98% d'efficacit√©. Conditions strictes n√©cessaires.",
                        tip: "Allaitement = contraceptif si exclusif + <6 mois + am√©norrh√©e"
                    },
                    {
                        type: "keyword",
                        keyword: "Consultation contraceptive",
                        question: "Rendez-vous m√©dical pour choisir, adapter ou changer de m√©thode contraceptive selon la situation personnelle.",
                        answer: "consultation contraceptive",
                        hint: "Accompagnement personnalis√© du choix",
                        explanation: "La consultation contraceptive √©value besoins, contre-indications, mode de vie pour recommander la m√©thode la plus adapt√©e.",
                        tip: "Consultation = personnalis√©e = situation + besoins + contre-indications"
                    },
                    {
                        type: "qcm",
                        keyword: "IST asymptomatiques",
                        question: "Pourquoi les IST asymptomatiques sont-elles particuli√®rement dangereuses ?",
                        options: ["Plus contagieuses", "Transmission inconnue", "Complications tardives", "Incurables"],
                        answer: 2,
                        hint: "Pas de sympt√¥mes = pas de traitement",
                        explanation: "Sans sympt√¥mes, pas de d√©pistage ni traitement. Les complications apparaissent tard : st√©rilit√©, cancers, atteintes d'organes.",
                        tip: "IST silencieuses = pas de traitement = complications tardives graves"
                    },
                    {
                        type: "vf",
                        keyword: "Pr√©servatif f√©minin",
                        question: "Le pr√©servatif f√©minin peut √™tre pos√© plusieurs heures avant le rapport.",
                        answer: true,
                        hint: "Avantage de cette m√©thode",
                        explanation: "Le pr√©servatif f√©minin peut √™tre mis en place jusqu'√† 8h avant le rapport, donnant plus d'autonomie √† la femme.",
                        tip: "Pr√©servatif ‚ôÄ = 8h avant rapport = autonomie f√©minine"
                    },
                    {
                        type: "keyword",
                        keyword: "Education sexuelle",
                        question: "Transmission d'informations sur sexualit√©, reproduction, contraception et IST adapt√©es √† l'√¢ge et au d√©veloppement.",
                        answer: "education sexuelle",
                        hint: "Pr√©vention par l'information",
                        explanation: "L'√©ducation sexuelle vise l'autonomie dans les choix reproductifs et pr√©ventifs. Obligatoire dans le cursus scolaire fran√ßais.",
                        tip: "√âducation sexuelle = information + pr√©vention = choix √©clair√©s"
                    },
                    {
                        type: "qcm",
                        keyword: "Fertilit√©",
                        question: "L'√¢ge optimal pour la fertilit√© f√©minine se situe :",
                        options: ["15-20 ans", "20-30 ans", "30-40 ans", "Indiff√©rent"],
                        answer: 1,
                        hint: "Pic de fertilit√© avant 30 ans",
                        explanation: "La fertilit√© f√©minine est maximale entre 20-30 ans, diminue apr√®s 35 ans et chute fortement apr√®s 40 ans. Facteur √¢ge important.",
                        tip: "Fertilit√© ‚ôÄ = pic 20-30 ans = d√©clin apr√®s 35 ans"
                    },
                    {
                        type: "vf",
                        keyword: "Vaccin HPV",
                        question: "La vaccination contre le HPV prot√®ge contre tous les cancers du col ut√©rin.",
                        answer: false,
                        hint: "Protection partielle mais importante",
                        explanation: "Le vaccin HPV prot√®ge contre 70% des cancers du col (types 16 et 18) et 90% des condylomes (types 6 et 11). D√©pistage reste n√©cessaire.",
                        tip: "Vaccin HPV = 70% cancers col + 90% condylomes = d√©pistage quand m√™me"
                    },
                    {
                        type: "keyword",
                        keyword: "CECOS",
                        question: "Centre d'√âtude et de Conservation des ≈íufs et du Sperme. Banques de gam√®tes pour PMA et don de gam√®tes.",
                        answer: "CECOS",
                        hint: "Conservation des gam√®tes",
                        explanation: "Les CECOS g√®rent don de gam√®tes, conservation pour PMA, pr√©servation fertilit√© (cancer, √¢ge). Activit√© encadr√©e par l'Agence biom√©decine.",
                        tip: "CECOS = banque gam√®tes = don + conservation + PMA"
                    }
                ]
            }
        };

        function startLevel(level) {
            // V√©rifier si le niveau est d√©verrouill√©
            if (level > 1 && levelProgress[level-1] < 60) {
                alert('D√©bloquez d\'abord le niveau pr√©c√©dent avec 60% minimum !');
                return;
            }
            
            currentLevel = level;
            currentCardIndex = 0;
            levelCorrect = 0;
            levelPoints = 0;
            levelErrors = [];
            hintUsed = false;
            
            document.getElementById('homeScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');
            document.getElementById('levelBadge').textContent = `Niveau ${level}`;
            
            showCard();
        }
        
        function showCard() {
            const card = levels[currentLevel].cards[currentCardIndex];
            const total = levels[currentLevel].cards.length;
            
            document.getElementById('cardCounter').textContent = `${currentCardIndex + 1}/${total}`;
            document.getElementById('gameProgress').style.width = `${((currentCardIndex) / total) * 100}%`;
            document.getElementById('cardKeyword').textContent = card.keyword;
            document.getElementById('hintText').textContent = '';
            document.getElementById('hintText').classList.remove('visible');
            hintUsed = false;
            
            // Type de carte
            const typeLabels = { 'keyword': 'MOT-CL√â', 'qcm': 'QCM', 'vf': 'VRAI/FAUX' };
            document.getElementById('cardType').textContent = typeLabels[card.type];
            
            const questionSection = document.getElementById('questionSection');
            
            if (card.type === 'keyword') {
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="input-container">
                        <input type="text" id="keywordAnswer" class="keyword-input" placeholder="Votre r√©ponse..." autocomplete="off">
                    </div>
                `;
                
                // Focus sur l'input et validation par Enter
                setTimeout(() => {
                    const input = document.getElementById('keywordAnswer');
                    input.focus();
                    input.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') validateAnswer();
                    });
                }, 100);
            }
            else if (card.type === 'qcm') {
                let optionsHTML = card.options.map((opt, i) => `
                    <button class="option-btn" data-index="${i}" onclick="selectOption(this)">
                        <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                        <span>${opt}</span>
                    </button>
                `).join('');
                
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="options-container">${optionsHTML}</div>
                `;
            }
            else if (card.type === 'vf') {
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="vf-container">
                        <button class="vf-btn vrai" onclick="selectVF(this, true)">‚úì VRAI</button>
                        <button class="vf-btn faux" onclick="selectVF(this, false)">‚úó FAUX</button>
                    </div>
                `;
            }
        }
        
        function selectOption(btn) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }
        
        function selectVF(btn, value) {
            document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            btn.dataset.value = value;
        }
        
        function showHint() {
            const card = levels[currentLevel].cards[currentCardIndex];
            if (card.hint) {
                document.getElementById('hintText').innerHTML = `üí° <strong>Indice :</strong> ${card.hint}`;
                document.getElementById('hintText').classList.add('visible');
                hintUsed = true;
            }
        }
        
        function validateAnswer() {
            const card = levels[currentLevel].cards[currentCardIndex];
            let isCorrect = false;
            let userAnswer = '';
            
            if (card.type === 'keyword') {
                userAnswer = document.getElementById('keywordAnswer').value.trim().toLowerCase();
                // Normaliser (accents, etc.)
                const normalize = str => str.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
                const normalizedAnswer = normalize(card.answer);
                const normalizedUser = normalize(userAnswer);
                isCorrect = normalizedUser === normalizedAnswer || 
                            normalizedUser.includes(normalizedAnswer) ||
                            normalizedAnswer.includes(normalizedUser);
            }
            else if (card.type === 'qcm') {
                const selected = document.querySelector('.option-btn.selected');
                if (!selected) { alert('S√©lectionne une r√©ponse'); return; }
                userAnswer = parseInt(selected.dataset.index);
                isCorrect = userAnswer === card.answer;
            }
            else if (card.type === 'vf') {
                const selected = document.querySelector('.vf-btn.selected');
                if (!selected) { alert('S√©lectionne VRAI ou FAUX'); return; }
                userAnswer = selected.dataset.value === 'true';
                isCorrect = userAnswer === card.answer;
            }
            
            showFeedback(isCorrect, card);
        }
        
        function showFeedback(isCorrect, card) {
            const overlay = document.getElementById('feedbackOverlay');
            const feedbackCard = document.getElementById('feedbackCard');
            
            let points = 0;
            if (isCorrect) {
                points = hintUsed ? 5 : 10;
                levelCorrect++;
                currentStreak++;
                if (currentStreak > bestStreak) bestStreak = currentStreak;
                
                // Streak bonus
                if (currentStreak === 3) showStreakPopup('üî• 3 de suite !');
                else if (currentStreak === 5) showStreakPopup('üî•üî• 5 de suite !');
                else if (currentStreak === 10) showStreakPopup('üî•üî•üî• INCROYABLE !');
            } else {
                currentStreak = 0;
                levelErrors.push(card.keyword || card.question.replace(/<[^>]*>/g, '').substring(0, 50) + '...');
            }
            
            levelPoints += points;
            totalPoints += points;
            updateScoreDisplay();
            
            feedbackCard.className = 'feedback-card ' + (isCorrect ? 'correct' : 'incorrect');
            document.getElementById('feedbackIcon').textContent = isCorrect ? '‚úÖ' : '‚ùå';
            document.getElementById('feedbackTitle').textContent = isCorrect ? 
                (currentStreak >= 3 ? 'Excellent ! üî•' : 'Bravo !') : 'Pas tout √† fait...';
            document.getElementById('feedbackPoints').textContent = isCorrect ? `+${points} points` : '0 point';
            document.getElementById('feedbackPoints').style.display = isCorrect ? 'block' : 'none';
            
            document.getElementById('feedbackExplanation').innerHTML = `
                <h4>üìö Explication</h4>
                <p>${card.explanation}</p>
                <div class="keyword-box">üîë <span>${card.keyword}</span></div>
                ${card.tip ? `<div class="tip-box"><h5>üí° Astuce BAC</h5><p>${card.tip}</p></div>` : ''}
            `;
            
            overlay.classList.add('visible');
        }
        
        function showStreakPopup(text) {
            const popup = document.getElementById('streakPopup');
            popup.textContent = text;
            popup.style.display = 'block';
            setTimeout(() => { popup.style.display = 'none'; }, 1500);
        }
        
        function nextCard() {
            document.getElementById('feedbackOverlay').classList.remove('visible');
            currentCardIndex++;
            
            if (currentCardIndex >= levels[currentLevel].cards.length) {
                showResults();
            } else {
                showCard();
            }
        }
        
        function showResults() {
            const total = levels[currentLevel].cards.length;
            const percent = Math.round((levelCorrect / total) * 100);
            
            levelProgress[currentLevel] = Math.max(levelProgress[currentLevel], percent);
            
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');
            
            document.getElementById('resultsIcon').textContent = percent >= 80 ? 'üéâ' : percent >= 50 ? 'üëç' : 'üí™';
            document.getElementById('resultsTitle').textContent = percent >= 80 ? 'Niveau r√©ussi !' : percent >= 50 ? 'Pas mal !' : 'Continue !';
            document.getElementById('resultsScore').textContent = percent + '%';
            document.getElementById('correctCount').textContent = levelCorrect + '/' + total;
            document.getElementById('pointsEarned').textContent = '+' + levelPoints;
            document.getElementById('bestStreak').textContent = bestStreak;
            
            // Erreurs
            const errorsRecap = document.getElementById('errorsRecap');
            if (levelErrors.length > 0) {
                errorsRecap.style.display = 'block';
                document.getElementById('errorsList').innerHTML = levelErrors.map(e => `<li>${e}</li>`).join('');
            } else {
                errorsRecap.style.display = 'none';
            }
            
            // Confettis si r√©ussi
            if (percent >= 80) {
                createConfetti();
            }
            
            // Bouton niveau suivant
            document.getElementById('nextLevelBtn').style.display = (currentLevel < 5 && percent >= 60) ? 'flex' : 'none';
            
            updateHomeProgress();
        }
        
        function createConfetti() {
            const colors = ['#ff9a9e', '#fecfef', '#ffd1ff', '#84fab0', '#8fd3f4', '#FFD700'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }
        
        function goHome() {
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('homeScreen').classList.add('active');
            updateHomeProgress();
        }
        
        function retryLevel() {
            startLevel(currentLevel);
        }
        
        function nextLevel() {
            if (currentLevel < 5) {
                startLevel(currentLevel + 1);
                document.getElementById('resultsScreen').classList.remove('active');
            }
        }
        
        function updateScoreDisplay() {
            document.getElementById('totalPoints').textContent = totalPoints;
            document.getElementById('currentStreak').textContent = currentStreak;
        }
        
        function updateHomeProgress() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`level${i}Percent`).textContent = levelProgress[i] + '%';
                document.getElementById(`level${i}Bar`).style.width = levelProgress[i] + '%';
                
                // D√©bloquer niveaux
                const card = document.querySelector(`.niveau-card:nth-child(${i})`);
                if (i === 1 || levelProgress[i-1] >= 60) {
                    card.classList.remove('locked');
                } else {
                    card.classList.add('locked');
                }
            }
        }
        
        // Init
        updateScoreDisplay();
        updateHomeProgress();
    </script>
</body>
</html>