<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module C3 â€“ Visite Virtuelle de l'Atelier</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0891b2;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #1e293b;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0891b2 0%, #0e7490 100%);
            min-height: 100vh;
            padding: 15px;
        }
        
        .container { max-width: 500px; margin: 0 auto; }
        
        .source-banner {
            background: rgba(255,255,255,0.15);
            padding: 6px 12px;
            border-radius: 8px;
            margin-bottom: 12px;
            text-align: center;
        }
        
        .source-banner a { color: rgba(255,255,255,0.9); font-size: 10px; text-decoration: none; }
        
        .screen { display: none; }
        .screen.active { display: block; }
        
        /* Intro */
        .intro-card {
            background: white;
            border-radius: 20px;
            padding: 30px 25px;
            text-align: center;
        }
        
        .intro-card h2 { font-size: 24px; margin-bottom: 12px; color: var(--dark); }
        .intro-card > p { color: #64748b; margin-bottom: 20px; font-size: 14px; }
        
        .objectif-box {
            background: linear-gradient(135deg, #e0f2fe, #bae6fd);
            border-left: 4px solid var(--primary);
            padding: 12px 15px;
            border-radius: 0 10px 10px 0;
            text-align: left;
            margin-bottom: 20px;
        }
        
        .objectif-box strong { color: var(--primary); font-size: 10px; }
        .objectif-box p { font-size: 12px; margin-top: 5px; }
        
        .workplace-selector {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .workplace-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f8fafc;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .workplace-option:hover { border-color: var(--primary); }
        .workplace-option.selected { border-color: var(--primary); background: #e0f2fe; }
        
        .workplace-option .icon { font-size: 35px; }
        .workplace-option .text .name { font-size: 15px; font-weight: 700; color: var(--dark); }
        .workplace-option .text .desc { font-size: 11px; color: #64748b; }
        
        .btn-start {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, var(--primary), #0e7490);
            color: white;
            font-family: inherit;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
        }
        
        .btn-start:disabled { opacity: 0.5; cursor: not-allowed; }
        
        /* Game */
        .game-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .game-header h3 { font-size: 14px; color: var(--dark); }
        
        .stats { display: flex; gap: 10px; }
        
        .stat {
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .stat.score { background: #fef3c7; color: #92400e; }
        .stat.progress { background: #dcfce7; color: #166534; }
        
        .progress-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), #06b6d4);
            border-radius: 10px;
            transition: width 0.4s ease;
        }
        
        /* Zone actuelle */
        .zone-display {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .zone-display .zone-icon {
            font-size: 50px;
            margin-bottom: 10px;
        }
        
        .zone-display .zone-name {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 5px;
        }
        
        .zone-display .zone-desc {
            font-size: 12px;
            color: #64748b;
        }
        
        .question {
            text-align: center;
            font-size: 14px;
            font-weight: 600;
            color: #475569;
            margin-bottom: 15px;
            padding: 10px;
            background: #fef3c7;
            border-radius: 10px;
        }
        
        /* Grille de pictogrammes 2x2 */
        .picto-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .picto-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            background: #f8fafc;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .picto-option:hover { border-color: var(--primary); transform: translateY(-2px); }
        .picto-option:active { transform: scale(0.98); }
        
        .picto-option img {
            width: 60px;
            height: 60px;
            object-fit: contain;
            margin-bottom: 8px;
        }
        
        .picto-option .name {
            font-size: 11px;
            font-weight: 600;
            color: var(--dark);
            text-align: center;
        }
        
        .picto-option.correct {
            border-color: var(--success);
            background: #dcfce7;
        }
        
        .picto-option.wrong {
            border-color: var(--danger);
            background: #fee2e2;
        }
        
        .feedback {
            text-align: center;
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
            display: none;
        }
        
        .feedback.show { display: block; animation: fadeIn 0.3s; }
        .feedback.success { background: #dcfce7; }
        .feedback.error { background: #fee2e2; }
        
        .feedback h4 { font-size: 16px; margin-bottom: 5px; }
        .feedback.success h4 { color: #166534; }
        .feedback.error h4 { color: #991b1b; }
        .feedback p { font-size: 12px; color: #475569; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Results */
        .results-card {
            background: white;
            border-radius: 20px;
            padding: 30px 25px;
            text-align: center;
        }
        
        .results-card .trophy { font-size: 70px; margin-bottom: 15px; }
        .results-card h2 { font-size: 24px; margin-bottom: 8px; color: var(--dark); }
        .results-card > p { color: #64748b; margin-bottom: 25px; font-size: 14px; }
        
        .results-stats {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .results-stats .stat-box { text-align: center; }
        .results-stats .stat-box .val { font-size: 32px; font-weight: 800; color: var(--primary); }
        .results-stats .stat-box .lbl { font-size: 11px; color: #64748b; }
        
        .btn-restart {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, var(--primary), #0e7490);
            color: white;
            font-family: inherit;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
        }
    </style>
</head>
<body>
    
    <div class="container">
        
        <div class="source-banner">
            <a href="https://www.inrs.fr" target="_blank">ğŸ“š Source : INRS â€“ www.inrs.fr</a>
        </div>
        
        <!-- Intro -->
        <div class="screen active" id="intro-screen">
            <div class="intro-card">
                <h2>ğŸ­ Visite Virtuelle</h2>
                <p>Identifie les pictogrammes dans chaque zone de travail !</p>
                
                <div class="objectif-box">
                    <strong>ğŸ¯ OBJECTIF</strong>
                    <p>ÃŠtre capable de <strong>reconnaÃ®tre</strong> les pictogrammes adaptÃ©s Ã  chaque zone d'un lieu de travail.</p>
                </div>
                
                <p style="font-weight: 600; margin-bottom: 12px; font-size: 13px;">Choisis ton lieu :</p>
                
                <div class="workplace-selector">
                    <div class="workplace-option" onclick="selectWorkplace('cuisine')" data-wp="cuisine">
                        <div class="icon">ğŸ‘¨â€ğŸ³</div>
                        <div class="text">
                            <div class="name">Cuisine professionnelle</div>
                            <div class="desc">Restaurant / Cantine</div>
                        </div>
                    </div>
                    <div class="workplace-option" onclick="selectWorkplace('atelier')" data-wp="atelier">
                        <div class="icon">ğŸ”§</div>
                        <div class="text">
                            <div class="name">Atelier mÃ©canique</div>
                            <div class="desc">Garage / Maintenance</div>
                        </div>
                    </div>
                    <div class="workplace-option" onclick="selectWorkplace('labo')" data-wp="labo">
                        <div class="icon">ğŸ”¬</div>
                        <div class="text">
                            <div class="name">Laboratoire</div>
                            <div class="desc">Chimie / Biologie</div>
                        </div>
                    </div>
                </div>
                
                <button class="btn-start" id="btn-start" onclick="startGame()" disabled>Commencer la visite ğŸš€</button>
            </div>
        </div>
        
        <!-- Game -->
        <div class="screen" id="game-screen">
            <div class="game-card">
                <div class="game-header">
                    <h3 id="workplace-title">ğŸ­ Cuisine</h3>
                    <div class="stats">
                        <div class="stat score" id="score">0 pts</div>
                        <div class="stat progress" id="progress">1/6</div>
                    </div>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-bar" style="width: 16.66%;"></div>
                </div>
                
                <div class="zone-display">
                    <div class="zone-icon" id="zone-icon">ğŸšª</div>
                    <div class="zone-name" id="zone-name">EntrÃ©e</div>
                    <div class="zone-desc" id="zone-desc">Tu arrives Ã  l'entrÃ©e du lieu de travail.</div>
                </div>
                
                <div class="question" id="question">
                    Quel pictogramme doit Ãªtre affichÃ© ici ?
                </div>
                
                <div class="picto-options" id="picto-options">
                    <!-- GÃ©nÃ©rÃ© dynamiquement -->
                </div>
                
                <div class="feedback" id="feedback">
                    <h4 id="feedback-title"></h4>
                    <p id="feedback-text"></p>
                </div>
            </div>
        </div>
        
        <!-- Results -->
        <div class="screen" id="results-screen">
            <div class="results-card">
                <div class="trophy" id="trophy">ğŸ†</div>
                <h2 id="results-title">Visite terminÃ©e !</h2>
                <p id="results-msg">Tu connais bien ce lieu de travail !</p>
                
                <div class="results-stats">
                    <div class="stat-box">
                        <div class="val" id="final-score">0</div>
                        <div class="lbl">Points</div>
                    </div>
                    <div class="stat-box">
                        <div class="val" id="final-correct">0/6</div>
                        <div class="lbl">Bonnes rÃ©ponses</div>
                    </div>
                </div>
                
                <button class="btn-restart" onclick="restartGame()">ğŸ”„ Nouveau lieu</button>
            </div>
        </div>
        
    </div>
    
    <script>
        const allPictos = {
            gants: { name: "Port des gants", image: "pictogrammes/images/OBLIGATION-gants.jpg" },
            casque: { name: "Port du casque", image: "pictogrammes/images/OBLIGATION-casque.jpg" },
            chaussures: { name: "Chaussures sÃ©curitÃ©", image: "pictogrammes/images/OBLIGATION-chaussures.jpg" },
            lunettes: { name: "Lunettes protection", image: "pictogrammes/images/OBLIGATION-lunettes.jpg" },
            antibruit: { name: "Protection auditive", image: "pictogrammes/images/OBLIGATION-casque-antibruit.jpg" },
            masque: { name: "Masque respiratoire", image: "pictogrammes/images/OBLIGATION-protection-voies-espiratoires.jpg" },
            combinaison: { name: "Tenue obligatoire", image: "pictogrammes/images/OBLIGATION-combinaison.jpg" },
            fumer: { name: "Interdiction fumer", image: "pictogrammes/images/INTERDIT-fumer.jpg" },
            flamme: { name: "Flamme interdite", image: "pictogrammes/images/INTERDIT-flamme.jpg" },
            entrer: { name: "AccÃ¨s interdit", image: "pictogrammes/images/INTERDIT-entrer.jpg" },
            electricite: { name: "Danger Ã©lectrique", image: "pictogrammes/images/DANGER-electricite.jpg" },
            chute: { name: "Danger chute", image: "pictogrammes/images/DANGER-chute.jpg" },
            toxique: { name: "Produit toxique", image: "pictogrammes/images/DANGER-produit-toxique.jpg" },
            chariot: { name: "Chariot Ã©lÃ©vateur", image: "pictogrammes/images/DANGER-chariot.jpg" },
            biologique: { name: "Risque biologique", image: "pictogrammes/images/DANGER-risque-biologique.jpg" },
            extincteur: { name: "Extincteur", image: "pictogrammes/images/INCENDIE-extincteur.jpg" },
            sortie: { name: "Sortie secours", image: "pictogrammes/images/SECOURS-sortie-vers-droite.jpg" },
            rassemblement: { name: "Point rassemblement", image: "pictogrammes/images/SECOURS-point-rassemblement.jpg" },
            secours: { name: "Premiers secours", image: "pictogrammes/images/SECOURS-croix.jpg" }
        };
        
        const workplaces = {
            cuisine: {
                name: "Cuisine professionnelle",
                icon: "ğŸ‘¨â€ğŸ³",
                zones: [
                    { icon: "ğŸšª", name: "EntrÃ©e cuisine", desc: "Ã‰quipement obligatoire pour entrer.", correct: "combinaison", options: ["combinaison", "casque", "antibruit", "entrer"] },
                    { icon: "ğŸ”¥", name: "Zone cuisson", desc: "Fours et plaques de cuisson.", correct: "extincteur", options: ["extincteur", "chariot", "lunettes", "sortie"] },
                    { icon: "ğŸ§¼", name: "Plonge", desc: "Nettoyage de la vaisselle.", correct: "gants", options: ["gants", "casque", "masque", "fumer"] },
                    { icon: "ğŸ§´", name: "Stockage produits", desc: "Produits d'entretien stockÃ©s.", correct: "fumer", options: ["fumer", "antibruit", "chute", "secours"] },
                    { icon: "ğŸš¨", name: "Issue de secours", desc: "Sortie en cas d'Ã©vacuation.", correct: "sortie", options: ["sortie", "extincteur", "gants", "toxique"] },
                    { icon: "ğŸ…¿ï¸", name: "Parking", desc: "Point de rassemblement dehors.", correct: "rassemblement", options: ["rassemblement", "entrer", "combinaison", "flamme"] }
                ]
            },
            atelier: {
                name: "Atelier mÃ©canique",
                icon: "ğŸ”§",
                zones: [
                    { icon: "ğŸ‘”", name: "Vestiaire", desc: "S'Ã©quiper avant d'entrer.", correct: "chaussures", options: ["chaussures", "combinaison", "fumer", "sortie"] },
                    { icon: "âš¡", name: "Armoire Ã©lectrique", desc: "Tableau haute tension.", correct: "electricite", options: ["electricite", "toxique", "gants", "rassemblement"] },
                    { icon: "ğŸ“¦", name: "EntrepÃ´t", desc: "Circulation de chariots.", correct: "chariot", options: ["chariot", "chute", "masque", "extincteur"] },
                    { icon: "ğŸ”Š", name: "Zone bruyante", desc: "Machines trÃ¨s bruyantes.", correct: "antibruit", options: ["antibruit", "lunettes", "fumer", "secours"] },
                    { icon: "ğŸš§", name: "Zone restreinte", desc: "AccÃ¨s personnel autorisÃ©.", correct: "entrer", options: ["entrer", "flamme", "casque", "sortie"] },
                    { icon: "ğŸ§¯", name: "Point incendie", desc: "Ã‰quipement anti-feu.", correct: "extincteur", options: ["extincteur", "rassemblement", "chaussures", "toxique"] }
                ]
            },
            labo: {
                name: "Laboratoire",
                icon: "ğŸ”¬",
                zones: [
                    { icon: "ğŸšª", name: "EntrÃ©e labo", desc: "Tenue obligatoire pour entrer.", correct: "combinaison", options: ["combinaison", "casque", "chariot", "sortie"] },
                    { icon: "ğŸ§ª", name: "Paillasse chimie", desc: "Manipulation de produits.", correct: "lunettes", options: ["lunettes", "antibruit", "fumer", "rassemblement"] },
                    { icon: "ğŸŒ¬ï¸", name: "Hotte aspirante", desc: "Vapeurs dangereuses.", correct: "masque", options: ["masque", "chaussures", "extincteur", "entrer"] },
                    { icon: "ğŸ—„ï¸", name: "Armoire produits", desc: "Stockage produits chimiques.", correct: "toxique", options: ["toxique", "chariot", "antibruit", "secours"] },
                    { icon: "ğŸ¦ ", name: "Zone biologique", desc: "Manipulation d'Ã©chantillons.", correct: "biologique", options: ["biologique", "electricite", "gants", "flamme"] },
                    { icon: "ğŸš¨", name: "Issue de secours", desc: "Sortie d'Ã©vacuation.", correct: "sortie", options: ["sortie", "extincteur", "combinaison", "casque"] }
                ]
            }
        };
        
        let selectedWorkplace = null;
        let currentZone = 0;
        let score = 0;
        let correctCount = 0;
        let canAnswer = true;
        
        function selectWorkplace(wp) {
            selectedWorkplace = wp;
            document.querySelectorAll('.workplace-option').forEach(opt => {
                opt.classList.toggle('selected', opt.dataset.wp === wp);
            });
            document.getElementById('btn-start').disabled = false;
        }
        
        function startGame() {
            document.getElementById('intro-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            
            currentZone = 0;
            score = 0;
            correctCount = 0;
            
            const wp = workplaces[selectedWorkplace];
            document.getElementById('workplace-title').textContent = wp.icon + ' ' + wp.name;
            
            loadZone();
        }
        
        function loadZone() {
            canAnswer = true;
            const wp = workplaces[selectedWorkplace];
            const zone = wp.zones[currentZone];
            
            document.getElementById('score').textContent = score + ' pts';
            document.getElementById('progress').textContent = (currentZone + 1) + '/' + wp.zones.length;
            document.getElementById('progress-bar').style.width = ((currentZone + 1) / wp.zones.length * 100) + '%';
            
            document.getElementById('zone-icon').textContent = zone.icon;
            document.getElementById('zone-name').textContent = zone.name;
            document.getElementById('zone-desc').textContent = zone.desc;
            
            // Shuffle options
            const shuffledOptions = [...zone.options].sort(() => Math.random() - 0.5);
            
            const container = document.getElementById('picto-options');
            container.innerHTML = shuffledOptions.map(key => {
                const picto = allPictos[key];
                return `
                    <div class="picto-option" data-key="${key}" onclick="answer('${key}')">
                        <img src="${picto.image}" alt="${picto.name}">
                        <div class="name">${picto.name}</div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('feedback').classList.remove('show', 'success', 'error');
        }
        
        function answer(key) {
            if (!canAnswer) return;
            canAnswer = false;
            
            const wp = workplaces[selectedWorkplace];
            const zone = wp.zones[currentZone];
            const feedback = document.getElementById('feedback');
            
            document.querySelectorAll('.picto-option').forEach(opt => {
                opt.style.pointerEvents = 'none';
                if (opt.dataset.key === zone.correct) {
                    opt.classList.add('correct');
                }
            });
            
            if (key === zone.correct) {
                document.querySelector(`.picto-option[data-key="${key}"]`).classList.add('correct');
                score += 15;
                correctCount++;
                
                feedback.classList.add('show', 'success');
                document.getElementById('feedback-title').textContent = 'âœ… Bravo !';
                document.getElementById('feedback-text').textContent = 'C\'est le bon pictogramme pour cette zone.';
            } else {
                document.querySelector(`.picto-option[data-key="${key}"]`).classList.add('wrong');
                
                feedback.classList.add('show', 'error');
                document.getElementById('feedback-title').textContent = 'âŒ Pas tout Ã  fait...';
                document.getElementById('feedback-text').textContent = 'Le bon pictogramme Ã©tait : ' + allPictos[zone.correct].name;
            }
            
            document.getElementById('score').textContent = score + ' pts';
            
            setTimeout(() => {
                currentZone++;
                if (currentZone < wp.zones.length) {
                    loadZone();
                } else {
                    showResults();
                }
            }, 1500);
        }
        
        function showResults() {
            document.getElementById('game-screen').classList.remove('active');
            document.getElementById('results-screen').classList.add('active');
            
            const wp = workplaces[selectedWorkplace];
            
            document.getElementById('final-score').textContent = score;
            document.getElementById('final-correct').textContent = correctCount + '/' + wp.zones.length;
            
            const pct = (correctCount / wp.zones.length) * 100;
            
            if (pct === 100) {
                document.getElementById('trophy').textContent = 'ğŸ†';
                document.getElementById('results-title').textContent = 'Parfait !';
                document.getElementById('results-msg').textContent = 'Tu connais parfaitement ce lieu !';
            } else if (pct >= 66) {
                document.getElementById('trophy').textContent = 'ğŸŒŸ';
                document.getElementById('results-title').textContent = 'Excellent !';
                document.getElementById('results-msg').textContent = 'TrÃ¨s bonne visite !';
            } else {
                document.getElementById('trophy').textContent = 'ğŸ’ª';
                document.getElementById('results-title').textContent = 'Continue !';
                document.getElementById('results-msg').textContent = 'RÃ©vise les pictogrammes de ce lieu.';
            }
        }
        
        function restartGame() {
            document.getElementById('results-screen').classList.remove('active');
            document.getElementById('intro-screen').classList.add('active');
            selectedWorkplace = null;
            document.querySelectorAll('.workplace-option').forEach(opt => opt.classList.remove('selected'));
            document.getElementById('btn-start').disabled = true;
        }
    </script>
    
</body>
</html>
