<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module A2: Le Sommeil - S√©ance 2 (Rythmes Biologiques)</title>
    <style>
        /* ==================================== */
        /* STYLES DE BASE (Identiques √† la S√©ance 1 V5) */
        /* ==================================== */
        body {
            font-family: Arial, sans-serif;
            line-height: 1.8;
            padding: 0;
            margin: 0;
            background-color: #f4f7f9;
            display: flex;
        }
        
        .content-area {
            flex-grow: 1; 
            max-width: 800px;
            padding: 30px;
        }

        .module-header {
            background-color: #007bff;
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
        }

        .section-box {
            background-color: white;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        h2 { color: #007bff; border-bottom: 3px solid #ffcc00; padding-bottom: 5px; }
        h3 { color: #343a40; margin-top: 25px; }
        
        .document-a {
            background-color: #e0f0ff; /* Bleu tr√®s clair pour le document texte */
            border: 2px solid #007bff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .document-image {
            display: block;
            margin: 15px auto;
            max-width: 90%;
            height: auto;
            border: 2px solid #ccc;
            border-radius: 5px;
        }

        /* Styles Barre Lat√©rale (Simplifi√©e V5) */
        .sidebar {
            width: 250px;
            background-color: #e9ecef;
            padding: 15px;
            position: sticky; 
            top: 0;
            height: 100vh;
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
        }
        
        .sidebar h3 { color: #495057; border-bottom: 1px solid #adb5bd; padding-bottom: 5px; margin-bottom: 15px; }
        .sidebar-group { margin-bottom: 20px; padding: 10px; border: 1px solid #dee2e6; border-radius: 5px; background-color: #f8f9fa; }
        .sidebar-group p { font-weight: bold; }
        .sidebar button { width: 100%; padding: 10px; margin-top: 8px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: background-color 0.2s; }
        .save-btn { background-color: #28a745; color: white; }
        .load-btn { background-color: #ffc107; color: #343a40; }
        .reset-btn { background-color: #dc3545; color: white; }
        .audio-btn { background-color: #17a2b8; color: white; }
        #confirmation-message { margin-top: 15px; padding: 10px; background-color: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; border-radius: 5px; text-align: center; display: none; font-size: 0.9em; opacity: 0; transition: opacity 0.5s ease-in-out; }
        
        /* INTERACTIVIT√â S√âANCE 2 */
        .mot-cle {
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 5px;
            transition: all 0.2s;
            display: inline-block;
            margin: 6px;
            font-weight: bold;
            border: 3px solid #007bff;
            color: #007bff;
            background-color: #e0f0ff;
            font-size: 1.1em;
        }
        .mot-cle:hover {
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(0, 123, 255, 0.7);
        }
        .mot-cle.selected {
            background-color: #28a745;
            color: white;
            border-color: #1e7e34;
        }
        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            display: none;
            font-weight: bold;
            font-size: 1.1em;
        }
        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .feedback.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
    </style>
</head>
<body>

    <div class="sidebar">
        
        <h3>‚öôÔ∏è Options pour m'aider</h3>
        
        <div class="sidebar-group">
            <p>1. Audio (√âcoute des consignes)</p>
            <button onclick="playAudio()" id="play-button" class="audio-btn">‚ñ∂Ô∏è √âcouter</button>
            <button onclick="stopAudio()" id="stop-button" class="audio-btn" disabled>‚èπÔ∏è Arr√™ter</button>
            <audio id="course-audio" src="audio_seance2.mp3" preload="auto"></audio>
        </div>
        
        <div class="sidebar-group">
            <p>2. Taille du Texte (Loupe)</p>
            <label for="font-size-slider">Agrandir :</label>
            <input type="range" id="font-size-slider" min="100" max="180" value="100" step="10" oninput="changeFontSize(this.value)">
            <span id="font-size-value">100%</span>
        </div>
        
        <hr style="border-top: 1px solid #adb5bd;">

        <h3>üíæ Mon travail</h3>
        <button onclick="saveProgress()" class="save-btn">üíæ Enregistrer ma page</button>
        <button onclick="loadProgress(true)" class="load-btn">‚Ü©Ô∏è Reprendre mon travail</button>
        <button onclick="resetProgress()" class="reset-btn">üóëÔ∏è R√©initialiser tout</button>
        
        <div id="confirmation-message"></div>
    </div>

    <div class="content-area" id="main-content">
        
        <div class="module-header">
            <h1>MODULE A2: Le sommeil, un rythme biologique</h1>
            <h2>S√©ance 2 : Comment notre corps fonctionne-t-il ?</h2>
        </div>

        <div class="section-box">
            <h3>üéØ Objectifs Simples</h3>
            <ul>
                <li>**Je d√©couvre** ce qu'est un rythme biologique.</li>
                <li>**J'identifie** ce qui nous aide √† dormir ou √† rester √©veill√©.</li>
            </ul>
            <p style="font-size: 0.9em; margin-top: 15px;">Comp√©tences CAP : C1, C3 - Comprendre le fonctionnement de base du corps.</p>
        </div>

        <div class="section-box">
            <h3 style="color: #dc3545;">üî¥ √âTAPE 1 : D√©couvrir les Rythmes</h3>

            <h4>Document A : Le rythme Veille / Sommeil (Texte)</h4>
            <div class="document-a">
                <p>Un exemple de rythme biologique : l'alternance veille / sommeil.</p>
                <p>Un rythme biologique, c'est quelque chose que le corps **r√©p√®te chaque jour**.</p>
                <p>Le sommeil est un rythme biologique. Le corps fonctionne sur un **cycle d'environ 24 heures**.</p>
                <p>On appelle cela un **rythme circadien**.</p>
                <p>La **lumi√®re du jour** aide le corps √† rester √©veill√©.</p>
                <p>L'absence de lumi√®re aide le corps √† dormir.</p>
                <p>La nuit, le corps fabrique une hormone du sommeil appel√©e **m√©latonine**.</p>
                <p>Cette hormone aide √† s'endormir.</p>
            </div>
            
            <h4>Document B : Cycle Jour/Nuit et M√©latonine (Sch√©ma)</h4>
            <img src="cycle_melatonine_graph.jpg" alt="Sch√©ma montrant le cycle Jour/Nuit, la lumi√®re et la production de m√©latonine." class="document-image">
        </div>

        <div class="section-box">
            <h3 style="color: #ffc107;">üü° √âTAPE 2 : R√©pondre par Clic</h3>
            
            <h4>3.1 D√©finir un rythme biologique (Clic unique)</h4>
            <p>Dans le Document A, clique sur le mot ou l'expression qui d√©finit un rythme biologique (ce que notre corps fait tout le temps) :</p>
            <div id="q3_1-container">
                <span class="mot-cle" data-answer="sommeil" data-q="q3_1">Le sommeil</span>
                <span class="mot-cle" data-answer="repete_chaque_jour" data-q="q3_1">R√©p√®te chaque jour</span>
                <span class="mot-cle" data-answer="melatonine" data-q="q3_1">La m√©latonine</span>
            </div>
            <button onclick="checkAnswer('q3_1', 'repete_chaque_jour')" style="margin-top: 10px; padding: 8px 15px; background-color: #007bff; color: white; border: none; border-radius: 5px;">V√©rifier üîç</button>
            <div class="feedback" id="feedback-q3_1"></div>

            <hr>

            <h4>3.2 Indiquer la dur√©e du rythme et son nom (Clics multiples)</h4>
            <p>Clique sur les **DEUX** bonnes r√©ponses (une dur√©e et un nom) :</p>
            <div id="q3_2-container">
                <span class="mot-cle" data-answer="24h" data-q="q3_2">24 heures</span>
                <span class="mot-cle" data-answer="12h" data-q="q3_2">12 heures</span>
                <span class="mot-cle" data-answer="circadien" data-q="q3_2">Rythme circadien</span>
                <span class="mot-cle" data-answer="biologique" data-q="q3_2">Rythme biologique</span>
            </div>
            <button onclick="checkAnswerMulti('q3_2', ['24h', 'circadien'])" style="margin-top: 10px; padding: 8px 15px; background-color: #007bff; color: white; border: none; border-radius: 5px;">V√©rifier üîç</button>
            <div class="feedback" id="feedback-q3_2"></div>
        </div>
        
        <div class="section-box">
            <h3 style="color: #28a745;">üü¢ √âTAPE 3 : La M√©latonine</h3>

            <h4>3.3 Citer le facteur ext√©rieur (Clic unique)</h4>
            <p>Qu'est-ce qui fait commencer la production de l'hormone du sommeil (m√©latonine) ? (Regarde le Document A)</p>
            <div id="q3_3-container">
                <span class="mot-cle" data-answer="lumiere_jour" data-q="q3_3">La lumi√®re du jour</span>
                <span class="mot-cle" data-answer="absence_lumiere" data-q="q3_3">L'absence de lumi√®re</span>
                <span class="mot-cle" data-answer="le_diner" data-q="q3_3">Le d√Æner</span>
            </div>
            <button onclick="checkAnswer('q3_3', 'absence_lumiere')" style="margin-top: 10px; padding: 8px 15px; background-color: #007bff; color: white; border: none; border-radius: 5px;">V√©rifier üîç</button>
            <div class="feedback" id="feedback-q3_3"></div>

            <hr>

            <h4>3.5 Pr√©ciser l'heure de d√©but (Clic sur l'heure)</h4>
            <p>√Ä quelle heure la m√©latonine commence-t-elle √† monter fortement, d'apr√®s le graphique (Document B) ?</p>
            <div id="q3_5-container">
                <span class="mot-cle" data-answer="18h" data-q="q3_5">18 h</span>
                <span class="mot-cle" data-answer="20h" data-q="q3_5">20 h</span>
                <span class="mot-cle" data-answer="00h" data-q="q3_5">00 h</span>
            </div>
            <button onclick="checkAnswer('q3_5', '20h')" style="margin-top: 10px; padding: 8px 15px; background-color: #007bff; color: white; border: none; border-radius: 5px;">V√©rifier üîç</button>
            <div class="feedback" id="feedback-q3_5"></div>
            
            </div>
        
        <hr>
        
        <div class="section-box" style="text-align: center; background-color: #e0f0ff;">
            <h3>Tr√®s bien ! Tu as termin√© la S√©ance 2.</h3>
            <p>N'oublie pas d'enregistrer ta page.</p>
        </div>

    </div>


    <script>
        // ====================================
        // JAVASCRIPT : ADAPT√â POUR LA S√âANCE 2
        // ====================================
        
        const localStorageKey = 'courseProgress_A2_S2'; // Cl√© chang√©e pour la S√©ance 2
        const confirmationMessage = document.getElementById('confirmation-message');

        function showConfirmation(message) {
            confirmationMessage.innerText = message;
            confirmationMessage.style.display = 'block';
            confirmationMessage.style.opacity = 1;
            
            setTimeout(() => {
                confirmationMessage.style.opacity = 0;
                setTimeout(() => confirmationMessage.style.display = 'none', 500); 
            }, 3000);
        }

        // --- AUDIO ---
        const audio = document.getElementById('course-audio');
        const playButton = document.getElementById('play-button');
        const stopButton = document.getElementById('stop-button');

        function playAudio() {
            if (audio.error) {
                showConfirmation("‚ùå Erreur : Le fichier audio est introuvable (audio_seance2.mp3).");
                return;
            }
            if (audio.readyState < 2) {
                showConfirmation("‚è≥ Chargement de l'audio en cours, veuillez r√©essayer.");
                audio.load();
                return;
            }
            
            audio.play();
            playButton.disabled = true;
            stopButton.disabled = false;
        }

        function stopAudio() {
            audio.pause();
            audio.currentTime = 0;
            playButton.disabled = false;
            stopButton.disabled = true;
        }
        audio.onended = function() {
            playButton.disabled = false;
            stopButton.disabled = true;
        };
        audio.onerror = function() {
            showConfirmation("‚ùå Erreur de lecture de l'audio. Assurez-vous que le fichier est bien l√†.");
            playButton.disabled = true;
            stopButton.disabled = true;
        };


        // --- TAILLE DU TEXTE ---
        function changeFontSize(value) {
            document.getElementById('main-content').style.fontSize = value + '%';
            document.getElementById('font-size-value').innerText = value + '%';
            saveState('font-size-slider', value);
        }

        // --- INTERACTIVIT√â (Clics) ---
        const motCles = document.querySelectorAll('.mot-cle');
        motCles.forEach(mot => {
            mot.addEventListener('click', function() {
                // Pour toutes les questions de la S√©ance 2 qui sont √† choix unique (data-q="q3_1", "q3_3", "q3_5")
                if (mot.dataset.q === 'q3_1' || mot.dataset.q === 'q3_3' || mot.dataset.q === 'q3_5') {
                    document.querySelectorAll(`.mot-cle[data-q="${mot.dataset.q}"]`).forEach(m => m.classList.remove('selected'));
                    this.classList.add('selected');
                }
                // Pour la question √† choix multiple (q3_2)
                if (mot.dataset.q === 'q3_2') {
                    this.classList.toggle('selected');
                }
            });
        });

        function checkAnswer(questionId, correctAnswer) {
            const selectedWord = document.querySelector(`.mot-cle[data-q="${questionId}"].selected`);
            const feedbackElement = document.getElementById(`feedback-${questionId}`);
            document.querySelectorAll('.feedback').forEach(f => f.style.display = 'none');

            if (selectedWord) {
                const isCorrect = selectedWord.dataset.answer === correctAnswer;
                feedbackElement.className = isCorrect ? 'feedback correct' : 'feedback incorrect';
                feedbackElement.style.display = 'block';
                feedbackElement.innerHTML = isCorrect ? '‚úîÔ∏è **Bravo !** Bonne r√©ponse.' : '‚ùå **Non, essaie encore.** Relis le Document A ou regarde le graphique.';
                saveState(questionId, selectedWord.dataset.answer);
            } else {
                showConfirmation("‚ö†Ô∏è Clique sur un mot pour r√©pondre !");
            }
        }

        function checkAnswerMulti(questionId, correctAnswers) {
            const selectedWords = document.querySelectorAll(`.mot-cle[data-q="${questionId}"].selected`);
            const feedbackElement = document.getElementById(`feedback-${questionId}`);
            document.querySelectorAll('.feedback').forEach(f => f.style.display = 'none');
            
            const selectedText = Array.from(selectedWords).map(m => m.dataset.answer);
            const isCorrect = correctAnswers.every(answer => selectedText.includes(answer)) && selectedText.length === correctAnswers.length;

            feedbackElement.className = isCorrect ? 'feedback correct' : 'feedback incorrect';
            feedbackElement.style.display = 'block';
            feedbackElement.innerHTML = isCorrect ? '‚úîÔ∏è **G√©nial !** Le rythme circadien dure bien 24 heures.' : '‚ùå **Attention.** Tu dois choisir la dur√©e et le nom corrects.';
            
            saveState(questionId, selectedText);
        }
        
        // Pas de Glisser-D√©poser dans cette s√©ance, donc les fonctions sont omises pour all√©ger.

        // --- SAUVEGARDE & REPRISE & R√âINITIALISATION ---
        
        function saveState(key, value) {
            const progress = JSON.parse(localStorage.getItem(localStorageKey) || '{}');
            progress[key] = value;
            localStorage.setItem(localStorageKey, JSON.stringify(progress));
        }

        function loadState() {
            return JSON.parse(localStorage.getItem(localStorageKey) || '{}');
        }

        function saveProgress() {
            showConfirmation("‚úÖ Votre progression pour la S√©ance 2 a √©t√© ENREGISTR√âE !");
        }

        function resetProgress() {
            const confirmReset = confirm("√ätes-vous s√ªr(e) de vouloir TOUT effacer et recommencer la S√©ance 2 ?");
            if (confirmReset) {
                localStorage.removeItem(localStorageKey);
                showConfirmation("üóëÔ∏è Toutes les donn√©es de la S√©ance 2 ont √©t√© EFFAC√âES. La page va se recharger.");
                
                setTimeout(() => {
                    window.location.reload(); 
                }, 2000);
            }
        }

        function loadProgress(manualLoad = false) {
            const progress = loadState();
            let hasLoadedData = false;

            for (const key in progress) {
                if (progress.hasOwnProperty(key)) {
                    hasLoadedData = true;

                    // Taille de police
                    if (key === 'font-size-slider') {
                        document.getElementById('font-size-slider').value = progress[key];
                        changeFontSize(progress[key]);
                    } 
                    // Restauration des clics (Q3_1, Q3_3, Q3_5)
                    else if (key === 'q3_1' || key === 'q3_3' || key === 'q3_5') {
                        document.querySelectorAll(`.mot-cle[data-q="${key}"]`).forEach(m => m.classList.remove('selected'));
                        const selected = document.querySelector(`.mot-cle[data-q="${key}"][data-answer="${progress[key]}"]`);
                        if (selected) selected.classList.add('selected');
                    }
                    // Restauration des clics multiples (Q3_2)
                    else if (key === 'q3_2' && Array.isArray(progress[key])) {
                        document.querySelectorAll(`.mot-cle[data-q="${key}"]`).forEach(m => m.classList.remove('selected'));
                        progress[key].forEach(answer => {
                            const selected = document.querySelector(`.mot-cle[data-q="${key}"][data-answer="${answer}"]`);
                            if (selected) selected.classList.add('selected');
                        });
                    }
                }
            }

            if (hasLoadedData && manualLoad) {
                showConfirmation("‚Ü©Ô∏è Votre travail a √©t√© repris pour la S√©ance 2 !");
            } else if (manualLoad && !hasLoadedData) {
                showConfirmation("‚ÑπÔ∏è Aucune donn√©e enregistr√©e trouv√©e pour la S√©ance 2.");
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
             loadProgress(false); 
        });
        
    </script>

</body>
</html>
