<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module A7 - Laboratoire Virtuel Digestion - Bac Pro Premi√®re</title>
    <style>
        :root {
            --primary-pse: #2E86AB;
            --secondary-pse: #A23B72;
            --success-pse: #219653;
            --warning-pse: #F2994A;
            --danger-pse: #EB5757;
            --dark-pse: #2F3542;
            --light-pse: #F1F2F6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
            font-size: 16px;
        }

        .exercice-container {
            width: 100%;
            max-width: 100vw;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        /* EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE */
        .cadre-pedagogique {
            background: linear-gradient(135deg, var(--primary-pse), var(--secondary-pse));
            color: white;
            padding: 20px;
        }

        .module-info h2 {
            font-size: 24px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .objectif {
            background: rgba(255,255,255,0.15);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #FFF;
        }

        .competences-travaillees h3 {
            margin: 15px 0 10px 0;
            font-size: 18px;
        }

        .competences-list {
            list-style: none;
            padding: 0;
        }

        .competences-list li {
            background: rgba(255,255,255,0.1);
            margin: 8px 0;
            padding: 10px;
            border-radius: 8px;
            border-left: 4px solid;
        }

        .competences-list li:nth-child(1) { border-left-color: #E74C3C; }
        .competences-list li:nth-child(2) { border-left-color: #3498DB; }
        .competences-list li:nth-child(3) { border-left-color: #2ECC71; }

        .niveau-cible {
            background: var(--warning-pse);
            padding: 10px 15px;
            border-radius: 25px;
            display: inline-block;
            font-weight: bold;
            margin-top: 10px;
        }

        /* CONTENU PRINCIPAL */
        .exercice-principal {
            padding: 25px;
        }

        .instructions-interaction {
            background: #E3F2FD;
            border: 2px solid #2196F3;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }

        .instructions-interaction h5 {
            color: #1976D2;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .etape-container {
            margin: 30px 0;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #E0E0E0;
        }

        .etape-active {
            border-color: var(--primary-pse);
            background: #F8F9FA;
        }

        .etape-titre {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary-pse);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .schema-digestif {
            position: relative;
            background: #F8F9FA;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            max-width: 100%;
        }

        .organe-clickable {
            position: absolute;
            background: #2196F3;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            min-width: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .organe-clickable:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
        }

        .organe-clickable.selected {
            background: var(--warning-pse);
            border: 3px solid #FF6F00;
            transform: scale(1.1);
        }

        .organe-clickable.correct {
            background: var(--success-pse);
            border: 3px solid #4CAF50;
        }

        .organe-clickable.incorrect {
            background: var(--danger-pse);
            border: 3px solid #F44336;
        }

        .zones-reponse {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .zone-drop {
            background: #E8F5E8;
            border: 3px dashed #4CAF50;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .zone-drop:hover {
            background: #C8E6C9;
            border-color: #2E7D32;
        }

        .zone-drop.active {
            background: #FFF3E0;
            border-color: var(--warning-pse);
        }

        .zone-drop.filled {
            background: #E8F5E8;
            border: 3px solid #4CAF50;
        }

        .feedback-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            display: none;
        }

        .feedback-card.show {
            display: block;
        }

        .feedback-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .correction-explicite {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .correction-explicite h4 {
            color: #FF6B6B;
            margin-bottom: 10px;
        }

        .bonne-reponse {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: bold;
        }

        .explication {
            background: rgba(255, 193, 7, 0.2);
            color: #FFC107;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .boutons-navigation {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            min-width: 120px;
            min-height: 44px;
        }

        .btn-primary {
            background: var(--primary-pse);
            color: white;
        }

        .btn-primary:hover {
            background: #1E5A7A;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6C757D;
            color: white;
        }

        .btn-success {
            background: var(--success-pse);
            color: white;
        }

        .btn:disabled {
            background: #CCC;
            cursor: not-allowed;
            transform: none;
        }

        /* PROGRESSION */
        .progression-bar {
            width: 100%;
            height: 6px;
            background: #E0E0E0;
            border-radius: 3px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progression-fill {
            height: 100%;
            background: linear-gradient(45deg, var(--success-pse), #27AE60);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* FOOTER RGPD */
        .rgpd-notice {
            background: var(--dark-pse);
            color: white;
            text-align: center;
            padding: 15px;
            font-size: 14px;
        }

        /* RESPONSIVE */
        @media (min-width: 768px) {
            body { font-size: 17px; padding: 20px; }
            .exercice-container { max-width: 900px; margin: 0 auto; }
            .exercice-principal { padding: 30px; }
        }

        @media (min-width: 1024px) {
            body { font-size: 18px; padding: 30px; }
        }

        /* SCHEMA DIGESTIF RESPONSIVE */
        .schema-corps {
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            position: relative;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 500"><path d="M150 30 Q140 20 130 25 Q120 30 125 40 L140 60 Q150 65 160 60 L175 40 Q180 30 170 25 Q160 20 150 30 Z M150 65 L150 120 M150 120 Q130 125 120 140 Q115 160 125 180 Q135 200 155 210 Q175 200 185 180 Q195 160 190 140 Q180 125 160 120 L150 120 M150 210 L150 280 Q140 290 130 300 Q120 320 130 340 Q140 360 160 370 Q180 360 190 340 Q200 320 190 300 Q180 290 170 280 L150 280 M150 370 L150 450" fill="none" stroke="%23FFC107" stroke-width="8"/></svg>') no-repeat center;
            background-size: contain;
            min-height: 400px;
        }

        /* POSITIONNEMENT DES ORGANES */
        .bouche { top: 5%; left: 45%; }
        .oesophage { top: 15%; left: 47%; }
        .estomac { top: 30%; left: 35%; }
        .foie { top: 28%; right: 30%; }
        .pancreas { top: 35%; right: 25%; }
        .intestin-grele { top: 50%; left: 40%; }
        .gros-intestin { top: 70%; left: 35%; }
    </style>
</head>
<body>
    <div class="exercice-container">
        <!-- EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE -->
        <div class="cadre-pedagogique">
            <div class="module-info">
                <h2>üß¨ Module A.7 : Les pratiques alimentaires</h2>
                <div class="objectif">
                    <strong>Objectif :</strong> Appr√©hender les enjeux de l'alimentation afin d'effectuer des choix raisonn√©s et de se maintenir en bonne sant√©.
                </div>
            </div>
            
            <div class="competences-travaillees">
                <h3>Comp√©tences travaill√©es dans cet exercice :</h3>
                <ul class="competences-list">
                    <li><strong>C1</strong> - Traiter une information</li>
                    <li><strong>C2</strong> - Appliquer une d√©marche d'analyse dans une situation donn√©e</li>
                    <li><strong>C3</strong> - Expliquer un ph√©nom√®ne physiologique en lien avec une mesure de pr√©vention</li>
                </ul>
            </div>
            
            <div class="niveau-cible">
                <strong>Niveau :</strong> Bac Pro Premi√®re
            </div>
        </div>

        <!-- EXERCICE PRINCIPAL -->
        <main class="exercice-principal">
            <h1>üß¨ Laboratoire Virtuel : La Digestion en Action</h1>
            
            <div class="instructions-interaction">
                <h5>üì± COMMENT MANIPULER :</h5>
                <p><strong>1.</strong> Cliquez sur un organe pour le s√©lectionner (il s'illumine)<br>
                <strong>2.</strong> Cliquez sur la zone de destination appropri√©e<br>
                <strong>3.</strong> L'√©l√©ment se place automatiquement !</p>
            </div>

            <div class="progression-bar">
                <div class="progression-fill" id="progressionFill"></div>
            </div>

            <!-- √âTAPE 1 -->
            <div class="etape-container etape-active" id="etape1">
                <div class="etape-titre">
                    üéØ √âtape 1 : Identifier les organes de l'appareil digestif
                </div>
                
                <p>Cliquez sur chaque organe puis associez-le √† sa fonction principale.</p>

                <div class="schema-digestif">
                    <div class="schema-corps">
                        <div class="organe-clickable bouche" data-organe="bouche">Bouche</div>
                        <div class="organe-clickable oesophage" data-organe="oesophage">≈ísophage</div>
                        <div class="organe-clickable estomac" data-organe="estomac">Estomac</div>
                        <div class="organe-clickable foie" data-organe="foie">Foie</div>
                        <div class="organe-clickable pancreas" data-organe="pancreas">Pancr√©as</div>
                        <div class="organe-clickable intestin-grele" data-organe="intestin-grele">Int. gr√™le</div>
                        <div class="organe-clickable gros-intestin" data-organe="gros-intestin">Gros int.</div>
                    </div>
                </div>

                <div class="zones-reponse">
                    <div class="zone-drop" data-fonction="mastication">
                        <strong>Mastication et salivation</strong><br>
                        <small>Broyage m√©canique des aliments</small>
                    </div>
                    <div class="zone-drop" data-fonction="transport">
                        <strong>Transport</strong><br>
                        <small>Acheminement par contractions</small>
                    </div>
                    <div class="zone-drop" data-fonction="brassage">
                        <strong>Brassage acide</strong><br>
                        <small>Transformation des prot√©ines</small>
                    </div>
                    <div class="zone-drop" data-fonction="bile">
                        <strong>Production de bile</strong><br>
                        <small>√âmulsification des lipides</small>
                    </div>
                    <div class="zone-drop" data-fonction="enzymes">
                        <strong>Enzymes digestives</strong><br>
                        <small>Sucs pancr√©atiques</small>
                    </div>
                    <div class="zone-drop" data-fonction="absorption">
                        <strong>Absorption</strong><br>
                        <small>Passage des nutriments</small>
                    </div>
                    <div class="zone-drop" data-fonction="elimination">
                        <strong>√âlimination</strong><br>
                        <small>Formation et √©vacuation</small>
                    </div>
                </div>

                <div class="boutons-navigation">
                    <button class="btn btn-primary" onclick="verifierEtape1()">V√©rifier mes r√©ponses</button>
                    <button class="btn btn-secondary" id="btnEtape2" disabled onclick="allerEtape2()">√âtape suivante</button>
                </div>
            </div>

            <!-- √âTAPE 2 -->
            <div class="etape-container" id="etape2" style="display:none;">
                <div class="etape-titre">
                    ‚öóÔ∏è √âtape 2 : Les transformations chimiques
                </div>
                
                <p>Associez chaque constituant alimentaire √† son nutriment final et au lieu de transformation.</p>

                <div class="zones-reponse">
                    <div class="zone-drop constituant" data-constituant="glucides">
                        <strong>GLUCIDES</strong><br>
                        <small>(Amidon, sucres complexes)</small>
                    </div>
                    <div class="zone-drop constituant" data-constituant="protides">
                        <strong>PROTIDES</strong><br>
                        <small>(Prot√©ines animales/v√©g√©tales)</small>
                    </div>
                    <div class="zone-drop constituant" data-constituant="lipides">
                        <strong>LIPIDES</strong><br>
                        <small>(Graisses, huiles)</small>
                    </div>
                </div>

                <h4>Nutriments finaux disponibles :</h4>
                <div class="organes-selectionables">
                    <div class="organe-clickable" data-nutriment="glucose">Glucose</div>
                    <div class="organe-clickable" data-nutriment="acides-amines">Acides amin√©s</div>
                    <div class="organe-clickable" data-nutriment="acides-gras">Acides gras + Glyc√©rol</div>
                </div>

                <div class="boutons-navigation">
                    <button class="btn btn-secondary" onclick="allerEtape1()">Retour √âtape 1</button>
                    <button class="btn btn-primary" onclick="verifierEtape2()">V√©rifier mes r√©ponses</button>
                    <button class="btn btn-secondary" id="btnEtape3" disabled onclick="allerEtape3()">√âtape suivante</button>
                </div>
            </div>

            <!-- √âTAPE 3 -->
            <div class="etape-container" id="etape3" style="display:none;">
                <div class="etape-titre">
                    ü©∏ √âtape 3 : L'absorption intestinale
                </div>
                
                <p>Placez les nutriments dans la bonne voie d'absorption.</p>

                <div class="zones-reponse">
                    <div class="zone-drop" data-voie="sanguine">
                        <strong>VOIE SANGUINE</strong><br>
                        <small>Capillaires sanguins des villosit√©s</small>
                    </div>
                    <div class="zone-drop" data-voie="lymphatique">
                        <strong>VOIE LYMPHATIQUE</strong><br>
                        <small>Vaisseaux lymphatiques</small>
                    </div>
                </div>

                <h4>Nutriments √† classer :</h4>
                <div class="organes-selectionables">
                    <div class="organe-clickable" data-absorption="glucose">Glucose</div>
                    <div class="organe-clickable" data-absorption="acides-amines">Acides amin√©s</div>
                    <div class="organe-clickable" data-absorption="vitamines-hydro">Vitamines hydrosolubles</div>
                    <div class="organe-clickable" data-absorption="lipides">Lipides</div>
                    <div class="organe-clickable" data-absorption="vitamines-lipo">Vitamines liposolubles</div>
                    <div class="organe-clickable" data-absorption="mineraux">Min√©raux</div>
                </div>

                <div class="boutons-navigation">
                    <button class="btn btn-secondary" onclick="allerEtape2()">Retour √âtape 2</button>
                    <button class="btn btn-primary" onclick="verifierEtape3()">V√©rifier mes r√©ponses</button>
                    <button class="btn btn-success" id="btnFinaliser" disabled onclick="finaliserExercice()">Finaliser l'exercice</button>
                </div>
            </div>

            <!-- ZONE DE FEEDBACK -->
            <div class="feedback-card" id="feedbackCard">
                <div class="feedback-title">
                    <span id="feedbackIcon">üìä</span>
                    <span id="feedbackTitre">R√©sultats</span>
                </div>
                <div id="feedbackContenu"></div>
            </div>

        </main>

        <!-- FOOTER RGPD -->
        <div class="rgpd-notice">
            üîí Conformit√© RGPD : Cet exercice respecte votre anonymat.
        </div>
    </div>

    <script>
        // DONN√âES DE L'EXERCICE
        const donneesExercice = {
            etape1: {
                associations: {
                    'bouche': 'mastication',
                    'oesophage': 'transport', 
                    'estomac': 'brassage',
                    'foie': 'bile',
                    'pancreas': 'enzymes',
                    'intestin-grele': 'absorption',
                    'gros-intestin': 'elimination'
                }
            },
            etape2: {
                associations: {
                    'glucides': 'glucose',
                    'protides': 'acides-amines',
                    'lipides': 'acides-gras'
                }
            },
            etape3: {
                associations: {
                    'glucose': 'sanguine',
                    'acides-amines': 'sanguine',
                    'vitamines-hydro': 'sanguine',
                    'lipides': 'lymphatique',
                    'vitamines-lipo': 'lymphatique',
                    'mineraux': 'sanguine'
                }
            }
        };

        let elementSelectionne = null;
        let progression = { etape1: 0, etape2: 0, etape3: 0 };

        // SYST√àME CLIC-S√âLECTION
        function selectionnerElement(element) {
            // D√©s√©lectionner l'ancien
            if (elementSelectionne) {
                elementSelectionne.classList.remove('selected');
            }
            
            // S√©lectionner le nouveau
            elementSelectionne = element;
            element.classList.add('selected');
        }

        function placerElement(zoneDestination, etapeNum) {
            if (!elementSelectionne) return;

            const elementData = elementSelectionne.dataset;
            const zoneData = zoneDestination.dataset;
            
            // Validation selon l'√©tape
            let estCorrect = false;
            
            if (etapeNum === 1) {
                estCorrect = donneesExercice.etape1.associations[elementData.organe] === zoneData.fonction;
            } else if (etapeNum === 2) {
                estCorrect = donneesExercice.etape2.associations[zoneData.constituant] === elementData.nutriment;
            } else if (etapeNum === 3) {
                estCorrect = donneesExercice.etape3.associations[elementData.absorption] === zoneData.voie;
            }

            // Placement visuel
            if (estCorrect) {
                elementSelectionne.classList.add('correct');
                zoneDestination.classList.add('filled');
                zoneDestination.innerHTML += `<br><strong style="color: #2E7D32;">${elementSelectionne.textContent}</strong>`;
            } else {
                elementSelectionne.classList.add('incorrect');
            }

            elementSelectionne.classList.remove('selected');
            elementSelectionne = null;
        }

        // √âV√âNEMENTS POUR √âTAPE 1
        document.addEventListener('DOMContentLoaded', function() {
            // Organes √©tape 1
            document.querySelectorAll('[data-organe]').forEach(organe => {
                organe.addEventListener('click', () => selectionnerElement(organe));
            });

            // Zones de drop √©tape 1
            document.querySelectorAll('[data-fonction]').forEach(zone => {
                zone.addEventListener('click', () => placerElement(zone, 1));
            });
        });

        // V√âRIFICATION √âTAPE 1
        function verifierEtape1() {
            let correctes = 0;
            const feedback = document.getElementById('feedbackCard');
            const contenu = document.getElementById('feedbackContenu');
            
            // Compter les bonnes r√©ponses
            document.querySelectorAll('.organe-clickable.correct').forEach(() => correctes++);
            
            let html = '<div class="correction-explicite">';
            html += '<h4>‚ùå CORRECTION</h4>';
            
            // Corrections explicites
            const corrections = {
                'bouche': { fonction: 'mastication', explication: 'La bouche assure le broyage m√©canique des aliments gr√¢ce aux dents et l\'humidification avec la salive.' },
                'oesophage': { fonction: 'transport', explication: 'L\'≈ìsophage transporte le bol alimentaire vers l\'estomac par des contractions musculaires (p√©ristaltisme).' },
                'estomac': { fonction: 'brassage', explication: 'L\'estomac brasse et malaxe les aliments avec le suc gastrique acide pour transformer les prot√©ines.' },
                'foie': { fonction: 'bile', explication: 'Le foie produit la bile qui √©mulsionne les lipides pour faciliter leur digestion.' },
                'pancreas': { fonction: 'enzymes', explication: 'Le pancr√©as s√©cr√®te des enzymes digestives (suc pancr√©atique) qui ach√®vent la digestion.' },
                'intestin-grele': { fonction: 'absorption', explication: 'L\'intestin gr√™le absorbe les nutriments gr√¢ce aux villosit√©s intestinales.' },
                'gros-intestin': { fonction: 'elimination', explication: 'Le gros intestin forme et √©vacue les d√©chets non digestibles.' }
            };

            Object.keys(corrections).forEach(organe => {
                const element = document.querySelector(`[data-organe="${organe}"]`);
                if (!element.classList.contains('correct')) {
                    html += `<div class="bonne-reponse">‚úÖ ${organe.charAt(0).toUpperCase() + organe.slice(1)} ‚Üí ${corrections[organe].fonction}</div>`;
                    html += `<div class="explication">üí° ${corrections[organe].explication}</div>`;
                }
            });

            html += '</div>';
            contenu.innerHTML = html;
            feedback.classList.add('show');
            
            if (correctes >= 5) {
                document.getElementById('btnEtape2').disabled = false;
                progression.etape1 = 33;
                mettreAJourProgression();
            }
        }

        // NAVIGATION ENTRE √âTAPES
        function allerEtape2() {
            document.getElementById('etape1').style.display = 'none';
            document.getElementById('etape2').style.display = 'block';
            document.getElementById('feedbackCard').classList.remove('show');
            
            // √âv√©nements pour √©tape 2
            document.querySelectorAll('[data-nutriment]').forEach(nutriment => {
                nutriment.addEventListener('click', () => selectionnerElement(nutriment));
            });

            document.querySelectorAll('[data-constituant]').forEach(zone => {
                zone.addEventListener('click', () => placerElement(zone, 2));
            });
        }

        function allerEtape1() {
            document.getElementById('etape2').style.display = 'none';
            document.getElementById('etape1').style.display = 'block';
            document.getElementById('feedbackCard').classList.remove('show');
        }

        function allerEtape3() {
            document.getElementById('etape2').style.display = 'none';
            document.getElementById('etape3').style.display = 'block';
            document.getElementById('feedbackCard').classList.remove('show');
            
            // √âv√©nements pour √©tape 3
            document.querySelectorAll('[data-absorption]').forEach(nutriment => {
                nutriment.addEventListener('click', () => selectionnerElement(nutriment));
            });

            document.querySelectorAll('[data-voie]').forEach(zone => {
                zone.addEventListener('click', () => placerElement(zone, 3));
            });
        }

        // V√âRIFICATION √âTAPE 2
        function verifierEtape2() {
            let correctes = 0;
            const feedback = document.getElementById('feedbackCard');
            const contenu = document.getElementById('feedbackContenu');
            
            document.querySelectorAll('.constituant .organe-clickable.correct').forEach(() => correctes++);
            
            let html = '<div class="correction-explicite">';
            html += '<h4>‚ùå CORRECTION</h4>';
            html += '<div class="bonne-reponse">‚úÖ GLUCIDES ‚Üí Glucose (bouche + intestin gr√™le)</div>';
            html += '<div class="explication">üí° L\'amidon est d√©coup√© par l\'amylase salivaire puis achev√© dans l\'intestin gr√™le.</div>';
            html += '<div class="bonne-reponse">‚úÖ PROTIDES ‚Üí Acides amin√©s (estomac + intestin gr√™le)</div>';
            html += '<div class="explication">üí° Les prot√©ines sont d√©compos√©es par le suc gastrique puis finalis√©es par les enzymes pancr√©atiques.</div>';
            html += '<div class="bonne-reponse">‚úÖ LIPIDES ‚Üí Acides gras + Glyc√©rol (intestin gr√™le)</div>';
            html += '<div class="explication">üí° Les lipides sont √©mulsionn√©s par la bile puis d√©coup√©s par la lipase pancr√©atique.</div>';
            html += '</div>';
            
            contenu.innerHTML = html;
            feedback.classList.add('show');
            
            if (correctes >= 2) {
                document.getElementById('btnEtape3').disabled = false;
                progression.etape2 = 66;
                mettreAJourProgression();
            }
        }

        // V√âRIFICATION √âTAPE 3
        function verifierEtape3() {
            let correctes = 0;
            const feedback = document.getElementById('feedbackCard');
            const contenu = document.getElementById('feedbackContenu');
            
            document.querySelectorAll('[data-voie] .organe-clickable.correct').forEach(() => correctes++);
            
            let html = '<div class="correction-explicite">';
            html += '<h4>‚ùå CORRECTION</h4>';
            html += '<div class="bonne-reponse">‚úÖ VOIE SANGUINE : Glucose, Acides amin√©s, Vitamines hydrosolubles, Min√©raux</div>';
            html += '<div class="explication">üí° Ces nutriments passent directement dans le sang via les capillaires des villosit√©s.</div>';
            html += '<div class="bonne-reponse">‚úÖ VOIE LYMPHATIQUE : Lipides, Vitamines liposolubles</div>';
            html += '<div class="explication">üí° Les lipides et vitamines grasses passent par la lymphe avant de rejoindre le sang.</div>';
            html += '</div>';
            
            contenu.innerHTML = html;
            feedback.classList.add('show');
            
            if (correctes >= 4) {
                document.getElementById('btnFinaliser').disabled = false;
                progression.etape3 = 100;
                mettreAJourProgression();
            }
        }

        // FINALISATION
        function finaliserExercice() {
            const feedback = document.getElementById('feedbackCard');
            const contenu = document.getElementById('feedbackContenu');
            
            contenu.innerHTML = `
                <div class="correction-explicite">
                    <h4>üéâ F√âLICITATIONS !</h4>
                    <div class="bonne-reponse">‚úÖ Vous avez termin√© le laboratoire virtuel sur la digestion !</div>
                    <div class="explication">üí° COMP√âTENCES D√âVELOPP√âES :</div>
                    <div class="explication">
                        <strong>C1 - Traiter une information :</strong> Vous avez identifi√© et analys√© les informations sur chaque organe.<br>
                        <strong>C2 - Appliquer une d√©marche d'analyse :</strong> Vous avez suivi une m√©thode logique pour associer organes et fonctions.<br>
                        <strong>C3 - Expliquer un ph√©nom√®ne physiologique :</strong> Vous comprenez maintenant le processus complet de digestion et d'absorption.
                    </div>
                    <div class="bonne-reponse">üéØ Cette connaissance vous aidera √† mieux comprendre l'importance d'une alimentation √©quilibr√©e pour votre sant√© !</div>
                </div>
            `;
            
            feedback.classList.add('show');
        }

        // PROGRESSION
        function mettreAJourProgression() {
            const progressMax = Math.max(progression.etape1, progression.etape2, progression.etape3);
            document.getElementById('progressionFill').style.width = progressMax + '%';
        }
    </script>
</body>
</html>