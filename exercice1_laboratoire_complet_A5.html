<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module A.5 - Laboratoire Anatomie & Reproduction - Bac Pro Seconde</title>
    <style>
        :root {
            --primary-pse: #2E86AB;
            --secondary-pse: #A23B72;
            --success-pse: #219653;
            --warning-pse: #F2994A;
            --danger-pse: #EB5757;
            --dark-pse: #2F3542;
            --light-pse: #F1F2F6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
            font-size: 16px;
        }

        .exercice-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            overflow: hidden;
        }

        /* EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE */
        .cadre-pedagogique {
            background: linear-gradient(135deg, var(--primary-pse), var(--secondary-pse));
            color: white;
            padding: 25px;
            margin-bottom: 0;
        }

        .module-info h2 {
            font-size: 1.6em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .objectif {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #FFD700;
        }

        .competences-travaillees h3 {
            margin-bottom: 12px;
            font-size: 1.1em;
        }

        .competences-list {
            list-style: none;
            display: grid;
            gap: 8px;
        }

        .competences-list li {
            background: rgba(255,255,255,0.15);
            padding: 10px 15px;
            border-radius: 8px;
        }

        .competences-list li:nth-child(1) { border-left: 5px solid #E74C3C; }
        .competences-list li:nth-child(2) { border-left: 5px solid #2ECC71; }
        .competences-list li:nth-child(3) { border-left: 5px solid #3498DB; }

        .niveau-cible {
            margin-top: 15px;
            font-weight: 600;
            color: #FFD700;
        }

        /* NAVIGATION PRINCIPALE */
        .navigation-principale {
            background: var(--light-pse);
            padding: 20px;
            text-align: center;
        }

        .navigation-tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .tab-button {
            padding: 12px 20px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
        }

        .tab-button.completed {
            background: var(--success-pse);
            color: white;
            border-color: var(--success-pse);
        }

        .tab-button.active {
            background: var(--primary-pse);
            color: white;
            border-color: var(--primary-pse);
        }

        .tab-button.locked {
            background: #f5f5f5;
            color: #999;
            cursor: not-allowed;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-pse), var(--primary-pse));
            transition: width 0.5s ease;
            width: 0%;
        }

        /* PARTIES D'EXERCICES */
        .partie-container {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s ease;
        }

        .partie-container.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .partie-header {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .partie-header h3 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .partie-header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        /* ACTIVIT√âS */
        .activite-block {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .activite-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .activite-number {
            width: 40px;
            height: 40px;
            background: var(--primary-pse);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }

        .activite-title {
            flex: 1;
            font-size: 1.3em;
            color: var(--primary-pse);
            font-weight: 600;
        }

        /* IMAGES ET SCH√âMAS */
        .schema-container {
            text-align: center;
            margin: 25px 0;
        }

        .schema-container img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .schema-title {
            font-weight: 600;
            color: var(--primary-pse);
            margin-bottom: 15px;
        }

        /* SYST√àME CLIC-S√âLECTION */
        .selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .selection-item {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
        }

        .selection-item:hover {
            border-color: var(--primary-pse);
            box-shadow: 0 5px 15px rgba(46, 134, 171, 0.1);
        }

        .selection-item.selected {
            border-color: var(--warning-pse);
            background: rgba(242, 153, 74, 0.1);
            transform: scale(1.02);
        }

        .selection-item.correct {
            border-color: var(--success-pse);
            background: rgba(33, 150, 83, 0.15);
        }

        .selection-item.incorrect {
            border-color: var(--danger-pse);
            background: rgba(235, 87, 87, 0.15);
        }

        /* ZONES DE DESTINATION */
        .destination-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .destination-zone {
            background: #f8f9fa;
            border: 3px dashed #ddd;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .destination-zone:hover {
            border-color: var(--primary-pse);
            background: rgba(46, 134, 171, 0.05);
        }

        .destination-zone.filled {
            background: rgba(33, 150, 83, 0.1);
            border-color: var(--success-pse);
            border-style: solid;
        }

        .destination-label {
            font-weight: bold;
            color: var(--primary-pse);
            font-size: 1.1em;
        }

        .destination-content {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }

        /* DROPDOWNS */
        .dropdown-container {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .dropdown-label {
            font-weight: 600;
            color: var(--primary-pse);
            min-width: 100px;
        }

        select {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            background: white;
        }

        select.correct {
            border-color: var(--success-pse);
            background: rgba(33, 150, 83, 0.05);
        }

        select.incorrect {
            border-color: var(--danger-pse);
            background: rgba(235, 87, 87, 0.05);
        }

        /* BOUTONS */
        .buttons-container {
            text-align: center;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: var(--primary-pse);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #1e5f8a;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success-pse);
            color: white;
        }

        .btn-success:hover {
            background: #1a7c42;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* FEEDBACK */
        .feedback-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            display: none;
        }

        .feedback-card.show {
            display: block;
            animation: bounceIn 0.6s ease;
        }

        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }

        .feedback-card h4 {
            margin-bottom: 15px;
            color: #4CAF50;
        }

        .correction-explicite {
            background: white;
            color: var(--dark-pse);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid var(--danger-pse);
        }

        .correction-explicite h4 {
            color: var(--danger-pse);
            margin-bottom: 10px;
        }

        .bonne-reponse {
            background: rgba(33, 150, 83, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid var(--success-pse);
        }

        /* INSTRUCTIONS INTERACTION */
        .instructions-interaction {
            background: rgba(242, 153, 74, 0.1);
            border: 2px solid var(--warning-pse);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .instructions-interaction h5 {
            color: var(--warning-pse);
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            body {
                padding: 10px;
                font-size: 15px;
            }
            
            .cadre-pedagogique, .partie-container {
                padding: 20px;
            }
            
            .navigation-tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .tab-button {
                width: 100%;
                max-width: 300px;
            }
            
            .selection-grid, .destination-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                margin: 5px;
                padding: 10px 20px;
            }
        }

        /* RGPD */
        .rgpd-notice {
            background: var(--light-pse);
            padding: 15px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="exercice-container">
        <!-- EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE -->
        <div class="cadre-pedagogique">
            <div class="module-info">
                <h2>Module A.5 : La sexualit√© - La contraception</h2>
                <div class="objectif">
                    <strong>Objectif :</strong> Expliquer le processus de reproduction humaine et caract√©riser les diff√©rentes m√©thodes de contraception
                </div>
            </div>
            
            <div class="competences-travaillees">
                <h3>Comp√©tences travaill√©es dans cet exercice :</h3>
                <ul class="competences-list">
                    <li><strong>C1</strong> - Traiter une information</li>
                    <li><strong>C3</strong> - Expliquer un ph√©nom√®ne physiologique en lien avec une mesure de pr√©vention</li>
                    <li><strong>C2</strong> - Appliquer une d√©marche d'analyse dans une situation donn√©e</li>
                </ul>
            </div>
            
            <div class="niveau-cible">
                <strong>Niveau :</strong> Bac Pro Seconde | <strong>Dur√©e :</strong> 35-40 minutes
            </div>
        </div>

        <!-- NAVIGATION PRINCIPALE -->
        <div class="navigation-principale">
            <h3>üß¨ Laboratoire d'Anatomie & Reproduction</h3>
            <p>4 parties progressives pour ma√Ætriser les bases anatomiques et reproductives</p>
            
            <div class="navigation-tabs">
                <div class="tab-button active" data-partie="1">
                    Partie 1 : Anatomie ‚ôÄ
                </div>
                <div class="tab-button locked" data-partie="2">
                    Partie 2 : Anatomie ‚ôÇ
                </div>
                <div class="tab-button locked" data-partie="3">
                    Partie 3 : Gam√®tes
                </div>
                <div class="tab-button locked" data-partie="4">
                    Partie 4 : F√©condation
                </div>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="global-progress"></div>
            </div>
        </div>

        <!-- PARTIE 1 : ANATOMIE F√âMININE -->
        <div class="partie-container active" id="partie1">
            <div class="partie-header">
                <h3>üî¨ Partie 1 : Anatomie de l'appareil g√©nital f√©minin</h3>
                <p>Identifier les structures anatomiques essentielles √† la reproduction</p>
            </div>

            <!-- Fichier utilis√© : anatomie_genital_femme_vierge.jpg -->
            <div class="schema-container">
                <div class="schema-title">Sch√©ma de l'appareil g√©nital f√©minin</div>
                <img src="images/anatomie_genital_femme_vierge.jpg" alt="Anatomie appareil g√©nital f√©minin √† compl√©ter" style="max-width: 600px;">
            </div>

            <div class="instructions-interaction">
                <h5>üì± COMMENT MANIPULER :</h5>
                <p><strong>1.</strong> S√©lectionnez un terme dans la liste ci-dessous
                <strong>2.</strong> Utilisez les dropdowns pour associer chaque lettre au bon organe
                <strong>3.</strong> Validez vos r√©ponses !</p>
            </div>

            <div class="activite-block">
                <div class="activite-header">
                    <div class="activite-number">1</div>
                    <div class="activite-title">L√©gender l'appareil g√©nital f√©minin</div>
                </div>

                <div class="dropdown-container">
                    <div class="dropdown-item">
                        <div class="dropdown-label">Zone A :</div>
                        <select id="feminin-A">
                            <option value="">Choisir un organe...</option>
                            <option value="trompe">Trompe de Fallope</option>
                            <option value="uterus">Ut√©rus</option>
                            <option value="ovaire">Ovaire</option>
                            <option value="vagin">Vagin</option>
                            <option value="vulve">Vulve</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Zone B :</div>
                        <select id="feminin-B">
                            <option value="">Choisir un organe...</option>
                            <option value="trompe">Trompe de Fallope</option>
                            <option value="uterus">Ut√©rus</option>
                            <option value="ovaire">Ovaire</option>
                            <option value="vagin">Vagin</option>
                            <option value="vulve">Vulve</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Zone C :</div>
                        <select id="feminin-C">
                            <option value="">Choisir un organe...</option>
                            <option value="trompe">Trompe de Fallope</option>
                            <option value="uterus">Ut√©rus</option>
                            <option value="ovaire">Ovaire</option>
                            <option value="vagin">Vagin</option>
                            <option value="vulve">Vulve</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Zone D :</div>
                        <select id="feminin-D">
                            <option value="">Choisir un organe...</option>
                            <option value="trompe">Trompe de Fallope</option>
                            <option value="uterus">Ut√©rus</option>
                            <option value="ovaire">Ovaire</option>
                            <option value="vagin">Vagin</option>
                            <option value="vulve">Vulve</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Zone E :</div>
                        <select id="feminin-E">
                            <option value="">Choisir un organe...</option>
                            <option value="trompe">Trompe de Fallope</option>
                            <option value="uterus">Ut√©rus</option>
                            <option value="ovaire">Ovaire</option>
                            <option value="vagin">Vagin</option>
                            <option value="vulve">Vulve</option>
                        </select>
                    </div>
                </div>

                <div class="buttons-container">
                    <button class="btn btn-primary" onclick="validerAnatomie('feminin')" disabled id="btn-feminin">Valider l'anatomie f√©minine</button>
                </div>
            </div>

            <div class="activite-block">
                <div class="activite-header">
                    <div class="activite-number">2</div>
                    <div class="activite-title">R√¥les et fonctions des organes</div>
                </div>

                <div class="dropdown-container">
                    <div class="dropdown-item">
                        <div class="dropdown-label">Les ovaires produisent :</div>
                        <select id="fonction-ovaires">
                            <option value="">Choisir...</option>
                            <option value="ovules">Les ovules et hormones sexuelles</option>
                            <option value="spermatozoides">Les spermatozo√Ødes</option>
                            <option value="sang">Les r√®gles</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">L'ut√©rus permet :</div>
                        <select id="fonction-uterus">
                            <option value="">Choisir...</option>
                            <option value="nidation">L'implantation et le d√©veloppement embryonnaire</option>
                            <option value="fecondation">La f√©condation</option>
                            <option value="ovulation">L'ovulation</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Les trompes de Fallope :</div>
                        <select id="fonction-trompes">
                            <option value="">Choisir...</option>
                            <option value="transport">Transportent l'ovule vers l'ut√©rus</option>
                            <option value="production">Produisent les hormones</option>
                            <option value="protection">Prot√®gent l'embryon</option>
                        </select>
                    </div>
                </div>

                <div class="buttons-container">
                    <button class="btn btn-primary" onclick="validerFonctions('feminin')" disabled id="btn-fonctions-feminin">Valider les fonctions</button>
                </div>
            </div>

            <div class="feedback-card" id="feedback1">
                <h4>‚úÖ Bravo ! Anatomie f√©minine ma√Ætris√©e !</h4>
                <p>Vous avez correctement identifi√© les structures de l'appareil reproducteur f√©minin.</p>
                <div class="feedback-explanation" style="background: rgba(0, 0, 0, 0.4); padding: 15px; border-radius: 10px; margin-top: 15px;">
                    <strong>üí° Astuce BAC :</strong> L'appareil g√©nital f√©minin comprend les organes g√©nitaux internes (ovaires, trompes, ut√©rus, vagin) et externes (vulve). Chaque structure a un r√¥le pr√©cis dans le processus reproductif.
                </div>
                <div class="buttons-container" style="margin-top: 20px;">
                    <button class="btn btn-success" onclick="passerPartie(2)">Partie 2 : Anatomie masculine ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- PARTIE 2 : ANATOMIE MASCULINE -->
        <div class="partie-container" id="partie2">
            <div class="partie-header">
                <h3>üî¨ Partie 2 : Anatomie de l'appareil g√©nital masculin</h3>
                <p>Comprendre l'organisation de l'appareil reproducteur masculin</p>
            </div>

            <!-- R√©f√©rence : anatomie_genital_homme_corrige.jpg pour programmer les bonnes r√©ponses -->
            <div class="schema-container">
                <div class="schema-title">Sch√©ma de l'appareil g√©nital masculin</div>
                <img src="images/anatomie_genital_homme_corrige.jpg" alt="Anatomie appareil g√©nital masculin" style="max-width: 600px;">
            </div>

            <div class="activite-block">
                <div class="activite-header">
                    <div class="activite-number">1</div>
                    <div class="activite-title">Identifier les structures masculines</div>
                </div>

                <div class="dropdown-container">
                    <div class="dropdown-item">
                        <div class="dropdown-label">Structure A (Canal d√©f√©rent) :</div>
                        <select id="masculin-A">
                            <option value="">Sa fonction principale...</option>
                            <option value="transport">Transport les spermatozo√Ødes vers l'ur√®tre</option>
                            <option value="production">Produit les spermatozo√Ødes</option>
                            <option value="stockage">Stocke d√©finitivement les gam√®tes</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Structure B (Prostate) :</div>
                        <select id="masculin-B">
                            <option value="">Son r√¥le est de...</option>
                            <option value="liquide">Produire du liquide s√©minal nutritif</option>
                            <option value="spermatozoides">Fabriquer les spermatozo√Ødes</option>
                            <option value="hormones">S√©cr√©ter uniquement des hormones</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Structure C (P√©nis) :</div>
                        <select id="masculin-C">
                            <option value="">Permet...</option>
                            <option value="copulation">La copulation et l'√©jaculation</option>
                            <option value="production">La production hormonale</option>
                            <option value="filtration">La filtration urinaire</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Structure D (Ur√®tre) :</div>
                        <select id="masculin-D">
                            <option value="">Canal commun pour...</option>
                            <option value="commun">L'√©vacuation urinaire et s√©minale</option>
                            <option value="urine">L'urine uniquement</option>
                            <option value="sperme">Le sperme uniquement</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Structure E (Testicule) :</div>
                        <select id="masculin-E">
                            <option value="">Organe qui...</option>
                            <option value="gametes">Produit spermatozo√Ødes et testost√©rone</option>
                            <option value="filtre">Filtre le sang</option>
                            <option value="stocke">Stocke l'urine</option>
                        </select>
                    </div>
                </div>

                <div class="buttons-container">
                    <button class="btn btn-primary" onclick="validerAnatomie('masculin')" disabled id="btn-masculin">Valider l'anatomie masculine</button>
                </div>
            </div>

            <div class="activite-block">
                <div class="activite-header">
                    <div class="activite-number">2</div>
                    <div class="activite-title">Production et maturation des gam√®tes m√¢les</div>
                </div>

                <div class="dropdown-container">
                    <div class="dropdown-item">
                        <div class="dropdown-label">La spermatogen√®se dure :</div>
                        <select id="duree-spermatogenese">
                            <option value="">Choisir la dur√©e...</option>
                            <option value="74jours">Environ 74 jours</option>
                            <option value="28jours">28 jours comme le cycle f√©minin</option>
                            <option value="1an">1 an compl√®te</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Un √©jaculat contient environ :</div>
                        <select id="nb-spermatozoides">
                            <option value="">Nombre de spermatozo√Ødes...</option>
                            <option value="300millions">300 millions de spermatozo√Ødes</option>
                            <option value="1million">1 million seulement</option>
                            <option value="1milliard">1 milliard exactement</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Les spermatozo√Ødes acqui√®rent leur mobilit√© :</div>
                        <select id="mobilite-spermatozoides">
                            <option value="">Lieu de maturation...</option>
                            <option value="epididyme">Dans l'√©pididyme</option>
                            <option value="testicule">Dans le testicule directement</option>
                            <option value="prostate">Dans la prostate</option>
                        </select>
                    </div>
                </div>

                <div class="buttons-container">
                    <button class="btn btn-primary" onclick="validerProduction()" disabled id="btn-production">Valider la production gam√©tique</button>
                </div>
            </div>

            <div class="feedback-card" id="feedback2">
                <h4>‚úÖ Excellent ! Anatomie masculine comprise !</h4>
                <p>Vous ma√Ætrisez l'organisation et les fonctions de l'appareil reproducteur masculin.</p>
                <div class="feedback-explanation" style="background: rgba(0, 0, 0, 0.4); padding: 15px; border-radius: 10px; margin-top: 15px;">
                    <strong>üí° Astuce BAC :</strong> L'appareil g√©nital masculin assure 3 fonctions : production des gam√®tes (testicules), transport (canaux d√©f√©rents), √©mission (prostate + v√©sicules s√©minales). La spermatogen√®se est continue contrairement au cycle f√©minin.
                </div>
                <div class="buttons-container" style="margin-top: 20px;">
                    <button class="btn btn-success" onclick="passerPartie(3)">Partie 3 : Structure des gam√®tes ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- PARTIE 3 : GAM√àTES -->
        <div class="partie-container" id="partie3">
            <div class="partie-header">
                <h3>üî¨ Partie 3 : Structure et caract√©ristiques des gam√®tes</h3>
                <p>Analyser les caract√©ristiques des cellules reproductrices</p>
            </div>

            <!-- Fichier utilis√© : gamete_males_vierge.jpg -->
            <div class="schema-container">
                <div class="schema-title">Structure d'un spermatozo√Øde</div>
                <img src="images/gamete_males_vierge.jpg" alt="Structure spermatozo√Øde √† compl√©ter" style="max-width: 500px;">
            </div>

            <div class="activite-block">
                <div class="activite-header">
                    <div class="activite-number">1</div>
                    <div class="activite-title">L√©gender le spermatozo√Øde</div>
                </div>

                <div class="dropdown-container">
                    <div class="dropdown-item">
                        <div class="dropdown-label">Zone A :</div>
                        <select id="sperma-A">
                            <option value="">Choisir la structure...</option>
                            <option value="tete">T√™te (contient le noyau)</option>
                            <option value="piece">Pi√®ce interm√©diaire</option>
                            <option value="flagelle">Flagelle</option>
                            <option value="noyau">Noyau seul</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Zone B :</div>
                        <select id="sperma-B">
                            <option value="">Choisir la structure...</option>
                            <option value="tete">T√™te (contient le noyau)</option>
                            <option value="piece">Pi√®ce interm√©diaire</option>
                            <option value="flagelle">Flagelle</option>
                            <option value="noyau">Noyau seul</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Zone C :</div>
                        <select id="sperma-C">
                            <option value="">Choisir la structure...</option>
                            <option value="tete">T√™te (contient le noyau)</option>
                            <option value="piece">Pi√®ce interm√©diaire</option>
                            <option value="flagelle">Flagelle</option>
                            <option value="noyau">Noyau seul</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Zone D :</div>
                        <select id="sperma-D">
                            <option value="">Choisir la structure...</option>
                            <option value="tete">T√™te (contient le noyau)</option>
                            <option value="piece">Pi√®ce interm√©diaire</option>
                            <option value="flagelle">Flagelle</option>
                            <option value="noyau">Noyau seul</option>
                        </select>
                    </div>
                </div>

                <div class="buttons-container">
                    <button class="btn btn-primary" onclick="validerSpermatozoides()" disabled id="btn-spermatozoides">Valider la structure</button>
                </div>
            </div>

            <div class="activite-block">
                <div class="activite-header">
                    <div class="activite-number">2</div>
                    <div class="activite-title">Comparaison gam√®tes masculins et f√©minins</div>
                </div>

                <div class="dropdown-container">
                    <div class="dropdown-item">
                        <div class="dropdown-label">Taille de l'ovule :</div>
                        <select id="taille-ovule">
                            <option value="">Compar√©e au spermatozo√Øde...</option>
                            <option value="plus-grande">Beaucoup plus grande (100 fois)</option>
                            <option value="identique">Identique</option>
                            <option value="plus-petite">Plus petite</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Mobilit√© des gam√®tes :</div>
                        <select id="mobilite-gametes">
                            <option value="">Qui se d√©place...</option>
                            <option value="spermatozoide">Le spermatozo√Øde vers l'ovule</option>
                            <option value="ovule">L'ovule vers le spermatozo√Øde</option>
                            <option value="les-deux">Les deux se d√©placent activement</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Production gam√©tique :</div>
                        <select id="production-gametes">
                            <option value="">Rythme de production...</option>
                            <option value="continue-cyclique">Continue (‚ôÇ) vs cyclique (‚ôÄ)</option>
                            <option value="identique">Identique pour les deux sexes</option>
                            <option value="cyclique-continue">Cyclique (‚ôÇ) vs continue (‚ôÄ)</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Dur√©e de vie :</div>
                        <select id="duree-vie">
                            <option value="">Dans les voies g√©nitales...</option>
                            <option value="sperma-3j-ovule-1j">Spermatozo√Øde 3j, ovule 24h</option>
                            <option value="identique-1j">Identique : 1 jour chacun</option>
                            <option value="ovule-3j-sperma-1j">Ovule 3j, spermatozo√Øde 24h</option>
                        </select>
                    </div>
                </div>

                <div class="buttons-container">
                    <button class="btn btn-primary" onclick="validerComparaison()" disabled id="btn-comparaison">Valider la comparaison</button>
                </div>
            </div>

            <div class="feedback-card" id="feedback3">
                <h4>‚úÖ Parfait ! Gam√®tes ma√Ætris√©s !</h4>
                <p>Vous distinguez clairement les caract√©ristiques des cellules reproductrices.</p>
                <div class="feedback-explanation" style="background: rgba(0, 0, 0, 0.4); padding: 15px; border-radius: 10px; margin-top: 15px;">
                    <strong>üí° Astuce BAC :</strong> Les gam√®tes sont compl√©mentaires : spermatozo√Øde petit et mobile vs ovule volumineux et immobile. Leurs diff√©rences refl√®tent leurs r√¥les sp√©cifiques dans la reproduction.
                </div>
                <div class="buttons-container" style="margin-top: 20px;">
                    <button class="btn btn-success" onclick="passerPartie(4)">Partie 4 : Processus de f√©condation ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- PARTIE 4 : F√âCONDATION -->
        <div class="partie-container" id="partie4">
            <div class="partie-header">
                <h3>üî¨ Partie 4 : Le processus de f√©condation</h3>
                <p>Comprendre les √©tapes initiales de la reproduction</p>
            </div>

            <div class="activite-block">
                <div class="activite-header">
                    <div class="activite-number">1</div>
                    <div class="activite-title">Conditions n√©cessaires √† la f√©condation</div>
                </div>

                <div class="dropdown-container">
                    <div class="dropdown-item">
                        <div class="dropdown-label">Lieu de la f√©condation :</div>
                        <select id="lieu-fecondation">
                            <option value="">O√π se rencontrent les gam√®tes...</option>
                            <option value="trompe">Dans la trompe de Fallope</option>
                            <option value="uterus">Dans l'ut√©rus</option>
                            <option value="vagin">Dans le vagin</option>
                            <option value="ovaire">Dans l'ovaire</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">P√©riode favorable :</div>
                        <select id="periode-fecondation">
                            <option value="">Moment du cycle...</option>
                            <option value="ovulation">Autour de l'ovulation (J14 ¬±2)</option>
                            <option value="regles">Pendant les r√®gles</option>
                            <option value="toujours">Tout le temps du cycle</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Nombre de spermatozo√Ødes n√©cessaires :</div>
                        <select id="nb-necessaire">
                            <option value="">Pour la f√©condation...</option>
                            <option value="un-seul">Un seul mais millions pour y arriver</option>
                            <option value="plusieurs">Plusieurs simultan√©ment</option>
                            <option value="tous">Tous les spermatozo√Ødes</option>
                        </select>
                    </div>
                </div>

                <div class="buttons-container">
                    <button class="btn btn-primary" onclick="validerConditions()" disabled id="btn-conditions">Valider les conditions</button>
                </div>
            </div>

            <div class="activite-block">
                <div class="activite-header">
                    <div class="activite-number">2</div>
                    <div class="activite-title">√âtapes de la f√©condation</div>
                </div>

                <div class="dropdown-container">
                    <div class="dropdown-item">
                        <div class="dropdown-label">√âtape 1 - Reconnaissance :</div>
                        <select id="etape1">
                            <option value="">Premi√®re √©tape...</option>
                            <option value="reconnaissance">Reconnaissance sp√©cifique spermatozo√Øde-ovule</option>
                            <option value="fusion">Fusion imm√©diate</option>
                            <option value="division">Division de l'ovule</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">√âtape 2 - P√©n√©tration :</div>
                        <select id="etape2">
                            <option value="">Que se passe-t-il...</option>
                            <option value="penetration">Un spermatozo√Øde traverse la membrane</option>
                            <option value="plusieurs">Plusieurs spermatozo√Ødes entrent</option>
                            <option value="rejet">L'ovule rejette tous les spermatozo√Ødes</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">√âtape 3 - Fusion :</div>
                        <select id="etape3">
                            <option value="">R√©sultat...</option>
                            <option value="fusion-noyaux">Fusion des noyaux = cellule-≈ìuf</option>
                            <option value="deux-cellules">Formation de 2 cellules</option>
                            <option value="elimination">√âlimination d'un noyau</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">√âtape 4 - Cons√©quence :</div>
                        <select id="etape4">
                            <option value="">Juste apr√®s...</option>
                            <option value="division">D√©but des divisions cellulaires</option>
                            <option value="repos">P√©riode de repos de 9 mois</option>
                            <option value="nidation">Nidation imm√©diate</option>
                        </select>
                    </div>
                </div>

                <div class="buttons-container">
                    <button class="btn btn-primary" onclick="validerEtapes()" disabled id="btn-etapes">Valider les √©tapes</button>
                </div>
            </div>

            <div class="activite-block">
                <div class="activite-header">
                    <div class="activite-number">3</div>
                    <div class="activite-title">Devenir de la cellule-≈ìuf</div>
                </div>

                <div class="dropdown-container">
                    <div class="dropdown-item">
                        <div class="dropdown-label">Apr√®s f√©condation, la cellule-≈ìuf :</div>
                        <select id="devenir-cellule">
                            <option value="">Son √©volution...</option>
                            <option value="divisions">Se divise en descendant vers l'ut√©rus</option>
                            <option value="reste">Reste immobile dans la trompe</option>
                            <option value="remonte">Remonte vers l'ovaire</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">Dur√©e du trajet trompe ‚Üí ut√©rus :</div>
                        <select id="duree-trajet">
                            <option value="">Temps n√©cessaire...</option>
                            <option value="7jours">Environ 7 jours</option>
                            <option value="24h">24 heures</option>
                            <option value="1mois">1 mois complet</option>
                        </select>
                    </div>
                    <div class="dropdown-item">
                        <div class="dropdown-label">√Ä l'arriv√©e dans l'ut√©rus :</div>
                        <select id="arrivee-uterus">
                            <option value="">La cellule-≈ìuf est devenue...</option>
                            <option value="blastocyste">Un blastocyste (100+ cellules)</option>
                            <option value="identique">Identique (1 cellule)</option>
                            <option value="embryon">Un embryon complet</option>
                        </select>
                    </div>
                </div>

                <div class="buttons-container">
                    <button class="btn btn-primary" onclick="validerDevenir()" disabled id="btn-devenir">Finaliser l'analyse</button>
                </div>
            </div>

            <div class="feedback-card" id="feedback4">
                <h4>üéâ LABORATOIRE TERMIN√â AVEC SUCC√àS !</h4>
                <p>Vous ma√Ætrisez les bases anatomiques et le processus de f√©condation !</p>
                
                <div class="competences-bilan" style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h4>üéØ Bilan des comp√©tences d√©velopp√©es :</h4>
                    <p><strong>C1 - Traitement information :</strong> Vous savez identifier les structures anatomiques ‚úÖ</p>
                    <p><strong>C3 - Explication physiologique :</strong> Vous expliquez les r√¥les de chaque organe ‚úÖ</p>
                    <p><strong>C2 - D√©marche d'analyse :</strong> Vous analysez le processus de f√©condation ‚úÖ</p>
                    
                    <h4 style="margin-top: 20px;">üí° Pour aller plus loin :</h4>
                    <p>Ces bases anatomiques vous seront essentielles pour comprendre les m√©canismes contraceptifs et la pr√©vention des IST dans les exercices suivants.</p>
                    
                    <h4 style="margin-top: 15px;">üéØ Astuce BAC :</h4>
                    <p>R√©visez les sch√©mas anatomiques r√©guli√®rement - ils tombent souvent √† l'examen !</p>
                </div>
                
                <div class="buttons-container" style="margin-top: 30px;">
                    <button class="btn btn-success" style="font-size: 1.1em; padding: 15px 30px;">üèÜ LABORATOIRE R√âUSSI !</button>
                </div>
            </div>
        </div>
    </div>

    <!-- RGPD FOOTER -->
    <div class="rgpd-notice">
        üîí Conformit√© RGPD : Cet exercice respecte votre anonymat.
    </div>

    <script>
        let partieActuelle = 1;
        let progress = 0;
        let responses = {};

        // R√©ponses correctes bas√©es sur les images "corrige"
        const bonnesReponses = {
            feminin: {
                'feminin-A': 'trompe',
                'feminin-B': 'uterus', 
                'feminin-C': 'ovaire',
                'feminin-D': 'vagin',
                'feminin-E': 'vulve'
            },
            fonctions_feminin: {
                'fonction-ovaires': 'ovules',
                'fonction-uterus': 'nidation',
                'fonction-trompes': 'transport'
            },
            masculin: {
                'masculin-A': 'transport',
                'masculin-B': 'liquide',
                'masculin-C': 'copulation',
                'masculin-D': 'commun',
                'masculin-E': 'gametes'
            },
            production: {
                'duree-spermatogenese': '74jours',
                'nb-spermatozoides': '300millions',
                'mobilite-spermatozoides': 'epididyme'
            },
            spermatozoides: {
                'sperma-A': 'tete',
                'sperma-B': 'piece',
                'sperma-C': 'noyau',
                'sperma-D': 'flagelle'
            },
            comparaison: {
                'taille-ovule': 'plus-grande',
                'mobilite-gametes': 'spermatozoide',
                'production-gametes': 'continue-cyclique',
                'duree-vie': 'sperma-3j-ovule-1j'
            },
            conditions: {
                'lieu-fecondation': 'trompe',
                'periode-fecondation': 'ovulation',
                'nb-necessaire': 'un-seul'
            },
            etapes: {
                'etape1': 'reconnaissance',
                'etape2': 'penetration',
                'etape3': 'fusion-noyaux',
                'etape4': 'division'
            },
            devenir: {
                'devenir-cellule': 'divisions',
                'duree-trajet': '7jours',
                'arrivee-uterus': 'blastocyste'
            }
        };

        // Fonction d'√©valuation des comp√©tences
        function trackCompetence(competenceCode, action, success) {
            const performance = {
                competence: competenceCode,
                action: action,
                reussite: success,
                timestamp: Date.now(),
                session_id: 'lab_' + Math.random().toString(36).substr(2, 9)
            };
            
            const performances = JSON.parse(localStorage.getItem('pse_performances') || '[]');
            performances.push(performance);
            localStorage.setItem('pse_performances', JSON.stringify(performances));
        }

        // Gestion des dropdowns
        document.addEventListener('change', function(e) {
            if (e.target.tagName === 'SELECT') {
                verifierCompletion();
            }
        });

        function verifierCompletion() {
            const selects = document.querySelectorAll(`#partie${partieActuelle} select`);
            const allFilled = Array.from(selects).every(select => select.value !== '');
            
            const buttons = document.querySelectorAll(`#partie${partieActuelle} .btn-primary`);
            buttons.forEach(btn => {
                if (allFilled) {
                    btn.disabled = false;
                    btn.style.background = '#4CAF50';
                    btn.textContent = btn.textContent.replace('Valider', '‚úÖ Valider');
                }
            });
        }

        function validerAnatomie(type) {
            let corrections = [];
            let score = 0;
            
            const reponses = bonnesReponses[type];
            
            Object.keys(reponses).forEach(id => {
                const select = document.getElementById(id);
                if (select) {
                    if (select.value === reponses[id]) {
                        select.classList.add('correct');
                        score++;
                    } else {
                        select.classList.add('incorrect');
                        corrections.push({
                            question: id,
                            correct: getOptionText(select, reponses[id]),
                            user: select.options[select.selectedIndex].text
                        });
                    }
                }
            });

            trackCompetence('C1', `anatomie_${type}`, score >= Math.floor(Object.keys(reponses).length * 0.7));
            
            if (corrections.length > 0) {
                afficherCorrections(corrections, partieActuelle);
            }
        }

        function validerFonctions(type) {
            validerGroup('fonctions_' + type, 'C3');
        }

        function validerProduction() {
            validerGroup('production', 'C3');
        }

        function validerSpermatozoides() {
            validerGroup('spermatozoides', 'C1');
        }

        function validerComparaison() {
            validerGroup('comparaison', 'C2');
        }

        function validerConditions() {
            validerGroup('conditions', 'C2');
        }

        function validerEtapes() {
            validerGroup('etapes', 'C3');
        }

        function validerDevenir() {
            validerGroup('devenir', 'C2');
            setTimeout(() => {
                document.getElementById(`feedback${partieActuelle}`).classList.add('show');
                marquerPartieComplete(partieActuelle);
                updateProgress();
            }, 500);
        }

        function validerGroup(groupName, competence) {
            let corrections = [];
            let score = 0;
            
            const reponses = bonnesReponses[groupName];
            
            Object.keys(reponses).forEach(id => {
                const select = document.getElementById(id);
                if (select) {
                    if (select.value === reponses[id]) {
                        select.classList.add('correct');
                        score++;
                    } else {
                        select.classList.add('incorrect');
                        corrections.push({
                            question: id,
                            correct: getOptionText(select, reponses[id]),
                            user: select.options[select.selectedIndex].text
                        });
                    }
                }
            });

            trackCompetence(competence, groupName, score >= Math.floor(Object.keys(reponses).length * 0.7));
            
            if (corrections.length > 0) {
                afficherCorrections(corrections, partieActuelle);
            } else {
                setTimeout(() => {
                    document.getElementById(`feedback${partieActuelle}`).classList.add('show');
                    if (partieActuelle < 4) {
                        marquerPartieComplete(partieActuelle);
                        updateProgress();
                    }
                }, 500);
            }
        }

        function getOptionText(select, value) {
            const option = select.querySelector(`option[value="${value}"]`);
            return option ? option.text : value;
        }

        function afficherCorrections(corrections, partie) {
            const feedback = document.getElementById(`feedback${partie}`);
            let html = '<div class="correction-explicite"><h4>‚ùå CORRECTION</h4>';
            
            corrections.forEach(item => {
                html += `
                    <div class="bonne-reponse">
                        <strong>‚úÖ ${item.question} :</strong><br>
                        <strong>Bonne r√©ponse :</strong> ${item.correct}<br>
                        <small style="color: #666;">Votre r√©ponse : ${item.user}</small>
                    </div>
                `;
            });

            html += '</div>';
            feedback.innerHTML = html + feedback.innerHTML;
            feedback.classList.add('show');

            setTimeout(() => {
                if (partie < 4) {
                    feedback.innerHTML += `
                        <div class="buttons-container" style="margin-top: 20px;">
                            <button class="btn btn-success" onclick="passerPartie(${partie + 1})">Partie suivante ‚Üí</button>
                        </div>
                    `;
                    marquerPartieComplete(partie);
                    updateProgress();
                }
            }, 2000);
        }

        function passerPartie(numeroParte) {
            document.getElementById(`partie${partieActuelle}`).classList.remove('active');
            document.querySelector(`[data-partie="${partieActuelle}"]`).classList.remove('active');
            
            partieActuelle = numeroParte;
            
            document.getElementById(`partie${numeroParte}`).classList.add('active');
            document.querySelector(`[data-partie="${numeroParte}"]`).classList.add('active');
            document.querySelector(`[data-partie="${numeroParte}"]`).classList.remove('locked');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function marquerPartieComplete(partie) {
            const tab = document.querySelector(`[data-partie="${partie}"]`);
            tab.classList.add('completed');
            tab.classList.remove('active');
            
            if (partie < 4) {
                const nextTab = document.querySelector(`[data-partie="${partie + 1}"]`);
                nextTab.classList.remove('locked');
            }
        }

        function updateProgress() {
            progress += 25;
            document.getElementById('global-progress').style.width = progress + '%';
        }

        // Navigation par onglets
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('tab-button') && !e.target.classList.contains('locked')) {
                const partie = parseInt(e.target.dataset.partie);
                if (partie <= partieActuelle || e.target.classList.contains('completed')) {
                    passerPartie(partie);
                }
            }
        });

        // Accessibilit√© clavier
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && e.target.tagName === 'BUTTON') {
                e.target.click();
            }
        });
    </script>
</body>
</html>