<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©vision A8 - Le Stress au Quotidien - Bac Pro Premi√®re</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #a855f7 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .btn-back {
            background: rgba(255,255,255,0.15);
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.3);
            cursor: pointer;
            min-height: 44px;
            display: flex;
            align-items: center;
        }
        
        .btn-back:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }
        
        .score-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.15);
            padding: 12px 20px;
            border-radius: 50px;
            flex-wrap: wrap;
        }
        
        .score-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .score-item .icon {
            font-size: 18px;
        }
        
        /* √âcrans */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* √âcran d'accueil */
        .welcome-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .welcome-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ff9a9e, #fecfef, #fecfef);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: rgba(255,255,255,0.8);
            margin-bottom: 30px;
        }
        
        /* Objectifs */
        .objectifs-card {
            background: linear-gradient(135deg, rgba(255, 154, 158, 0.2), rgba(254, 207, 239, 0.2));
            border: 2px solid rgba(255, 154, 158, 0.4);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: left;
        }
        
        .objectifs-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .objectif-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
            line-height: 1.5;
        }
        
        .objectif-item:last-child {
            border-bottom: none;
        }
        
        .objectif-item .check {
            color: #4CAF50;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .competences-row {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .comp-badge {
            background: rgba(255,255,255,0.15);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .comp-badge.c1 { background: rgba(231, 76, 60, 0.3); border: 1px solid #e74c3c; }
        .comp-badge.c2 { background: rgba(52, 152, 219, 0.3); border: 1px solid #3498db; }
        .comp-badge.c3 { background: rgba(46, 204, 113, 0.3); border: 1px solid #2ecc71; }
        .comp-badge.c4 { background: rgba(243, 156, 18, 0.3); border: 1px solid #f39c12; }
        
        /* Niveaux */
        .niveaux-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .niveau-card {
            background: rgba(255,255,255,0.08);
            border: 2px solid rgba(255,255,255,0.15);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 80px;
        }
        
        .niveau-card:hover:not(.locked) {
            background: rgba(255,255,255,0.15);
            transform: translateX(5px);
            border-color: rgba(255, 154, 158, 0.5);
        }
        
        .niveau-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .niveau-card.completed {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.15);
        }
        
        .niveau-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: 900;
            color: #333;
            flex-shrink: 0;
        }
        
        .niveau-info {
            flex: 1;
        }
        
        .niveau-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .niveau-desc {
            font-size: 13px;
            color: rgba(255,255,255,0.7);
            line-height: 1.3;
        }
        
        .niveau-progress {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 8px;
        }
        
        .niveau-percent {
            font-size: 18px;
            font-weight: 700;
            color: #4CAF50;
        }
        
        .niveau-bar {
            width: 60px;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .niveau-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #81C784);
            transition: width 0.5s ease;
        }
        
        /* Jeu */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .progress-info {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 14px;
        }
        
        .card-container {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            backdrop-filter: blur(10px);
        }
        
        .card-type {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .keyword-section {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .keyword-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: rgba(255,255,255,0.9);
        }
        
        .keyword-display {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 22px;
            font-weight: 900;
            margin-bottom: 20px;
        }
        
        .question-section {
            margin-bottom: 25px;
        }
        
        .question-text {
            font-size: 18px;
            line-height: 1.4;
            margin-bottom: 20px;
        }
        
        .keyword-input {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            padding: 15px 20px;
            color: white;
            font-size: 16px;
            width: 100%;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }
        
        .keyword-input:focus {
            outline: none;
            border-color: #ff9a9e;
            background: rgba(255,255,255,0.15);
        }
        
        .keyword-input::placeholder {
            color: rgba(255,255,255,0.6);
        }
        
        /* Options QCM */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .option-btn {
            background: rgba(255,255,255,0.08);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 15px 20px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 15px;
            text-align: left;
            min-height: 60px;
        }
        
        .option-btn:hover {
            background: rgba(255,255,255,0.15);
            transform: translateX(5px);
        }
        
        .option-btn.selected {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
            border-color: #ff9a9e;
        }
        
        .option-letter {
            width: 30px;
            height: 30px;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }
        
        .option-btn.selected .option-letter {
            background: rgba(51, 51, 51, 0.3);
            color: #333;
        }
        
        /* Vrai/Faux */
        .vf-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .vf-btn {
            background: rgba(255,255,255,0.08);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            font-weight: 700;
            text-align: center;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .vf-btn:hover {
            background: rgba(255,255,255,0.15);
            transform: translateY(-2px);
        }
        
        .vf-btn.selected {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
            border-color: #ff9a9e;
        }
        
        .vf-btn.vrai {
            border-color: rgba(76, 175, 80, 0.5);
        }
        
        .vf-btn.faux {
            border-color: rgba(244, 67, 54, 0.5);
        }
        
        /* Boutons d'action */
        .action-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .btn {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
            border: none;
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            min-height: 50px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 154, 158, 0.4);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.15);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(255,255,255,0.25);
            box-shadow: 0 8px 25px rgba(255,255,255,0.2);
        }
        
        /* Overlay feedback - FONDS OPAQUES OBLIGATOIRE */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8); /* OPAQUE - Pas de transparence probl√©matique */
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .feedback-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .feedback-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f); /* OPAQUE = LISIBLE */
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .feedback-overlay.visible .feedback-card {
            transform: scale(1);
        }
        
        .feedback-card.correct {
            border: 3px solid #4CAF50;
        }
        
        .feedback-card.incorrect {
            border: 3px solid #f44336;
        }
        
        .feedback-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }
        
        .feedback-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .feedback-points {
            font-size: 18px;
            color: #4CAF50;
            margin-bottom: 20px;
        }
        
        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05); /* Minimum opacit√© pour lisibilit√© */
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
            line-height: 1.5;
        }
        
        .feedback-explanation h4 {
            color: #ffd700;
            margin-bottom: 12px;
            font-size: 16px;
        }
        
        .keyword-box {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
            padding: 12px 20px;
            border-radius: 12px;
            margin: 15px 0;
            font-weight: 700;
            text-align: center;
        }
        
        .tip-box {
            background: rgba(255, 215, 0, 0.1);
            border-left: 4px solid #ffd700;
            padding: 15px;
            margin-top: 15px;
            border-radius: 8px;
        }
        
        .tip-box h5 {
            color: #ffd700;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        /* R√©sultats */
        .results-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }
        
        .results-title {
            font-size: 32px;
            font-weight: 900;
            margin-bottom: 10px;
        }
        
        .results-score {
            font-size: 48px;
            font-weight: 900;
            color: #4CAF50;
            margin-bottom: 20px;
        }
        
        .results-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.08);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #4CAF50;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            color: rgba(255,255,255,0.7);
        }
        
        .errors-recap {
            background: rgba(244, 67, 54, 0.1);
            border: 2px solid rgba(244, 67, 54, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }
        
        .errors-recap h4 {
            color: #f44336;
            margin-bottom: 12px;
        }
        
        .errors-recap ul {
            list-style: none;
            padding: 0;
        }
        
        .errors-recap li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(244, 67, 54, 0.2);
            font-size: 14px;
        }
        
        .errors-recap li:last-child {
            border-bottom: none;
        }
        
        /* Confettis */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #ff9a9e;
            animation: confetti-fall 3s linear;
            z-index: 1001;
        }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* Streak popup */
        .streak-popup {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
            padding: 20px 30px;
            border-radius: 20px;
            font-size: 18px;
            font-weight: 700;
            z-index: 1001;
            display: none;
            box-shadow: 0 10px 30px rgba(255, 154, 158, 0.5);
            animation: popup-bounce 1.5s ease;
        }
        
        @keyframes popup-bounce {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.1); }
        }
        
        /* Hint */
        .hint-text {
            background: rgba(255, 215, 0, 0.15);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            font-size: 14px;
            line-height: 1.4;
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .welcome-title {
                font-size: 32px;
            }
            
            .card-container {
                padding: 20px;
            }
            
            .feedback-card {
                padding: 25px;
                margin: 0 15px;
            }
            
            .vf-container {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: stretch;
            }
            
            .btn {
                justify-content: center;
            }
            
            .results-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .score-bar {
                justify-content: center;
                gap: 10px;
            }
            
            .header {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .welcome-title {
                font-size: 28px;
            }
            
            .question-text {
                font-size: 16px;
            }
            
            .keyword-display {
                font-size: 18px;
                padding: 12px 20px;
            }
            
            .results-score {
                font-size: 36px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <button class="btn-back" onclick="goHome()">üè† Accueil</button>
            <div class="score-bar">
                <div class="score-item">
                    <span class="icon">‚≠ê</span>
                    <span id="totalPoints">0</span>
                </div>
                <div class="score-item">
                    <span class="icon">üî•</span>
                    <span id="currentStreak">0</span>
                </div>
            </div>
        </div>

        <!-- √âcran d'accueil -->
        <div id="homeScreen" class="screen active">
            <div class="welcome-screen">
                <h1 class="welcome-title">üß† FlashCards A8</h1>
                <p class="welcome-subtitle">Le Stress au Quotidien - R√©vision Interactive</p>
                
                <!-- Objectifs p√©dagogiques -->
                <div class="objectifs-card">
                    <h3>üéØ Module A8 - Objectifs</h3>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Appr√©hender le m√©canisme physiologique du stress pour mieux s'en prot√©ger</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Ma√Ætriser les 3 phases du syndrome g√©n√©ral d'adaptation</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Identifier les facteurs de stress et les mesures de pr√©vention</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Diff√©rencier stress aigu et stress chronique</span>
                    </div>
                    
                    <div class="competences-row">
                        <span class="comp-badge c1">C1 - Traiter information</span>
                        <span class="comp-badge c2">C2 - Analyser situation</span>
                        <span class="comp-badge c3">C3 - Expliquer ph√©nom√®ne</span>
                        <span class="comp-badge c4">C4 - Proposer solutions</span>
                    </div>
                </div>

                <!-- Niveaux de difficult√© -->
                <div class="niveaux-grid">
                    <div class="niveau-card" onclick="startLevel(1)">
                        <div class="niveau-icon">1</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Les bases du stress</div>
                            <div class="niveau-desc">D√©finition, caract√©ristiques et facteurs</div>
                        </div>
                        <div class="niveau-progress">
                            <div class="niveau-percent" id="level1Percent">0%</div>
                            <div class="niveau-bar">
                                <div class="niveau-bar-fill" id="level1Bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(2)">
                        <div class="niveau-icon">2</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Les 3 phases physiologiques</div>
                            <div class="niveau-desc">Alarme, r√©sistance, √©puisement</div>
                        </div>
                        <div class="niveau-progress">
                            <div class="niveau-percent" id="level2Percent">0%</div>
                            <div class="niveau-bar">
                                <div class="niveau-bar-fill" id="level2Bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(3)">
                        <div class="niveau-icon">3</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Hormones et m√©canismes</div>
                            <div class="niveau-desc">Adr√©naline, cortisol, hypothalamus</div>
                        </div>
                        <div class="niveau-progress">
                            <div class="niveau-percent" id="level3Percent">0%</div>
                            <div class="niveau-bar">
                                <div class="niveau-bar-fill" id="level3Bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(4)">
                        <div class="niveau-icon">4</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Stress aigu vs chronique</div>
                            <div class="niveau-desc">Effets, pathologies, burn-out</div>
                        </div>
                        <div class="niveau-progress">
                            <div class="niveau-percent" id="level4Percent">0%</div>
                            <div class="niveau-bar">
                                <div class="niveau-bar-fill" id="level4Bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(5)">
                        <div class="niveau-icon">5</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Pr√©vention et solutions</div>
                            <div class="niveau-desc">Mesures individuelles et collectives</div>
                        </div>
                        <div class="niveau-progress">
                            <div class="niveau-percent" id="level5Percent">0%</div>
                            <div class="niveau-bar">
                                <div class="niveau-bar-fill" id="level5Bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- √âcran de jeu -->
        <div id="gameScreen" class="screen">
            <div class="game-header">
                <div class="progress-info">
                    <span>Niveau <span id="currentLevel">1</span></span>
                    <span>‚Ä¢</span>
                    <span>Question <span id="currentCard">1</span>/<span id="totalCards">10</span></span>
                </div>
            </div>

            <div class="card-container">
                <div class="card-type" id="cardType">Mot-cl√©</div>
                
                <div class="keyword-section" id="keywordSection">
                    <div class="keyword-title">Trouvez le mot-cl√© correspondant :</div>
                    <div class="keyword-display" id="keywordDisplay">STRESS</div>
                </div>

                <div class="question-section" id="questionSection">
                    <p class="question-text" id="questionText">Quel terme d√©signe une r√©action physiologique de l'organisme face √† une agression ?</p>
                    <input type="text" class="keyword-input" id="keywordAnswer" placeholder="Tapez votre r√©ponse...">
                </div>

                <div id="hintText" class="hint-text" style="display: none;"></div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="showHint()">üí° Indice</button>
                    <button class="btn" onclick="validateAnswer()">‚úÖ Valider</button>
                </div>
            </div>
        </div>

        <!-- √âcran de r√©sultats -->
        <div id="resultsScreen" class="screen">
            <div class="welcome-screen">
                <div class="results-icon" id="resultsIcon">üéâ</div>
                <h2 class="results-title" id="resultsTitle">Niveau r√©ussi !</h2>
                <div class="results-score" id="resultsScore">85%</div>
                
                <div class="results-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="correctCount">8/10</div>
                        <div class="stat-label">Bonnes r√©ponses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="pointsEarned">+75</div>
                        <div class="stat-label">Points gagn√©s</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="bestStreak">5</div>
                        <div class="stat-label">Meilleure s√©rie</div>
                    </div>
                </div>

                <div class="errors-recap" id="errorsRecap" style="display: none;">
                    <h4>üìù Points √† revoir</h4>
                    <ul id="errorsList"></ul>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="goHome()">üè† Accueil</button>
                    <button class="btn" id="nextLevelBtn" onclick="nextLevel()" style="display: none;">‚û°Ô∏è Niveau suivant</button>
                    <button class="btn" onclick="startLevel(currentLevel)">üîÑ Refaire</button>
                </div>
            </div>
        </div>

        <!-- Overlay feedback - FOND OPAQUE OBLIGATOIRE -->
        <div class="feedback-overlay" id="feedbackOverlay">
            <div class="feedback-card" id="feedbackCard">
                <div class="feedback-icon" id="feedbackIcon">‚úÖ</div>
                <h3 class="feedback-title" id="feedbackTitle">Bravo !</h3>
                <div class="feedback-points" id="feedbackPoints">+10 points</div>
                <div class="feedback-explanation" id="feedbackExplanation">
                    <h4>üìö Explication</h4>
                    <p>Le stress est effectivement une r√©action physiologique d'adaptation de l'organisme.</p>
                </div>
                <button class="btn" onclick="nextCard()">Suivant ‚û°Ô∏è</button>
            </div>
        </div>

        <!-- Popup streak -->
        <div class="streak-popup" id="streakPopup">üî• 3 de suite !</div>
    </div>

    <script>
        // Variables globales
        let currentLevel = 1;
        let currentCardIndex = 0;
        let levelProgress = [0, 0, 0, 0, 0, 0]; // Index 0 inutilis√©
        let levelCorrect = 0;
        let levelPoints = 0;
        let levelErrors = [];
        let totalPoints = 0;
        let currentStreak = 0;
        let bestStreak = 0;
        let hintUsed = false;

        // Contenu des flashcards par niveau
        const levels = {
            1: {
                title: "Les bases du stress",
                cards: [
                    {
                        type: 'keyword',
                        keyword: 'STRESS',
                        question: 'Quel terme d√©signe une r√©action physiologique de l\'organisme face √† une agression ?',
                        answer: 'stress',
                        hint: 'Ce terme vient de l\'anglais et signifie "tension"',
                        explanation: 'Le stress est une r√©action d\'adaptation normale de l\'organisme face √† ce qu\'il per√ßoit comme une agression ou un changement.',
                        tip: 'Retenir : r√©action d\'ADAPTATION physiologique'
                    },
                    {
                        type: 'qcm',
                        question: 'Qui a d√©velopp√© la th√©orie du syndrome g√©n√©ral d\'adaptation ?',
                        keyword: 'HANS SELYE',
                        options: [
                            'Hans Selye',
                            'Sigmund Freud', 
                            'Carl Jung',
                            'Ivan Pavlov'
                        ],
                        answer: 0,
                        hint: 'Endocrinologue austro-hongrois qui a travaill√© au Canada',
                        explanation: 'Hans Selye (1907-1982) est le pionnier de la recherche sur le stress et a d√©velopp√© la th√©orie des 3 phases.',
                        tip: '√Ä retenir pour le BAC : Selye = stress'
                    },
                    {
                        type: 'vf',
                        question: 'Le stress est toujours n√©faste pour l\'organisme.',
                        keyword: 'STRESS POSITIF',
                        answer: false,
                        hint: 'Pensez aux situations d\'urgence ou de comp√©tition',
                        explanation: 'Le stress peut √™tre b√©n√©fique √† court terme (stress positif ou eustress) car il mobilise nos ressources pour faire face √† une situation.',
                        tip: 'Distinguer stress aigu (positif) et stress chronique (n√©gatif)'
                    },
                    {
                        type: 'keyword',
                        keyword: 'VULN√âRABILIT√â',
                        question: 'Comment appelle-t-on la fragilit√© individuelle face au stress ?',
                        answer: 'vuln√©rabilit√©',
                        hint: 'Terme qui d√©signe une faiblesse, une sensibilit√© particuli√®re',
                        explanation: 'La vuln√©rabilit√© au stress varie selon les individus : √¢ge, personnalit√©, v√©cu, √©tat de sant√©.',
                        tip: 'Vuln√©rabilit√© = capacit√©s d\'adaptation d√©pass√©es'
                    },
                    {
                        type: 'qcm',
                        question: 'Parmi ces √©l√©ments, lequel N\'EST PAS un facteur de stress professionnel ?',
                        keyword: 'FACTEURS STRESS',
                        options: [
                            'Surcharge de travail',
                            'Manque de reconnaissance',
                            'Bonnes relations avec les coll√®gues',
                            'Ambigu√Øt√© des r√¥les'
                        ],
                        answer: 2,
                        hint: 'Cherchez l\'√©l√©ment positif dans la liste',
                        explanation: 'Les bonnes relations avec les coll√®gues sont un facteur protecteur, contrairement aux autres qui sont des stresseurs.',
                        tip: 'Facteurs protecteurs vs facteurs de risque'
                    },
                    {
                        type: 'vf',
                        question: 'Tous les individus r√©agissent de la m√™me mani√®re face au stress.',
                        keyword: 'INDIVIDUALIT√â',
                        answer: false,
                        hint: 'Pensez aux diff√©rences de personnalit√© et d\'exp√©rience',
                        explanation: 'La r√©action au stress est tr√®s individuelle : m√™me situation = r√©actions diff√©rentes selon la personne.',
                        tip: 'Stress = perception subjective de la situation'
                    },
                    {
                        type: 'keyword',
                        keyword: 'AGENT STRESSEUR',
                        question: 'Comment appelle-t-on l\'√©l√©ment d√©clencheur du stress ?',
                        answer: 'agent stresseur',
                        hint: 'Terme m√©dical pour d√©signer ce qui provoque le stress',
                        explanation: 'L\'agent stresseur (ou stressor) est tout √©l√©ment de l\'environnement per√ßu comme une menace ou un d√©fi.',
                        tip: 'Agent stresseur ‚Üí r√©action de stress'
                    },
                    {
                        type: 'qcm',
                        question: 'Le stress peut avoir une origine :',
                        keyword: 'ORIGINES STRESS',
                        options: [
                            'Uniquement physique',
                            'Uniquement psychologique', 
                            'Physique, psychologique et sociale',
                            'Uniquement environnementale'
                        ],
                        answer: 2,
                        hint: 'Le stress est multifactoriel',
                        explanation: 'Le stress peut √™tre d√©clench√© par des facteurs physiques, psychologiques, sociaux ou environnementaux.',
                        tip: 'Approche globale = bio-psycho-sociale'
                    },
                    {
                        type: 'vf',
                        question: 'Le stress aigu dure g√©n√©ralement moins d\'une heure.',
                        keyword: 'DUR√âE STRESS',
                        answer: true,
                        hint: 'Pensez √† la phase d\'alarme de Selye',
                        explanation: 'Le stress aigu correspond √† la phase d\'alarme qui dure effectivement moins d\'une heure.',
                        tip: 'Alarme < 1h, R√©sistance < 1 mois, √âpuisement = chronique'
                    },
                    {
                        type: 'keyword',
                        keyword: 'HOM√âOSTASIE',
                        question: 'Comment appelle-t-on l\'√©quilibre physiologique que le corps cherche √† maintenir ?',
                        answer: 'hom√©ostasie',
                        hint: 'Terme grec signifiant "√©tat stable"',
                        explanation: 'L\'hom√©ostasie est l\'√©quilibre interne que l\'organisme maintient gr√¢ce √† ses m√©canismes de r√©gulation.',
                        tip: 'Hom√©ostasie perturb√©e ‚Üí stress ‚Üí adaptation'
                    }
                ]
            },
            2: {
                title: "Les 3 phases physiologiques",
                cards: [
                    {
                        type: 'qcm',
                        question: 'Quelle est la premi√®re phase du syndrome g√©n√©ral d\'adaptation ?',
                        keyword: 'PHASE ALARME',
                        options: [
                            'Phase d\'√©puisement',
                            'Phase d\'alarme',
                            'Phase de r√©sistance',
                            'Phase d\'adaptation'
                        ],
                        answer: 1,
                        hint: 'C\'est la r√©action imm√©diate √† l\'agression',
                        explanation: 'La phase d\'alarme est la r√©action imm√©diate de mobilisation des ressources face √† l\'agression.',
                        tip: 'Ordre chronologique : Alarme ‚Üí R√©sistance ‚Üí √âpuisement'
                    },
                    {
                        type: 'keyword',
                        keyword: 'HYPOTHALAMUS',
                        question: 'Quelle r√©gion du cerveau d√©clenche la r√©action de stress ?',
                        answer: 'hypothalamus',
                        hint: 'Structure situ√©e sous le thalamus',
                        explanation: 'L\'hypothalamus d√©tecte la situation stressante et active le syst√®me nerveux sympathique et l\'axe hypothalamo-hypophysaire.',
                        tip: 'Hypothalamus = chef d\'orchestre du stress'
                    },
                    {
                        type: 'vf',
                        question: 'La phase de r√©sistance peut durer jusqu\'√† un mois.',
                        keyword: 'DUR√âE R√âSISTANCE',
                        answer: true,
                        hint: 'C\'est la phase interm√©diaire d\'adaptation',
                        explanation: 'La phase de r√©sistance permet √† l\'organisme de s\'adapter sur une dur√©e plus longue, jusqu\'√† environ un mois.',
                        tip: 'R√©sistance = adaptation prolong√©e (< 1 mois)'
                    },
                    {
                        type: 'qcm',
                        question: 'Que se passe-t-il lors de la phase d\'√©puisement ?',
                        keyword: '√âPUISEMENT',
                        options: [
                            'L\'organisme s\'adapte parfaitement',
                            'Les ressources se r√©g√©n√®rent',
                            'Les capacit√©s d\'adaptation sont d√©pass√©es',
                            'Le stress dispara√Æt naturellement'
                        ],
                        answer: 2,
                        hint: 'C\'est la phase de d√©compensation',
                        explanation: 'La phase d\'√©puisement survient quand l\'organisme ne peut plus faire face et ses capacit√©s d\'adaptation sont d√©pass√©es.',
                        tip: '√âpuisement = d√©passement des capacit√©s ‚Üí pathologies'
                    },
                    {
                        type: 'keyword',
                        keyword: 'SYNDROME G√âN√âRAL',
                        question: 'Comment Selye a-t-il nomm√© sa th√©orie des 3 phases du stress ?',
                        answer: 'syndrome g√©n√©ral d\'adaptation',
                        hint: 'Sigle : S.G.A.',
                        explanation: 'Le Syndrome G√©n√©ral d\'Adaptation (S.G.A.) d√©crit les 3 phases de r√©action de l\'organisme face au stress.',
                        tip: 'S.G.A. = th√©orie de r√©f√©rence sur le stress'
                    },
                    {
                        type: 'vf',
                        question: 'Pendant la phase d\'alarme, le rythme cardiaque augmente.',
                        keyword: 'R√âACTION ALARME',
                        answer: true,
                        hint: 'Pensez √† la r√©action "fight or flight"',
                        explanation: 'La phase d\'alarme active le syst√®me sympathique : tachycardie, hyperventilation, tension musculaire.',
                        tip: 'Alarme = mobilisation imm√©diate des ressources'
                    },
                    {
                        type: 'qcm',
                        question: 'Quelle phase correspond au stress chronique ?',
                        keyword: 'STRESS CHRONIQUE',
                        options: [
                            'Phase d\'alarme uniquement',
                            'Phase de r√©sistance uniquement',
                            'Phase d\'√©puisement uniquement',
                            'Phases de r√©sistance et d\'√©puisement'
                        ],
                        answer: 3,
                        hint: 'Le chronique s\'oppose √† l\'aigu',
                        explanation: 'Le stress chronique correspond aux phases de r√©sistance prolong√©e puis d\'√©puisement.',
                        tip: 'Chronique = r√©sistance + √©puisement (pathologique)'
                    },
                    {
                        type: 'keyword',
                        keyword: 'R√âVERSIBILIT√â',
                        question: 'Quelle caract√©ristique de la phase d\'alarme permet un retour √† l\'√©tat normal ?',
                        answer: 'r√©versibilit√©',
                        hint: 'Capacit√© √† revenir en arri√®re',
                        explanation: 'La phase d\'alarme est r√©versible : si le stresseur dispara√Æt, l\'organisme revient √† l\'√©tat normal.',
                        tip: 'Alarme r√©versible ‚â† √©puisement (l√©sions parfois irr√©versibles)'
                    },
                    {
                        type: 'vf',
                        question: 'La phase de r√©sistance consomme beaucoup d\'√©nergie.',
                        keyword: 'CO√õT √âNERG√âTIQUE',
                        answer: true,
                        hint: 'L\'adaptation n\'est pas gratuite',
                        explanation: 'La phase de r√©sistance mobilise √©norm√©ment de ressources √©nerg√©tiques et peut mener √† l\'√©puisement.',
                        tip: 'R√©sistance = co√ªt √©nerg√©tique √©lev√©'
                    },
                    {
                        type: 'qcm',
                        question: 'Qu\'observe-t-on au niveau des glandes surr√©nales pendant le stress ?',
                        keyword: 'SURR√âNALES',
                        options: [
                            'Elles diminuent de volume',
                            'Elles ne changent pas',
                            'Elles grossissent (hypertrophie)',
                            'Elles disparaissent'
                        ],
                        answer: 2,
                        hint: 'Elles travaillent plus, donc...',
                        explanation: 'Les glandes surr√©nales s\'hypertrophient car elles produisent massivement les hormones du stress.',
                        tip: 'Surr√©nales = usines √† hormones du stress'
                    }
                ]
            },
            3: {
                title: "Hormones et m√©canismes",
                cards: [
                    {
                        type: 'keyword',
                        keyword: 'ADR√âNALINE',
                        question: 'Quelle hormone est s√©cr√©t√©e massivement lors de la phase d\'alarme ?',
                        answer: 'adr√©naline',
                        hint: 'Aussi appel√©e √©pin√©phrine',
                        explanation: 'L\'adr√©naline (√©pin√©phrine) est l\'hormone d\'urgence s√©cr√©t√©e par la m√©dullosurr√©nale lors du stress aigu.',
                        tip: 'Adr√©naline = hormone de l\'urgence (phase alarme)'
                    },
                    {
                        type: 'qcm',
                        question: 'O√π est produite l\'adr√©naline ?',
                        keyword: 'M√âDULLOSURR√âNALE',
                        options: [
                            'Thyro√Øde',
                            'Pancr√©as',
                            'M√©dullosurr√©nale',
                            'Hypophyse'
                        ],
                        answer: 2,
                        hint: 'Partie centrale des glandes surr√©nales',
                        explanation: 'L\'adr√©naline est produite par la m√©dullosurr√©nale (partie centrale des glandes surr√©nales).',
                        tip: 'M√©dullosurr√©nale = partie centrale des surr√©nales'
                    },
                    {
                        type: 'keyword',
                        keyword: 'CORTISOL',
                        question: 'Quelle hormone permet de maintenir l\'adaptation lors de la phase de r√©sistance ?',
                        answer: 'cortisol',
                        hint: 'Hormone st√©ro√Øde, "hormone du stress chronique"',
                        explanation: 'Le cortisol est s√©cr√©t√© par le cortex surr√©nalien et permet de maintenir l\'adaptation prolong√©e.',
                        tip: 'Cortisol = hormone du stress prolong√©'
                    },
                    {
                        type: 'vf',
                        question: 'L\'adr√©naline augmente la fr√©quence cardiaque.',
                        keyword: 'EFFETS ADR√âNALINE',
                        answer: true,
                        hint: 'Pensez aux effets de l\'urgence',
                        explanation: 'L\'adr√©naline stimule le syst√®me cardiovasculaire : tachycardie, augmentation de la pression art√©rielle.',
                        tip: 'Adr√©naline = stimulation cardio-vasculaire'
                    },
                    {
                        type: 'qcm',
                        question: 'Quel effet a le cortisol sur la glyc√©mie ?',
                        keyword: 'CORTISOL GLUCOSE',
                        options: [
                            'Il la diminue',
                            'Il l\'augmente',
                            'Il n\'a aucun effet',
                            'Il la stabilise'
                        ],
                        answer: 1,
                        hint: 'L\'organisme a besoin d\'√©nergie pour r√©sister',
                        explanation: 'Le cortisol augmente la glyc√©mie (hyperglyc√©mie) pour fournir de l\'√©nergie aux organes sollicit√©s.',
                        tip: 'Cortisol ‚Üí hyperglyc√©mie (besoin d\'√©nergie)'
                    },
                    {
                        type: 'keyword',
                        keyword: 'NORADR√âNALINE',
                        question: 'Quel neurotransmetteur est lib√©r√© par le syst√®me nerveux sympathique ?',
                        answer: 'noradr√©naline',
                        hint: 'Pr√©curseur de l\'adr√©naline',
                        explanation: 'La noradr√©naline est lib√©r√©e par les terminaisons nerveuses sympathiques et pr√©pare l\'action de l\'adr√©naline.',
                        tip: 'Noradr√©naline = neurotransmetteur du sympathique'
                    },
                    {
                        type: 'vf',
                        question: 'Le cortisol a des effets anti-inflammatoires.',
                        keyword: 'CORTISOL ANTI-INFLAMMATOIRE',
                        answer: true,
                        hint: 'C\'est pourquoi on l\'utilise en m√©dicament',
                        explanation: 'Le cortisol a effectivement des propri√©t√©s anti-inflammatoires, d\'o√π son utilisation th√©rapeutique.',
                        tip: 'Cortisol = anti-inflammatoire naturel'
                    },
                    {
                        type: 'qcm',
                        question: 'Qu\'est-ce que l\'axe hypothalamo-hypophyso-surr√©nalien ?',
                        keyword: 'AXE HHS',
                        options: [
                            'Une maladie du stress',
                            'Un syst√®me de r√©gulation du stress',
                            'Une hormone du stress',
                            'Une phase du stress'
                        ],
                        answer: 1,
                        hint: 'C\'est une cascade de r√©gulation',
                        explanation: 'L\'axe HHS est le syst√®me de r√©gulation qui contr√¥le la s√©cr√©tion des hormones du stress.',
                        tip: 'Axe HHS = hypothalamus ‚Üí hypophyse ‚Üí surr√©nales'
                    },
                    {
                        type: 'keyword',
                        keyword: 'CAT√âCHOLAMINES',
                        question: 'Comment appelle-t-on la famille d\'hormones comprenant l\'adr√©naline et la noradr√©naline ?',
                        answer: 'cat√©cholamines',
                        hint: 'Famille d\'hormones d√©riv√©es de la tyrosine',
                        explanation: 'Les cat√©cholamines (adr√©naline, noradr√©naline, dopamine) sont les hormones d\'urgence du stress.',
                        tip: 'Cat√©cholamines = hormones d\'urgence'
                    },
                    {
                        type: 'vf',
                        question: 'Un exc√®s de cortisol peut affaiblir le syst√®me immunitaire.',
                        keyword: 'IMMUNOSUPPRESSION',
                        answer: true,
                        hint: 'Pensez au stress chronique',
                        explanation: 'L\'hypercortisolisme chronique supprime les d√©fenses immunitaires, d\'o√π les infections fr√©quentes lors de stress prolong√©.',
                        tip: 'Cortisol chronique = immunod√©pression'
                    }
                ]
            },
            4: {
                title: "Stress aigu vs chronique",
                cards: [
                    {
                        type: 'vf',
                        question: 'Le stress aigu peut am√©liorer les performances.',
                        keyword: 'STRESS POSITIF',
                        answer: true,
                        hint: 'Pensez aux comp√©titions sportives',
                        explanation: 'Le stress aigu mobilise les ressources et peut am√©liorer les performances physiques et intellectuelles.',
                        tip: 'Stress aigu = eustress (b√©n√©fique √† court terme)'
                    },
                    {
                        type: 'qcm',
                        question: 'Quand parle-t-on de stress chronique ?',
                        keyword: 'STRESS CHRONIQUE',
                        options: [
                            'Stress de moins d\'1 heure',
                            'Stress de moins d\'1 jour',
                            'Stress de plusieurs semaines/mois',
                            'Stress de quelques minutes'
                        ],
                        answer: 2,
                        hint: 'Le terme "chronique" indique la dur√©e',
                        explanation: 'Le stress devient chronique quand il persiste plusieurs semaines ou mois sans r√©cup√©ration.',
                        tip: 'Chronique = prolong√© dans le temps (> 1 mois)'
                    },
                    {
                        type: 'keyword',
                        keyword: 'BURN-OUT',
                        question: 'Comment appelle-t-on l\'√©puisement professionnel li√© au stress chronique ?',
                        answer: 'burn-out',
                        hint: 'Terme anglais signifiant "br√ªl√© de l\'int√©rieur"',
                        explanation: 'Le burn-out est un syndrome d\'√©puisement physique, √©motionnel et mental li√© au stress professionnel chronique.',
                        tip: 'Burn-out = √©puisement professionnel (stress chronique)'
                    },
                    {
                        type: 'vf',
                        question: 'Le stress chronique peut provoquer des maladies cardiovasculaires.',
                        keyword: 'PATHOLOGIES CARDIO',
                        answer: true,
                        hint: 'Le c≈ìur est mis √† rude √©preuve',
                        explanation: 'Le stress chronique augmente les risques d\'hypertension, d\'infarctus et d\'accidents vasculaires c√©r√©braux.',
                        tip: 'Stress chronique = facteur de risque cardiovasculaire'
                    },
                    {
                        type: 'qcm',
                        question: 'Lequel de ces sympt√¥mes est typique du stress aigu ?',
                        keyword: 'SYMPT√îMES AIGUS',
                        options: [
                            'D√©pression',
                            'Troubles du sommeil chroniques',
                            'Palpitations cardiaques',
                            'Burn-out'
                        ],
                        answer: 2,
                        hint: 'Sympt√¥me imm√©diat et r√©versible',
                        explanation: 'Les palpitations sont un sympt√¥me typique du stress aigu (activation sympathique).',
                        tip: 'Stress aigu = sympt√¥mes imm√©diats et r√©versibles'
                    },
                    {
                        type: 'keyword',
                        keyword: 'TROUBLES MUSCULOSQUELETTIQUES',
                        question: 'Comment appelle-t-on les douleurs musculaires li√©es au stress chronique ? (sigle : TMS)',
                        answer: 'troubles musculosquelettiques',
                        hint: 'Sigle : TMS',
                        explanation: 'Les TMS r√©sultent des tensions musculaires chroniques maintenues lors du stress prolong√©.',
                        tip: 'TMS = cons√©quence m√©canique du stress chronique'
                    },
                    {
                        type: 'vf',
                        question: 'Le stress chronique affaiblit les d√©fenses immunitaires.',
                        keyword: 'IMMUNOD√âPRESSION',
                        answer: true,
                        hint: 'D\'o√π les infections √† r√©p√©tition',
                        explanation: 'L\'hypercortisolisme chronique supprime l\'immunit√© : infections fr√©quentes, cicatrisation lente.',
                        tip: 'Stress chronique ‚Üí cortisol ‚Üí immunod√©pression'
                    },
                    {
                        type: 'qcm',
                        question: 'Quelle est la diff√©rence principale entre stress aigu et chronique ?',
                        keyword: 'DIFF√âRENCE AIGU/CHRONIQUE',
                        options: [
                            'L\'intensit√© uniquement',
                            'Les hormones impliqu√©es',
                            'La dur√©e et les cons√©quences',
                            'Les organes touch√©s'
                        ],
                        answer: 2,
                        hint: 'Pensez temps et effets sur la sant√©',
                        explanation: 'La dur√©e d√©termine les cons√©quences : aigu = adaptatif, chronique = pathologique.',
                        tip: 'Dur√©e = crit√®re cl√© (aigu adaptatif vs chronique pathologique)'
                    },
                    {
                        type: 'keyword',
                        keyword: 'ULC√àRE',
                        question: 'Quelle pathologie digestive peut √™tre caus√©e par le stress chronique ?',
                        answer: 'ulc√®re',
                        hint: 'L√©sion de la paroi gastrique',
                        explanation: 'L\'ulc√®re gastro-duod√©nal peut r√©sulter du stress chronique (hypers√©cr√©tion acide + inflammation).',
                        tip: 'Stress chronique ‚Üí troubles digestifs (ulc√®re)'
                    },
                    {
                        type: 'vf',
                        question: 'Tous les individus d√©veloppent un burn-out en cas de stress professionnel.',
                        keyword: 'VULN√âRABILIT√â BURN-OUT',
                        answer: false,
                        hint: 'La r√©silience varie selon les personnes',
                        explanation: 'La vuln√©rabilit√© au burn-out varie selon la personnalit√©, les ressources personnelles et l\'environnement.',
                        tip: 'Burn-out = interaction personne √ó environnement'
                    }
                ]
            },
            5: {
                title: "Pr√©vention et solutions",
                cards: [
                    {
                        type: 'qcm',
                        question: 'Quel type de pr√©vention agit sur les causes du stress ?',
                        keyword: 'PR√âVENTION PRIMAIRE',
                        options: [
                            'Pr√©vention secondaire',
                            'Pr√©vention tertiaire',
                            'Pr√©vention primaire',
                            'Pr√©vention quaternaire'
                        ],
                        answer: 2,
                        hint: 'Elle intervient AVANT l\'apparition du probl√®me',
                        explanation: 'La pr√©vention primaire agit sur les facteurs de risque pour emp√™cher l\'apparition du stress.',
                        tip: 'Primaire = √©liminer les causes (facteurs stressants)'
                    },
                    {
                        type: 'keyword',
                        keyword: 'COPING',
                        question: 'Comment appelle-t-on les strat√©gies individuelles d\'adaptation au stress ?',
                        answer: 'coping',
                        hint: 'Terme anglais signifiant "faire face"',
                        explanation: 'Le coping regroupe toutes les strat√©gies cognitives et comportementales pour g√©rer le stress.',
                        tip: 'Coping = strat√©gies d\'adaptation individuelles'
                    },
                    {
                        type: 'vf',
                        question: 'L\'activit√© physique r√©guli√®re r√©duit les effets du stress.',
                        keyword: 'SPORT ANTISTRESS',
                        answer: true,
                        hint: 'Le sport √©vacue les tensions',
                        explanation: 'L\'exercice physique lib√®re les tensions, am√©liore l\'humeur et renforce la r√©sistance au stress.',
                        tip: 'Sport = lib√©ration endorphines + √©vacuation tensions'
                    },
                    {
                        type: 'qcm',
                        question: 'Quelle technique de relaxation utilise la respiration ?',
                        keyword: 'RELAXATION',
                        options: [
                            'Yoga uniquement',
                            'M√©ditation uniquement',
                            'Coh√©rence cardiaque',
                            'Toutes ces techniques'
                        ],
                        answer: 3,
                        hint: 'La respiration est universelle',
                        explanation: 'Yoga, m√©ditation, coh√©rence cardiaque utilisent tous des techniques respiratoires pour r√©duire le stress.',
                        tip: 'Respiration = outil universel de gestion du stress'
                    },
                    {
                        type: 'keyword',
                        keyword: 'SOUTIEN SOCIAL',
                        question: 'Comment appelle-t-on l\'aide apport√©e par l\'entourage face au stress ?',
                        answer: 'soutien social',
                        hint: 'Le r√©seau relationnel qui aide',
                        explanation: 'Le soutien social (famille, amis, coll√®gues) est un facteur protecteur majeur contre le stress.',
                        tip: 'Soutien social = facteur protecteur relationnel'
                    },
                    {
                        type: 'vf',
                        question: 'Dormir suffisamment aide √† mieux r√©sister au stress.',
                        keyword: 'SOMMEIL R√âCUP√âRATEUR',
                        answer: true,
                        hint: 'Le sommeil restaure l\'organisme',
                        explanation: 'Un sommeil de qualit√© permet la r√©cup√©ration physique et mentale, essentielle pour faire face au stress.',
                        tip: 'Sommeil = r√©cup√©ration + r√©sistance au stress'
                    },
                    {
                        type: 'qcm',
                        question: 'En entreprise, qui peut intervenir pour la pr√©vention du stress ?',
                        keyword: 'ACTEURS PR√âVENTION',
                        options: [
                            'Le m√©decin du travail uniquement',
                            'Les RH uniquement',
                            'Le CHSCT/CSE uniquement',
                            'Tous ces acteurs ensemble'
                        ],
                        answer: 3,
                        hint: 'Approche pluridisciplinaire',
                        explanation: 'La pr√©vention du stress en entreprise n√©cessite une approche collective : m√©decin du travail, RH, repr√©sentants du personnel.',
                        tip: 'Pr√©vention collective = approche pluridisciplinaire'
                    },
                    {
                        type: 'keyword',
                        keyword: 'R√âSILIENCE',
                        question: 'Comment appelle-t-on la capacit√© √† surmonter les √©preuves ?',
                        answer: 'r√©silience',
                        hint: 'Capacit√© de rebond apr√®s un choc',
                        explanation: 'La r√©silience est la capacit√© √† r√©cup√©rer et √† s\'adapter positivement face aux difficult√©s.',
                        tip: 'R√©silience = capacit√© d\'adaptation et de r√©cup√©ration'
                    },
                    {
                        type: 'vf',
                        question: 'La gestion du temps peut r√©duire le stress professionnel.',
                        keyword: 'GESTION TEMPS',
                        answer: true,
                        hint: 'Organisation = moins de pression',
                        explanation: 'Une bonne organisation du temps r√©duit la pression, les urgences et donc le stress au travail.',
                        tip: 'Gestion du temps = pr√©vention du stress d\'urgence'
                    },
                    {
                        type: 'qcm',
                        question: 'Quelle est la meilleure approche pour g√©rer le stress ?',
                        keyword: 'APPROCHE GLOBALE',
                        options: [
                            'Uniquement individuelle',
                            'Uniquement collective',
                            'Individuelle ET collective',
                            'Uniquement m√©dicamenteuse'
                        ],
                        answer: 2,
                        hint: 'Combiner les approches',
                        explanation: 'La gestion efficace du stress combine actions individuelles (coping) et collectives (environnement).',
                        tip: 'Efficacit√© maximale = individuel + collectif'
                    }
                ]
            }
        };

        function startLevel(levelNum) {
            currentLevel = levelNum;
            currentCardIndex = 0;
            levelCorrect = 0;
            levelPoints = 0;
            levelErrors = [];
            hintUsed = false;

            document.getElementById('homeScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');

            document.getElementById('currentLevel').textContent = levelNum;
            document.getElementById('totalCards').textContent = levels[levelNum].cards.length;

            showCard();
        }

        function showCard() {
            const card = levels[currentLevel].cards[currentCardIndex];
            document.getElementById('currentCard').textContent = currentCardIndex + 1;
            
            // Reset hint
            document.getElementById('hintText').style.display = 'none';
            hintUsed = false;

            // Type de carte
            const typeMap = {
                'keyword': 'üîë Mot-cl√©',
                'qcm': 'üìù QCM',
                'vf': '‚úì/‚úó Vrai/Faux'
            };
            document.getElementById('cardType').textContent = typeMap[card.type];

            // Section keyword
            const keywordSection = document.getElementById('keywordSection');
            const questionSection = document.getElementById('questionSection');

            if (card.type === 'keyword') {
                keywordSection.style.display = 'block';
                document.getElementById('keywordDisplay').textContent = card.keyword;
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <input type="text" class="keyword-input" id="keywordAnswer" placeholder="Tapez votre r√©ponse...">
                `;
            } else {
                keywordSection.style.display = 'none';
            }

            if (card.type === 'qcm') {
                let optionsHTML = card.options.map((opt, i) => `
                    <button class="option-btn" data-index="${i}" onclick="selectOption(this)">
                        <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                        <span>${opt}</span>
                    </button>
                `).join('');
                
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="options-container">${optionsHTML}</div>
                `;
            } else if (card.type === 'vf') {
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="vf-container">
                        <button class="vf-btn vrai" onclick="selectVF(this, true)">‚úì VRAI</button>
                        <button class="vf-btn faux" onclick="selectVF(this, false)">‚úó FAUX</button>
                    </div>
                `;
            }
        }

        function selectOption(btn) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }

        function selectVF(btn, value) {
            document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            btn.dataset.value = value;
        }

        function showHint() {
            const card = levels[currentLevel].cards[currentCardIndex];
            if (card.hint) {
                const hintElement = document.getElementById('hintText');
                hintElement.innerHTML = `üí° <strong>Indice :</strong> ${card.hint}`;
                hintElement.style.display = 'block';
                hintUsed = true;
            }
        }

        function validateAnswer() {
            const card = levels[currentLevel].cards[currentCardIndex];
            let isCorrect = false;
            let userAnswer = '';

            if (card.type === 'keyword') {
                userAnswer = document.getElementById('keywordAnswer').value.trim().toLowerCase();
                // Normalisation pour g√©rer les accents
                const normalize = str => str.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
                const normalizedUser = normalize(userAnswer);
                const normalizedAnswer = normalize(card.answer);
                isCorrect = normalizedUser === normalizedAnswer || 
                           normalizedUser.includes(normalizedAnswer) ||
                           normalizedAnswer.includes(normalizedUser);
            } else if (card.type === 'qcm') {
                const selected = document.querySelector('.option-btn.selected');
                if (!selected) { 
                    alert('S√©lectionnez une r√©ponse !'); 
                    return; 
                }
                userAnswer = parseInt(selected.dataset.index);
                isCorrect = userAnswer === card.answer;
            } else if (card.type === 'vf') {
                const selected = document.querySelector('.vf-btn.selected');
                if (!selected) { 
                    alert('S√©lectionnez VRAI ou FAUX !'); 
                    return; 
                }
                userAnswer = selected.dataset.value === 'true';
                isCorrect = userAnswer === card.answer;
            }

            showFeedback(isCorrect, card);
        }

        function showFeedback(isCorrect, card) {
            const overlay = document.getElementById('feedbackOverlay');
            const feedbackCard = document.getElementById('feedbackCard');

            let points = 0;
            if (isCorrect) {
                points = hintUsed ? 5 : 10;
                levelCorrect++;
                currentStreak++;
                if (currentStreak > bestStreak) bestStreak = currentStreak;

                // Streak bonus
                if (currentStreak === 3) showStreakPopup('üî• 3 de suite !');
                else if (currentStreak === 5) showStreakPopup('üî•üî• 5 de suite !');
                else if (currentStreak === 10) showStreakPopup('üî•üî•üî• INCROYABLE !');
            } else {
                currentStreak = 0;
                levelErrors.push(card.keyword || card.question.replace(/<[^>]*>/g, '').substring(0, 50) + '...');
            }

            levelPoints += points;
            totalPoints += points;
            updateScoreDisplay();

            feedbackCard.className = 'feedback-card ' + (isCorrect ? 'correct' : 'incorrect');
            document.getElementById('feedbackIcon').textContent = isCorrect ? '‚úÖ' : '‚ùå';
            document.getElementById('feedbackTitle').textContent = isCorrect ? 
                (currentStreak >= 3 ? 'Excellent ! üî•' : 'Bravo !') : 'Pas tout √† fait...';
            document.getElementById('feedbackPoints').textContent = isCorrect ? `+${points} points` : '0 point';
            document.getElementById('feedbackPoints').style.display = isCorrect ? 'block' : 'none';

            document.getElementById('feedbackExplanation').innerHTML = `
                <h4>üìö Explication</h4>
                <p>${card.explanation}</p>
                <div class="keyword-box">üîë <span>${card.keyword}</span></div>
                ${card.tip ? `<div class="tip-box"><h5>üí° Astuce BAC</h5><p>${card.tip}</p></div>` : ''}
            `;

            overlay.classList.add('visible');
        }

        function showStreakPopup(text) {
            const popup = document.getElementById('streakPopup');
            popup.textContent = text;
            popup.style.display = 'block';
            setTimeout(() => { popup.style.display = 'none'; }, 1500);
        }

        function nextCard() {
            document.getElementById('feedbackOverlay').classList.remove('visible');
            currentCardIndex++;

            if (currentCardIndex >= levels[currentLevel].cards.length) {
                showResults();
            } else {
                showCard();
            }
        }

        function showResults() {
            const total = levels[currentLevel].cards.length;
            const percent = Math.round((levelCorrect / total) * 100);

            levelProgress[currentLevel] = Math.max(levelProgress[currentLevel], percent);

            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');

            document.getElementById('resultsIcon').textContent = percent >= 80 ? 'üéâ' : percent >= 50 ? 'üëç' : 'üí™';
            document.getElementById('resultsTitle').textContent = percent >= 80 ? 'Niveau r√©ussi !' : percent >= 50 ? 'Pas mal !' : 'Continue !';
            document.getElementById('resultsScore').textContent = percent + '%';
            document.getElementById('correctCount').textContent = levelCorrect + '/' + total;
            document.getElementById('pointsEarned').textContent = '+' + levelPoints;
            document.getElementById('bestStreak').textContent = bestStreak;

            // Erreurs
            const errorsRecap = document.getElementById('errorsRecap');
            if (levelErrors.length > 0) {
                errorsRecap.style.display = 'block';
                document.getElementById('errorsList').innerHTML = levelErrors.map(e => `<li>${e}</li>`).join('');
            } else {
                errorsRecap.style.display = 'none';
            }

            // Confettis si r√©ussi
            if (percent >= 80) {
                createConfetti();
            }

            // Bouton niveau suivant
            document.getElementById('nextLevelBtn').style.display = (currentLevel < 5 && percent >= 60) ? 'flex' : 'none';

            updateHomeProgress();
        }

        function createConfetti() {
            const colors = ['#ff9a9e', '#fecfef', '#ffd1ff', '#84fab0', '#8fd3f4', '#FFD700'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }

        function goHome() {
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('homeScreen').classList.add('active');
            updateHomeProgress();
        }

        function nextLevel() {
            if (currentLevel < 5) {
                startLevel(currentLevel + 1);
                document.getElementById('resultsScreen').classList.remove('active');
            }
        }

        function updateScoreDisplay() {
            document.getElementById('totalPoints').textContent = totalPoints;
            document.getElementById('currentStreak').textContent = currentStreak;
        }

        function updateHomeProgress() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`level${i}Percent`).textContent = levelProgress[i] + '%';
                document.getElementById(`level${i}Bar`).style.width = levelProgress[i] + '%';
            }
        }

        // Initialisation
        updateScoreDisplay();
        updateHomeProgress();
    </script>
</body>
</html>