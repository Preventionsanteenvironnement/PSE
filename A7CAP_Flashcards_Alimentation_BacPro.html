<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©vision A7 - L'alimentation adapt√©e √† son activit√© - Bac Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #d97706 0%, #f59e0b 40%, #16a34a 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }

        .container { max-width: 800px; margin: 0 auto; padding: 20px; min-height: 100vh; }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .btn-back {
            background: rgba(255,255,255,0.1);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.2);
            cursor: pointer;
        }
        .btn-back:hover { background: rgba(255,255,255,0.2); transform: translateY(-2px); }

        .score-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 50px;
        }
        .score-item { display: flex; align-items: center; gap: 5px; font-size: 14px; font-weight: 600; }
        .score-item .icon { font-size: 18px; }

        /* √âcrans */
        .screen { display: none; animation: fadeIn 0.5s ease; }
        .screen.active { display: block; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        /* Accueil */
        .welcome-screen { text-align: center; padding: 30px 0; }
        .welcome-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #fde68a, #86efac, #6ee7b7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .welcome-subtitle { font-size: 18px; color: rgba(255,255,255,0.7); margin-bottom: 30px; }

        /* Objectifs */
        .objectifs-card {
            background: linear-gradient(135deg, rgba(253,230,138,0.3), rgba(134,239,172,0.3));
            border: 2px solid rgba(253,230,138,0.5);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: left;
        }
        .objectifs-card h3 { font-size: 18px; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .objectif-item {
            display: flex; align-items: flex-start; gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px; line-height: 1.5;
        }
        .objectif-item:last-child { border-bottom: none; }
        .objectif-item .check { color: #86efac; font-size: 18px; flex-shrink: 0; }
        .competences-row { display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; }
        .comp-badge { background: rgba(255,255,255,0.15); padding: 6px 14px; border-radius: 20px; font-size: 12px; font-weight: 700; }
        .comp-badge.c1 { background: rgba(231,76,60,0.3); border: 1px solid #e74c3c; }
        .comp-badge.c2 { background: rgba(52,152,219,0.3); border: 1px solid #3498db; }
        .comp-badge.c3 { background: rgba(46,204,113,0.3); border: 1px solid #2ecc71; }
        .comp-badge.c4 { background: rgba(243,156,18,0.3); border: 1px solid #f39c12; }
        .comp-badge.c5 { background: rgba(155,89,182,0.3); border: 1px solid #9b59b6; }

        /* Niveaux */
        .niveaux-grid { display: flex; flex-direction: column; gap: 12px; margin-bottom: 25px; }
        .niveau-card {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            display: flex; align-items: center; gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .niveau-card:hover:not(.locked) { background: rgba(255,255,255,0.1); transform: translateX(5px); border-color: rgba(253,230,138,0.5); }
        .niveau-card.locked { opacity: 0.5; cursor: not-allowed; }
        .niveau-card.completed { border-color: #86efac; background: rgba(134,239,172,0.1); }

        .niveau-icon {
            width: 50px; height: 50px; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px; flex-shrink: 0;
        }
        .niveau-card:nth-child(1) .niveau-icon { background: linear-gradient(135deg, #fde68a, #d97706); }
        .niveau-card:nth-child(2) .niveau-icon { background: linear-gradient(135deg, #86efac, #16a34a); }
        .niveau-card:nth-child(3) .niveau-icon { background: linear-gradient(135deg, #6ee7b7, #0d9488); }
        .niveau-card:nth-child(4) .niveau-icon { background: linear-gradient(135deg, #fca5a5, #dc2626); }
        .niveau-card:nth-child(5) .niveau-icon { background: linear-gradient(135deg, #c4b5fd, #7c3aed); }

        .niveau-info { flex: 1; }
        .niveau-info h4 { font-size: 16px; margin-bottom: 4px; }
        .niveau-info p { font-size: 12px; color: rgba(255,255,255,0.6); }

        .niveau-progress { width: 80px; text-align: right; }
        .niveau-progress .percent { font-size: 18px; font-weight: 700; }
        .progress-mini { height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; margin-top: 5px; overflow: hidden; }
        .progress-mini-fill { height: 100%; background: linear-gradient(90deg, #fde68a, #86efac); border-radius: 3px; transition: width 0.5s ease; }
        .lock-icon { font-size: 24px; color: rgba(255,255,255,0.3); }

        /* √âcran de jeu */
        .game-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
        .game-title { font-size: 20px; font-weight: 700; }
        .game-progress { display: flex; align-items: center; gap: 10px; }
        .card-counter { font-size: 14px; color: rgba(255,255,255,0.7); }
        .progress-bar { width: 150px; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #fde68a, #86efac); transition: width 0.3s ease; }

        /* Carte */
        .flashcard {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            border-radius: 25px;
            padding: 35px;
            min-height: 400px;
            display: flex; flex-direction: column;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border: 2px solid rgba(253,230,138,0.3);
            position: relative; overflow: hidden;
        }

        .card-type { position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.1); padding: 5px 12px; border-radius: 20px; font-size: 11px; font-weight: 600; text-transform: uppercase; }
        .card-competence { position: absolute; top: 20px; left: 20px; padding: 5px 12px; border-radius: 20px; font-size: 11px; font-weight: 700; }

        .question-section { flex: 1; display: flex; flex-direction: column; justify-content: center; text-align: center; padding: 20px 0; }
        .question-text { font-size: 22px; font-weight: 600; line-height: 1.5; margin-bottom: 25px; }
        .question-text .highlight { color: #fde68a; font-weight: 700; }
        .sigle { background: rgba(253,230,138,0.2); padding: 2px 6px; border-radius: 4px; cursor: help; border-bottom: 2px dotted #fde68a; }

        /* Input mot-cl√© */
        .keyword-input-container { display: flex; flex-direction: column; align-items: center; gap: 15px; }
        .keyword-input {
            background: rgba(255,255,255,0.1);
            border: 3px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 18px 25px;
            font-size: 24px; font-weight: 700;
            color: white; text-align: center;
            width: 100%; max-width: 350px;
            font-family: inherit;
            transition: all 0.3s ease;
            text-transform: lowercase;
        }
        .keyword-input:focus { outline: none; border-color: #fde68a; background: rgba(253,230,138,0.1); }
        .keyword-input::placeholder { color: rgba(255,255,255,0.3); font-weight: 400; }
        .hint-text { font-size: 14px; color: rgba(255,255,255,0.5); }
        .hint-text strong { color: #fde68a; }

        /* QCM */
        .options-container { display: flex; flex-direction: column; gap: 12px; width: 100%; max-width: 500px; margin: 0 auto; }
        .option-btn {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.15);
            border-radius: 12px;
            padding: 16px 20px;
            color: white; font-size: 15px; font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            display: flex; align-items: center; gap: 12px;
            min-height: 44px;
        }
        .option-btn:hover { background: rgba(253,230,138,0.2); border-color: rgba(253,230,138,0.5); transform: translateX(5px); }
        .option-btn.selected { background: rgba(253,230,138,0.3); border-color: #fde68a; }
        .option-btn.correct { background: rgba(134,239,172,0.3); border-color: #86efac; }
        .option-btn.incorrect { background: rgba(231,76,60,0.3); border-color: #e74c3c; }
        .option-letter { width: 30px; height: 30px; background: rgba(255,255,255,0.1); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: 700; flex-shrink: 0; }

        /* Vrai/Faux */
        .vf-container { display: flex; gap: 20px; justify-content: center; }
        .vf-btn {
            width: 140px; height: 80px;
            border-radius: 15px;
            border: 3px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.05);
            color: white; font-size: 20px; font-weight: 700;
            cursor: pointer; transition: all 0.3s ease;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            min-height: 44px;
        }
        .vf-btn:hover { transform: scale(1.05); }
        .vf-btn.vrai:hover { background: rgba(134,239,172,0.3); border-color: #86efac; }
        .vf-btn.faux:hover { background: rgba(231,76,60,0.3); border-color: #e74c3c; }
        .vf-btn.selected.vrai { background: rgba(134,239,172,0.3); border-color: #86efac; }
        .vf-btn.selected.faux { background: rgba(231,76,60,0.3); border-color: #e74c3c; }

        /* Boutons action */
        .action-row { display: flex; gap: 12px; margin-top: 25px; justify-content: center; flex-wrap: wrap; }
        .btn {
            padding: 14px 30px; border-radius: 12px;
            font-size: 16px; font-weight: 700;
            cursor: pointer; transition: all 0.3s ease;
            border: none;
            display: flex; align-items: center; gap: 8px;
            min-height: 44px;
        }
        .btn-primary { background: linear-gradient(135deg, #fde68a, #d97706); color: #1a1a2e; }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(253,230,138,0.4); }
        .btn-secondary { background: rgba(255,255,255,0.1); color: white; border: 2px solid rgba(255,255,255,0.2); }
        .btn-secondary:hover { background: rgba(255,255,255,0.15); }
        .btn-hint { background: rgba(134,239,172,0.2); color: #86efac; border: 2px solid rgba(134,239,172,0.3); }
        .btn-hint:hover { background: rgba(134,239,172,0.3); }

        /* Feedback overlay */
        .feedback-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.9);
            display: none; align-items: center; justify-content: center;
            z-index: 1000; padding: 20px;
        }
        .feedback-overlay.visible { display: flex; animation: fadeIn 0.3s ease; }
        .feedback-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            border-radius: 25px; padding: 35px;
            max-width: 500px; width: 100%;
            text-align: center;
            border: 3px solid; color: white;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        .feedback-card.correct { border-color: #86efac; }
        .feedback-card.incorrect { border-color: #e74c3c; }
        .feedback-icon { font-size: 60px; margin-bottom: 15px; }
        .feedback-title { font-size: 28px; font-weight: 900; margin-bottom: 10px; }
        .feedback-card.correct .feedback-title { color: #86efac; }
        .feedback-card.incorrect .feedback-title { color: #e74c3c; }
        .feedback-points { font-size: 18px; color: #fde68a; margin-bottom: 20px; }
        .feedback-explanation {
            background: rgba(0,0,0,0.6);
            border-radius: 15px; padding: 20px;
            text-align: left; margin-bottom: 20px;
        }
        .feedback-explanation h4 { font-size: 14px; color: #fde68a; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
        .feedback-explanation p { font-size: 14px; line-height: 1.6; color: rgba(255,255,255,0.9); }
        .keyword-box { background: rgba(253,230,138,0.2); border: 2px solid #fde68a; border-radius: 10px; padding: 10px 15px; margin-top: 12px; display: inline-block; }
        .keyword-box span { font-weight: 700; color: #fde68a; }
        .tip-box { background: rgba(134,239,172,0.1); border-left: 4px solid #86efac; border-radius: 8px; padding: 12px 15px; margin-top: 15px; text-align: left; }
        .tip-box h5 { font-size: 12px; color: #86efac; margin-bottom: 5px; }
        .tip-box p { font-size: 13px; color: rgba(255,255,255,0.8); }

        /* Streak */
        .streak-popup {
            position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #fde68a, #86efac);
            padding: 20px 40px; border-radius: 20px;
            font-size: 24px; font-weight: 900; color: #1a1a2e;
            z-index: 1001; display: none;
            animation: streakPop 0.5s ease;
        }
        @keyframes streakPop {
            0%   { transform: translate(-50%,-50%) scale(0); }
            50%  { transform: translate(-50%,-50%) scale(1.2); }
            100% { transform: translate(-50%,-50%) scale(1); }
        }

        /* R√©sultats */
        .results-screen { text-align: center; padding: 30px 0; }
        .results-icon { font-size: 80px; margin-bottom: 20px; }
        .results-title { font-size: 36px; font-weight: 900; margin-bottom: 10px; }
        .results-score {
            font-size: 60px; font-weight: 900;
            background: linear-gradient(135deg, #fde68a, #86efac, #6ee7b7);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
            margin: 20px 0;
        }
        .results-stats { display: flex; justify-content: center; gap: 30px; margin: 30px 0; flex-wrap: wrap; }
        .stat-item { background: rgba(255,255,255,0.05); border-radius: 15px; padding: 20px 30px; min-width: 120px; }
        .stat-value { font-size: 32px; font-weight: 900; color: #fde68a; }
        .stat-label { font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 5px; }
        .errors-recap { background: rgba(231,76,60,0.1); border: 2px solid rgba(231,76,60,0.3); border-radius: 15px; padding: 20px; margin: 25px 0; text-align: left; }
        .errors-recap h4 { color: #e74c3c; margin-bottom: 12px; font-size: 16px; }
        .errors-recap ul { margin-left: 20px; font-size: 14px; color: rgba(255,255,255,0.8); }
        .errors-recap li { margin: 8px 0; }

        /* Responsive */
        @media (max-width: 600px) {
            .welcome-title { font-size: 28px; }
            .question-text { font-size: 18px; }
            .flashcard { padding: 25px; min-height: 350px; }
            .keyword-input { font-size: 20px; padding: 15px 20px; }
            .vf-container { gap: 12px; }
            .vf-btn { width: 120px; height: 70px; font-size: 16px; }
            .results-score { font-size: 48px; }
            .feedback-card { padding: 25px; }
            .container { padding: 15px; }
            .btn { padding: 12px 20px; font-size: 14px; }
            .option-btn { padding: 14px 16px; font-size: 14px; }
        }
        .hidden { display: none !important; }
    </style>
</head>
<body>
<div class="container">

    <!-- Header -->
    <div class="header">
        <button class="btn-back" onclick="goHome()">‚¨ÖÔ∏è Retour</button>
        <div class="score-bar" id="scoreBar">
            <div class="score-item">
                <span class="icon">üçΩÔ∏è</span>
                <span id="totalPoints">0</span> pts
            </div>
            <div class="score-item">
                <span class="icon">üî•</span>
                <span id="currentStreak">0</span>
            </div>
        </div>
    </div>

    <!-- √âCRAN ACCUEIL -->
    <div class="screen active" id="homeScreen">
        <div class="welcome-screen">
            <h1 class="welcome-title">ü•ó R√âVISION A.7</h1>
            <p class="welcome-subtitle">L'alimentation adapt√©e √† son activit√©</p>

            <div class="objectifs-card">
                <h3>üéØ Module A.7 ‚Äî Objectif :</h3>
                <div class="objectif-item">
                    <span class="check">‚úì</span>
                    <span><strong>Je dois √™tre capable d'adopter un comportement alimentaire responsable</strong> adapt√© √† mon activit√© professionnelle</span>
                </div>
                <div class="objectif-item">
                    <span class="check">‚úì</span>
                    <span><strong>Identifier</strong> les besoins nutritionnels de l'organisme et leurs facteurs de variation</span>
                </div>
                <div class="objectif-item">
                    <span class="check">‚úì</span>
                    <span><strong>Appliquer</strong> les principes d'une alimentation √©quilibr√©e (PNNS, r√®gle de l'assiette)</span>
                </div>
                <div class="objectif-item">
                    <span class="check">‚úì</span>
                    <span><strong>Analyser</strong> les erreurs alimentaires et leurs cons√©quences sur la sant√© et le travail</span>
                </div>
                <div class="objectif-item">
                    <span class="check">‚úì</span>
                    <span><strong>Proposer</strong> des choix alimentaires adapt√©s aux contraintes professionnelles</span>
                </div>
                <div class="competences-row">
                    <span class="comp-badge c1">C1 - Analyser</span>
                    <span class="comp-badge c2">C2 - Appliquer</span>
                    <span class="comp-badge c3">C3 - Mettre en relation</span>
                    <span class="comp-badge c5">C5 - Proposer</span>
                </div>
            </div>

            <div class="niveaux-grid">
                <div class="niveau-card" onclick="startLevel(1)" id="level1Card">
                    <div class="niveau-icon">‚ö°</div>
                    <div class="niveau-info">
                        <h4>Niveau 1 : Les besoins nutritionnels</h4>
                        <p>√ânerg√©tique, plastique, fonctionnel, r√¥les...</p>
                    </div>
                    <div class="niveau-progress">
                        <span class="percent" id="level1Percent">0%</span>
                        <div class="progress-mini"><div class="progress-mini-fill" id="level1Bar" style="width:0%"></div></div>
                    </div>
                </div>

                <div class="niveau-card" onclick="startLevel(2)" id="level2Card">
                    <div class="niveau-icon">üìä</div>
                    <div class="niveau-info">
                        <h4>Niveau 2 : Facteurs de variation</h4>
                        <p>Sexe, √¢ge, grossesse, activit√© physique...</p>
                    </div>
                    <div class="niveau-progress">
                        <span class="percent" id="level2Percent">0%</span>
                        <div class="progress-mini"><div class="progress-mini-fill" id="level2Bar" style="width:0%"></div></div>
                    </div>
                </div>

                <div class="niveau-card" onclick="startLevel(3)" id="level3Card">
                    <div class="niveau-icon">ü•¶</div>
                    <div class="niveau-info">
                        <h4>Niveau 3 : Groupes alimentaires & PNNS</h4>
                        <p>7 groupes, assiette √©quilibr√©e, recommandations...</p>
                    </div>
                    <div class="niveau-progress">
                        <span class="percent" id="level3Percent">0%</span>
                        <div class="progress-mini"><div class="progress-mini-fill" id="level3Bar" style="width:0%"></div></div>
                    </div>
                </div>

                <div class="niveau-card" onclick="startLevel(4)" id="level4Card">
                    <div class="niveau-icon">‚ö†Ô∏è</div>
                    <div class="niveau-info">
                        <h4>Niveau 4 : Erreurs alimentaires & sant√©</h4>
                        <p>Grignotage, cholest√©rol, hypertension, David...</p>
                    </div>
                    <div class="niveau-progress">
                        <span class="percent" id="level4Percent">0%</span>
                        <div class="progress-mini"><div class="progress-mini-fill" id="level4Bar" style="width:0%"></div></div>
                    </div>
                </div>

                <div class="niveau-card" onclick="startLevel(5)" id="level5Card">
                    <div class="niveau-icon">üíº</div>
                    <div class="niveau-info">
                        <h4>Niveau 5 : Choix & solutions professionnels</h4>
                        <p>Ma√ßon, secr√©taire, 3√ó8, solutions David...</p>
                    </div>
                    <div class="niveau-progress">
                        <span class="percent" id="level5Percent">0%</span>
                        <div class="progress-mini"><div class="progress-mini-fill" id="level5Bar" style="width:0%"></div></div>
                    </div>
                </div>
            </div>

            <div style="text-align:center; margin-top:25px;">
                <p style="color:rgba(255,255,255,0.6); font-size:14px;">
                    <strong>Niveau :</strong> Premi√®re BAC PRO<br>
                    üì± Compatible mobile ¬∑ üí° Indices disponibles ¬∑ üéØ 100% du programme A7
                </p>
            </div>
        </div>
    </div>

    <!-- √âCRAN DE JEU -->
    <div class="screen" id="gameScreen">
        <div class="game-header">
            <div class="game-title" id="levelTitle">Niveau 1</div>
            <div class="game-progress">
                <span class="card-counter" id="cardCounter">1 / 8</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width:12.5%"></div>
                </div>
            </div>
        </div>

        <div class="flashcard" id="flashcard">
            <div class="card-type" id="cardType">MOT-CL√â</div>
            <div class="card-competence" id="cardCompetence" style="background:rgba(231,76,60,0.3);color:#e74c3c;">C1</div>

            <div class="question-section">
                <div class="question-text" id="questionText">Chargement...</div>

                <div class="keyword-input-container" id="keywordContainer">
                    <input type="text" class="keyword-input" id="keywordInput" placeholder="Tapez votre r√©ponse...">
                    <div class="hint-text" id="hintText" style="display:none;">
                        üí° Indice : <strong id="hintContent"></strong>
                    </div>
                </div>

                <div class="options-container" id="optionsContainer" style="display:none;"></div>

                <div class="vf-container" id="vfContainer" style="display:none;">
                    <button class="vf-btn vrai" onclick="selectVF(true)"><span>‚úì</span><span>VRAI</span></button>
                    <button class="vf-btn faux" onclick="selectVF(false)"><span>‚úó</span><span>FAUX</span></button>
                </div>
            </div>

            <div class="action-row">
                <button class="btn btn-hint" id="hintBtn" onclick="showHint()">üí° Indice</button>
                <button class="btn btn-primary" id="validateBtn" onclick="validateAnswer()">Valider</button>
                <button class="btn btn-secondary" onclick="skipCard()">Passer</button>
            </div>
        </div>
    </div>

    <!-- √âCRAN R√âSULTATS -->
    <div class="screen" id="resultsScreen">
        <div class="results-screen">
            <div class="results-icon" id="resultsIcon">üèÜ</div>
            <h2 class="results-title" id="resultsTitle">Niveau termin√© !</h2>
            <div class="results-score" id="resultsScore">850</div>
            <div class="results-stats">
                <div class="stat-item">
                    <div class="stat-value" id="statCorrect">6</div>
                    <div class="stat-label">BONNES R√âPONSES</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="statIncorrect">2</div>
                    <div class="stat-label">ERREURS</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="statStreak">4</div>
                    <div class="stat-label">MEILLEURE S√âRIE</div>
                </div>
            </div>
            <div class="errors-recap" id="errorsRecap" style="display:none;">
                <h4>üí° Points √† r√©viser :</h4>
                <ul id="errorsList"></ul>
            </div>
            <div class="action-row">
                <button class="btn btn-secondary" onclick="goHome()">üè† Accueil</button>
                <button class="btn btn-primary" onclick="nextLevel()" id="nextLevelBtn">Niveau suivant ‚Üí</button>
                <button class="btn btn-primary" onclick="retryLevel()" id="retryBtn" style="display:none;">üîÑ Rejouer</button>
            </div>
        </div>
    </div>

    <!-- FEEDBACK OVERLAY -->
    <div class="feedback-overlay" id="feedbackOverlay">
        <div class="feedback-card" id="feedbackCard">
            <div class="feedback-icon" id="feedbackIcon">‚úÖ</div>
            <h3 class="feedback-title" id="feedbackTitle">Bravo !</h3>
            <div class="feedback-points" id="feedbackPoints">+10 points</div>
            <div class="feedback-explanation" id="feedbackExplanation"></div>
            <button class="btn btn-primary" onclick="nextCard()">Suivant ‚Üí</button>
        </div>
    </div>

    <!-- STREAK POPUP -->
    <div class="streak-popup" id="streakPopup"></div>

</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DONN√âES MODULE A.7 ‚Äî L'alimentation adapt√©e √† son activit√©
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

let totalPoints = 0;
let currentStreak = 0;
let bestStreak = 0;
let currentLevel = 1;
let currentCardIndex = 0;
let levelCorrect = 0;
let levelPoints = 0;
let levelErrors = [];
let levelProgress = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };
let hintUsed = false;
let userAnswer = '';

const levels = {

    // ‚îÄ‚îÄ NIVEAU 1 : Les besoins nutritionnels ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    1: {
        title: "Niveau 1 : Les besoins nutritionnels",
        competence: "C1",
        cards: [
            {
                type: "keyword",
                question: "Quel type de besoin correspond √† l'<span class='highlight'>√©nergie</span> n√©cessaire au fonctionnement du corps ?",
                answer: "√©nerg√©tique",
                hint: "Besoin √© _ _ _ _ _ _ _ _ _ _",
                explanation: "Les besoins √âNERG√âTIQUES = le carburant du corps. Comme une voiture a besoin d'essence, notre corps a besoin de calories pour fonctionner, se d√©placer et travailler.",
                keyword: "Besoin √©nerg√©tique = carburant du corps",
                tip: "3 besoins √† retenir : √â-P-F (√ânerg√©tique, Plastique, Fonctionnel)"
            },
            {
                type: "keyword",
                question: "Comment appelle-t-on le besoin qui sert √† <span class='highlight'>construire et r√©parer</span> les cellules du corps ?",
                answer: "plastique",
                hint: "Besoin p _ _ _ _ _ _ _ _ (ou b√¢tisseur)",
                explanation: "Les besoins PLASTIQUES (b√¢tisseurs) = construction et r√©paration des cellules. Les prot√©ines (viande, poisson, ≈ìufs, l√©gumineuses) couvrent principalement ces besoins.",
                keyword: "Besoin plastique = construction cellulaire",
                tip: "Plastique = comme un mat√©riau de construction. Les prot√©ines b√¢tissent !"
            },
            {
                type: "qcm",
                question: "Quel nutriment couvre principalement les <span class='highlight'>besoins plastiques</span> (b√¢tisseurs) ?",
                options: [
                    "Les glucides (sucres)",
                    "Les prot√©ines (viande, poisson, ≈ìufs)",
                    "Les lipides (graisses)",
                    "Les vitamines"
                ],
                answer: 1,
                explanation: "Les PROT√âINES = mat√©riaux de construction du corps. Sources animales : viandes, poissons, ≈ìufs, fromage. Sources v√©g√©tales : lentilles, pois chiches, tofu.",
                keyword: "Prot√©ines ‚Üí besoins plastiques",
                tip: "Pro-t√©ines = pro-construction ! Les muscles sont faits de prot√©ines."
            },
            {
                type: "keyword",
                question: "Les vitamines et min√©raux couvrent quel type de besoin nutritionnel ?",
                answer: "fonctionnel",
                hint: "Besoin f _ _ _ _ _ _ _ _ _ _",
                explanation: "Les besoins FONCTIONNELS = apporter vitamines, min√©raux, oligo√©l√©ments pour que les cellules fonctionnent correctement. Sources : fruits, l√©gumes, produits laitiers.",
                keyword: "Besoin fonctionnel = vitamines et min√©raux",
                tip: "Fonctionnel = pour que tout fonctionne bien dans le corps !"
            },
            {
                type: "vf",
                question: "L'organisme a <span class='highlight'>4 types</span> de besoins nutritionnels.",
                answer: false,
                explanation: "FAUX ! L'organisme a 3 types de besoins : √ânerg√©tiques (carburant), Plastiques (construction), Fonctionnels (vitamines/min√©raux). Retiens √â-P-F !",
                keyword: "3 besoins : √ânerg√©tique / Plastique / Fonctionnel",
                tip: "M√©mo : √â comme √ânergie, P comme Plastique, F comme Fonctionnel"
            },
            {
                type: "qcm",
                question: "Un repas √† base de riz et de pain complet couvre principalement quel besoin ?",
                options: [
                    "Besoin plastique (b√¢tisseur)",
                    "Besoin fonctionnel",
                    "Besoin √©nerg√©tique",
                    "Besoin hydrique"
                ],
                answer: 2,
                explanation: "Le riz et le pain = glucides complexes ‚Üí √âNERGIE sur la dur√©e. Ils couvrent les besoins √©nerg√©tiques. C'est le 'carburant lent' du corps.",
                keyword: "F√©culents (riz, pain) ‚Üí besoin √©nerg√©tique",
                tip: "F√©culents = √©nergie durable, comme un r√©servoir d'essence longue dur√©e"
            },
            {
                type: "vf",
                question: "Les besoins plastiques sont couverts principalement par les <span class='highlight'>prot√©ines</span>.",
                answer: true,
                explanation: "VRAI ! Prot√©ines = mat√©riaux de construction. Elles permettent la fabrication et la r√©paration des cellules, des muscles, de la peau. Sources : viande, poisson, ≈ìufs, l√©gumineuses.",
                keyword: "Prot√©ines = besoins plastiques",
                tip: "Apr√®s un effort physique, les muscles se r√©parent gr√¢ce aux prot√©ines"
            },
            {
                type: "qcm",
                question: "Quel aliment couvre principalement un <span class='highlight'>besoin fonctionnel</span> ?",
                options: [
                    "Un bol de p√¢tes",
                    "Un steak de b≈ìuf",
                    "Une orange",
                    "Un croissant"
                ],
                answer: 2,
                explanation: "L'ORANGE = riche en vitamine C (immunit√©), fibres, min√©raux ‚Üí besoin fonctionnel. Les p√¢tes = √©nergie, le steak = plastique, le croissant = √©nergie (mais trop grasse).",
                keyword: "Orange ‚Üí vitamine C ‚Üí besoin fonctionnel",
                tip: "Fruits et l√©gumes color√©s = vitamines = besoins fonctionnels"
            }
        ]
    },

    // ‚îÄ‚îÄ NIVEAU 2 : Facteurs de variation ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    2: {
        title: "Niveau 2 : Facteurs de variation des besoins",
        competence: "C1",
        cards: [
            {
                type: "keyword",
                question: "Combien de <span class='highlight'>facteurs</span> font varier les besoins √©nerg√©tiques ?",
                answer: "4",
                hint: "Entre 3 et 5",
                explanation: "4 FACTEURS de variation : le sexe, l'√¢ge, la grossesse, et l'activit√© physique. Ces 4 √©l√©ments modifient le nombre de calories dont chaque personne a besoin.",
                keyword: "4 facteurs : sexe / √¢ge / grossesse / activit√© physique",
                tip: "M√©mo S-A-G-A : Sexe, √Çge, Grossesse, Activit√©"
            },
            {
                type: "qcm",
                question: "Bastien (homme, 19 ans) a besoin de 2 500 kcal/jour. Lyse (femme, m√™me √¢ge) a besoin de 1 900 kcal/jour. Quel facteur explique cette diff√©rence ?",
                options: [
                    "L'√¢ge",
                    "L'activit√© physique",
                    "Le sexe",
                    "La grossesse"
                ],
                answer: 2,
                explanation: "Le SEXE explique cette diff√©rence : √† √¢ge et activit√© identiques, les hommes ont g√©n√©ralement des besoins plus √©lev√©s car leur masse musculaire est plus importante.",
                keyword: "Sexe ‚Üí diff√©rence besoins √©nerg√©tiques",
                tip: "Les hommes ont + de masse musculaire ‚Üí + de calories br√ªl√©es au repos"
            },
            {
                type: "vf",
                question: "Un adolescent de 15 ans (Steve, 2 600 kcal) a des besoins plus √©lev√©s qu'un adulte de 52 ans (Ga√´tan, 2 350 kcal).",
                answer: true,
                explanation: "VRAI ! L'adolescent est en pleine croissance : son corps fabrique de nouvelles cellules en grande quantit√© ‚Üí besoins plus √©lev√©s. Avec l'√¢ge, le m√©tabolisme ralentit.",
                keyword: "Adolescent > adulte √¢g√© en besoins √©nerg√©tiques",
                tip: "Croissance = construction = √©nergie. Comme b√¢tir une maison !"
            },
            {
                type: "keyword",
                question: "Kamel, manutentionnaire, a besoin de 3 000 kcal/jour. Quel facteur explique ses besoins √©lev√©s ?",
                answer: "activit√© physique",
                hint: "Il soul√®ve des charges et se d√©place beaucoup...",
                explanation: "L'ACTIVIT√â PHYSIQUE est le facteur d√©terminant. Kamel d√©pense beaucoup d'√©nergie en travaillant physiquement. Plus on bouge, plus on br√ªle de calories.",
                keyword: "Travail physique intense ‚Üí besoins √©nerg√©tiques √©lev√©s",
                tip: "Manutentionnaire = 3000 kcal vs administratif = 2500 kcal"
            },
            {
                type: "qcm",
                question: "Sylvie (25 ans, enceinte de 6 mois) a besoin de 2 250 kcal/jour contre 1 900 kcal normalement. Quel facteur explique cela ?",
                options: [
                    "Le sexe",
                    "L'√¢ge",
                    "La grossesse",
                    "L'activit√© physique"
                ],
                answer: 2,
                explanation: "La GROSSESSE augmente les besoins : le corps nourrit deux personnes (la m√®re et le b√©b√©) et fabrique le placenta, le liquide amniotique, les nouveaux tissus du f≈ìtus.",
                keyword: "Grossesse ‚Üí +350 kcal/jour environ",
                tip: "Nourrir 2 personnes = plus de carburant n√©cessaire !"
            },
            {
                type: "vf",
                question: "Un sportif de haut niveau et un comptable du m√™me √¢ge et sexe ont les <span class='highlight'>m√™mes besoins √©nerg√©tiques</span>.",
                answer: false,
                explanation: "FAUX ! L'activit√© physique est un facteur majeur. Un sportif peut avoir des besoins 1,5 √† 2 fois sup√©rieurs √† ceux d'une personne s√©dentaire du m√™me profil.",
                keyword: "Activit√© physique ‚Üí grande diff√©rence de besoins",
                tip: "Un marathon n√©cessite ~2 500 kcal suppl√©mentaires pour 42 km !"
            },
            {
                type: "qcm",
                question: "Parmi ces facteurs, lequel <span class='highlight'>n'influence PAS</span> les besoins √©nerg√©tiques ?",
                options: [
                    "L'√¢ge",
                    "La couleur des yeux",
                    "La grossesse",
                    "L'activit√© physique"
                ],
                answer: 1,
                explanation: "La COULEUR DES YEUX n'influence pas les besoins √©nerg√©tiques. Les 4 vrais facteurs sont : sexe, √¢ge, grossesse, activit√© physique.",
                keyword: "4 vrais facteurs : SAGA (Sexe, √Çge, Grossesse, Activit√©)",
                tip: "Ni la taille, ni la couleur des yeux, ni la nationalit√© !"
            },
            {
                type: "keyword",
                question: "Kamel a besoin de <span class='highlight'>3 000 kcal</span>/jour. Il est manutentionnaire. Bruno, agent administratif, a besoin de 2 500 kcal. Quelle est la diff√©rence en kcal ?",
                answer: "500",
                hint: "3000 - 2500 = ?",
                explanation: "500 kcal de diff√©rence ! C'est l'impact de l'activit√© physique intense. Cette diff√©rence correspond √† environ 2 yaourts + 1 banane + 1 tranche de pain.",
                keyword: "Manutentionnaire - Administratif = 500 kcal d'√©cart",
                tip: "500 kcal = une collation compl√®te en plus par jour"
            }
        ]
    },

    // ‚îÄ‚îÄ NIVEAU 3 : Groupes alimentaires & PNNS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    3: {
        title: "Niveau 3 : Groupes alimentaires & PNNS",
        competence: "C2",
        cards: [
            {
                type: "keyword",
                question: "Combien de <span class='highlight'>groupes alimentaires</span> existent selon le cours ?",
                answer: "7",
                hint: "Plus que 5, moins que 9",
                explanation: "7 GROUPES alimentaires : sucres, mati√®res grasses, viandes/poissons/≈ìufs, laitages, l√©gumes/fruits, c√©r√©ales, boissons. Chaque groupe apporte des nutriments diff√©rents.",
                keyword: "7 groupes alimentaires",
                tip: "7 groupes comme les 7 jours de la semaine ‚Üí un groupe par jour !"
            },
            {
                type: "qcm",
                question: "Quel groupe alimentaire apporte principalement des <span class='highlight'>glucides complexes et des fibres</span> ?",
                options: [
                    "Viandes, poissons, ≈ìufs",
                    "Lait et produits laitiers",
                    "C√©r√©ales et d√©riv√©s (pain, riz, p√¢tes)",
                    "L√©gumes et fruits"
                ],
                answer: 2,
                explanation: "C√âR√âALES ET D√âRIV√âS = glucides complexes + fibres. √ânergie durable et progressive. √Ä privil√©gier en version compl√®te (riz complet, pain complet) pour + de fibres.",
                keyword: "C√©r√©ales ‚Üí glucides complexes + fibres",
                tip: "Pain, p√¢tes, riz = carburant longue dur√©e du corps"
            },
            {
                type: "keyword",
                question: "Que signifie <span class='highlight sigle' title='Programme National Nutrition Sant√©'>PNNS</span> ?",
                answer: "programme national nutrition sant√©",
                hint: "Programme N_ _ _ _ _ _ _ N_ _ _ _ _ _ _ _ S_ _ _ _",
                explanation: "PNNS = Programme National Nutrition Sant√©. C'est un programme de sant√© publique qui donne des recommandations alimentaires pour am√©liorer la sant√© de toute la population.",
                keyword: "PNNS = recommandations nationales pour bien manger",
                tip: "Le PNNS, c'est l'√©tat qui conseille : mangez mieux pour vivre mieux !"
            },
            {
                type: "qcm",
                question: "Quelle fraction de l'assiette les <span class='highlight'>l√©gumes</span> doivent-ils occuper selon la r√®gle de l'assiette ?",
                options: [
                    "¬º de l'assiette",
                    "‚Öì de l'assiette",
                    "¬Ω de l'assiette",
                    "¬æ de l'assiette"
                ],
                answer: 2,
                explanation: "¬Ω L√âGUMES + ¬º f√©culents + ¬º prot√©ines. Les l√©gumes occupent la moiti√© de l'assiette car ils apportent vitamines, min√©raux et fibres essentiels.",
                keyword: "Assiette = ¬Ω l√©gumes + ¬º f√©culents + ¬º prot√©ines",
                tip: "M√©mo : la moiti√© verte, un quart blanc (f√©culent), un quart rose (viande)"
            },
            {
                type: "vf",
                question: "Le <span class='highlight sigle' title='Programme National Nutrition Sant√©'>PNNS</span> recommande de consommer du poisson <span class='highlight'>3 fois</span> par semaine.",
                answer: false,
                explanation: "FAUX ! Le PNNS recommande 2 fois par semaine dont 1 poisson gras (saumon, sardines, maquereau). Le poisson gras est riche en om√©ga-3 bons pour le c≈ìur.",
                keyword: "Poisson = 2√ó/semaine dont 1 poisson gras",
                tip: "2 fois ‚Üí facile √† m√©moriser : lundi poisson maigre, vendredi poisson gras !"
            },
            {
                type: "keyword",
                question: "Selon le PNNS, combien de portions de <span class='highlight'>fruits et l√©gumes</span> par jour minimum ?",
                answer: "5",
                hint: "C'est le slogan connu du PNNS",
                explanation: "5 PORTIONS par jour minimum ! C'est le slogan du PNNS : ¬´ 5 fruits et l√©gumes par jour ¬ª. Ils apportent vitamines, min√©raux, fibres et antioxydants.",
                keyword: "5 fruits et l√©gumes par jour",
                tip: "Slogan PNNS : ¬´ Mangez au moins 5 fruits et l√©gumes par jour ¬ª"
            },
            {
                type: "qcm",
                question: "Selon le PNNS, quelle est la quantit√© maximale de <span class='highlight'>charcuterie</span> conseill√©e par semaine ?",
                options: [
                    "500 g par semaine",
                    "300 g par semaine",
                    "150 g par semaine",
                    "50 g par semaine"
                ],
                answer: 2,
                explanation: "150 g de charcuterie par semaine maximum selon le PNNS. La charcuterie est trop riche en sel et graisses satur√©es. Elle augmente les risques cardiovasculaires.",
                keyword: "Charcuterie : max 150 g/semaine",
                tip: "150 g = environ 3-4 tranches de jambon par semaine"
            },
            {
                type: "vf",
                question: "Le rythme alimentaire conseill√© est de <span class='highlight'>5 repas</span> par jour.",
                answer: false,
                explanation: "FAUX ! Le PNNS recommande 3 √† 4 repas par jour : petit-d√©jeuner, d√©jeuner, go√ªter (optionnel) et d√Æner. Multiplier les prises favorise le grignotage.",
                keyword: "3 √† 4 repas/jour conseill√©s",
                tip: "3-4 vrais repas valent mieux que 5-6 petites prises d√©sorganis√©es"
            },
            {
                type: "qcm",
                question: "Les huiles recommand√©es en priorit√© par le PNNS sont :",
                options: [
                    "Huile de palme et huile d'arachide",
                    "Huile de tournesol et huile de ma√Øs",
                    "Huile d'olive, huile de colza, huile de noix",
                    "Beurre et margarine"
                ],
                answer: 2,
                explanation: "Olive, colza, noix = riches en bons acides gras (om√©ga-3 et om√©ga-9). L'huile de palme est trop riche en graisses satur√©es = mauvais pour le c≈ìur.",
                keyword: "Huiles conseill√©es : olive / colza / noix",
                tip: "Les huiles v√©g√©tales non tropicales = bons pour le c≈ìur !"
            }
        ]
    },

    // ‚îÄ‚îÄ NIVEAU 4 : Erreurs alimentaires & cons√©quences ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    4: {
        title: "Niveau 4 : Erreurs alimentaires & cons√©quences",
        competence: "C2",
        cards: [
            {
                type: "qcm",
                question: "Amina saute son petit-d√©jeuner. Elle ressent un gros coup de fatigue vers 10h. Quelle en est la cause ?",
                options: [
                    "Elle a trop dormi",
                    "Hypoglyc√©mie : chute du taux de sucre dans le sang",
                    "Elle mange trop au d√Æner",
                    "Elle boit trop d'eau le matin"
                ],
                answer: 1,
                explanation: "HYPOGLYC√âMIE = chute de la glyc√©mie (taux de sucre sanguin). Sans petit-d√©jeuner, le corps n'a plus de carburant le matin ‚Üí fatigue, difficult√©s de concentration.",
                keyword: "Sauter le petit-d√©jeuner ‚Üí hypoglyc√©mie vers 10h",
                tip: "Hypoglyc√©mie = hypo (insuffisant) + glyc√©mie (sucre). Le corps est en panne s√®che !"
            },
            {
                type: "vf",
                question: "Grignoter des barres chocolat√©es et des chips entre les repas est une <span class='highlight'>bonne habitude</span> alimentaire.",
                answer: false,
                explanation: "FAUX ! Le grignotage = calories vides + sucres rapides + graisses satur√©es. Cela perturbe le rythme des repas et favorise la prise de poids, le cholest√©rol et le diab√®te.",
                keyword: "Grignotage = mauvaise habitude alimentaire",
                tip: "Barres choco + chips = √©nergie rapide puis chute ‚Üí encore plus fatigu√© !"
            },
            {
                type: "keyword",
                question: "J√©r√¥me consomme trop d'aliments gras. Sa prise de sang r√©v√®le un exc√®s de quoi ?",
                answer: "cholest√©rol",
                hint: "Cho_ _ _ _ _ _ _ _ _",
                explanation: "CHOLEST√âROL en exc√®s = r√©sultat d'une alimentation trop riche en graisses satur√©es (pizza, chips, barres choco). √Ä long terme, risque de maladies cardiovasculaires.",
                keyword: "Trop de graisses satur√©es ‚Üí exc√®s de cholest√©rol",
                tip: "Cholest√©rol LDL ('mauvais') se d√©pose dans les art√®res ‚Üí danger !"
            },
            {
                type: "qcm",
                question: "Katia ne mange jamais de fruits ni de l√©gumes. Elle souffre de :",
                options: [
                    "Diab√®te et hypertension",
                    "Constipation et carence en vitamine C",
                    "Exc√®s de cholest√©rol et surpoids",
                    "An√©mie et fatigue musculaire"
                ],
                answer: 1,
                explanation: "Sans fruits et l√©gumes : pas de FIBRES ‚Üí constipation + pas de VITAMINE C ‚Üí immunit√© affaiblie. Les F&L sont indispensables pour le transit et l'immunit√©.",
                keyword: "Pas de F&L ‚Üí constipation + carence vitamine C",
                tip: "Fibres = tuyauterie. Vitamine C = bouclier immunitaire. Les 2 viennent des F&L !"
            },
            {
                type: "vf",
                question: "David, ouvrier en 3√ó8, a pris 10 kg et souffre d'<span class='highlight sigle' title='Pression art√©rielle trop √©lev√©e'>hypertension</span>.",
                answer: true,
                explanation: "VRAI ! Ses mauvaises habitudes (grignotage, caf√© en exc√®s, aliments gras/sucr√©s la nuit) ont entra√Æn√© une prise de poids et une hypertension art√©rielle confirm√©es par le m√©decin.",
                keyword: "Erreurs alimentaires de David ‚Üí surpoids + hypertension",
                tip: "Hypertension = pression sanguine trop forte. Li√© au sel, aux graisses, au stress."
            },
            {
                type: "qcm",
                question: "Selon le m√©decin (Doc. F), les mauvaises habitudes alimentaires de David risquent d'entra√Æner :",
                options: [
                    "Une carence en vitamine C et de la constipation",
                    "Du diab√®te et des maladies cardiovasculaires",
                    "De l'hypoglyc√©mie et de l'an√©mie",
                    "Une fracture osseuse et de l'arthrite"
                ],
                answer: 1,
                explanation: "Le m√©decin cite le DIAB√àTE (exc√®s de sucre) et les MALADIES CARDIOVASCULAIRES (exc√®s de graisses + hypertension). Ces maladies chroniques sont directement li√©es √† l'alimentation.",
                keyword: "Alimentation d√©s√©quilibr√©e ‚Üí diab√®te + maladies cardiovasculaires",
                tip: "Ces maladies sont √©vitables en grande partie gr√¢ce √† une bonne alimentation !"
            },
            {
                type: "vf",
                question: "Les erreurs alimentaires n'ont des cons√©quences que sur la sant√©, pas sur l'activit√© professionnelle.",
                answer: false,
                explanation: "FAUX ! Fatigue ‚Üí baisse de concentration ‚Üí moins productif. J√©r√¥me travaille de moins en moins vite. Le manque d'√©nergie = risques d'accidents au travail √©galement.",
                keyword: "Erreurs alimentaires ‚Üí impact sur sant√© ET travail",
                tip: "Alimentation d√©s√©quilibr√©e = manque de concentration = danger au travail !"
            },
            {
                type: "keyword",
                question: "David fait <span class='highlight'>6 prises alimentaires</span> par jour. Quel est le nombre conseill√© ?",
                answer: "3 √† 4",
                hint: "Pas plus de 4, pas moins de 3",
                explanation: "3 √Ä 4 repas par jour sont conseill√©s. 6 prises = grignotage permanent + apport calorique trop √©lev√© + perturbation du rythme digestif.",
                keyword: "David : 6 prises ‚Üí id√©al = 3 √† 4 repas/jour",
                tip: "Moins de prises mais de vrais repas √©quilibr√©s = meilleur pour la sant√©"
            }
        ]
    },

    // ‚îÄ‚îÄ NIVEAU 5 : Choix & solutions professionnels ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    5: {
        title: "Niveau 5 : Choix alimentaires & solutions professionnelles",
        competence: "C5",
        cards: [
            {
                type: "qcm",
                question: "Un ma√ßon a <span class='highlight'>30 minutes</span> de pause d√©jeuner. Quel repas est le plus adapt√© ?",
                options: [
                    "Hamburger-frites + soda",
                    "Salade de p√¢tes au poulet + eau",
                    "Sandwich saucisses + bi√®re",
                    "Pizza livr√©e + jus de fruits"
                ],
                answer: 1,
                explanation: "Salade de p√¢tes au poulet + eau = rapide, √©quilibr√© (glucides + prot√©ines), sans alcool. La bi√®re est interdite au travail car elle r√©duit les r√©flexes et augmente le risque d'accidents.",
                keyword: "Ma√ßon 30 min = repas rapide, √©quilibr√©, sans alcool",
                tip: "Alcool au travail = interdit ! P√¢tes + poulet = √©nergie + muscles ‚úì"
            },
            {
                type: "vf",
                question: "L'alcool est tol√©r√© pendant la pause d√©jeuner d'un <span class='highlight'>travailleur sur chantier</span>.",
                answer: false,
                explanation: "FAUX ! L'alcool est formellement d√©conseill√© au travail. Il r√©duit les r√©flexes, la coordination et le jugement. Sur un chantier, c'est un danger grave pour soi et les coll√®gues.",
                keyword: "Alcool au travail = DANGER absolu",
                tip: "Code du travail : l'employeur peut refuser l'acc√®s au chantier √† un salari√© alcoolis√©"
            },
            {
                type: "qcm",
                question: "David travaille de nuit (3√ó8). Que devrait-il manger <span class='highlight'>avant de prendre son poste</span> (20h) ?",
                options: [
                    "Un repas tr√®s copieux et tr√®s gras pour tenir toute la nuit",
                    "Rien, pour ne pas avoir sommeil au travail",
                    "Un repas √©quilibr√© : l√©gumes + f√©culents + prot√©ines maigres",
                    "Des barres √©nerg√©tiques et du caf√© tr√®s fort"
                ],
                answer: 2,
                explanation: "Repas √©quilibr√© AVANT le poste : l√©gumes + f√©culents (√©nergie progressive) + prot√©ines maigres. √âviter le repas trop gras qui provoque somnolence et difficult√©s digestives la nuit.",
                keyword: "Avant poste nuit = repas √©quilibr√©, pas trop lourd",
                tip: "Repas gras + digestion lente + travail de nuit = somnolence dangereuse !"
            },
            {
                type: "vf",
                question: "Les <span class='highlight'>barres chocolat√©es</span> sont id√©ales lors des pauses de nuit pour rester √©veill√©.",
                answer: false,
                explanation: "FAUX ! Sucres rapides = pic d'√©nergie puis chute brutale (hypoglyc√©mie r√©actionnelle) = encore plus de fatigue. Mieux : fruit frais, fruits √† coque, yaourt, eau.",
                keyword: "Barres choco = fausse bonne id√©e pour la nuit",
                tip: "Sucre rapide = sprint d'√©nergie puis mur. Sucre lent = marathon d'√©nergie !"
            },
            {
                type: "keyword",
                question: "Que devrait manger David <span class='highlight'>au retour du travail de nuit</span>, avant de dormir ?",
                answer: "repas l√©ger",
                hint: "L'oppos√© d'un repas copieux...",
                explanation: "REPAS L√âGER au retour : yaourt + fruit + tisane. Un gros repas avant de dormir perturbe le sommeil et la digestion. Le corps doit se reposer, pas dig√©rer intens√©ment.",
                keyword: "Retour nuit ‚Üí repas l√©ger avant de dormir",
                tip: "Lourd repas = sommeil agit√©. L√©ger repas = bonne r√©cup√©ration !"
            },
            {
                type: "qcm",
                question: "Pour couvrir les besoins en <span class='highlight'>besoins plastiques</span> apr√®s un effort physique intense, David devrait consommer :",
                options: [
                    "Chips et barres chocolat√©es",
                    "Pain blanc et confiture",
                    "Poulet grill√©, l√©gumineuses ou poisson",
                    "Soda et jus de fruits sucr√©s"
                ],
                answer: 2,
                explanation: "Poulet, l√©gumineuses, poisson = PROT√âINES ‚Üí besoins plastiques ‚Üí r√©paration musculaire. Apr√®s un effort, les muscles se r√©parent gr√¢ce aux prot√©ines alimentaires.",
                keyword: "Effort physique ‚Üí prot√©ines ‚Üí r√©paration musculaire",
                tip: "Les sportifs mangent des prot√©ines apr√®s l'effort pour exactement cette raison !"
            },
            {
                type: "vf",
                question: "Le travail en horaires d√©cal√©s (3√ó8) peut perturber les habitudes alimentaires et favoriser les erreurs.",
                answer: true,
                explanation: "VRAI ! Le 3√ó8 perturbe l'horloge biologique (rythme circadien). Les repas sont d√©cal√©s, la faim arrive √† des heures inhabituelles ‚Üí grignotage, aliments de mauvaise qualit√©.",
                keyword: "3√ó8 = perturbation du rythme alimentaire",
                tip: "Horloge biologique = rythme naturel du corps. Le 3√ó8 le d√©synchronise !"
            },
            {
                type: "qcm",
                question: "Pour une secr√©taire avec <span class='highlight'>1 heure</span> de pause d√©jeuner, quel repas est le plus adapt√© ?",
                options: [
                    "Hamburger-frites + soda car elle a le temps",
                    "P√¢tes au saumon + yaourt + pomme + eau",
                    "Chips + sandwich jambon-beurre + caf√©",
                    "Pizza livr√©e + glace + caf√©"
                ],
                answer: 1,
                explanation: "P√¢tes + saumon (om√©ga-3) + yaourt (calcium) + pomme (fibres/vitamines) + eau = repas complet et √©quilibr√©. Avec 1h, elle peut prendre un vrai repas qui couvre tous ses besoins.",
                keyword: "Secr√©taire 1h = repas complet √©quilibr√© possible",
                tip: "Plus de temps = plus de qualit√© possible. Pas d'excuse pour manger mal !"
            }
        ]
    }
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FONCTIONS JAVASCRIPT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function showScreen(screenId) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(screenId).classList.add('active');
}

function goHome() {
    showScreen('homeScreen');
}

function startLevel(levelNum) {
    currentLevel = levelNum;
    currentCardIndex = 0;
    levelCorrect = 0;
    levelPoints = 0;
    levelErrors = [];
    hintUsed = false;
    userAnswer = '';
    showScreen('gameScreen');
    loadCard();
}

function loadCard() {
    const levelData = levels[currentLevel];
    const card = levelData.cards[currentCardIndex];
    const total = levelData.cards.length;

    document.getElementById('levelTitle').textContent = levelData.title;
    document.getElementById('cardCounter').textContent = `${currentCardIndex + 1} / ${total}`;
    document.getElementById('progressFill').style.width = `${((currentCardIndex + 1) / total) * 100}%`;
    document.getElementById('questionText').innerHTML = card.question;
    document.getElementById('hintText').style.display = 'none';
    hintUsed = false;
    userAnswer = '';

    // Type badge
    const types = { keyword: 'MOT-CL√â', qcm: 'QCM', vf: 'VRAI / FAUX' };
    document.getElementById('cardType').textContent = types[card.type] || 'QUESTION';

    // Comp√©tence badge
    const compEl = document.getElementById('cardCompetence');
    const comp = levels[currentLevel].competence;
    const compColors = { C1: '#e74c3c', C2: '#3498db', C3: '#2ecc71', C4: '#f39c12', C5: '#9b59b6', C6: '#1abc9c' };
    const bg = compColors[comp] || '#e74c3c';
    compEl.textContent = comp;
    compEl.style.background = bg + '40';
    compEl.style.color = bg;

    // Reset containers
    document.getElementById('keywordContainer').style.display = 'none';
    document.getElementById('optionsContainer').style.display = 'none';
    document.getElementById('vfContainer').style.display = 'none';

    if (card.type === 'keyword') {
        document.getElementById('keywordContainer').style.display = 'flex';
        const input = document.getElementById('keywordInput');
        input.value = '';
        input.disabled = false;
        setTimeout(() => input.focus(), 300);
    } else if (card.type === 'qcm') {
        document.getElementById('optionsContainer').style.display = 'flex';
        buildQCMOptions(card);
    } else if (card.type === 'vf') {
        document.getElementById('vfContainer').style.display = 'flex';
        resetVFButtons();
    }
}

function buildQCMOptions(card) {
    const container = document.getElementById('optionsContainer');
    container.innerHTML = '';
    const letters = ['A', 'B', 'C', 'D'];
    card.options.forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.innerHTML = `<span class="option-letter">${letters[i]}</span>${opt}`;
        btn.onclick = () => selectQCMOption(i, btn);
        container.appendChild(btn);
    });
}

function selectQCMOption(index, btn) {
    document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
    userAnswer = index;
}

function selectVF(value) {
    document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('selected'));
    event.target.closest('.vf-btn').classList.add('selected');
    userAnswer = value;
}

function resetVFButtons() {
    document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('selected'));
}

function showHint() {
    const card = levels[currentLevel].cards[currentCardIndex];
    document.getElementById('hintContent').textContent = card.hint;
    document.getElementById('hintText').style.display = 'block';
    hintUsed = true;
}

function validateAnswer() {
    const card = levels[currentLevel].cards[currentCardIndex];
    let correct = false;

    if (card.type === 'keyword') {
        const input = document.getElementById('keywordInput').value.toLowerCase().trim();
        if (!input) { alert('√âcris ta r√©ponse !'); return; }
        const expected = card.answer.toLowerCase().split('/');
        correct = expected.some(a => input.includes(a.trim()) || a.trim().includes(input));
    } else if (card.type === 'qcm') {
        if (userAnswer === '') { alert('Choisis une r√©ponse !'); return; }
        correct = userAnswer === card.answer;
    } else if (card.type === 'vf') {
        if (userAnswer === '') { alert('Choisis Vrai ou Faux !'); return; }
        correct = userAnswer === card.answer;
    }

    showFeedback(correct, card);
}

function showFeedback(correct, card) {
    const overlay = document.getElementById('feedbackOverlay');
    const feedbackCard = document.getElementById('feedbackCard');

    let points = correct ? 10 : 2;
    if (correct && !hintUsed) points += 5;

    totalPoints += points;
    levelPoints += points;

    if (correct) {
        levelCorrect++;
        currentStreak++;
        if (currentStreak > bestStreak) bestStreak = currentStreak;
        if (currentStreak >= 3) showStreakPopup(currentStreak);
    } else {
        currentStreak = 0;
        levelErrors.push(card.keyword);
    }

    // QCM : colorer les options
    if (card.type === 'qcm') {
        document.querySelectorAll('.option-btn').forEach((btn, i) => {
            if (i === card.answer) btn.classList.add('correct');
            else if (i === userAnswer && !correct) btn.classList.add('incorrect');
        });
    }

    feedbackCard.className = 'feedback-card ' + (correct ? 'correct' : 'incorrect');
    document.getElementById('feedbackIcon').textContent = correct ? '‚úÖ' : '‚ùå';
    document.getElementById('feedbackTitle').textContent = correct ? 'Bravo !' : 'Pas tout √† fait...';
    document.getElementById('feedbackPoints').textContent = `+${points} points`;

    document.getElementById('feedbackExplanation').innerHTML = `
        <h4>üí° ${correct ? 'Explication' : 'Correction'}</h4>
        <p>${card.explanation}</p>
        <div class="keyword-box"><span>${card.keyword}</span></div>
        <div class="tip-box">
            <h5>üí° ASTUCE</h5>
            <p>${card.tip}</p>
        </div>`;

    updateUI();
    overlay.classList.add('visible');
}

function nextCard() {
    document.getElementById('feedbackOverlay').classList.remove('visible');
    currentCardIndex++;
    if (currentCardIndex >= levels[currentLevel].cards.length) {
        finishLevel();
    } else {
        loadCard();
    }
}

function finishLevel() {
    const total = levels[currentLevel].cards.length;
    const percent = Math.round((levelCorrect / total) * 100);
    levelProgress[currentLevel] = percent;

    document.getElementById('resultsIcon').textContent = percent >= 75 ? 'üèÜ' : percent >= 50 ? 'üéØ' : 'üìö';
    document.getElementById('resultsTitle').textContent = percent >= 75 ? 'Excellent !' : percent >= 50 ? 'Bien jou√© !' : '√Ä revoir !';
    document.getElementById('resultsScore').textContent = levelPoints;
    document.getElementById('statCorrect').textContent = levelCorrect;
    document.getElementById('statIncorrect').textContent = total - levelCorrect;
    document.getElementById('statStreak').textContent = bestStreak;

    const errorsRecap = document.getElementById('errorsRecap');
    if (levelErrors.length > 0) {
        document.getElementById('errorsList').innerHTML = levelErrors.map(e => `<li>${e}</li>`).join('');
        errorsRecap.style.display = 'block';
    } else {
        errorsRecap.style.display = 'none';
    }

    const nextLevelBtn = document.getElementById('nextLevelBtn');
    const retryBtn = document.getElementById('retryBtn');
    if (currentLevel < 5 && percent >= 50) {
        nextLevelBtn.style.display = 'block';
        retryBtn.style.display = 'none';
    } else if (percent < 50) {
        nextLevelBtn.style.display = 'none';
        retryBtn.style.display = 'block';
    } else {
        nextLevelBtn.style.display = 'none';
        retryBtn.style.display = 'block';
    }

    updateUI();
    showScreen('resultsScreen');
}

function nextLevel() { if (currentLevel < 5) startLevel(currentLevel + 1); }
function retryLevel() { startLevel(currentLevel); }

function skipCard() {
    if (confirm('Passer cette question ?')) nextCard();
}

function showStreakPopup(streak) {
    const popup = document.getElementById('streakPopup');
    popup.textContent = `üî• ${streak} d'affil√©e !`;
    popup.style.display = 'block';
    setTimeout(() => { popup.style.display = 'none'; }, 2000);
}

function updateUI() {
    document.getElementById('totalPoints').textContent = totalPoints;
    document.getElementById('currentStreak').textContent = currentStreak;

    for (let i = 1; i <= 5; i++) {
        const percent = levelProgress[i];
        const card = document.getElementById(`level${i}Card`);
        const percentEl = document.getElementById(`level${i}Percent`);
        const barEl = document.getElementById(`level${i}Bar`);
        if (card && percentEl && barEl) {
            percentEl.textContent = `${percent}%`;
            barEl.style.width = `${percent}%`;
            if (percent >= 75) {
                card.classList.add('completed');
                card.classList.remove('locked');
            } else {
                card.classList.remove('locked', 'completed');
            }
        }
    }
}

document.addEventListener('DOMContentLoaded', function() {
    updateUI();
    document.getElementById('keywordInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') validateAnswer();
    });
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('sigle')) {
            const def = e.target.getAttribute('title');
            alert(`üí° ${e.target.textContent} : ${def}`);
        }
    });
});
</script>
</body>
</html>
