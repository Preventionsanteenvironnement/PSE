<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission RPS : Bac Pro</title>
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --primary: #bb86fc;
            --secondary: #03dac6;
            --error: #cf6679;
            --text: #ffffff;
            --text-muted: #b0b0b0;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, sans-serif;
            background-color: var(--bg-color);
            color: var(--text);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Container Mobile */
        .app-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Header & Progress */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(30, 30, 30, 0.95);
            padding: 10px 20px;
            z-index: 100;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-bar {
            height: 6px;
            background: #333;
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
            width: 100%;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Cards */
        .card {
            background-color: var(--card-bg);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.5);
            margin-top: 40px; /* Space for header */
            text-align: center;
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1, h2 { margin-bottom: 15px; }
        h2 { color: var(--secondary); font-size: 1.4rem; }
        p { color: var(--text-muted); line-height: 1.5; margin-bottom: 20px; }

        /* Images */
        .img-wrapper {
            background: white;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: inline-block;
        }
        img {
            max-width: 100%;
            max-height: 250px;
            border-radius: 5px;
            object-fit: contain;
        }

        /* Boutons */
        .btn-grid {
            display: grid;
            gap: 12px;
        }

        button {
            background-color: #333;
            color: white;
            border: 2px solid #333;
            padding: 15px;
            border-radius: 12px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            font-weight: 600;
        }

        button:hover, button:active {
            background-color: #444;
            transform: scale(1.02);
        }

        button.selected-correct {
            background-color: rgba(3, 218, 198, 0.2);
            border-color: var(--secondary);
            color: var(--secondary);
        }

        button.selected-wrong {
            background-color: rgba(207, 102, 121, 0.2);
            border-color: var(--error);
            color: var(--error);
        }

        button.primary-action {
            background: var(--primary);
            color: black;
            border: none;
            text-align: center;
            width: 100%;
            margin-top: 20px;
        }

        /* Feedback Zone */
        .feedback-box {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            background: #2c2c2c;
            display: none;
            border-left: 4px solid var(--secondary);
            text-align: left;
        }
        .feedback-box.error { border-left-color: var(--error); }

        /* Screens visibility */
        .screen { display: none; }
        .screen.active { display: block; }

        /* Checklist Auto-eval */
        .checklist-item {
            display: flex;
            align-items: center;
            background: #333;
            margin-bottom: 10px;
            padding: 15px;
            border-radius: 10px;
            text-align: left;
        }
        .checklist-item input {
            transform: scale(1.5);
            margin-right: 15px;
        }

    </style>
</head>
<body>

    <header>
        <div style="font-weight:bold;">Mission RPS</div>
        <div id="score-display">Score: 0</div>
    </header>
    <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>

    <div class="app-container">
        
        <div id="screen-welcome" class="screen active card">
            <h1>üéì Mission : Pr√©vention</h1>
            <p>Bonjour. Vous allez int√©grer l'√©quipe "S√©curit√©" de l'entreprise. <br><br>Votre objectif : Diagnostiquer les Risques Psychosociaux (RPS) et proposer des solutions.</p>
            <div class="img-wrapper">
                <img src="imagesrps/risquepsychosociaux.jpg" alt="Intro">
            </div>
            <p>20 questions pour valider votre module C3.</p>
            <button class="primary-action" onclick="startQuiz()">Commencer la mission</button>
        </div>

        <div id="screen-quiz" class="screen card">
            <h2 id="q-category">Cat√©gorie</h2>
            <div id="q-image-container" class="img-wrapper" style="display:none;">
                <img id="q-image" src="" alt="Situation">
            </div>
            <p id="q-text">La question va ici...</p>
            
            <div id="options-container" class="btn-grid">
                </div>

            <div id="feedback" class="feedback-box">
                <strong id="feedback-title"></strong>
                <p id="feedback-text" style="margin:5px 0 0 0; color:white; font-size:0.9rem;"></p>
                <button class="primary-action" onclick="nextQuestion()">Continuer ‚ûî</button>
            </div>
        </div>

        <div id="screen-autoeval" class="screen card">
            <h2>üìù Auto-√©valuation</h2>
            <p>Avant de voir votre score final, cochez les comp√©tences que vous pensez ma√Ætriser :</p>
            <div class="checklist-item">
                <input type="checkbox"> <span>Je sais d√©finir le Stress et les Violences.</span>
            </div>
            <div class="checklist-item">
                <input type="checkbox"> <span>Je connais les 6 facteurs de risques (Gollac).</span>
            </div>
            <div class="checklist-item">
                <input type="checkbox"> <span>Je distingue Burn-out et Bore-out.</span>
            </div>
            <div class="checklist-item">
                <input type="checkbox"> <span>Je connais les obligations de l'employeur.</span>
            </div>
            <button class="primary-action" onclick="showResults()">Voir mon bilan</button>
        </div>

        <div id="screen-result" class="screen card">
            <h1>Mission Termin√©e !</h1>
            <div id="final-score-circle" style="font-size:3rem; font-weight:bold; color:var(--secondary); margin:20px 0;"></div>
            <p id="final-msg">Analyse en cours...</p>
            <button class="primary-action" onclick="location.reload()">Recommencer la mission ‚Ü∫</button>
        </div>

    </div>

<script>
    // --- DONN√âES DU QUIZ ---
    // CORRECTION ICI : Toutes les images ont maintenant le pr√©fixe "imagesrps/"
    const quizData = [
        // PHASE 1 : DIAGNOSTIC (3 questions)
        {
            category: "1. Diagnostic",
            text: "C'est quoi exactement un 'RPS' ?",
            options: ["Un risque li√© uniquement aux machines", "Un risque pour la sant√© mentale et physique li√© au travail", "Un conflit personnel sans lien avec le travail"],
            correct: 1,
            feedback: "Exact ! Les Risques Psychosociaux touchent √† la fois le mental et le physique et sont caus√©s par l'organisation du travail."
        },
        {
            category: "1. Diagnostic",
            text: "Qui est responsable l√©galement de la sant√© des salari√©s ?",
            options: ["Le salari√© lui-m√™me", "L'employeur (Obligation de s√©curit√©)", "La m√©decine du travail uniquement"],
            correct: 1,
            feedback: "C'est l'employeur ! Selon le Code du travail, il a une obligation de r√©sultat concernant la s√©curit√©."
        },
        {
            category: "1. Diagnostic",
            text: "Les RPS co√ªtent de l'argent √† l'entreprise. Vrai ou Faux ?",
            options: ["Vrai", "Faux"],
            correct: 0,
            feedback: "Vrai. Absent√©isme, baisse de productivit√© et turnover co√ªtent tr√®s cher."
        },

        // PHASE 2 : L'ACAD√âMIE (Vocabulaire - 5 questions)
        {
            category: "2. Vocabulaire",
            text: "Analysez cette image. De quoi souffre ce salari√© ?",
            image: "imagesrps/Stress.jpg",
            options: ["De harc√®lement", "De stress (Surcharge)", "De violence externe"],
            correct: 1,
            feedback: "C'est le Stress : un d√©s√©quilibre entre ce qu'on lui demande (la pile de dossiers) et ses ressources."
        },
        {
            category: "2. Vocabulaire",
            text: "Quelle est la diff√©rence entre ces deux situations ?",
            image: "imagesrps/boreout.jpg",
            options: ["L'image montre un Burn-out (Surcharge)", "L'image montre un Bore-out (Ennui)", "C'est la m√™me chose"],
            correct: 1,
            feedback: "C'est un BORE-out. L'√©puisement par l'ennui et le manque de t√¢ches, contraire du Burn-out."
        },
        {
            category: "2. Vocabulaire",
            text: "Cette sc√®ne se passe dans l'ascenseur entre coll√®gues. Quel est ce type de risque ?",
            image: "imagesrps/violenceinterne.jpg",
            options: ["Violence Interne", "Violence Externe", "Stress"],
            correct: 0,
            feedback: "Violence Interne : Harc√®lement ou conflit qui se passe √Ä L'INT√âRIEUR de l'√©quipe."
        },
        {
            category: "2. Vocabulaire",
            text: "Un client insulte un ouvrier sur un chantier. C'est...",
            image: "imagesrps/violenceexterne.jpg",
            options: ["Une incivilit√© interne", "Une violence externe", "Un conflit de valeur"],
            correct: 1,
            feedback: "Violence Externe : L'agresseur (client, usager) est ext√©rieur √† l'entreprise."
        },
        {
            category: "2. Vocabulaire",
            text: "Le Harc√®lement sexuel est d√©fini comme...",
            options: ["Des propos ou comportements √† connotation sexuelle r√©p√©t√©s", "Une simple blague lourde une fois", "Une critique sur le travail"],
            correct: 0,
            feedback: "Oui. Depuis la loi du 2 ao√ªt 2021, la d√©finition a √©t√© renforc√©e."
        },

        // PHASE 3 : ENQU√äTE TERRAIN (Les 6 Facteurs - 6 questions)
        {
            category: "3. Les Facteurs (Causes)",
            text: "Regardez cette image. Quel est le facteur de risque ?",
            image: "imagesrps/manquedautonomie.jpg",
            options: ["Intensit√© du travail", "Manque d'autonomie", "Ins√©curit√© de l'emploi"],
            correct: 1,
            feedback: "Manque d'autonomie. Le salari√© est 'cadenass√©', il ne peut pas prendre de d√©cisions sur son travail."
        },
        {
            category: "3. Les Facteurs (Causes)",
            text: "Devoir cacher sa tristesse ou sourire forc√© face √† un client, c'est...",
            image: "imagesrps/Exigencesemotionnelles.jpg",
            options: ["Des exigences √©motionnelles", "Des rapports sociaux d√©grad√©s", "De la violence physique"],
            correct: 0,
            feedback: "Exigences √©motionnelles. Il faut ma√Ætriser ses √©motions pour le travail, ce qui est √©puisant."
        },
        {
            category: "3. Les Facteurs (Causes)",
            text: "Avoir peur de perdre son emploi ou ne pas savoir si son contrat sera renouvel√©.",
            image: "imagesrps/Insecuritedelasituationdetravail.jpg",
            options: ["Conflit de valeurs", "Ins√©curit√© de la situation de travail", "Intensit√© du travail"],
            correct: 1,
            feedback: "Ins√©curit√© de la situation de travail. La pr√©carit√© est un gros facteur de stress."
        },
        {
            category: "3. Les Facteurs (Causes)",
            text: "Travailler dans le bruit, √™tre interrompu tout le temps, devoir aller trop vite.",
            image: "imagesrps/Intensiteetempsde travail.jpg",
            options: ["Rapports sociaux d√©grad√©s", "Intensit√© et temps de travail", "Manque d'autonomie"],
            correct: 1,
            feedback: "Intensit√© et temps de travail. C'est la pression du rythme et des conditions difficiles."
        },
        {
            category: "3. Les Facteurs (Causes)",
            text: "Devoir vendre un produit qu'on sait √™tre une arnaque. √áa heurte ma conscience.",
            image: "imagesrps/conflitsdevaleurs.jpg",
            options: ["Conflits de valeurs", "Exigences √©motionnelles", "Violence interne"],
            correct: 0,
            feedback: "Conflit de valeurs (ou conflit √©thique). On me demande de faire quelque chose que je d√©sapprouve."
        },
        {
            category: "3. Les Facteurs (Causes)",
            text: "Mon chef ne me dit jamais bonjour et me critique devant tout le monde.",
            image: "imagesrps/Rapportssociauxautravaildegrades.jpg",
            options: ["Rapports sociaux d√©grad√©s", "Ins√©curit√© de l'emploi", "Intensit√© du travail"],
            correct: 0,
            feedback: "Rapports sociaux d√©grad√©s. Le manque de soutien et la mauvaise ambiance sont toxiques."
        },

        // PHASE 4 : CONS√âQUENCES & PR√âVENTION (6 questions)
        {
            category: "4. Cons√©quences & Solutions",
            text: "Quelle image repr√©sente une cons√©quence PHYSIQUE (sur le corps) ?",
            image: "imagesrps/integritephysique.jpg",
            options: ["Le mal de dos (TMS)", "La d√©pression", "L'absent√©isme"],
            correct: 0,
            feedback: "Correct. Les Troubles Musculo-Squelettiques (TMS) sont des atteintes physiques li√©es au stress et aux postures."
        },
        {
            category: "4. Cons√©quences & Solutions",
            text: "Quelle image repr√©sente une atteinte √† la sant√© MENTALE ?",
            image: "imagesrps/integritementale.jpg",
            options: ["Maladie cardio-vasculaire", "D√©pression / Anxi√©t√©", "Accident du travail"],
            correct: 1,
            feedback: "D√©pression et anxi√©t√© sont des atteintes √† l'int√©grit√© mentale (psychique)."
        },
        {
            category: "4. Cons√©quences & Solutions",
            text: "Si les salari√©s sont malades, l'entreprise en souffre aussi. Comment ?",
            image: "imagesrps/consequence_entreprise.jpg",
            options: ["Elle ne souffre pas", "Augmentation de l'absent√©isme et baisse de qualit√©", "Baisse des imp√¥ts"],
            correct: 1,
            feedback: "C'est un co√ªt √©norme pour l'entreprise : absent√©isme, turnover, mauvaise image."
        },
        {
            category: "4. Cons√©quences & Solutions",
            text: "Situation : Trop de bruit dans l'open-space. Quelle est la MEILLEURE pr√©vention ?",
            options: ["Donner des boules quies (Protection individuelle)", "Installer des cloisons anti-bruit (Pr√©vention collective)", "Dire aux gens de chuchoter (Information)"],
            correct: 1,
            feedback: "Toujours privil√©gier la pr√©vention COLLECTIVE (modifier l'environnement) avant l'individuelle."
        },
        {
            category: "4. Cons√©quences & Solutions",
            text: "Le Document Unique (DUERP) sert √†...",
            image: "imagesrps/Lecadre_reglementaire.jpg",
            options: ["Licencier les gens stress√©s", "Lister et √©valuer les risques dans l'entreprise", "Donner des amendes"],
            correct: 1,
            feedback: "C'est obligatoire. L'employeur y liste tous les risques identifi√©s et les solutions pr√©vues."
        },
        {
            category: "4. Cons√©quences & Solutions",
            text: "Derni√®re question ! Qui peut aider un salari√© en souffrance ?",
            options: ["Le m√©decin du travail", "Les repr√©sentants du personnel (CSE)", "Les deux"],
            correct: 2,
            feedback: "Les deux ! On peut aussi contacter l'inspection du travail ou des psychologues."
        }
    ];

    // --- LOGIQUE JS ---
    let currentQuestionIndex = 0;
    let score = 0;
    let userResponses = [];

    function startQuiz() {
        showScreen('screen-quiz');
        loadQuestion();
    }

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function loadQuestion() {
        const q = quizData[currentQuestionIndex];
        
        // Mise √† jour UI
        document.getElementById('q-category').innerText = q.category;
        document.getElementById('q-text').innerText = q.text;
        
        // Image ?
        const imgContainer = document.getElementById('q-image-container');
        const img = document.getElementById('q-image');
        if(q.image) {
            imgContainer.style.display = 'inline-block';
            img.src = q.image;
        } else {
            imgContainer.style.display = 'none';
        }

        // Options
        const optionsDiv = document.getElementById('options-container');
        optionsDiv.innerHTML = '';
        q.options.forEach((opt, index) => {
            const btn = document.createElement('button');
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(index, btn);
            optionsDiv.appendChild(btn);
        });

        // Reset Feedback
        document.getElementById('feedback').style.display = 'none';
        
        // Progress Bar
        const pct = (currentQuestionIndex / quizData.length) * 100;
        document.getElementById('progress').style.width = pct + '%';
    }

    function checkAnswer(selectedIndex, btnElement) {
        // D√©sactiver tous les boutons
        const buttons = document.querySelectorAll('#options-container button');
        buttons.forEach(b => b.disabled = true);

        const q = quizData[currentQuestionIndex];
        const isCorrect = (selectedIndex === q.correct);
        
        if(isCorrect) {
            btnElement.classList.add('selected-correct');
            document.getElementById('feedback').classList.remove('error');
            document.getElementById('feedback-title').innerText = "‚úÖ Excellent !";
            score++;
        } else {
            btnElement.classList.add('selected-wrong');
            // Montrer la bonne r√©ponse
            buttons[q.correct].classList.add('selected-correct');
            document.getElementById('feedback').classList.add('error');
            document.getElementById('feedback-title').innerText = "‚ùå A√Øe...";
        }

        document.getElementById('feedback-text').innerText = q.feedback;
        document.getElementById('feedback').style.display = 'block';
        document.getElementById('score-display').innerText = `Score: ${score}`;
    }

    function nextQuestion() {
        currentQuestionIndex++;
        if(currentQuestionIndex < quizData.length) {
            loadQuestion();
        } else {
            showScreen('screen-autoeval');
            document.getElementById('progress').style.width = '100%';
        }
    }

    function showResults() {
        showScreen('screen-result');
        const finalScore = document.getElementById('final-score-circle');
        const msg = document.getElementById('final-msg');
        
        finalScore.innerText = `${score} / ${quizData.length}`;
        
        if(score >= 15) {
            msg.innerHTML = "üåü <strong>Expert en Pr√©vention !</strong><br>Vous ma√Ætrisez parfaitement le module C3. Pr√™t pour l'examen.";
        } else if (score >= 10) {
            msg.innerHTML = "üëç <strong>Bon travail.</strong><br>Les bases sont l√†, mais relisez les d√©finitions des facteurs de risques.";
        } else {
            msg.innerHTML = "‚ö†Ô∏è <strong>Attention.</strong><br>Il faut revoir les fiches, notamment les 6 facteurs de Gollac.";
        }
    }
</script>

</body>
</html>