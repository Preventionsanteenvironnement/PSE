<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPS S1.2 - Empathie</title>
    <style>
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f4f8;
            color: #1e293b;
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 40px;
        }

        .container {
            max-width: 520px;
            margin: 0 auto;
            padding: 16px;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            color: #7c3aed;
            text-decoration: none;
            font-size: 0.95rem;
            font-weight: 500;
            margin-bottom: 12px;
            transition: color 0.2s;
        }

        .back-btn:hover { color: #5b21b6; }

        .header-card {
            background: linear-gradient(135deg, #6d28d9, #7c3aed);
            border-radius: 15px;
            padding: 28px 24px;
            color: white;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.3);
        }

        .header-card .emoji { font-size: 2.2rem; margin-bottom: 8px; }
        .header-card h1 { font-size: 1.6rem; margin-bottom: 8px; font-weight: 700; }
        .header-card p { font-size: 0.92rem; opacity: 0.92; line-height: 1.5; }

        .card {
            background: white;
            border-radius: 15px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            animation: fadeIn 0.4s ease;
        }

        .card-title {
            font-size: 1.15rem;
            font-weight: 700;
            color: #6d28d9;
            margin-bottom: 16px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section { display: none; }
        .section.active { display: block; }

        /* INTRO */
        .empathy-type {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px 14px;
            background: #f5f3ff;
            border-radius: 12px;
            margin-bottom: 10px;
            font-size: 0.88rem;
            line-height: 1.5;
        }

        .empathy-type .type-icon {
            font-size: 1.4rem;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .empathy-type strong { color: #5b21b6; display: block; margin-bottom: 2px; }
        .empathy-type span { color: #475569; }

        .intro-note {
            font-size: 0.88rem;
            color: #475569;
            background: #faf5ff;
            border-left: 3px solid #7c3aed;
            padding: 12px 14px;
            border-radius: 0 10px 10px 0;
            margin: 16px 0;
            line-height: 1.55;
        }

        .btn-primary {
            display: block;
            width: 100%;
            background: linear-gradient(135deg, #6d28d9, #7c3aed);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 15px 24px;
            font-size: 1.05rem;
            font-weight: 700;
            cursor: pointer;
            font-family: inherit;
            margin-top: 8px;
            transition: transform 0.15s, box-shadow 0.15s;
            box-shadow: 0 3px 12px rgba(124, 58, 237, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 18px rgba(124, 58, 237, 0.35);
        }

        /* PROGRESS */
        .progress-bar {
            height: 6px;
            background: #e2e8f0;
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 6px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6d28d9, #7c3aed);
            border-radius: 20px;
            transition: width 0.4s ease;
        }

        .progress-text {
            font-size: 0.8rem;
            color: #94a3b8;
            text-align: right;
            margin-bottom: 16px;
        }

        /* SCENARIO */
        .scenario-card {
            background: #f5f3ff;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 14px;
        }

        .scenario-emoji {
            font-size: 1.5rem;
            margin-bottom: 6px;
        }

        .scenario-text {
            font-size: 0.92rem;
            color: #374151;
            line-height: 1.55;
            font-style: italic;
        }

        .scenario-prompt {
            font-size: 0.95rem;
            font-weight: 700;
            color: #6d28d9;
            margin-bottom: 12px;
        }

        .option-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 14px 16px;
            margin-bottom: 8px;
            cursor: pointer;
            font-size: 0.88rem;
            line-height: 1.5;
            color: #374151;
            transition: all 0.2s;
            animation: fadeIn 0.3s ease;
        }

        .option-card:hover { border-color: #7c3aed; background: #faf5ff; }
        .option-card.disabled { pointer-events: none; opacity: 0.6; }
        .option-card.selected-correct { border-color: #22c55e; background: #dcfce7; opacity: 1; }
        .option-card.selected-partial { border-color: #f59e0b; background: #fef3c7; opacity: 1; }
        .option-card.selected-wrong { border-color: #ef4444; background: #fee2e2; opacity: 1; }
        .option-card.reveal-correct { border-color: #22c55e; background: #dcfce7; opacity: 1; }

        .feedback-card {
            border-radius: 12px;
            padding: 14px 16px;
            margin: 12px 0;
            font-size: 0.86rem;
            line-height: 1.55;
            animation: fadeIn 0.3s ease;
        }

        .feedback-card.correct { background: #dcfce7; border: 2px solid #86efac; color: #166534; }
        .feedback-card.partial { background: #fef3c7; border: 2px solid #fcd34d; color: #92400e; }
        .feedback-card.wrong { background: #fee2e2; border: 2px solid #fca5a5; color: #991b1b; }

        .feedback-points {
            font-weight: 700;
            font-size: 0.82rem;
            margin-bottom: 4px;
        }

        .btn-next {
            display: block;
            width: 100%;
            background: #7c3aed;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px;
            font-size: 0.92rem;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
            transition: background 0.2s;
        }

        .btn-next:hover { background: #6d28d9; }

        /* REFORMULATION */
        .statement-card {
            background: #f5f3ff;
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 14px;
            font-style: italic;
            font-size: 0.95rem;
            color: #4c1d95;
            line-height: 1.55;
        }

        .statement-icon {
            font-size: 1.3rem;
            font-style: normal;
            display: block;
            margin-bottom: 6px;
        }

        .reform-prompt {
            font-weight: 700;
            color: #6d28d9;
            font-size: 0.92rem;
            margin-bottom: 12px;
        }

        /* BILAN */
        .score-display { text-align: center; padding: 20px; }
        .score-number { font-size: 3rem; font-weight: 800; color: #7c3aed; line-height: 1.1; }
        .score-total { font-size: 1.1rem; color: #94a3b8; font-weight: 500; }
        .score-message { margin-top: 14px; font-size: 1.1rem; font-weight: 600; color: #1e293b; line-height: 1.45; }

        .synthesis-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 12px 14px;
            background: #f5f3ff;
            border-radius: 10px;
            margin-bottom: 8px;
            font-size: 0.88rem;
            color: #4c1d95;
            line-height: 1.5;
        }

        .synthesis-icon { font-size: 1.2rem; flex-shrink: 0; }
    </style>
</head>
<body>

<div class="container">
    <a href="index.html" class="back-btn">‚Üê Retour</a>

    <div class="header-card">
        <div class="emoji">üëü</div>
        <h1>Dans les baskets de l'autre</h1>
        <p>Comprendre ce que les autres ressentent et pensent</p>
    </div>

    <!-- SECTION 1 : INTRO -->
    <div id="section-intro" class="section active">
        <div class="card">
            <div class="card-title">Les 3 formes d'empathie</div>

            <div class="empathy-type">
                <span class="type-icon">üß†</span>
                <div>
                    <strong>Empathie cognitive</strong>
                    <span>Comprendre ce que l'autre pense ou voit (se mettre √† sa place mentalement).</span>
                </div>
            </div>

            <div class="empathy-type">
                <span class="type-icon">üíú</span>
                <div>
                    <strong>Empathie affective</strong>
                    <span>Ressentir ce que l'autre ressent (partager son √©motion).</span>
                </div>
            </div>

            <div class="empathy-type">
                <span class="type-icon">ü§≤</span>
                <div>
                    <strong>Pr√©occupation empathique</strong>
                    <span>Avoir envie d'aider ou de soutenir l'autre.</span>
                </div>
            </div>

            <div class="intro-note">
                L'empathie, ce n'est pas √™tre d'accord avec l'autre. C'est prendre le temps de comprendre son point de vue et ce qu'il ressent.
            </div>

            <button class="btn-primary" onclick="startScenarios()">üéØ C'est parti !</button>
        </div>
    </div>

    <!-- SECTION 2 : SCENARIOS -->
    <div id="section-scenarios" class="section">
        <div class="card">
            <div class="card-title">Mises en situation</div>
            <div class="progress-bar"><div class="progress-fill" id="sc-progress"></div></div>
            <div class="progress-text" id="sc-progress-text"></div>
            <div id="sc-container"></div>
        </div>
    </div>

    <!-- SECTION 3 : REFORMULATION -->
    <div id="section-reform" class="section">
        <div class="card">
            <div class="card-title">Reformulation empathique</div>
            <p style="font-size:0.88rem; color:#64748b; margin-bottom:16px; line-height:1.5;">
                L'√©coute empathique, c'est aussi savoir reformuler ce que l'autre dit pour lui montrer qu'on a compris.
            </p>
            <div class="progress-bar"><div class="progress-fill" id="rf-progress"></div></div>
            <div class="progress-text" id="rf-progress-text"></div>
            <div id="rf-container"></div>
        </div>
    </div>

    <!-- SECTION 4 : BILAN -->
    <div id="section-bilan" class="section">
        <div class="card">
            <div class="score-display">
                <div class="score-number" id="final-score">0</div>
                <div class="score-total">/ 16</div>
                <div class="score-message" id="score-message"></div>
            </div>
        </div>

        <div class="card">
            <div class="card-title">Ce qu'il faut retenir</div>
            <div class="synthesis-item">
                <span class="synthesis-icon">üß†</span>
                <span>L'empathie cognitive, c'est comprendre le point de vue de l'autre.</span>
            </div>
            <div class="synthesis-item">
                <span class="synthesis-icon">üíú</span>
                <span>L'empathie affective, c'est ressentir ce que l'autre ressent.</span>
            </div>
            <div class="synthesis-item">
                <span class="synthesis-icon">ü§≤</span>
                <span>La pr√©occupation empathique, c'est vouloir aider et soutenir.</span>
            </div>

            <button class="btn-primary" onclick="resetAll()" style="margin-top:16px;">üîÑ Refaire l'exercice</button>
        </div>
    </div>
</div>

<footer style="text-align:center; padding:20px 16px; color:#94a3b8; font-size:0.78rem;">
    Comp√©tences psychosociales ‚Äî R√©f√©rentiel Sant√© publique France 2025
</footer>

<script>
    /* ========== DATA ========== */
    var scenarios = [
        {
            emoji: "üìù",
            text: "En classe, un camarade vient de recevoir sa copie. Il la retourne imm√©diatement, le visage ferm√©.",
            options: [
                { type: "non", label: "Tu lui dis : ¬´ C'est pas grave, c'est juste une note ! ¬ª", feedback: "Minimiser ce que l'autre ressent, m√™me avec de bonnes intentions, ne l'aide pas √† se sentir compris.", points: 0 },
                { type: "partiel", label: "Tu lui fais un petit signe discret pour montrer que tu as remarqu√©.", feedback: "C'est un premier pas. Tu as remarqu√© son √©tat, mais il n'y a pas encore d'√©change.", points: 1 },
                { type: "empathique", label: "Tu t'approches calmement et tu lui dis : ¬´ √áa a l'air dur. Tu veux qu'on en parle apr√®s le cours ? ¬ª", feedback: "Tu montres que tu per√ßois son √©motion (empathie affective), que tu comprends la situation (empathie cognitive) et que tu proposes ton aide (pr√©occupation empathique).", points: 2 }
            ]
        },
        {
            emoji: "üÜï",
            text: "Un nouvel √©l√®ve arrive dans la classe en milieu d'ann√©e. √Ä la pause, il reste seul dans un coin.",
            options: [
                { type: "non", label: "Tu ne fais rien, il finira par s'int√©grer tout seul.", feedback: "Ignorer la situation ne montre pas d'empathie. √ätre nouveau peut √™tre tr√®s inconfortable.", points: 0 },
                { type: "partiel", label: "Tu lui souris en passant.", feedback: "C'est un geste bienveillant, mais qui reste √† distance. L'√©l√®ve se sent peut-√™tre toujours isol√©.", points: 1 },
                { type: "empathique", label: "Tu vas le voir et tu lui proposes de venir avec ton groupe : ¬´ Salut, viens avec nous si tu veux ! ¬ª", feedback: "Tu te mets √† sa place (empathie cognitive), tu per√ßois son malaise (empathie affective) et tu agis pour l'aider (pr√©occupation empathique).", points: 2 }
            ]
        },
        {
            emoji: "üèÉ",
            text: "Un camarade arrive en cours d'EPS en ayant oubli√© ses affaires de sport. Il a l'air stress√© car le professeur est strict.",
            options: [
                { type: "non", label: "Tu lui dis : ¬´ T'avais qu'√† v√©rifier ton sac hier soir. ¬ª", feedback: "Faire la morale √† quelqu'un qui est d√©j√† stress√© ne l'aide pas. C'est un jugement, pas de l'empathie.", points: 0 },
                { type: "partiel", label: "Tu penses ¬´ Pas de chance pour lui ¬ª mais tu ne dis rien.", feedback: "Tu as reconnu sa situation int√©rieurement, mais sans le montrer, l'autre ne se sent pas soutenu.", points: 1 },
                { type: "empathique", label: "Tu lui proposes discr√®tement : ¬´ J'ai un t-shirt en plus dans mon sac, √ßa peut d√©panner. ¬ª", feedback: "Tu comprends sa situation (empathie cognitive), tu per√ßois son stress (empathie affective) et tu proposes une solution concr√®te (pr√©occupation empathique).", points: 2 }
            ]
        },
        {
            emoji: "üë•",
            text: "Pendant un travail de groupe, un √©l√®ve ne participe pas. Il regarde par la fen√™tre, l'air absent.",
            options: [
                { type: "non", label: "Tu lui dis : ¬´ Eh, tu pourrais participer quand m√™me, on fait tout le boulot ! ¬ª", feedback: "Reprocher directement peut braquer l'autre. On ne sait pas ce qu'il traverse.", points: 0 },
                { type: "partiel", label: "Tu continues le travail sans rien dire, en te disant qu'il a peut-√™tre ses raisons.", feedback: "Tu √©vites le conflit et tu lui laisses de l'espace, mais sans chercher √† comprendre ce qui se passe.", points: 1 },
                { type: "empathique", label: "Tu lui demandes discr√®tement : ¬´ √áa va ? T'as l'air ailleurs. Tu veux qu'on t'explique o√π on en est ? ¬ª", feedback: "Tu remarques son √©tat sans juger (empathie affective), tu cherches √† comprendre (empathie cognitive) et tu lui proposes de l'aide (pr√©occupation empathique).", points: 2 }
            ]
        },
        {
            emoji: "üé§",
            text: "Pendant un expos√©, la voix d'une camarade commence √† trembler. Elle perd le fil de ses phrases.",
            options: [
                { type: "non", label: "Tu chuchotes √† ton voisin : ¬´ Elle a pas du tout pr√©par√©... ¬ª", feedback: "Juger et commenter aggravent la situation. Le stress de parler en public est tr√®s courant.", points: 0 },
                { type: "partiel", label: "Tu restes attentif et silencieux pour ne pas rajouter de pression.", feedback: "C'est un bon r√©flexe. Tu ne juges pas, mais tu pourrais aussi montrer un signe de soutien.", points: 1 },
                { type: "empathique", label: "Tu la regardes avec un air encourageant et tu hoches la t√™te pour la soutenir.", feedback: "Par ton attitude bienveillante, tu montres que tu comprends sa difficult√© (empathie cognitive), que tu partages un peu de son stress (empathie affective) et que tu l'encourages (pr√©occupation empathique).", points: 2 }
            ]
        },
        {
            emoji: "üò§",
            text: "Apr√®s la r√©cr√©ation, un camarade entre en classe visiblement √©nerv√©. Il claque son sac sur la table.",
            options: [
                { type: "non", label: "Tu lui dis : ¬´ Calme-toi, c'est pas la peine de casser ton sac. ¬ª", feedback: "Dire ¬´ calme-toi ¬ª √† quelqu'un d'√©nerv√© a souvent l'effet inverse. √áa invalide ce qu'il ressent.", points: 0 },
                { type: "partiel", label: "Tu le laisses tranquille en attendant que √ßa passe.", feedback: "Respecter son espace est bien, mais il pourrait aussi avoir besoin de sentir qu'on le comprend.", points: 1 },
                { type: "empathique", label: "Tu lui laisses un moment, puis tu lui dis simplement : ¬´ T'as l'air vraiment √©nerv√©. Il s'est pass√© quelque chose ? ¬ª", feedback: "Tu nommes son √©motion (empathie affective), tu cherches √† comprendre ce qui s'est pass√© (empathie cognitive) et tu montres que tu es disponible (pr√©occupation empathique).", points: 2 }
            ]
        }
    ];

    var reformulations = [
        {
            statement: "J'ai r√©vis√© toute la soir√©e et j'ai quand m√™me eu une mauvaise note...",
            options: [
                { text: "Tu as l'impression que tes efforts n'ont pas pay√©, c'est frustrant.", correct: true },
                { text: "T'inqui√®te, la prochaine fois √ßa ira mieux !", correct: false },
                { text: "Tu aurais peut-√™tre d√ª r√©viser autrement.", correct: false }
            ]
        },
        {
            statement: "Tout le monde a √©t√© choisi pour l'activit√© sauf moi...",
            options: [
                { text: "Tu te sens mis de c√¥t√© et √ßa te fait de la peine.", correct: true },
                { text: "Bah c'est pas si grave, il y aura d'autres activit√©s.", correct: false },
                { text: "T'as demand√© pourquoi ? Peut-√™tre que tu peux encore t'inscrire.", correct: false }
            ]
        },
        {
            statement: "Mon expos√© est demain et j'ai peur de parler devant tout le monde.",
            options: [
                { text: "Tu appr√©hendes le moment parce que c'est important pour toi.", correct: true },
                { text: "Mais non, y'a pas de raison d'avoir peur !", correct: false },
                { text: "Imagine les gens en sous-v√™tements, √ßa aide.", correct: false }
            ]
        },
        {
            statement: "Je comprends rien √† cet exercice, j'en ai marre...",
            options: [
                { text: "√áa a l'air vraiment bloquant, tu te sens d√©courag√©.", correct: true },
                { text: "Mais si, c'est facile, regarde...", correct: false },
                { text: "Demande au prof, c'est son travail.", correct: false }
            ]
        }
    ];

    /* ========== STATE ========== */
    var shuffledSc = [];
    var currentSc = 0;
    var scScore = 0;

    var shuffledRf = [];
    var currentRf = 0;
    var rfScore = 0;

    /* ========== UTILITIES ========== */
    function shuffle(arr) {
        var a = arr.slice();
        for (var i = a.length - 1; i > 0; i--) {
            var j = Math.floor(Math.random() * (i + 1));
            var tmp = a[i]; a[i] = a[j]; a[j] = tmp;
        }
        return a;
    }

    function showSection(id) {
        var sections = document.querySelectorAll('.section');
        for (var i = 0; i < sections.length; i++) sections[i].classList.remove('active');
        document.getElementById(id).classList.add('active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function esc(str) {
        var d = document.createElement('div');
        d.appendChild(document.createTextNode(str));
        return d.innerHTML;
    }

    /* ========== SCENARIOS ========== */
    function startScenarios() {
        shuffledSc = shuffle(scenarios);
        currentSc = 0;
        scScore = 0;
        showSection('section-scenarios');
        renderScenario();
    }

    function renderScenario() {
        var s = shuffledSc[currentSc];
        var total = shuffledSc.length;
        var pct = (currentSc / total) * 100;

        document.getElementById('sc-progress').style.width = pct + '%';
        document.getElementById('sc-progress-text').textContent = (currentSc + 1) + ' / ' + total;

        var opts = shuffle(s.options);

        var html = '';
        html += '<div class="scenario-card">';
        html += '<div class="scenario-emoji">' + s.emoji + '</div>';
        html += '<div class="scenario-text">' + esc(s.text) + '</div>';
        html += '</div>';
        html += '<div class="scenario-prompt">Que fais-tu ?</div>';

        for (var i = 0; i < opts.length; i++) {
            var o = opts[i];
            html += '<div class="option-card" data-type="' + o.type + '" data-points="' + o.points + '" data-feedback="' + esc(o.feedback) + '" onclick="selectScenario(this)" style="animation-delay:' + (i * 0.08) + 's">' + esc(o.label) + '</div>';
        }

        html += '<div id="sc-feedback"></div>';
        document.getElementById('sc-container').innerHTML = html;
    }

    function selectScenario(el) {
        var type = el.getAttribute('data-type');
        var points = parseInt(el.getAttribute('data-points'));
        var feedback = el.getAttribute('data-feedback');
        scScore += points;

        var cards = document.querySelectorAll('#sc-container .option-card');
        for (var i = 0; i < cards.length; i++) cards[i].classList.add('disabled');

        if (type === 'empathique') el.classList.add('selected-correct');
        else if (type === 'partiel') el.classList.add('selected-partial');
        else el.classList.add('selected-wrong');

        if (type !== 'empathique') {
            for (var i = 0; i < cards.length; i++) {
                if (cards[i].getAttribute('data-type') === 'empathique') cards[i].classList.add('reveal-correct');
            }
        }

        var fbClass = type === 'empathique' ? 'correct' : (type === 'partiel' ? 'partial' : 'wrong');
        var ptsLabel = points === 2 ? '+2 points' : (points === 1 ? '+1 point' : '0 point');

        var isLast = currentSc >= shuffledSc.length - 1;
        var btnLabel = isLast ? 'Passer aux reformulations ‚Üí' : 'Situation suivante ‚Üí';
        var btnAction = isLast ? 'startReform()' : 'nextScenario()';

        var fbHtml = '<div class="feedback-card ' + fbClass + '">';
        fbHtml += '<div class="feedback-points">' + ptsLabel + '</div>';
        fbHtml += feedback;
        fbHtml += '</div>';
        fbHtml += '<button class="btn-next" onclick="' + btnAction + '">' + btnLabel + '</button>';

        document.getElementById('sc-feedback').innerHTML = fbHtml;
    }

    function nextScenario() {
        currentSc++;
        renderScenario();
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    /* ========== REFORMULATION ========== */
    function startReform() {
        shuffledRf = shuffle(reformulations);
        currentRf = 0;
        rfScore = 0;
        showSection('section-reform');
        renderReform();
    }

    function renderReform() {
        var r = shuffledRf[currentRf];
        var total = shuffledRf.length;
        var pct = (currentRf / total) * 100;

        document.getElementById('rf-progress').style.width = pct + '%';
        document.getElementById('rf-progress-text').textContent = (currentRf + 1) + ' / ' + total;

        var opts = shuffle(r.options);

        var html = '';
        html += '<div class="statement-card"><span class="statement-icon">üí¨</span>¬´ ' + esc(r.statement) + ' ¬ª</div>';
        html += '<div class="reform-prompt">Quelle reformulation est la plus empathique ?</div>';

        for (var i = 0; i < opts.length; i++) {
            var o = opts[i];
            html += '<div class="option-card" data-correct="' + o.correct + '" onclick="selectReform(this)" style="animation-delay:' + (i * 0.08) + 's">' + esc(o.text) + '</div>';
        }

        html += '<div id="rf-feedback"></div>';
        document.getElementById('rf-container').innerHTML = html;
    }

    function selectReform(el) {
        var correct = el.getAttribute('data-correct') === 'true';
        if (correct) rfScore++;

        var cards = document.querySelectorAll('#rf-container .option-card');
        for (var i = 0; i < cards.length; i++) cards[i].classList.add('disabled');

        if (correct) {
            el.classList.add('selected-correct');
        } else {
            el.classList.add('selected-wrong');
            for (var i = 0; i < cards.length; i++) {
                if (cards[i].getAttribute('data-correct') === 'true') cards[i].classList.add('reveal-correct');
            }
        }

        var fbClass = correct ? 'correct' : 'wrong';
        var ptsLabel = correct ? '+1 point' : '0 point';
        var fbText = correct
            ? "Bien vu ! Cette reformulation montre que tu as compris ce que l'autre ressent, sans minimiser ni juger."
            : "Ce n'est pas la reformulation la plus empathique. Reformuler, c'est nommer ce que l'autre ressent pour lui montrer qu'on a compris.";

        var isLast = currentRf >= shuffledRf.length - 1;
        var btnLabel = isLast ? 'Voir mon bilan ‚Üí' : 'Suite ‚Üí';
        var btnAction = isLast ? 'showBilan()' : 'nextReform()';

        var fbHtml = '<div class="feedback-card ' + fbClass + '">';
        fbHtml += '<div class="feedback-points">' + ptsLabel + '</div>';
        fbHtml += fbText;
        fbHtml += '</div>';
        fbHtml += '<button class="btn-next" onclick="' + btnAction + '">' + btnLabel + '</button>';

        document.getElementById('rf-feedback').innerHTML = fbHtml;
    }

    function nextReform() {
        currentRf++;
        renderReform();
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    /* ========== BILAN ========== */
    function showBilan() {
        var total = scScore + rfScore;
        document.getElementById('final-score').textContent = total;

        var msg = '';
        if (total >= 14) msg = 'üåü Excellent ! Tu fais preuve d\'une vraie √©coute empathique.';
        else if (total >= 10) msg = 'üëè Bien jou√© ! Tu d√©veloppes une belle capacit√© d\'empathie.';
        else msg = 'üí™ C\'est un d√©but ! L\'empathie se travaille au quotidien.';

        document.getElementById('score-message').textContent = msg;
        showSection('section-bilan');
    }

    /* ========== RESET ========== */
    function resetAll() {
        currentSc = 0; scScore = 0;
        currentRf = 0; rfScore = 0;
        showSection('section-intro');
    }
</script>

</body>
</html>
