<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module C3 ‚Äì Pictogrammes de s√©curit√© ‚Äì Niveau 3 Expert</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1e293b;
            --expert: #dc2626;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            min-height: 100vh;
            color: var(--dark);
        }
        
        .container { max-width: 1100px; margin: 0 auto; padding: 20px; }
        
        .source-banner {
            background: rgba(255,255,255,0.15);
            padding: 8px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .source-banner a { color: rgba(255,255,255,0.95); font-size: 11px; text-decoration: none; }
        
        .header {
            background: white;
            border-radius: 20px;
            padding: 25px 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .module-badge {
            background: linear-gradient(135deg, var(--expert), #991b1b);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .level-badge {
            background: var(--expert);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .header h1 { font-size: 24px; font-weight: 800; margin-bottom: 10px; }
        .header .subtitle { font-size: 14px; color: #64748b; margin-bottom: 15px; }
        
        .objectif-box {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-left: 4px solid var(--expert);
            padding: 15px 20px;
            border-radius: 0 12px 12px 0;
        }
        
        .objectif-box strong { color: #991b1b; font-size: 12px; display: block; margin-bottom: 5px; }
        .objectif-box p { font-size: 14px; font-weight: 600; }
        
        .mode-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            flex: 1;
            min-width: 180px;
            padding: 20px;
            border: none;
            border-radius: 15px;
            background: rgba(255,255,255,0.2);
            color: white;
            font-family: inherit;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .mode-btn:hover { background: rgba(255,255,255,0.3); transform: translateY(-3px); }
        .mode-btn.active { background: white; color: var(--expert); box-shadow: 0 5px 20px rgba(0,0,0,0.2); }
        
        .mode-btn .icon { font-size: 28px; display: block; margin-bottom: 8px; }
        .mode-btn .desc { font-size: 10px; font-weight: 500; opacity: 0.8; margin-top: 5px; }
        
        .main-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            min-height: 500px;
        }
        
        .section { display: none; }
        .section.active { display: block; animation: fadeIn 0.5s ease; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* =====================================================
           ENCYCLOP√âDIE COMPL√àTE
           ===================================================== */
        .search-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 12px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 50px;
            font-family: inherit;
            font-size: 14px;
        }
        
        .search-input:focus { outline: none; border-color: var(--primary); }
        
        .filter-btns {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 10px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 50px;
            background: white;
            font-family: inherit;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .filter-btn:hover { border-color: var(--primary); }
        .filter-btn.active { background: var(--primary); color: white; border-color: var(--primary); }
        
        .pictograms-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }
        
        .picto-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .picto-item:hover {
            border-color: var(--primary);
            transform: translateX(5px);
        }
        
        .picto-item img {
            width: 60px;
            height: 60px;
            object-fit: contain;
        }
        
        .picto-item .info h4 {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .picto-item .info .cat {
            font-size: 11px;
            color: #64748b;
        }
        
        .picto-count {
            text-align: center;
            padding: 10px;
            color: #64748b;
            font-size: 13px;
        }
        
        /* Modal d√©tail */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-overlay.show { display: flex; }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 550px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalIn 0.3s ease;
        }
        
        @keyframes modalIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .modal-header img {
            width: 100px;
            height: 100px;
            object-fit: contain;
        }
        
        .modal-header .title h3 { font-size: 18px; margin-bottom: 5px; }
        .modal-header .title .category {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 11px;
            font-weight: 700;
        }
        
        .modal-body p { font-size: 14px; color: #475569; line-height: 1.7; margin-bottom: 15px; }
        
        .modal-body .tip {
            background: #f1f5f9;
            padding: 15px;
            border-radius: 10px;
            font-size: 13px;
        }
        
        .modal-body .tip strong { color: var(--primary); }
        
        .modal-close {
            width: 100%;
            margin-top: 20px;
            padding: 12px;
            border: none;
            border-radius: 10px;
            background: var(--primary);
            color: white;
            font-family: inherit;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
        }
        
        /* =====================================================
           D√âFI SITUATION PROFESSIONNELLE
           ===================================================== */
        .challenge-intro {
            text-align: center;
            padding: 40px 20px;
        }
        
        .challenge-intro h2 { font-size: 26px; margin-bottom: 15px; }
        .challenge-intro p { color: #64748b; margin-bottom: 30px; max-width: 600px; margin-left: auto; margin-right: auto; }
        
        .challenge-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .challenge-stat {
            text-align: center;
        }
        
        .challenge-stat .value {
            font-size: 32px;
            font-weight: 800;
            color: var(--expert);
        }
        
        .challenge-stat .label { font-size: 12px; color: #64748b; }
        
        .btn-challenge {
            padding: 18px 50px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, var(--expert), #991b1b);
            color: white;
            font-family: inherit;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(220, 38, 38, 0.4);
        }
        
        .btn-challenge:hover { transform: translateY(-3px); }
        
        /* Situation en cours */
        .situation-active { display: none; }
        .situation-active.show { display: block; }
        
        .situation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-radius: 15px;
            margin-bottom: 25px;
        }
        
        .situation-progress {
            font-weight: 700;
            color: #991b1b;
        }
        
        .situation-score {
            display: flex;
            gap: 15px;
        }
        
        .situation-score .item {
            padding: 8px 15px;
            background: white;
            border-radius: 8px;
            font-weight: 700;
            font-size: 13px;
        }
        
        .situation-card {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }
        
        .situation-card .scenario {
            display: flex;
            align-items: flex-start;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .situation-card .scenario .icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            flex-shrink: 0;
        }
        
        .situation-card .scenario .text h4 {
            font-size: 16px;
            margin-bottom: 8px;
            color: var(--dark);
        }
        
        .situation-card .scenario .text p {
            font-size: 14px;
            color: #475569;
            line-height: 1.6;
        }
        
        .situation-card .question {
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }
        
        .situation-card .question h5 {
            font-size: 14px;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .situation-card .question p {
            font-size: 15px;
            font-weight: 600;
        }
        
        .picto-choices {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }
        
        .picto-choice {
            padding: 15px;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .picto-choice:hover:not(:disabled) {
            border-color: var(--primary);
            transform: translateY(-3px);
        }
        
        .picto-choice img {
            width: 70px;
            height: 70px;
            object-fit: contain;
            margin-bottom: 8px;
        }
        
        .picto-choice .name {
            font-size: 11px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .picto-choice.correct { border-color: var(--success); background: #dcfce7; }
        .picto-choice.wrong { border-color: var(--danger); background: #fee2e2; }
        .picto-choice:disabled { cursor: default; }
        
        .situation-feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 15px;
            display: none;
            text-align: center;
        }
        
        .situation-feedback.show { display: block; animation: bounceIn 0.4s ease; }
        
        @keyframes bounceIn {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .situation-feedback.success { background: #dcfce7; border: 2px solid var(--success); }
        .situation-feedback.error { background: #fee2e2; border: 2px solid var(--danger); }
        
        .situation-feedback h4 { font-size: 20px; margin-bottom: 10px; }
        .situation-feedback.success h4 { color: #166534; }
        .situation-feedback.error h4 { color: #991b1b; }
        
        .situation-feedback p { font-size: 13px; color: #475569; margin-bottom: 15px; }
        
        .btn-next {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            background: var(--primary);
            color: white;
            font-family: inherit;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
        }
        
        /* R√©sultats */
        .results-section {
            text-align: center;
            padding: 30px;
            display: none;
        }
        
        .results-section.show { display: block; }
        
        .trophy { font-size: 80px; margin-bottom: 20px; }
        
        .results-section h2 { font-size: 28px; margin-bottom: 10px; }
        .results-section .msg { color: #64748b; margin-bottom: 30px; }
        
        .final-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .final-stat {
            padding: 25px;
            background: #f8fafc;
            border-radius: 15px;
        }
        
        .final-stat .val { font-size: 36px; font-weight: 800; color: var(--expert); }
        .final-stat .lbl { font-size: 12px; color: #64748b; margin-top: 5px; }
        
        .badge-earned {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 15px 30px;
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #f59e0b;
            border-radius: 50px;
            margin-bottom: 30px;
        }
        
        .badge-earned .icon { font-size: 30px; }
        .badge-earned .text { font-weight: 700; color: #92400e; }
        
        .btn-action {
            padding: 15px 35px;
            border: none;
            border-radius: 50px;
            font-family: inherit;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            margin: 8px;
            transition: all 0.3s;
        }
        
        .btn-action.primary { background: linear-gradient(135deg, var(--expert), #991b1b); color: white; }
        .btn-action.secondary { background: #e2e8f0; color: var(--dark); }
        .btn-action:hover { transform: translateY(-2px); }
        
        @media (max-width: 700px) {
            .picto-choices { grid-template-columns: repeat(2, 1fr); }
            .final-stats { grid-template-columns: 1fr; }
            .pictograms-list { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    
    <div class="container">
        
        <div class="source-banner">
            <a href="https://www.inrs.fr" target="_blank">üìö Source : INRS ‚Äì Institut National de Recherche et de S√©curit√© ‚Äì www.inrs.fr</a>
        </div>
        
        <div class="header">
            <div class="header-top">
                <span class="module-badge">MODULE C3 ‚Äì Th√©matique C</span>
                <span class="level-badge">‚≠ê‚≠ê‚≠ê NIVEAU 3 ‚Äì Expert</span>
            </div>
            <h1>üõ°Ô∏è Les pictogrammes de s√©curit√©</h1>
            <p class="subtitle">La d√©marche de pr√©vention appliqu√©e √† une activit√© de travail</p>
            <div class="objectif-box">
                <strong>üéØ OBJECTIF DE LA S√âANCE</strong>
                <p>√ätre capable d'<strong>analyser une situation professionnelle</strong> et de <strong>s√©lectionner les pictogrammes de s√©curit√© appropri√©s</strong> pour garantir la protection des personnes.</p>
            </div>
        </div>
        
        <div class="mode-selector">
            <button class="mode-btn active" onclick="setMode('encyclopedia')">
                <span class="icon">üìö</span>
                Encyclop√©die
                <span class="desc">35 pictogrammes complets</span>
            </button>
            <button class="mode-btn" onclick="setMode('challenge')">
                <span class="icon">üè¢</span>
                Situations Pro
                <span class="desc">Mises en situation r√©elles</span>
            </button>
        </div>
        
        <div class="main-content">
            
            <!-- ENCYCLOP√âDIE -->
            <div class="section active" id="section-encyclopedia">
                <div class="search-bar">
                    <input type="text" class="search-input" placeholder="üîç Rechercher un pictogramme..." oninput="filterPictograms()">
                    <div class="filter-btns">
                        <button class="filter-btn active" onclick="setFilter('all')">Tous</button>
                        <button class="filter-btn" onclick="setFilter('obligation')">üîµ Obligation</button>
                        <button class="filter-btn" onclick="setFilter('interdiction')">üî¥ Interdiction</button>
                        <button class="filter-btn" onclick="setFilter('avertissement')">‚ö†Ô∏è Danger</button>
                        <button class="filter-btn" onclick="setFilter('incendie')">üßØ Incendie</button>
                        <button class="filter-btn" onclick="setFilter('secours')">üü¢ Secours</button>
                    </div>
                </div>
                
                <div class="picto-count" id="picto-count">35 pictogrammes</div>
                
                <div class="pictograms-list" id="pictograms-list"></div>
            </div>
            
            <!-- D√âFI SITUATIONS PRO -->
            <div class="section" id="section-challenge">
                
                <div class="challenge-intro" id="challenge-intro">
                    <h2>üè¢ D√©fi : Situations Professionnelles</h2>
                    <p>Mets-toi dans la peau d'un responsable s√©curit√© ! Pour chaque situation, identifie le ou les pictogrammes qui doivent √™tre affich√©s.</p>
                    
                    <div class="challenge-stats">
                        <div class="challenge-stat">
                            <div class="value">8</div>
                            <div class="label">Situations</div>
                        </div>
                        <div class="challenge-stat">
                            <div class="value">35</div>
                            <div class="label">Pictogrammes</div>
                        </div>
                        <div class="challenge-stat">
                            <div class="value">üèÜ</div>
                            <div class="label">Badge √† gagner</div>
                        </div>
                    </div>
                    
                    <button class="btn-challenge" onclick="startChallenge()">
                        Relever le d√©fi ! üí™
                    </button>
                </div>
                
                <div class="situation-active" id="situation-active">
                    <div class="situation-header">
                        <div class="situation-progress">
                            Situation <span id="sit-current">1</span>/8
                        </div>
                        <div class="situation-score">
                            <div class="item">‚≠ê <span id="sit-score">0</span> pts</div>
                            <div class="item">‚úÖ <span id="sit-correct">0</span>/8</div>
                        </div>
                    </div>
                    
                    <div class="situation-card">
                        <div class="scenario">
                            <div class="icon" id="sit-icon">üè≠</div>
                            <div class="text">
                                <h4 id="sit-title">Titre de la situation</h4>
                                <p id="sit-description">Description de la situation professionnelle.</p>
                            </div>
                        </div>
                        <div class="question">
                            <h5>‚ùì Question</h5>
                            <p id="sit-question">Quel pictogramme doit √™tre affich√© ?</p>
                        </div>
                    </div>
                    
                    <div class="picto-choices" id="picto-choices"></div>
                    
                    <div class="situation-feedback" id="sit-feedback">
                        <h4 id="sit-feedback-title"></h4>
                        <p id="sit-feedback-text"></p>
                        <button class="btn-next" onclick="nextSituation()">Continuer ‚Üí</button>
                    </div>
                </div>
                
                <div class="results-section" id="results-section">
                    <div class="trophy">üèÜ</div>
                    <h2 id="results-title">F√©licitations !</h2>
                    <p class="msg" id="results-msg"></p>
                    
                    <div class="badge-earned" id="badge-earned">
                        <span class="icon">üéñÔ∏è</span>
                        <span class="text">Badge "Expert S√©curit√©" obtenu !</span>
                    </div>
                    
                    <div class="final-stats">
                        <div class="final-stat">
                            <div class="val" id="final-score">0</div>
                            <div class="lbl">Points totaux</div>
                        </div>
                        <div class="final-stat">
                            <div class="val" id="final-correct">0/8</div>
                            <div class="lbl">Bonnes r√©ponses</div>
                        </div>
                        <div class="final-stat">
                            <div class="val" id="final-pct">0%</div>
                            <div class="lbl">Taux de r√©ussite</div>
                        </div>
                    </div>
                    
                    <button class="btn-action primary" onclick="restartChallenge()">üîÑ Recommencer</button>
                    <button class="btn-action secondary" onclick="setMode('encyclopedia')">üìö Encyclop√©die</button>
                </div>
                
            </div>
            
        </div>
        
    </div>
    
    <!-- Modal d√©tail -->
    <div class="modal-overlay" id="modal" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <img id="modal-img" src="" alt="">
                <div class="title">
                    <h3 id="modal-name"></h3>
                    <span class="category" id="modal-cat" style="background: #0ea5e9; color: white;"></span>
                </div>
            </div>
            <div class="modal-body">
                <p id="modal-desc"></p>
                <div class="tip">
                    <strong>üìç O√π le trouve-t-on ?</strong><br>
                    <span id="modal-context"></span>
                </div>
            </div>
            <button class="modal-close" onclick="closeModal()">Fermer</button>
        </div>
    </div>
    
    <script>
        // Base compl√®te - 35 pictogrammes
        const allPictograms = [
            // OBLIGATION (10)
            { id: 1, name: "Port des gants obligatoire", image: "pictogrammes/images/OBLIGATION-gants.jpg", category: "obligation", catName: "Obligation", color: "#0ea5e9", desc: "Obligation de porter des gants de protection.", context: "Manipulation de produits chimiques, travaux manuels, cuisine professionnelle." },
            { id: 2, name: "Port du casque obligatoire", image: "pictogrammes/images/OBLIGATION-casque.jpg", category: "obligation", catName: "Obligation", color: "#0ea5e9", desc: "Obligation de porter un casque de s√©curit√©.", context: "Chantiers de construction, zones de manutention, entrep√¥ts." },
            { id: 3, name: "Port des chaussures de s√©curit√©", image: "pictogrammes/images/OBLIGATION-chaussures.jpg", category: "obligation", catName: "Obligation", color: "#0ea5e9", desc: "Obligation de porter des chaussures de s√©curit√©.", context: "Ateliers, entrep√¥ts, chantiers, industrie." },
            { id: 4, name: "Port des lunettes de protection", image: "pictogrammes/images/OBLIGATION-lunettes.jpg", category: "obligation", catName: "Obligation", color: "#0ea5e9", desc: "Obligation de porter des lunettes de protection.", context: "Travaux avec projections, soudure, laboratoires." },
            { id: 5, name: "Protection auditive obligatoire", image: "pictogrammes/images/OBLIGATION-casque-antibruit.jpg", category: "obligation", catName: "Obligation", color: "#0ea5e9", desc: "Obligation de porter une protection auditive.", context: "Environnements bruyants (>85 dB), machines." },
            { id: 6, name: "Protection respiratoire obligatoire", image: "pictogrammes/images/OBLIGATION-protection-voies-espiratoires.jpg", category: "obligation", catName: "Obligation", color: "#0ea5e9", desc: "Obligation de porter un masque respiratoire.", context: "Pr√©sence de poussi√®res, vapeurs, gaz." },
            { id: 7, name: "Port de la combinaison obligatoire", image: "pictogrammes/images/OBLIGATION-combinaison.jpg", category: "obligation", catName: "Obligation", color: "#0ea5e9", desc: "Obligation de porter une combinaison de protection.", context: "Travaux salissants, produits chimiques." },
            { id: 8, name: "Port du harnais obligatoire", image: "pictogrammes/images/OBLIGATION-harnais.jpg", category: "obligation", catName: "Obligation", color: "#0ea5e9", desc: "Obligation de porter un harnais anti-chute.", context: "Travaux en hauteur, nacelles, toitures." },
            { id: 9, name: "Port de la visi√®re obligatoire", image: "pictogrammes/images/OBLIGATION-visiere.jpg", category: "obligation", catName: "Obligation", color: "#0ea5e9", desc: "Obligation de porter une visi√®re de protection.", context: "Soudure, projection de particules." },
            { id: 10, name: "Consulter la notice", image: "pictogrammes/images/OBLIGATION-consulter-notice.jpg", category: "obligation", catName: "Obligation", color: "#0ea5e9", desc: "Obligation de lire les instructions avant utilisation.", context: "Machines, √©quipements, produits dangereux." },
            
            // INTERDICTION (7)
            { id: 11, name: "Interdiction de fumer", image: "pictogrammes/images/INTERDIT-fumer.jpg", category: "interdiction", catName: "Interdiction", color: "#dc2626", desc: "Il est interdit de fumer.", context: "Tous les lieux de travail, ERP." },
            { id: 12, name: "Flamme nue interdite", image: "pictogrammes/images/INTERDIT-flamme.jpg", category: "interdiction", catName: "Interdiction", color: "#dc2626", desc: "Interdiction d'approcher une flamme.", context: "Stockage de produits inflammables." },
            { id: 13, name: "Acc√®s interdit", image: "pictogrammes/images/INTERDIT-entrer.jpg", category: "interdiction", catName: "Interdiction", color: "#dc2626", desc: "Entr√©e interdite aux personnes non autoris√©es.", context: "Zones dangereuses, locaux techniques." },
            { id: 14, name: "Interdit de toucher", image: "pictogrammes/images/INTERDIT-toucher.jpg", category: "interdiction", catName: "Interdiction", color: "#dc2626", desc: "Interdiction de toucher.", context: "Machines en fonctionnement, surfaces chaudes." },
            { id: 15, name: "Interdit aux pi√©tons", image: "pictogrammes/images/INTERDIT-pietons.jpg", category: "interdiction", catName: "Interdiction", color: "#dc2626", desc: "Zone interdite aux pi√©tons.", context: "Voies de circulation engins." },
            { id: 16, name: "Interdit aux chariots", image: "pictogrammes/images/INTERDIT-chariot.jpg", category: "interdiction", catName: "Interdiction", color: "#dc2626", desc: "Circulation des chariots interdite.", context: "Zones pi√©tonnes, passages √©troits." },
            { id: 17, name: "Eau interdite sur ce feu", image: "pictogrammes/images/INTERDIT-seau-eau.jpg", category: "interdiction", catName: "Interdiction", color: "#dc2626", desc: "Ne pas utiliser d'eau pour √©teindre.", context: "Feux d'origine √©lectrique, huiles." },
            
            // AVERTISSEMENT (10)
            { id: 18, name: "Danger √©lectrique", image: "pictogrammes/images/DANGER-electricite.jpg", category: "avertissement", catName: "Avertissement", color: "#eab308", desc: "Risque d'√©lectrocution.", context: "Armoires √©lectriques, transformateurs." },
            { id: 19, name: "Danger de chute", image: "pictogrammes/images/DANGER-chute.jpg", category: "avertissement", catName: "Avertissement", color: "#eab308", desc: "Risque de chute en hauteur.", context: "Escaliers, fosses, √©chafaudages." },
            { id: 20, name: "Produit toxique", image: "pictogrammes/images/DANGER-produit-toxique.jpg", category: "avertissement", catName: "Avertissement", color: "#eab308", desc: "Pr√©sence de produit toxique.", context: "Stockage chimique, laboratoires." },
            { id: 21, name: "Produit inflammable", image: "pictogrammes/images/DANGER-produit-inflammable.jpg", category: "avertissement", catName: "Avertissement", color: "#eab308", desc: "Produit qui peut prendre feu.", context: "Solvants, carburants, alcools." },
            { id: 22, name: "Danger de tr√©buchement", image: "pictogrammes/images/DANGER-trebuchement.jpg", category: "avertissement", catName: "Avertissement", color: "#eab308", desc: "Risque de tr√©buchement.", context: "Sols irr√©guliers, c√¢bles au sol." },
            { id: 23, name: "Chariot √©l√©vateur", image: "pictogrammes/images/DANGER-chariot.jpg", category: "avertissement", catName: "Avertissement", color: "#eab308", desc: "Circulation de chariots.", context: "Entrep√¥ts, zones logistiques." },
            { id: 24, name: "Produit corrosif", image: "pictogrammes/images/DANGER-produit-corrosif.jpg", category: "avertissement", catName: "Avertissement", color: "#eab308", desc: "Produit qui peut br√ªler la peau.", context: "Acides, bases, produits d'entretien." },
            { id: 25, name: "Charge suspendue", image: "pictogrammes/images/DANGER-charge-suspendue.jpg", category: "avertissement", catName: "Avertissement", color: "#eab308", desc: "Risque de chute d'objets.", context: "Grues, ponts roulants." },
            { id: 26, name: "Risque biologique", image: "pictogrammes/images/DANGER-risque-biologique.jpg", category: "avertissement", catName: "Avertissement", color: "#eab308", desc: "Pr√©sence de risque biologique.", context: "Laboratoires, h√¥pitaux, DASRI." },
            { id: 27, name: "Basse temp√©rature", image: "pictogrammes/images/DANGER-froid-gel.jpg", category: "avertissement", catName: "Avertissement", color: "#eab308", desc: "Risque li√© au froid.", context: "Chambres froides, cryog√©nie." },
            
            // INCENDIE (4)
            { id: 28, name: "Extincteur", image: "pictogrammes/images/INCENDIE-extincteur.jpg", category: "incendie", catName: "Incendie", color: "#b91c1c", desc: "Emplacement d'un extincteur.", context: "Tous les b√¢timents." },
            { id: 29, name: "Alarme incendie", image: "pictogrammes/images/INCENDIE-alarme.jpg", category: "incendie", catName: "Incendie", color: "#b91c1c", desc: "D√©clencheur d'alarme incendie.", context: "Pr√®s des issues de secours." },
            { id: 30, name: "Lance √† incendie (RIA)", image: "pictogrammes/images/INCENDIE-lance.jpg", category: "incendie", catName: "Incendie", color: "#b91c1c", desc: "Robinet d'incendie arm√©.", context: "Couloirs, grandes surfaces." },
            { id: 31, name: "√âquipement de lutte incendie", image: "pictogrammes/images/INCENDIE-equipement.jpg", category: "incendie", catName: "Incendie", color: "#b91c1c", desc: "Mat√©riel de lutte contre l'incendie.", context: "Local s√©curit√©, d√©p√¥ts." },
            
            // SECOURS (4)
            { id: 32, name: "Sortie de secours", image: "pictogrammes/images/SECOURS-sortie-vers-droite.jpg", category: "secours", catName: "Secours", color: "#16a34a", desc: "Direction de la sortie de secours.", context: "Couloirs, escaliers." },
            { id: 33, name: "Point de rassemblement", image: "pictogrammes/images/SECOURS-point-rassemblement.jpg", category: "secours", catName: "Secours", color: "#16a34a", desc: "Lieu de rassemblement √©vacuation.", context: "Ext√©rieur des b√¢timents." },
            { id: 34, name: "Premiers secours", image: "pictogrammes/images/SECOURS-croix.jpg", category: "secours", catName: "Secours", color: "#16a34a", desc: "Mat√©riel de premiers secours.", context: "Infirmerie, armoires √† pharmacie." },
            { id: 35, name: "D√©fibrillateur (DAE)", image: "pictogrammes/images/SECOURS-defibrillateur.jpg", category: "secours", catName: "Secours", color: "#16a34a", desc: "D√©fibrillateur automatique externe.", context: "Halls, lieux publics." }
        ];
        
        // Situations professionnelles
        const situations = [
            {
                icon: "üî¨",
                title: "Laboratoire de chimie",
                desc: "Tu travailles dans un laboratoire o√π sont manipul√©s des produits chimiques corrosifs. Tu dois pr√©parer une solution acide.",
                question: "Quel pictogramme d'obligation doit √™tre affich√© √† l'entr√©e ?",
                correctId: 4, // Lunettes
                explanation: "Les lunettes de protection sont obligatoires pour prot√©ger les yeux des projections de produits chimiques."
            },
            {
                icon: "üèóÔ∏è",
                title: "Chantier de construction",
                desc: "Tu arrives sur un chantier de construction o√π des travaux sont en cours au-dessus de toi.",
                question: "Quel pictogramme d'obligation est indispensable ?",
                correctId: 2, // Casque
                explanation: "Le casque prot√®ge la t√™te des chutes d'objets sur un chantier."
            },
            {
                icon: "üì¶",
                title: "Entrep√¥t logistique",
                desc: "Tu travailles dans un entrep√¥t o√π circulent des chariots √©l√©vateurs. Une zone est r√©serv√©e aux pi√©tons.",
                question: "Quel pictogramme d'avertissement doit √™tre pr√©sent ?",
                correctId: 23, // Chariot
                explanation: "Ce pictogramme avertit de la circulation de chariots √©l√©vateurs."
            },
            {
                icon: "‚ö°",
                title: "Local technique √©lectrique",
                desc: "Tu dois intervenir pr√®s d'une armoire √©lectrique haute tension.",
                question: "Quel pictogramme d'avertissement est obligatoire ?",
                correctId: 18, // √âlectricit√©
                explanation: "Le pictogramme danger √©lectrique signale le risque d'√©lectrocution."
            },
            {
                icon: "üè•",
                title: "Service hospitalier",
                desc: "Tu travailles dans un service o√π sont manipul√©s des d√©chets d'activit√©s de soins √† risques infectieux (DASRI).",
                question: "Quel pictogramme d'avertissement doit √™tre affich√© ?",
                correctId: 26, // Biologique
                explanation: "Le risque biologique signale la pr√©sence d'agents infectieux."
            },
            {
                icon: "üßØ",
                title: "√âvacuation incendie",
                desc: "Lors d'une √©vacuation incendie, les employ√©s doivent se retrouver √† un endroit pr√©cis.",
                question: "Quel pictogramme de secours indique ce lieu ?",
                correctId: 33, // Point rassemblement
                explanation: "Le point de rassemblement est le lieu o√π se regrouper apr√®s √©vacuation."
            },
            {
                icon: "üè≠",
                title: "Atelier de menuiserie",
                desc: "Tu travailles dans un atelier o√π les machines produisent beaucoup de bruit (>90 dB).",
                question: "Quel pictogramme d'obligation est n√©cessaire ?",
                correctId: 5, // Antibruit
                explanation: "La protection auditive est obligatoire au-del√† de 85 dB."
            },
            {
                icon: "üî•",
                title: "Stockage de solvants",
                desc: "Tu es responsable d'une zone de stockage contenant des solvants et des peintures.",
                question: "Quel pictogramme d'interdiction doit √™tre affich√© ?",
                correctId: 12, // Flamme interdite
                explanation: "Les flammes nues sont interdites pr√®s des produits inflammables."
            }
        ];
        
        // Variables
        let currentFilter = 'all';
        let currentSituation = 0;
        let sitScore = 0;
        let sitCorrect = 0;
        
        // Init
        document.addEventListener('DOMContentLoaded', () => {
            renderEncyclopedia();
        });
        
        function setMode(mode) {
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            
            event.target.closest('.mode-btn').classList.add('active');
            document.getElementById('section-' + mode).classList.add('active');
            
            if (mode === 'challenge') {
                document.getElementById('challenge-intro').style.display = 'block';
                document.getElementById('situation-active').classList.remove('show');
                document.getElementById('results-section').classList.remove('show');
            }
        }
        
        function setFilter(cat) {
            currentFilter = cat;
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            renderEncyclopedia();
        }
        
        function filterPictograms() {
            renderEncyclopedia();
        }
        
        function renderEncyclopedia() {
            const search = document.querySelector('.search-input').value.toLowerCase();
            let filtered = allPictograms;
            
            if (currentFilter !== 'all') {
                filtered = filtered.filter(p => p.category === currentFilter);
            }
            
            if (search) {
                filtered = filtered.filter(p => p.name.toLowerCase().includes(search) || p.desc.toLowerCase().includes(search));
            }
            
            document.getElementById('picto-count').textContent = filtered.length + ' pictogramme' + (filtered.length > 1 ? 's' : '');
            
            document.getElementById('pictograms-list').innerHTML = filtered.map(p => `
                <div class="picto-item" onclick="showDetail(${p.id})">
                    <img src="${p.image}" alt="${p.name}">
                    <div class="info">
                        <h4>${p.name}</h4>
                        <span class="cat">${p.catName}</span>
                    </div>
                </div>
            `).join('');
        }
        
        function showDetail(id) {
            const p = allPictograms.find(x => x.id === id);
            document.getElementById('modal-img').src = p.image;
            document.getElementById('modal-name').textContent = p.name;
            document.getElementById('modal-cat').textContent = p.catName;
            document.getElementById('modal-cat').style.background = p.color;
            document.getElementById('modal-desc').textContent = p.desc;
            document.getElementById('modal-context').textContent = p.context;
            document.getElementById('modal').classList.add('show');
        }
        
        function closeModal(e) {
            if (!e || e.target === document.getElementById('modal')) {
                document.getElementById('modal').classList.remove('show');
            }
        }
        
        function startChallenge() {
            currentSituation = 0;
            sitScore = 0;
            sitCorrect = 0;
            
            document.getElementById('challenge-intro').style.display = 'none';
            document.getElementById('situation-active').classList.add('show');
            document.getElementById('results-section').classList.remove('show');
            
            loadSituation();
        }
        
        function loadSituation() {
            const sit = situations[currentSituation];
            
            document.getElementById('sit-current').textContent = currentSituation + 1;
            document.getElementById('sit-icon').textContent = sit.icon;
            document.getElementById('sit-title').textContent = sit.title;
            document.getElementById('sit-description').textContent = sit.desc;
            document.getElementById('sit-question').textContent = sit.question;
            
            // Generate choices (correct + 3 random)
            let choices = [allPictograms.find(p => p.id === sit.correctId)];
            let others = allPictograms.filter(p => p.id !== sit.correctId);
            while (choices.length < 4) {
                const rand = Math.floor(Math.random() * others.length);
                choices.push(others[rand]);
                others.splice(rand, 1);
            }
            choices.sort(() => Math.random() - 0.5);
            
            document.getElementById('picto-choices').innerHTML = choices.map(c => `
                <button class="picto-choice" onclick="checkSituation(${c.id}, ${sit.correctId})">
                    <img src="${c.image}" alt="${c.name}">
                    <div class="name">${c.name}</div>
                </button>
            `).join('');
            
            document.getElementById('sit-feedback').classList.remove('show', 'success', 'error');
        }
        
        function checkSituation(answerId, correctId) {
            const sit = situations[currentSituation];
            const correct = allPictograms.find(p => p.id === correctId);
            const feedback = document.getElementById('sit-feedback');
            
            document.querySelectorAll('.picto-choice').forEach(btn => {
                btn.disabled = true;
                if (btn.querySelector('.name').textContent === correct.name) {
                    btn.classList.add('correct');
                }
            });
            
            if (answerId === correctId) {
                sitCorrect++;
                sitScore += 15;
                
                feedback.classList.add('show', 'success');
                document.getElementById('sit-feedback-title').textContent = 'Excellent ! ‚úÖ';
                document.getElementById('sit-feedback-text').textContent = sit.explanation;
            } else {
                feedback.classList.add('show', 'error');
                document.getElementById('sit-feedback-title').textContent = 'Pas tout √† fait...';
                document.getElementById('sit-feedback-text').textContent = 'La bonne r√©ponse √©tait : ' + correct.name + '. ' + sit.explanation;
                
                document.querySelectorAll('.picto-choice').forEach(btn => {
                    if (!btn.classList.contains('correct')) {
                        btn.classList.add('wrong');
                    }
                });
            }
            
            document.getElementById('sit-score').textContent = sitScore;
            document.getElementById('sit-correct').textContent = sitCorrect;
            
            if (currentSituation === situations.length - 1) {
                document.querySelector('#sit-feedback .btn-next').textContent = 'Voir les r√©sultats üèÜ';
            }
        }
        
        function nextSituation() {
            currentSituation++;
            
            if (currentSituation < situations.length) {
                loadSituation();
            } else {
                showFinalResults();
            }
        }
        
        function showFinalResults() {
            document.getElementById('situation-active').classList.remove('show');
            document.getElementById('results-section').classList.add('show');
            
            const pct = Math.round((sitCorrect / situations.length) * 100);
            
            document.getElementById('final-score').textContent = sitScore;
            document.getElementById('final-correct').textContent = sitCorrect + '/' + situations.length;
            document.getElementById('final-pct').textContent = pct + '%';
            
            if (pct >= 75) {
                document.getElementById('results-title').textContent = 'F√©licitations ! üèÜ';
                document.getElementById('results-msg').textContent = 'Tu as obtenu le badge Expert S√©curit√© !';
                document.getElementById('badge-earned').style.display = 'inline-flex';
            } else {
                document.getElementById('results-title').textContent = 'Continue tes efforts ! üí™';
                document.getElementById('results-msg').textContent = 'R√©vise l\'encyclop√©die et r√©essaie pour obtenir le badge.';
                document.getElementById('badge-earned').style.display = 'none';
            }
        }
        
        function restartChallenge() {
            document.getElementById('results-section').classList.remove('show');
            document.getElementById('challenge-intro').style.display = 'block';
        }
    </script>
    
</body>
</html>
