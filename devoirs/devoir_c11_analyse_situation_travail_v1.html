<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Évaluation PSE – Module C11 – Analyse d’une situation de travail</title>
  <style>
    :root {
      --bg: #f4f4f4;
      --card: #ffffff;
      --text: #111827;
      --muted: #6b7280;
      --line: #e5e7eb;
      --band: #0f172a;
      --bandText: #ffffff;
      --badgeBg: #0f172a;
      --badgeText: #ffffff;
      --focus: #2563eb;
      --hintBg: #ecfdf5;
      --hintLine: #bbf7d0;
    }

    * { box-sizing: border-box; }

    body {
      font-family: Arial, Helvetica, sans-serif;
      max-width: 980px;
      margin: 0 auto;
      padding: 18px;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }

    .container {
      background: var(--card);
      padding: 18px;
      border-radius: 14px;
      border: 1px solid var(--line);
      box-shadow: 0 2px 12px rgba(0,0,0,0.06);
    }

    h1 {
      margin: 0 0 6px 0;
      font-size: 18px;
      color: var(--band);
    }

    .meta {
      margin: 0 0 14px 0;
      color: var(--muted);
      font-size: 13px;
    }

    .top-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }

    .info-row {
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px;
      background: #fff;
    }

    .info-row label {
      display: block;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
      font-weight: 700;
      letter-spacing: .3px;
    }

    input[type="text"], input[type="date"] {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--line);
      border-radius: 10px;
      font-size: 14px;
      outline: none;
    }

    input[type="text"]:focus, input[type="date"]:focus {
      border-color: var(--focus);
      box-shadow: 0 0 0 3px rgba(37,99,235,.12);
    }

    .competences {
      margin-top: 12px;
      padding: 10px 12px;
      border: 1px solid var(--line);
      border-radius: 12px;
      background: #fff;
      font-size: 13px;
      color: var(--muted);
    }

    .competences ul {
      margin: 8px 0 0 18px;
      padding: 0;
    }

    .competences li { margin: 4px 0; }

    .phase {
      margin-top: 14px;
      border: 1px solid var(--line);
      border-radius: 14px;
      background: #fff;
      overflow: hidden;
    }

    .phase-title {
      background: var(--band);
      color: var(--bandText);
      padding: 10px 12px;
      font-weight: 700;
      text-align: center;
      font-size: 14px;
    }

    .phase-content { padding: 12px; }

    .doc {
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 12px;
      background: #fff;
      margin: 10px 0;
    }

    .doc h2 {
      margin: 0 0 8px 0;
      font-size: 14px;
      color: var(--band);
    }

    .question {
      border-top: 1px solid var(--line);
      padding-top: 12px;
      margin-top: 12px;
    }

    .question:first-child {
      border-top: none;
      padding-top: 0;
      margin-top: 0;
    }

    .qline {
      display: flex;
      gap: 10px;
      align-items: baseline;
      flex-wrap: wrap;
      margin: 0 0 8px 0;
      font-size: 14px;
    }

    .badge {
      display: inline-block;
      background: var(--badgeBg);
      color: var(--badgeText);
      border-radius: 10px;
      padding: 2px 8px;
      font-size: 12px;
      font-weight: 700;
      flex: 0 0 auto;
    }

    .pts {
      margin-left: auto;
      color: var(--muted);
      font-size: 12px;
      white-space: nowrap;
    }

    .reponse-eleve {
      width: 100%;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px;
      font-size: 14px;
      outline: none;
      resize: none;
      min-height: 44px;
      line-height: 1.35;
      overflow: hidden;
      white-space: pre-wrap;
    }

    .reponse-eleve:focus {
      border-color: var(--focus);
      box-shadow: 0 0 0 3px rgba(37,99,235,.12);
    }

    .table-wrapper {
      width: 100%;
      overflow: auto;
      border: 1px solid var(--line);
      border-radius: 12px;
      background: #fff;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 760px;
    }

    th, td {
      border: 1px solid var(--line);
      padding: 10px;
      font-size: 13px;
      vertical-align: top;
      text-align: left;
    }

    thead th {
      background: var(--band);
      color: #fff;
      font-weight: 700;
    }

    .hint {
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--hintLine);
      background: var(--hintBg);
      color: #064e3b;
      font-size: 13px;
    }

    .submit-zone {
      margin-top: 14px;
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }

    .status {
      flex: 1 1 260px;
      color: var(--muted);
      font-size: 12px;
      min-height: 18px;
    }

    .submit-btn {
      border: none;
      border-radius: 14px;
      padding: 12px 16px;
      font-weight: 700;
      cursor: pointer;
      background: var(--band);
      color: #fff;
    }

    .submit-btn:active { transform: translateY(1px); }

    @media (max-width: 700px) {
      body { padding: 12px; }
      .top-info { grid-template-columns: 1fr; }
      table { min-width: 680px; }
    }

    @media (max-width: 400px) {
      h1 { font-size: 16px; }
      .submit-btn { width: 100%; }
    }
  </style>

  <script>
    const DEVOIR_ID = "devoir_c11_analyse_situation_travail_v1";
    localStorage.setItem("devoir_start_time_" + DEVOIR_ID, Date.now());
    let pasteStats = { total: 0, external: 0, document: 0 };
  </script>

  <script type="module">
    import("https://preventionsanteenvironnement.github.io/PSE/annuaire.js")
      .then(async () => {
        if (typeof window.demanderCode === "function") {
          const user = await window.demanderCode("Évaluation PSE – Module C11 – Analyse d’une situation de travail");
          if (user && user.code) {
            const codeField = document.getElementById("code-eleve");
            if (codeField) codeField.value = user.code;
            window.eleveData = user;
          }
        }
      });
  </script>

  <script type="module">
    import("https://preventionsanteenvironnement.github.io/PSE/assets/pse-runner.js");
  </script>
</head>

<body data-id-exercice="devoir_c11_analyse_situation_travail_v1">
  <div class="container">
    <header>
      <h1>Évaluation PSE – Module C11 – Analyse d’une situation de travail</h1>
      <p class="meta">Bac Pro – Barème total 20 points</p>

      <div class="top-info">
        <div class="info-row">
          <label>CODE ÉLÈVE</label>
          <input type="text" id="code-eleve" placeholder="Ex: AB12" required />
        </div>
        <div class="info-row">
          <label>DATE</label>
          <input type="date" id="date-eleve" required />
        </div>
      </div>

      <div class="competences">
        Compétences travaillées
        <ul>
          <li>C1 – Traiter une information</li>
          <li>C2 – Appliquer une démarche d’analyse dans une situation donnée</li>
          <li>C3 – Expliquer un phénomène physiologique en lien avec une mesure de prévention</li>
          <li>C4 – Proposer une solution pour résoudre un problème</li>
          <li>C5 – Argumenter un choix</li>
        </ul>
      </div>
    </header>

    <section class="phase">
      <div class="phase-title">Phase 1 – Situation-problème</div>
      <div class="phase-content">
        <div class="doc">
          <h2>Situation</h2>
          <p>Maya, 19 ans, travaille en restauration collective dans une cuisine centrale. Pendant le service du midi, elle prépare des bacs gastro, dresse des plateaux et réapprovisionne la ligne chaude. Plusieurs fois par service, elle soulève des bacs de 6 à 10 kg, se penche pour atteindre des niveaux bas et effectue des rotations pour poser les bacs sur un chariot. En fin de service, elle ressent des douleurs au bas du dos et aux épaules et dit être très fatiguée. Le sol est parfois humide, l’espace est étroit près de la plonge et la ventilation est bruyante.</p>
        </div>

        <div class="question">
          <p class="qline"><span class="badge">C2</span>1. <b>Formuler</b> la problématique principale de la situation ?<span class="pts">2 points</span></p>
          <textarea class="reponse-eleve" data-qid="q_1_problematique" rows="3" placeholder="Écrire une phrase complète."></textarea>
        </div>
      </div>
    </section>

    <section class="phase">
      <div class="phase-title">Phase 2 – Analyse de la situation avec un outil</div>
      <div class="phase-content">

        <div class="question">
          <p class="qline"><span class="badge">C2</span>2. <b>Compléter</b> ITAMaMi en relevant un élément pertinent pour chaque case ?<span class="pts">5 points</span></p>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Case</th>
                  <th>Réponse</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>I – Individu</td>
                  <td><textarea class="reponse-eleve" data-qid="q_2_itamami_individu" rows="2" placeholder="Âge, état, ressentis, capacités..."></textarea></td>
                </tr>
                <tr>
                  <td>T – Tâche</td>
                  <td><textarea class="reponse-eleve" data-qid="q_2_itamami_tache" rows="2" placeholder="Ce qui est demandé, objectif de la mission..."></textarea></td>
                </tr>
                <tr>
                  <td>A – Activité</td>
                  <td><textarea class="reponse-eleve" data-qid="q_2_itamami_activite" rows="2" placeholder="Comment on fait, gestes observables..."></textarea></td>
                </tr>
                <tr>
                  <td>Ma – Matériel</td>
                  <td><textarea class="reponse-eleve" data-qid="q_2_itamami_materiel" rows="2" placeholder="Outils, charges, chariot..."></textarea></td>
                </tr>
                <tr>
                  <td>Mi – Milieu</td>
                  <td><textarea class="reponse-eleve" data-qid="q_2_itamami_milieu" rows="2" placeholder="Espace, sol, bruit, ambiance..."></textarea></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="question">
          <p class="qline"><span class="badge">C2</span>3. <b>Classer</b> chaque item dans la catégorie tâche ou activité ?<span class="pts">4 points</span></p>
          <div class="hint">Rappel : tâche = ce qui est demandé ; activité = comment on s’y prend concrètement (gestes et ajustements).</div>
          <div class="table-wrapper" style="margin-top:10px">
            <table>
              <thead>
                <tr>
                  <th>Item</th>
                  <th>Catégorie</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Assurer le réapprovisionnement de la ligne chaude</td>
                  <td>
                    <label><input class="reponse-eleve" data-qid="q_3_1_reappro" type="radio" name="q_3_1" value="tache"> Tâche</label>
                    <label style="margin-left:10px"><input class="reponse-eleve" data-qid="q_3_1_reappro" type="radio" name="q_3_1" value="activite"> Activité</label>
                  </td>
                </tr>
                <tr>
                  <td>Soulever des bacs de 6 à 10 kg à répétition</td>
                  <td>
                    <label><input class="reponse-eleve" data-qid="q_3_2_soulever" type="radio" name="q_3_2" value="tache"> Tâche</label>
                    <label style="margin-left:10px"><input class="reponse-eleve" data-qid="q_3_2_soulever" type="radio" name="q_3_2" value="activite"> Activité</label>
                  </td>
                </tr>
                <tr>
                  <td>Dresser des plateaux pour le service</td>
                  <td>
                    <label><input class="reponse-eleve" data-qid="q_3_3_dresser" type="radio" name="q_3_3" value="tache"> Tâche</label>
                    <label style="margin-left:10px"><input class="reponse-eleve" data-qid="q_3_3_dresser" type="radio" name="q_3_3" value="activite"> Activité</label>
                  </td>
                </tr>
                <tr>
                  <td>Se pencher pour atteindre des niveaux bas</td>
                  <td>
                    <label><input class="reponse-eleve" data-qid="q_3_4_pencher" type="radio" name="q_3_4" value="tache"> Tâche</label>
                    <label style="margin-left:10px"><input class="reponse-eleve" data-qid="q_3_4_pencher" type="radio" name="q_3_4" value="activite"> Activité</label>
                  </td>
                </tr>
                <tr>
                  <td>Respecter l’organisation du service du midi</td>
                  <td>
                    <label><input class="reponse-eleve" data-qid="q_3_5_orga" type="radio" name="q_3_5" value="tache"> Tâche</label>
                    <label style="margin-left:10px"><input class="reponse-eleve" data-qid="q_3_5_orga" type="radio" name="q_3_5" value="activite"> Activité</label>
                  </td>
                </tr>
                <tr>
                  <td>Effectuer une rotation du tronc en charge pour poser les bacs</td>
                  <td>
                    <label><input class="reponse-eleve" data-qid="q_3_6_rotation" type="radio" name="q_3_6" value="tache"> Tâche</label>
                    <label style="margin-left:10px"><input class="reponse-eleve" data-qid="q_3_6_rotation" type="radio" name="q_3_6" value="activite"> Activité</label>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <p class="meta" style="margin-top:8px">4 points si 6 items correctement classés</p>
        </div>

      </div>
    </section>

    <section class="phase">
      <div class="phase-title">Phase 3 – Documents</div>
      <div class="phase-content">
        <div class="doc">
          <h2>DOC A</h2>
          <p>Principes de manutention manuelle : rapprocher la charge du corps ; fléchir les jambes et garder le dos aligné ; éviter la rotation du tronc en charge et pivoter avec les pieds ; organiser son geste avant de soulever ; alterner les tâches et prévoir des pauses.</p>
        </div>
        <div class="doc">
          <h2>DOC B</h2>
          <p>Éléments observables : masses des bacs 6 à 10 kg ; fréquence de manipulation élevée pendant le service ; postures fréquentes : flexions du tronc, bras en élévation, rotations ; espace étroit près de la plonge ; sol parfois humide ; bruit de ventilation ; organisation cadencée.</p>
        </div>
        <div class="doc">
          <h2>DOC C</h2>
          <p>Prévention (hiérarchie) : 1) réduire le risque à la source (diminuer la masse des bacs, fractionner les charges, aides à la manutention) ; 2) protections collectives (aménagement du poste, chariots à bonne hauteur, dégagement de l’espace, traitement antidérapant du sol, organisation des flux) ; 3) protections individuelles (chaussures antidérapantes adaptées) ; 4) information/formation (gestes et postures, PRAP, consignes).</p>
        </div>
      </div>
    </section>

    <section class="phase">
      <div class="phase-title">Phase 4 – Exploitation des documents</div>
      <div class="phase-content">

        <div class="question">
          <p class="qline"><span class="badge">C1</span>4. <b>Relever</b> deux contraintes d’organisation et deux contraintes de milieu présentes dans la situation ?<span class="pts">4 points</span></p>
          <textarea class="reponse-eleve" data-qid="q_4_contraintes" rows="4" placeholder="Organisation : ... / Milieu : ..."></textarea>
        </div>

        <div class="question">
          <p class="qline"><span class="badge">C3</span>5. <b>Expliquer</b> pourquoi la rotation du tronc en charge augmente le risque de douleur lombaire ?<span class="pts">2 points</span></p>
          <textarea class="reponse-eleve" data-qid="q_5_rotation_risque" rows="3" placeholder="Écrire 2 à 4 phrases."></textarea>
        </div>

      </div>
    </section>

    <section class="phase">
      <div class="phase-title">Phase 5 – Retour à la situation : hypothèse et prévention</div>
      <div class="phase-content">

        <div class="question">
          <p class="qline"><span class="badge">C2</span>6. <b>Relier</b> deux causes probables à l’effet douleurs lombaires en construisant deux chaînes cause → activité → effet ?<span class="pts">2 points</span></p>
          <textarea class="reponse-eleve" data-qid="q_6_chainage" rows="4" placeholder="Chaîne 1 : ... / Chaîne 2 : ..."></textarea>
        </div>

        <div class="question">
          <p class="qline"><span class="badge">C2</span>7. <b>Formuler</b> une hypothèse complète qui résume la situation en une phrase ?<span class="pts">1 point</span></p>
          <textarea class="reponse-eleve" data-qid="q_7_hypothese" rows="2" placeholder="Il semble que ..."></textarea>
        </div>

        <div class="question">
          <p class="qline"><span class="badge">C4</span>8. <b>Proposer</b> trois mesures de prévention adaptées à la situation ?<span class="pts">1,5 point</span></p>
          <textarea class="reponse-eleve" data-qid="q_8_mesure_1" rows="2" placeholder="Mesure 1"></textarea>
          <div style="height:8px"></div>
          <textarea class="reponse-eleve" data-qid="q_8_mesure_2" rows="2" placeholder="Mesure 2"></textarea>
          <div style="height:8px"></div>
          <textarea class="reponse-eleve" data-qid="q_8_mesure_3" rows="2" placeholder="Mesure 3"></textarea>
        </div>

        <div class="question">
          <p class="qline"><span class="badge">C5</span>9. <b>Justifier</b> la mesure prioritaire en argumentant avec la situation et la hiérarchie de prévention ?<span class="pts">1,5 point</span></p>
          <textarea class="reponse-eleve" data-qid="q_9_justification" rows="4" placeholder="Je choisis ... car ..."></textarea>
        </div>

        <div class="submit-zone">
          <div class="status" id="statusMsg"></div>
          <button class="submit-btn" onclick="window.tenterEnvoi()">Envoyer au prof</button>
        </div>

      </div>
    </section>
  </div>

  <script>
    function autoResize(el) {
      if (!el) return;
      el.style.height = "auto";
      el.style.height = (el.scrollHeight + 2) + "px";
    }

    function initAutoResize() {
      document.querySelectorAll("textarea.reponse-eleve").forEach((t) => {
        autoResize(t);
        t.addEventListener("input", () => autoResize(t));
      });
    }

    function toast(msg) {
      const el = document.getElementById("statusMsg");
      if (el) el.textContent = msg;
    }

    function blockPaste() {
      function onPaste(e) {
        e.preventDefault();
        pasteStats.total++;
        pasteStats.external++;
        toast("Copier-coller interdit.");
        return false;
      }

      function onKeyDown(e) {
        const k = (e.key || "").toLowerCase();
        const isPaste = (e.ctrlKey || e.metaKey) && (k === "v");
        if (isPaste) {
          e.preventDefault();
          pasteStats.total++;
          pasteStats.external++;
          toast("Copier-coller interdit.");
          return false;
        }
      }

      document.addEventListener("paste", onPaste, true);
      document.addEventListener("keydown", onKeyDown, true);

      document.querySelectorAll("textarea.reponse-eleve").forEach((el) => {
        el.addEventListener("paste", onPaste, true);
      });
    }

    window.addEventListener("load", () => {
      initAutoResize();
      blockPaste();

      if (location.protocol === "file:") {
        toast("Ouvre ce devoir depuis l’URL GitHub (https), pas depuis un fichier local.");
      }
    });
  </script>
</body>
</html>
