<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ã‰valuation PSE - Module D2 - Budget et CrÃ©dit (AdaptÃ©)</title>
    <style>
        * { box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            max-width: 900px; 
            margin: 0 auto; 
            padding: 20px; 
            background-color: #f4f4f4; 
            color: #333;
            line-height: 1.6;
        }
        .container { 
            background-color: white; 
            padding: 30px; 
            box-shadow: 0 0 15px rgba(0,0,0,0.1); 
            border-radius: 10px; 
        }
        h1.main-title-editable { 
            color: #2c3e50; 
            text-align: center; 
            font-size: 1.5em; 
            margin-bottom: 25px; 
            border-bottom: 3px solid #3498db; 
            padding-bottom: 15px; 
        }
        .student-info { 
            background-color: #eef2f3; 
            padding: 15px; 
            border-radius: 8px; 
            margin-bottom: 25px; 
            text-align: center;
        }
        .student-info label { font-weight: bold; margin-right: 10px; }
        .student-info input { 
            padding: 8px 15px; 
            border: 2px solid #3498db; 
            border-radius: 5px; 
            font-size: 1.1em; 
            font-weight: bold;
            text-align: center;
            width: 150px;
        }
        
        /* Situation */
        .situation-box {
            background: linear-gradient(135deg, #e8f4fd 0%, #d6eaf8 100%);
            border-left: 5px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }
        .situation-box h2 { 
            color: #2980b9; 
            margin-top: 0; 
            font-size: 1.2em;
        }
        
        /* Documents */
        .doc-block {
            background: #fff;
            border: 2px solid #27ae60;
            border-radius: 10px;
            margin: 25px 0;
            overflow: hidden;
        }
        .doc-title {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            padding: 12px 20px;
            font-weight: bold;
            font-size: 1.1em;
        }
        .doc-content {
            padding: 15px;
        }
        
        /* Questions */
        .question-block {
            background: #fff;
            border: 1px solid #ddd;
            border-left: 4px solid #e74c3c;
            margin: 20px 0;
            padding: 20px;
            border-radius: 0 8px 8px 0;
        }
        .question-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .num-display {
            background: #e74c3c;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1em;
        }
        .comp-display {
            background: #27ae60;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }
        .points-display {
            background: #3498db;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
        }
        .question-text {
            font-size: 1.05em;
            margin-bottom: 15px;
        }
        .help-text {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 0.9em;
            color: #856404;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        /* Tableaux */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        th {
            background: #34495e;
            color: white;
            font-weight: bold;
        }
        .table-label {
            background: #ecf0f1;
            text-align: left;
            font-weight: 600;
            padding-left: 15px;
        }
        
        /* Cases Ã  cocher - CLASSE .reponse-eleve pour compatibilitÃ© runner */
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 10px 0;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .checkbox-item:hover {
            border-color: #3498db;
            background: #e8f4fd;
        }
        .checkbox-item input[type="checkbox"].reponse-eleve,
        .checkbox-item input[type="radio"].reponse-eleve {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        .checkbox-item label {
            cursor: pointer;
            font-size: 0.95em;
        }
        
        /* QCM dans tableau */
        td input[type="radio"].reponse-eleve,
        td input[type="checkbox"].reponse-eleve {
            width: 22px;
            height: 22px;
            cursor: pointer;
        }
        
        /* Bouton envoi */
        .submit-btn {
            display: block;
            margin: 40px auto;
            padding: 15px 50px;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }
        
        /* Responsive Mobile */
        @media (max-width: 700px) {
            body { padding: 8px; font-size: 0.95em; }
            .container { padding: 12px; }
            h1.main-title-editable { font-size: 1.2em; }
            
            .checkbox-group { flex-direction: column; gap: 10px; }
            .checkbox-item { padding: 12px; }
            .checkbox-item input[type="radio"],
            .checkbox-item input[type="checkbox"] { 
                width: 24px; height: 24px; /* Plus gros pour le doigt */
            }
            
            .question-header { flex-wrap: wrap; gap: 8px; }
            .num-display, .comp-display, .points-display { 
                font-size: 0.9em; 
                padding: 6px 10px; 
            }
            
            /* Tableaux scrollables */
            .table-wrapper {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            table {
                min-width: 400px;
                font-size: 0.85em;
            }
            th, td { padding: 8px 5px; }
            
            td input[type="radio"],
            td input[type="checkbox"] {
                width: 26px; height: 26px; /* Zone tactile plus grande */
            }
            
            .doc-title { font-size: 1em; padding: 10px 15px; }
            .help-text { font-size: 0.85em; padding: 8px 12px; }
            .submit-btn { 
                width: 90%; 
                padding: 18px; 
                font-size: 1.2em; 
            }
            
            .situation-box { padding: 15px; }
            .situation-box h2 { font-size: 1.1em; }
        }
        
        /* TrÃ¨s petit Ã©cran */
        @media (max-width: 400px) {
            body { padding: 5px; font-size: 0.9em; }
            .container { padding: 8px; }
            h1.main-title-editable { font-size: 1em; }
            .question-text { font-size: 0.95em; }
            table { min-width: 320px; font-size: 0.8em; }
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ğŸ¦® BARRE D'ACCESSIBILITÃ‰
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .accessibility-bar {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: linear-gradient(135deg, #1e3a5f 0%, #2c5282 100%);
            padding: 10px 15px;
            border-radius: 0 0 12px 12px;
            margin: -20px -30px 20px -30px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .accessibility-bar label {
            color: white;
            font-size: 0.85em;
            font-weight: bold;
            margin-right: 5px;
        }
        .access-btn {
            background: rgba(255,255,255,0.15);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: bold;
            transition: all 0.2s;
        }
        .access-btn:hover {
            background: rgba(255,255,255,0.25);
            border-color: white;
        }
        .access-btn.active {
            background: #48bb78;
            border-color: #48bb78;
        }
        .access-group {
            display: flex;
            gap: 5px;
            align-items: center;
            background: rgba(0,0,0,0.2);
            padding: 5px 10px;
            border-radius: 8px;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ğŸ”¤ MODE DYSLEXIE
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        body.mode-dyslexie {
            font-family: 'OpenDyslexic', 'Comic Sans MS', 'Arial', sans-serif;
            letter-spacing: 0.05em;
            word-spacing: 0.2em;
        }
        body.mode-dyslexie p,
        body.mode-dyslexie td,
        body.mode-dyslexie label,
        body.mode-dyslexie .question-text,
        body.mode-dyslexie .help-text {
            line-height: 1.8;
        }
        body.mode-dyslexie .checkbox-item label {
            letter-spacing: 0.03em;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ğŸ” MODE GROS TEXTE
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        body.mode-gros-texte {
            font-size: 1.25em;
        }
        body.mode-gros-texte h1 {
            font-size: 1.8em;
        }
        body.mode-gros-texte .question-text {
            font-size: 1.2em;
        }
        body.mode-gros-texte .checkbox-item {
            padding: 15px 20px;
        }
        body.mode-gros-texte input[type="radio"],
        body.mode-gros-texte input[type="checkbox"] {
            width: 28px !important;
            height: 28px !important;
        }
        body.mode-gros-texte table {
            font-size: 1.1em;
        }
        body.mode-gros-texte td input[type="radio"],
        body.mode-gros-texte td input[type="checkbox"] {
            width: 30px !important;
            height: 30px !important;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ğŸŒ™ MODE CONTRASTE Ã‰LEVÃ‰
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        body.mode-contraste {
            background-color: #000 !important;
            color: #ffff00 !important;
        }
        body.mode-contraste .container {
            background-color: #1a1a1a !important;
            border: 3px solid #ffff00;
        }
        body.mode-contraste h1,
        body.mode-contraste h2,
        body.mode-contraste strong {
            color: #00ffff !important;
        }
        body.mode-contraste .question-block {
            background: #1a1a1a !important;
            border-color: #ffff00 !important;
        }
        body.mode-contraste .checkbox-item {
            background: #2a2a2a !important;
            border-color: #ffff00 !important;
            color: #ffffff !important;
        }
        body.mode-contraste .checkbox-item:hover {
            background: #3a3a3a !important;
        }
        body.mode-contraste label {
            color: #ffffff !important;
        }
        body.mode-contraste .num-display {
            background: #ff6600 !important;
        }
        body.mode-contraste .comp-display {
            background: #00cc00 !important;
        }
        body.mode-contraste table {
            border-color: #ffff00 !important;
        }
        body.mode-contraste th {
            background: #004400 !important;
            color: #ffff00 !important;
        }
        body.mode-contraste td {
            background: #1a1a1a !important;
            color: #ffffff !important;
            border-color: #666 !important;
        }
        body.mode-contraste .table-label {
            background: #2a2a2a !important;
        }
        body.mode-contraste .doc-block {
            border-color: #00ff00 !important;
        }
        body.mode-contraste .doc-title {
            background: #004400 !important;
        }
        body.mode-contraste .help-text {
            background: #3a3a00 !important;
            border-color: #ffff00 !important;
            color: #ffff00 !important;
        }
        body.mode-contraste .situation-box {
            background: #1a2a3a !important;
            border-color: #00ffff !important;
        }
        body.mode-contraste .submit-btn {
            background: #006600 !important;
            border: 3px solid #00ff00 !important;
        }
        body.mode-contraste .accessibility-bar {
            background: #2a2a2a !important;
            border: 2px solid #ffff00;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ğŸ“ MODE INTERLIGNE LARGE
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        body.mode-interligne {
            line-height: 2.2;
        }
        body.mode-interligne p,
        body.mode-interligne td,
        body.mode-interligne label {
            line-height: 2.2;
            margin-bottom: 10px;
        }
        body.mode-interligne .checkbox-item {
            margin-bottom: 12px;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ğŸ¯ MODE FOCUS (surlignage ligne par ligne)
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        body.mode-focus .question-block:hover {
            box-shadow: 0 0 0 4px #3498db, 0 0 20px rgba(52, 152, 219, 0.4);
        }
        body.mode-focus .checkbox-item:hover {
            transform: scale(1.02);
            box-shadow: 0 0 0 3px #e74c3c;
        }
        body.mode-focus tr:hover td {
            background: #fff3cd !important;
        }
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ğŸ§® CALCULATRICE FLOTTANTE
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .calc-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            z-index: 9998;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .calc-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }
        .calc-toggle.active {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .calculator {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 220px;
            background: #2d3436;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 9999;
            display: none;
            cursor: move;
            user-select: none;
        }
        .calculator.visible {
            display: block;
            animation: calcSlideIn 0.2s ease-out;
        }
        @keyframes calcSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .calc-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid #636e72;
        }
        .calc-header span {
            color: #b2bec3;
            font-size: 0.75em;
            font-weight: bold;
        }
        .calc-close {
            background: #e74c3c;
            border: none;
            color: white;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.8em;
            line-height: 1;
        }
        .calc-display {
            background: #1e272e;
            color: #00d2d3;
            font-size: 1.8em;
            text-align: right;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            font-family: 'Courier New', monospace;
            min-height: 50px;
            word-break: break-all;
            overflow: hidden;
        }
        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }
        .calc-btn {
            background: #636e72;
            border: none;
            color: white;
            padding: 12px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background 0.15s, transform 0.1s;
        }
        .calc-btn:hover {
            background: #74b9ff;
        }
        .calc-btn:active {
            transform: scale(0.95);
        }
        .calc-btn.operator {
            background: #fdcb6e;
            color: #2d3436;
        }
        .calc-btn.operator:hover {
            background: #f9ca24;
        }
        .calc-btn.equals {
            background: #00b894;
            grid-column: span 2;
        }
        .calc-btn.equals:hover {
            background: #00cec9;
        }
        .calc-btn.clear {
            background: #d63031;
        }
        .calc-btn.clear:hover {
            background: #ff7675;
        }
        
        /* Responsive calculatrice */
        @media (max-width: 500px) {
            .calc-toggle {
                bottom: 15px;
                right: 15px;
                width: 45px;
                height: 45px;
                font-size: 1.3em;
            }
            .calculator {
                bottom: 70px;
                right: 10px;
                left: 10px;
                width: auto;
            }
        }
    </style>
</head>
<body data-id-exercice="devoir_D2_budget_adapte">
    <div class="container">
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             ğŸ¦® BARRE D'ACCESSIBILITÃ‰
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="accessibility-bar">
            <label>ğŸ¦® AccessibilitÃ© :</label>
            
            <div class="access-group">
                <button type="button" class="access-btn" onclick="toggleMode('dyslexie')" id="btn-dyslexie" title="Police adaptÃ©e dyslexie">
                    ğŸ”¤ Dyslexie
                </button>
                <button type="button" class="access-btn" onclick="toggleMode('gros-texte')" id="btn-gros-texte" title="Agrandir le texte">
                    ğŸ” Gros texte
                </button>
            </div>
            
            <div class="access-group">
                <button type="button" class="access-btn" onclick="toggleMode('contraste')" id="btn-contraste" title="Contraste Ã©levÃ© (fond noir)">
                    ğŸŒ™ Contraste
                </button>
                <button type="button" class="access-btn" onclick="toggleMode('interligne')" id="btn-interligne" title="Espacement des lignes">
                    ğŸ“ Interligne
                </button>
            </div>
            
            <div class="access-group">
                <button type="button" class="access-btn" onclick="toggleMode('focus')" id="btn-focus" title="Surlignage au survol">
                    ğŸ¯ Focus
                </button>
                <button type="button" class="access-btn" onclick="resetModes()" title="RÃ©initialiser">
                    â™»ï¸ Reset
                </button>
            </div>
        </div>
        
        <h1 class="main-title-editable">ğŸ“ Ã‰VALUATION PSE - MODULE D2 - Budget et CrÃ©dit (AdaptÃ©)</h1>
        
        <div class="student-info">
            <label for="code-eleve">ğŸ‘¤ CODE Ã‰LÃˆVE :</label>
            <input type="text" id="code-eleve" placeholder="Ex: AB12">
        </div>
        
        <!-- SITUATION -->
        <div class="situation-box">
            <h2>ğŸ“‹ SITUATION</h2>
            <p><strong>Lucas</strong>, 21 ans, travaille comme magasinier. Il gagne <strong>1 380 â‚¬</strong> par mois.</p>
            <p><strong>Manon</strong>, 20 ans, est Ã©tudiante. Elle a une bourse de <strong>120 â‚¬</strong> par mois.</p>
            <p>Ils vivent ensemble Ã  Lyon. Ils reÃ§oivent une aide au logement (APL) de <strong>180 â‚¬</strong>.</p>
            <p>Lucas veut acheter un <strong>scooter Ã  1 200 â‚¬</strong>. Manon dit : Â« <em>On a dÃ©jÃ  le loyer et les factures Ã  payer !</em> Â»</p>
        </div>
        
        <!-- QUESTION 1 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">1)</span>
                <span class="comp-display">C1</span>
                <span class="points-display">1 pt</span>
            </div>
            <div class="question-text"><strong>Cocher</strong> le problÃ¨me de Lucas et Manon.</div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="radio" name="q1" id="q1a" value="scooter" class="reponse-eleve" data-qid="q_0">
                    <label for="q1a">Comment acheter un scooter ?</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q1" id="q1b" value="gerer" class="reponse-eleve" data-qid="q_0">
                    <label for="q1b">Comment gÃ©rer son argent pour acheter le scooter ?</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q1" id="q1c" value="travail" class="reponse-eleve" data-qid="q_0">
                    <label for="q1c">Comment trouver un meilleur travail ?</label>
                </div>
            </div>
        </div>
        
        <!-- QUESTION 2 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">2)</span>
                <span class="comp-display">C2</span>
                <span class="points-display">2 pts</span>
            </div>
            <div class="question-text"><strong>Cocher</strong> les bonnes rÃ©ponses sur la situation.</div>
            <div class="table-wrapper"><table>
                <tr>
                    <th style="width:25%">Question</th>
                    <th>RÃ©ponse 1</th>
                    <th>RÃ©ponse 2</th>
                    <th>RÃ©ponse 3</th>
                </tr>
                <tr>
                    <td class="table-label">Qui ?</td>
                    <td><input type="radio" name="q2a" value="lucas" class="reponse-eleve" data-qid="q_2_qui"> Lucas</td>
                    <td><input type="radio" name="q2a" value="manon" class="reponse-eleve" data-qid="q_2_qui"> Manon</td>
                    <td><input type="radio" name="q2a" value="deux" class="reponse-eleve" data-qid="q_2_qui"> Les deux</td>
                </tr>
                <tr>
                    <td class="table-label">Acheter quoi ?</td>
                    <td><input type="radio" name="q2b" value="voiture" class="reponse-eleve" data-qid="q_2_quoi"> Voiture</td>
                    <td><input type="radio" name="q2b" value="scooter" class="reponse-eleve" data-qid="q_2_quoi"> Scooter</td>
                    <td><input type="radio" name="q2b" value="velo" class="reponse-eleve" data-qid="q_2_quoi"> VÃ©lo</td>
                </tr>
                <tr>
                    <td class="table-label">Prix ?</td>
                    <td><input type="radio" name="q2c" value="800" class="reponse-eleve" data-qid="q_2_prix"> 800 â‚¬</td>
                    <td><input type="radio" name="q2c" value="1200" class="reponse-eleve" data-qid="q_2_prix"> 1 200 â‚¬</td>
                    <td><input type="radio" name="q2c" value="2000" class="reponse-eleve" data-qid="q_2_prix"> 2 000 â‚¬</td>
                </tr>
                <tr>
                    <td class="table-label">ProblÃ¨me ?</td>
                    <td><input type="radio" name="q2d" value="permis" class="reponse-eleve" data-qid="q_2_probleme"> Pas le permis</td>
                    <td><input type="radio" name="q2d" value="factures" class="reponse-eleve" data-qid="q_2_probleme"> Des factures Ã  payer</td>
                    <td><input type="radio" name="q2d" value="ferme" class="reponse-eleve" data-qid="q_2_probleme"> Magasin fermÃ©</td>
                </tr>
            </table></div>
        </div>
        
        <!-- DOC A -->
        <div class="doc-block">
            <div class="doc-title">ğŸ“„ DOC A â€“ L'argent de Lucas et Manon chaque mois</div>
            <div class="doc-content">
                <div class="table-wrapper"><table>
                    <tr>
                        <th colspan="2" style="background:#27ae60;">CE QU'ILS GAGNENT</th>
                        <th colspan="2" style="background:#e74c3c;">CE QU'ILS DÃ‰PENSENT</th>
                    </tr>
                    <tr>
                        <td>Salaire de Lucas</td>
                        <td><strong>1 380 â‚¬</strong></td>
                        <td>Loyer</td>
                        <td><strong>520 â‚¬</strong></td>
                    </tr>
                    <tr>
                        <td>Bourse de Manon</td>
                        <td><strong>120 â‚¬</strong></td>
                        <td>Ã‰lectricitÃ© et eau</td>
                        <td><strong>65 â‚¬</strong></td>
                    </tr>
                    <tr>
                        <td>APL (aide)</td>
                        <td><strong>180 â‚¬</strong></td>
                        <td>Assurances</td>
                        <td><strong>95 â‚¬</strong></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td>TÃ©lÃ©phone / Internet</td>
                        <td><strong>70 â‚¬</strong></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td>Courses</td>
                        <td><strong>320 â‚¬</strong></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td>Essence</td>
                        <td><strong>80 â‚¬</strong></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td>Loisirs</td>
                        <td><strong>60 â‚¬</strong></td>
                    </tr>
                </table></div>
            </div>
        </div>
        
        <!-- QUESTION 3.1 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">3.1)</span>
                <span class="comp-display">C2</span>
                <span class="points-display">1 pt</span>
            </div>
            <div class="question-text">D'oÃ¹ vient l'argent ? <strong>Cocher</strong> la bonne colonne.</div>
            <div class="help-text">ğŸ’¡ Travail = argent gagnÃ© en travaillant | Aide = argent donnÃ© par l'Ã‰tat</div>
            <div class="table-wrapper"><table>
                <tr>
                    <th>Revenu</th>
                    <th>Travail</th>
                    <th>Aide de l'Ã‰tat</th>
                </tr>
                <tr>
                    <td class="table-label">Salaire de Lucas</td>
                    <td><input type="radio" name="q3a1" value="travail" class="reponse-eleve" data-qid="q_3_1_salaire"></td>
                    <td><input type="radio" name="q3a1" value="aide" class="reponse-eleve" data-qid="q_3_1_salaire"></td>
                </tr>
                <tr>
                    <td class="table-label">Bourse de Manon</td>
                    <td><input type="radio" name="q3a2" value="travail" class="reponse-eleve" data-qid="q_3_1_bourse"></td>
                    <td><input type="radio" name="q3a2" value="aide" class="reponse-eleve" data-qid="q_3_1_bourse"></td>
                </tr>
                <tr>
                    <td class="table-label">APL</td>
                    <td><input type="radio" name="q3a3" value="travail" class="reponse-eleve" data-qid="q_3_1_apl"></td>
                    <td><input type="radio" name="q3a3" value="aide" class="reponse-eleve" data-qid="q_3_1_apl"></td>
                </tr>
            </table></div>
        </div>
        
        <!-- QUESTION 3.2 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">3.2)</span>
                <span class="comp-display">C2</span>
                <span class="points-display">3 pts</span>
            </div>
            <div class="question-text">Type de dÃ©pense ? <strong>Cocher</strong> la bonne colonne.</div>
            <div class="help-text">ğŸ’¡ Obligatoire = on doit payer | Courante = tous les mois | Plaisir = pas obligatoire</div>
            <div class="table-wrapper"><table>
                <tr>
                    <th>DÃ©pense</th>
                    <th>Obligatoire</th>
                    <th>Courante</th>
                    <th>Plaisir</th>
                </tr>
                <tr>
                    <td class="table-label">Loyer</td>
                    <td><input type="radio" name="q3b1" value="oblig" class="reponse-eleve" data-qid="q_3_2_loyer"></td>
                    <td><input type="radio" name="q3b1" value="cour" class="reponse-eleve" data-qid="q_3_2_loyer"></td>
                    <td><input type="radio" name="q3b1" value="plaisir" class="reponse-eleve" data-qid="q_3_2_loyer"></td>
                </tr>
                <tr>
                    <td class="table-label">Ã‰lectricitÃ©</td>
                    <td><input type="radio" name="q3b2" value="oblig" class="reponse-eleve" data-qid="q_3_2_electricite"></td>
                    <td><input type="radio" name="q3b2" value="cour" class="reponse-eleve" data-qid="q_3_2_electricite"></td>
                    <td><input type="radio" name="q3b2" value="plaisir" class="reponse-eleve" data-qid="q_3_2_electricite"></td>
                </tr>
                <tr>
                    <td class="table-label">Assurances</td>
                    <td><input type="radio" name="q3b3" value="oblig" class="reponse-eleve" data-qid="q_3_2_assurances"></td>
                    <td><input type="radio" name="q3b3" value="cour" class="reponse-eleve" data-qid="q_3_2_assurances"></td>
                    <td><input type="radio" name="q3b3" value="plaisir" class="reponse-eleve" data-qid="q_3_2_assurances"></td>
                </tr>
                <tr>
                    <td class="table-label">TÃ©lÃ©phone</td>
                    <td><input type="radio" name="q3b4" value="oblig" class="reponse-eleve" data-qid="q_3_2_telephone"></td>
                    <td><input type="radio" name="q3b4" value="cour" class="reponse-eleve" data-qid="q_3_2_telephone"></td>
                    <td><input type="radio" name="q3b4" value="plaisir" class="reponse-eleve" data-qid="q_3_2_telephone"></td>
                </tr>
                <tr>
                    <td class="table-label">Courses</td>
                    <td><input type="radio" name="q3b5" value="oblig" class="reponse-eleve" data-qid="q_3_2_courses"></td>
                    <td><input type="radio" name="q3b5" value="cour" class="reponse-eleve" data-qid="q_3_2_courses"></td>
                    <td><input type="radio" name="q3b5" value="plaisir" class="reponse-eleve" data-qid="q_3_2_courses"></td>
                </tr>
                <tr>
                    <td class="table-label">Essence</td>
                    <td><input type="radio" name="q3b6" value="oblig" class="reponse-eleve" data-qid="q_3_2_essence"></td>
                    <td><input type="radio" name="q3b6" value="cour" class="reponse-eleve" data-qid="q_3_2_essence"></td>
                    <td><input type="radio" name="q3b6" value="plaisir" class="reponse-eleve" data-qid="q_3_2_essence"></td>
                </tr>
                <tr>
                    <td class="table-label">Loisirs</td>
                    <td><input type="radio" name="q3b7" value="oblig" class="reponse-eleve" data-qid="q_3_2_loisirs"></td>
                    <td><input type="radio" name="q3b7" value="cour" class="reponse-eleve" data-qid="q_3_2_loisirs"></td>
                    <td><input type="radio" name="q3b7" value="plaisir" class="reponse-eleve" data-qid="q_3_2_loisirs"></td>
                </tr>
            </table></div>
        </div>
        
        <!-- QUESTION 4 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">4.1)</span>
                <span class="comp-display">C3</span>
                <span class="points-display">1 pt</span>
            </div>
            <div class="question-text"><strong>Calculer</strong> puis <strong>cocher</strong> : Revenus = 1 380 + 120 + 180 = ?</div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="radio" name="q4a" value="1500" class="reponse-eleve" data-qid="q_4">
                    <label>1 500 â‚¬</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q4a" value="1680" class="reponse-eleve" data-qid="q_4">
                    <label>1 680 â‚¬</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q4a" value="1800" class="reponse-eleve" data-qid="q_4">
                    <label>1 800 â‚¬</label>
                </div>
            </div>
        </div>
        
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">4.2)</span>
                <span class="comp-display">C3</span>
                <span class="points-display">1 pt</span>
            </div>
            <div class="question-text"><strong>Calculer</strong> puis <strong>cocher</strong> : DÃ©penses = 520 + 65 + 95 + 70 + 320 + 80 + 60 = ?</div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="radio" name="q4b" value="1100" class="reponse-eleve" data-qid="q_5">
                    <label>1 100 â‚¬</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q4b" value="1210" class="reponse-eleve" data-qid="q_5">
                    <label>1 210 â‚¬</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q4b" value="1350" class="reponse-eleve" data-qid="q_5">
                    <label>1 350 â‚¬</label>
                </div>
            </div>
        </div>
        
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">4.3)</span>
                <span class="comp-display">C3</span>
                <span class="points-display">1 pt</span>
            </div>
            <div class="question-text"><strong>Calculer</strong> : Ce qui reste = Revenus â€“ DÃ©penses = ?</div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="radio" name="q4c" value="350" class="reponse-eleve" data-qid="q_6">
                    <label>350 â‚¬</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q4c" value="470" class="reponse-eleve" data-qid="q_6">
                    <label>470 â‚¬</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q4c" value="590" class="reponse-eleve" data-qid="q_6">
                    <label>590 â‚¬</label>
                </div>
            </div>
        </div>
        
        <!-- QUESTION 5 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">5)</span>
                <span class="comp-display">C3</span>
                <span class="points-display">1 pt</span>
            </div>
            <div class="question-text">Le budget est :</div>
            <div class="help-text">ğŸ’¡ Il reste de l'argent = excÃ©dentaire | Rien = Ã©quilibrÃ© | Il manque = dÃ©ficitaire</div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="radio" name="q5" value="excedentaire" class="reponse-eleve" data-qid="q_7">
                    <label>ExcÃ©dentaire</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q5" value="equilibre" class="reponse-eleve" data-qid="q_7">
                    <label>Ã‰quilibrÃ©</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q5" value="deficitaire" class="reponse-eleve" data-qid="q_7">
                    <label>DÃ©ficitaire</label>
                </div>
            </div>
        </div>
        
        <!-- DOC B -->
        <div class="doc-block">
            <div class="doc-title">ğŸ“„ DOC B â€“ OÃ¹ mettre son argent de cÃ´tÃ© ?</div>
            <div class="doc-content">
                <div class="table-wrapper"><table>
                    <tr>
                        <th>Nom</th>
                        <th>IntÃ©rÃªt</th>
                        <th>Pour qui ?</th>
                        <th>Disponible ?</th>
                    </tr>
                    <tr>
                        <td><strong>Livret A</strong></td>
                        <td>3 %</td>
                        <td>Tout le monde</td>
                        <td>Oui</td>
                    </tr>
                    <tr>
                        <td><strong>Livret Jeune</strong></td>
                        <td>3 % ou +</td>
                        <td>12 Ã  25 ans</td>
                        <td>Oui</td>
                    </tr>
                    <tr>
                        <td><strong>LEP</strong></td>
                        <td>5 %</td>
                        <td>Petits revenus</td>
                        <td>Oui</td>
                    </tr>
                    <tr>
                        <td><strong>PEL</strong></td>
                        <td>2,25 %</td>
                        <td>Tout le monde</td>
                        <td>Non (bloquÃ© 4 ans)</td>
                    </tr>
                </table></div>
            </div>
        </div>
        
        <!-- QUESTION 6 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">6)</span>
                <span class="comp-display">C4</span>
                <span class="points-display">2 pts</span>
            </div>
            <div class="question-text">Quelle Ã©pargne pour Manon (20 ans, Ã©tudiante) ? <strong>Cocher.</strong></div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="radio" name="q6" value="livretA" class="reponse-eleve" data-qid="q_8">
                    <label>Livret A</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q6" value="livretJeune" class="reponse-eleve" data-qid="q_8">
                    <label>Livret Jeune</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q6" value="lep" class="reponse-eleve" data-qid="q_8">
                    <label>LEP</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q6" value="pel" class="reponse-eleve" data-qid="q_8">
                    <label>PEL</label>
                </div>
            </div>
        </div>
        
        <!-- DOC C -->
        <div class="doc-block">
            <div class="doc-title">ğŸ“„ DOC C â€“ Deux offres de crÃ©dit pour le scooter (1 200 â‚¬)</div>
            <div class="doc-content">
                <div class="table-wrapper"><table>
                    <tr>
                        <th></th>
                        <th style="background:#3498db;">OFFRE A (Magasin)</th>
                        <th style="background:#e74c3c;">OFFRE B (Internet)</th>
                    </tr>
                    <tr>
                        <td class="table-label">DurÃ©e</td>
                        <td>6 mois</td>
                        <td>10 mois</td>
                    </tr>
                    <tr>
                        <td class="table-label">Ã€ payer / mois</td>
                        <td>205 â‚¬</td>
                        <td>128 â‚¬</td>
                    </tr>
                    <tr>
                        <td class="table-label">Total Ã  rembourser</td>
                        <td><strong>1 230 â‚¬</strong></td>
                        <td><strong>1 280 â‚¬</strong></td>
                    </tr>
                </table></div>
            </div>
        </div>
        
        <!-- QUESTION 7.1 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">7.1)</span>
                <span class="comp-display">C4</span>
                <span class="points-display">1 pt</span>
            </div>
            <div class="question-text">Lucas paye 520 â‚¬ de loyer et gagne 1 380 â‚¬. Calcul : 520 Ã· 1 380 Ã— 100 = ?</div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="radio" name="q7a" value="25" class="reponse-eleve" data-qid="q_9">
                    <label>Environ 25 %</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q7a" value="38" class="reponse-eleve" data-qid="q_9">
                    <label>Environ 38 %</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q7a" value="50" class="reponse-eleve" data-qid="q_9">
                    <label>Environ 50 %</label>
                </div>
            </div>
        </div>
        
        <!-- QUESTION 7.2 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">7.2)</span>
                <span class="comp-display">C4</span>
                <span class="points-display">1 pt</span>
            </div>
            <div class="question-text">Si c'est entre 33 % et 40 %, Lucas peut emprunter :</div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="radio" name="q7b" value="sans" class="reponse-eleve" data-qid="q_10">
                    <label>Sans problÃ¨me</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q7b" value="prudence" class="reponse-eleve" data-qid="q_10">
                    <label>Avec prudence</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q7b" value="non" class="reponse-eleve" data-qid="q_10">
                    <label>Non, trop risquÃ©</label>
                </div>
            </div>
        </div>
        
        <!-- QUESTION 7.3 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">7.3)</span>
                <span class="comp-display">C4</span>
                <span class="points-display">1 pt</span>
            </div>
            <div class="question-text">Quelle offre coÃ»te le moins cher au total ?</div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="radio" name="q7c" value="A" class="reponse-eleve" data-qid="q_11">
                    <label>Offre A (1 230 â‚¬)</label>
                </div>
                <div class="checkbox-item">
                    <input type="radio" name="q7c" value="B" class="reponse-eleve" data-qid="q_11">
                    <label>Offre B (1 280 â‚¬)</label>
                </div>
            </div>
        </div>
        
        <!-- QUESTION 8 -->
        <div class="question-block">
            <div class="question-header">
                <span class="num-display">8)</span>
                <span class="comp-display">C5</span>
                <span class="points-display">2 pts</span>
            </div>
            <div class="question-text">Pourquoi l'offre A est meilleure ? <strong>Cocher 2 raisons.</strong></div>
            <div class="checkbox-group" style="flex-direction: column;">
                <div class="checkbox-item">
                    <input type="checkbox" name="q8" value="moins_cher" class="reponse-eleve" data-qid="q_12">
                    <label>Le total est moins cher (1 230 â‚¬ au lieu de 1 280 â‚¬)</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" name="q8" value="plus_vite" class="reponse-eleve" data-qid="q_12">
                    <label>On rembourse plus vite (6 mois au lieu de 10 mois)</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" name="q8" value="mensualite" class="reponse-eleve" data-qid="q_12">
                    <label>La mensualitÃ© est moins chÃ¨re (205 â‚¬ au lieu de 128 â‚¬)</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" name="q8" value="economie" class="reponse-eleve" data-qid="q_12">
                    <label>On Ã©conomise 50 â‚¬ par rapport Ã  l'offre B</label>
                </div>
            </div>
        </div>
        
        <button class="submit-btn" onclick="window.tenterEnvoi()">ğŸ“¤ Envoyer au prof</button>
    </div>
    
    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ¦® GESTION DE L'ACCESSIBILITÃ‰
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        const MODES = ['dyslexie', 'gros-texte', 'contraste', 'interligne', 'focus'];
        
        // Charger les prÃ©fÃ©rences sauvegardÃ©es
        function loadAccessibilityPrefs() {
            MODES.forEach(mode => {
                const saved = localStorage.getItem('access_' + mode);
                if (saved === 'true') {
                    document.body.classList.add('mode-' + mode);
                    const btn = document.getElementById('btn-' + mode);
                    if (btn) btn.classList.add('active');
                }
            });
        }
        
        // Activer/DÃ©sactiver un mode
        function toggleMode(mode) {
            const className = 'mode-' + mode;
            const btn = document.getElementById('btn-' + mode);
            
            if (document.body.classList.contains(className)) {
                document.body.classList.remove(className);
                if (btn) btn.classList.remove('active');
                localStorage.setItem('access_' + mode, 'false');
            } else {
                document.body.classList.add(className);
                if (btn) btn.classList.add('active');
                localStorage.setItem('access_' + mode, 'true');
            }
        }
        
        // RÃ©initialiser tous les modes
        function resetModes() {
            MODES.forEach(mode => {
                document.body.classList.remove('mode-' + mode);
                const btn = document.getElementById('btn-' + mode);
                if (btn) btn.classList.remove('active');
                localStorage.setItem('access_' + mode, 'false');
            });
        }
        
        // Charger au dÃ©marrage
        document.addEventListener('DOMContentLoaded', loadAccessibilityPrefs);
        
        // Exposer les fonctions
        window.toggleMode = toggleMode;
        window.resetModes = resetModes;
    </script>
    
    <script>
        // Enregistrer le temps de dÃ©but
        const DEVOIR_ID = "devoir_D2_budget_adapte";
        localStorage.setItem('devoir_start_time_' + DEVOIR_ID, Date.now());
        
        // Stats copier-coller (vide car QCM)
        let pasteStats = { total: 0, external: 0, document: 0 };
    </script>
    
    <!-- Charger l'annuaire -->
    <script type="module">
        import("............/annuaire.js")
            .then(async () => {
                console.log("âœ… Annuaire chargÃ©");
                if(typeof window.demanderCode === 'function') {
                    const user = await window.demanderCode("D2 Budget AdaptÃ©");
                    if(user && user.code) {
                        document.getElementById('code-eleve').value = user.code;
                        window.eleveData = user;
                    }
                }
            })
            .catch(e => console.warn("âš ï¸ Annuaire non chargÃ©:", e));
    </script>
    
    <!-- Charger le runner -->
    <script type="module">
        import("../assets/pse-runner.js")
            .then(() => console.log("âœ… Runner chargÃ© !"))
            .catch(e => {
                console.error("âŒ Runner non chargÃ©:", e);
                alert("âš ï¸ Impossible de charger le systÃ¨me d'envoi.\nVÃ©rifiez votre connexion internet.");
            });
    </script>
    
    <script>
        window.tenterEnvoi = async function() {
            const codeInput = document.getElementById('code-eleve');
            const code = codeInput.value.trim().toUpperCase();
            
            // Validation du code
            if(!code || code.length < 3) {
                alert("âš ï¸ CODE Ã‰LÃˆVE MANQUANT\n\nVous devez saisir votre code Ã©lÃ¨ve avant d'envoyer.");
                codeInput.focus();
                codeInput.style.border = "3px solid red";
                setTimeout(() => codeInput.style.border = "", 2000);
                return;
            }
            
            // VÃ©rifier l'annuaire si disponible
            let eleveData = window.eleveData || null;
            if(typeof ANNUAIRE !== 'undefined') {
                const classe = ANNUAIRE[code];
                if(classe) {
                    eleveData = { code: code, classe: classe };
                } else {
                    alert("âŒ CODE INVALIDE\n\nLe code Â« " + code + " Â» n'existe pas dans l'annuaire.\n\nVÃ©rifiez votre code ou contactez votre professeur.");
                    codeInput.focus();
                    codeInput.select();
                    return;
                }
            }
            
            // Confirmation
            const radios = document.querySelectorAll('input[type="radio"].reponse-eleve:checked, input[type="checkbox"].reponse-eleve:checked');
            
            let msg = "ğŸ“¤ CONFIRMER L'ENVOI\n\n";
            msg += "ğŸ‘¤ Code : " + code + "\n";
            if(eleveData?.classe) msg += "ğŸ« Classe : " + eleveData.classe + "\n";
            msg += "ğŸ“ RÃ©ponses cochÃ©es : " + radios.length + "\n";
            
            if(radios.length < 5) {
                msg += "\nâš ï¸ Attention : TrÃ¨s peu de rÃ©ponses !";
            }
            
            if(!confirm(msg + "\n\nEnvoyer ?")) return;
            
            // Appel du runner avec la bonne signature !
            if(typeof window.envoyerCopie === 'function') {
                await window.envoyerCopie(code, pasteStats, eleveData);
            } else {
                alert("âŒ SystÃ¨me d'envoi non disponible.\nRechargez la page et rÃ©essayez.");
            }
        };
    </script>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         ğŸ§® CALCULATRICE FLOTTANTE
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <button class="calc-toggle" id="calcToggle" title="Calculatrice">ğŸ§®</button>
    
    <div class="calculator" id="calculator">
        <div class="calc-header">
            <span>ğŸ§® CALCULATRICE</span>
            <button class="calc-close" onclick="toggleCalculator()">âœ•</button>
        </div>
        <div class="calc-display" id="calcDisplay">0</div>
        <div class="calc-buttons">
            <button class="calc-btn clear" onclick="calcClear()">C</button>
            <button class="calc-btn" onclick="calcBackspace()">âŒ«</button>
            <button class="calc-btn operator" onclick="calcInput('%')">%</button>
            <button class="calc-btn operator" onclick="calcInput('/')">Ã·</button>
            
            <button class="calc-btn" onclick="calcInput('7')">7</button>
            <button class="calc-btn" onclick="calcInput('8')">8</button>
            <button class="calc-btn" onclick="calcInput('9')">9</button>
            <button class="calc-btn operator" onclick="calcInput('*')">Ã—</button>
            
            <button class="calc-btn" onclick="calcInput('4')">4</button>
            <button class="calc-btn" onclick="calcInput('5')">5</button>
            <button class="calc-btn" onclick="calcInput('6')">6</button>
            <button class="calc-btn operator" onclick="calcInput('-')">âˆ’</button>
            
            <button class="calc-btn" onclick="calcInput('1')">1</button>
            <button class="calc-btn" onclick="calcInput('2')">2</button>
            <button class="calc-btn" onclick="calcInput('3')">3</button>
            <button class="calc-btn operator" onclick="calcInput('+')">+</button>
            
            <button class="calc-btn" onclick="calcInput('0')">0</button>
            <button class="calc-btn" onclick="calcInput('.')">.</button>
            <button class="calc-btn equals" onclick="calcEquals()">=</button>
        </div>
    </div>
    
    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ§® CALCULATRICE - Logique
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        let calcExpression = '';
        let calcResult = '0';
        
        function toggleCalculator() {
            const calc = document.getElementById('calculator');
            const btn = document.getElementById('calcToggle');
            calc.classList.toggle('visible');
            btn.classList.toggle('active');
        }
        
        document.getElementById('calcToggle').addEventListener('click', toggleCalculator);
        
        function updateDisplay() {
            const display = document.getElementById('calcDisplay');
            display.textContent = calcExpression || calcResult;
        }
        
        function calcInput(val) {
            // Ã‰viter les opÃ©rateurs en dÃ©but ou doublons
            const ops = ['+', '-', '*', '/', '%'];
            if (ops.includes(val) && (calcExpression === '' || ops.includes(calcExpression.slice(-1)))) {
                if (calcExpression === '' && calcResult !== '0') {
                    calcExpression = calcResult + val;
                } else if (calcExpression !== '') {
                    calcExpression = calcExpression.slice(0, -1) + val;
                }
            } else {
                calcExpression += val;
            }
            updateDisplay();
        }
        
        function calcClear() {
            calcExpression = '';
            calcResult = '0';
            updateDisplay();
        }
        
        function calcBackspace() {
            calcExpression = calcExpression.slice(0, -1);
            updateDisplay();
        }
        
        function calcEquals() {
            if (!calcExpression) return;
            try {
                // SÃ©curitÃ© : n'Ã©valuer que des expressions mathÃ©matiques
                if (!/^[\d+\-*/.%() ]+$/.test(calcExpression)) {
                    calcResult = 'Erreur';
                } else {
                    let result = eval(calcExpression);
                    // Arrondir Ã  4 dÃ©cimales max
                    result = Math.round(result * 10000) / 10000;
                    calcResult = String(result);
                }
            } catch (e) {
                calcResult = 'Erreur';
            }
            calcExpression = '';
            updateDisplay();
        }
        
        // Permettre le clavier
        document.addEventListener('keydown', (e) => {
            const calc = document.getElementById('calculator');
            if (!calc.classList.contains('visible')) return;
            
            if (e.key >= '0' && e.key <= '9') calcInput(e.key);
            else if (['+', '-', '*', '/', '%', '.'].includes(e.key)) calcInput(e.key);
            else if (e.key === 'Enter') { e.preventDefault(); calcEquals(); }
            else if (e.key === 'Escape') toggleCalculator();
            else if (e.key === 'Backspace') calcBackspace();
            else if (e.key === 'c' || e.key === 'C') calcClear();
        });
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ–±ï¸ DRAG & DROP - DÃ©placer la calculatrice
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        (function() {
            const calc = document.getElementById('calculator');
            let isDragging = false;
            let offsetX, offsetY;
            
            calc.addEventListener('mousedown', (e) => {
                if (e.target.tagName === 'BUTTON') return; // Ne pas drag si clic bouton
                isDragging = true;
                offsetX = e.clientX - calc.getBoundingClientRect().left;
                offsetY = e.clientY - calc.getBoundingClientRect().top;
                calc.style.cursor = 'grabbing';
            });
            
            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                const x = e.clientX - offsetX;
                const y = e.clientY - offsetY;
                calc.style.left = x + 'px';
                calc.style.top = y + 'px';
                calc.style.right = 'auto';
                calc.style.bottom = 'auto';
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
                calc.style.cursor = 'move';
            });
            
            // Touch support (mobile)
            calc.addEventListener('touchstart', (e) => {
                if (e.target.tagName === 'BUTTON') return;
                isDragging = true;
                const touch = e.touches[0];
                offsetX = touch.clientX - calc.getBoundingClientRect().left;
                offsetY = touch.clientY - calc.getBoundingClientRect().top;
            }, { passive: true });
            
            document.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                const touch = e.touches[0];
                const x = touch.clientX - offsetX;
                const y = touch.clientY - offsetY;
                calc.style.left = x + 'px';
                calc.style.top = y + 'px';
                calc.style.right = 'auto';
                calc.style.bottom = 'auto';
            }, { passive: true });
            
            document.addEventListener('touchend', () => {
                isDragging = false;
            });
        })();
    </script>
</body>
</html>
