<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSE - Ã‰valuation PSE : L'addiction au tÃ©lÃ©phone portable et les risques numÃ©riques</title>
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://firestore.googleapis.com" crossorigin>
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #f0f2f5 0%, #e8ecef 100%); 
            color: #1a1a2e; line-height: 1.6; padding: 12px; 
            min-height: 100vh;
        }
        .container { 
            max-width: 900px; margin: 0 auto; background: #fff; 
            border-radius: 16px; box-shadow: 0 8px 32px rgba(0,0,0,0.12); overflow: hidden; 
        }
        .header { 
            background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 50%, #74b9ff 100%); 
            color: #fff; padding: 32px 30px; text-align: center; 
            position: relative; overflow: hidden;
        }
        .header::before {
            content: ''; position: absolute; top: -50%; left: -50%;
            width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: headerShimmer 6s ease-in-out infinite;
        }
        @keyframes headerShimmer {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
        }
        .header h1 { font-size: 1.6em; margin-bottom: 6px; font-weight: 700; position: relative; z-index: 1; }
        .header .subtitle { font-size: 1.05em; opacity: 0.95; position: relative; z-index: 1; }
        
        .competences-box { 
            background: linear-gradient(135deg, #f8f9ff 0%, #f0f4ff 100%); 
            border-left: 5px solid #6c5ce7; margin: 24px 28px; padding: 18px 22px; 
            border-radius: 0 10px 10px 0; box-shadow: 0 4px 15px rgba(108, 92, 231, 0.08);
        }
        .competences-box h3 { color: #6c5ce7; margin-bottom: 12px; font-size: 1em; font-weight: 600; }
        .competences-box ul { list-style: none; padding: 0; display:flex; gap:12px; flex-wrap:wrap; }
        .comp-tag { 
            display: inline-block; background: linear-gradient(135deg, #6c5ce7, #8b5cf6); 
            color: #fff; padding: 2px 12px; border-radius: 6px; font-weight: 600; 
            font-size: 0.8em; box-shadow: 0 2px 4px rgba(108, 92, 231, 0.2);
        }
        .body-content { padding: 0 28px 28px; }
        .identification { 
            background: linear-gradient(135deg, #fff3e0 0%, #fff8f1 100%); 
            border: 2px solid #ff9800; border-radius: 12px; padding: 18px 22px; 
            margin: 24px 0; box-shadow: 0 4px 12px rgba(255, 152, 0, 0.1);
        }
        .identification h3 { color: #e65100; margin-bottom: 12px; font-weight: 600; }
        .identification label { font-weight: 600; font-size: 0.9em; margin-right:12px; }
        .identification input { 
            padding: 10px 14px; border: 2px solid #ffcc80; border-radius: 8px; 
            font-size: 0.95em; width: 200px; text-transform: uppercase; 
            transition: all 0.2s ease; font-weight: 600;
        }
        .identification input:focus {
            border-color: #ff9800; outline: none; 
            box-shadow: 0 0 0 3px rgba(255, 152, 0, 0.1);
            transform: translateY(-1px);
        }
        
        .document-box { 
            background: linear-gradient(135deg, #fff8e1 0%, #fffbef 100%); 
            border: 1px solid #ffc107; border-radius: 10px; padding: 16px 20px; 
            margin: 16px 0; font-size: 0.9em; border-left: 6px solid #ffb74d; 
            box-shadow: 0 3px 10px rgba(255, 193, 7, 0.1);
        }
        .document-box h4 { 
            color: #f57f17; margin-bottom: 10px; font-size: 1.1em; 
            border-bottom: 2px solid #ffe0b2; padding-bottom: 6px; font-weight: 600;
        }

        .question-block { 
            background: linear-gradient(135deg, #fafbff 0%, #f8fafc 100%); 
            border: 2px solid #e2e8f0; border-radius: 12px; padding: 18px 20px; 
            margin: 16px 0; box-shadow: 0 4px 15px rgba(0,0,0,0.06);
            transition: all 0.2s ease;
        }
        .question-block:hover {
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        .q-label { 
            display: inline-block; background: linear-gradient(135deg, #6c5ce7, #8b5cf6); 
            color: #fff; width: 32px; height: 32px; line-height: 32px; text-align: center; 
            border-radius: 50%; font-size: 0.85em; font-weight: bold; margin-right: 10px; 
            box-shadow: 0 3px 8px rgba(108, 92, 231, 0.3);
        }
        .q-comp { 
            display: inline-block; background: linear-gradient(135deg, #e8eaf6, #f3e5f5); 
            color: #3949ab; padding: 3px 10px; border-radius: 6px; font-size: 0.75em; 
            font-weight: 600; margin-left: 8px; 
        }
        .q-points { 
            float: right; background: linear-gradient(135deg, #e0f7fa, #e1f5fe); 
            color: #006064; padding: 3px 12px; border-radius: 15px; font-size: 0.78em; 
            font-weight: 600; 
        }
        .q-text { 
            margin: 12px 0; font-size: 0.95em; font-weight: 500; color: #2c3e50; 
            line-height: 1.6;
        }
        
        .checkbox-group { display: flex; flex-direction: column; gap: 10px; margin-top: 12px; }
        .checkbox-group label { 
            display: flex; align-items: center; gap: 12px; padding: 12px 16px; 
            background: linear-gradient(135deg, #fff 0%, #fafafa 100%); 
            border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; 
            font-size: 0.9em; transition: all 0.2s ease;
        }
        .checkbox-group label:hover { 
            background: linear-gradient(135deg, #f3f0ff, #f8f5ff); 
            border-color: #a29bfe; transform: translateX(4px);
        }
        .checkbox-group input { width: 20px; height: 20px; accent-color: #6c5ce7; }
        
        .answer-input { 
            padding: 12px 16px; border: 3px solid #d1c4e9; border-radius: 8px; 
            font-size: 0.95em; width: 100%; max-width: 320px; 
            transition: all 0.2s ease; font-weight: 500;
            resize: none; overflow: hidden; min-height: 40px;
        }
        .answer-input:focus {
            border-color: #6c5ce7; outline: none;
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.1);
            transform: translateY(-1px);
        }
        .answer-select { 
            padding: 12px 16px; border: 3px solid #d1c4e9; border-radius: 8px; 
            font-size: 0.95em; background: #fff; width: 100%; font-weight: 500;
            transition: all 0.2s ease;
        }
        .answer-select:focus {
            border-color: #6c5ce7; outline: none;
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.1);
        }
        
        .eval-table { 
            width: 100%; border-collapse: collapse; font-size: 0.9em; 
            margin-top: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border-radius: 8px; overflow: hidden;
        }
        .eval-table td { 
            padding: 12px; border-bottom: 1px solid #f0f0f0; 
            background: linear-gradient(135deg, #fff 0%, #fafafa 100%);
        }
        
        .submit-section { text-align: center; margin: 40px 0; }
        .submit-btn { 
            background: linear-gradient(135deg, #6c5ce7, #a29bfe); color: #fff; 
            border: none; padding: 16px 48px; font-size: 1.1em; font-weight: 700; 
            border-radius: 50px; cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            box-shadow: 0 8px 25px rgba(108, 92, 231, 0.3);
            position: relative; overflow: hidden;
        }
        .submit-btn::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        .submit-btn:hover::before { left: 100%; }
        .submit-btn:hover { 
            transform: translateY(-3px) scale(1.02); 
            box-shadow: 0 12px 35px rgba(108, 92, 231, 0.4); 
        }
        .submit-btn:disabled { 
            background: #bbb; cursor: not-allowed; transform: none; 
            box-shadow: none;
        }
        
        /* ANIMATIONS */
        .question-block { animation: slideInUp 0.5s ease-out; }
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* RESPONSIVE */
        @media (max-width: 768px) {
            .body-content { padding: 0 16px 16px; }
            .competences-box { margin: 16px; }
            .identification { margin: 16px 0; padding: 16px; }
            .question-block { margin: 12px 0; padding: 16px; }
        }

        /* â”€â”€ OVERLAY IDENTIFICATION â”€â”€ */
        .pse-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #4338ca 100%);
            z-index: 9999; display: flex; align-items: center; justify-content: center;
            padding: 20px;
        }
        .pse-overlay.hidden { display: none; }
        .pse-overlay-box {
            background: #fff; border-radius: 20px; padding: 40px 36px; max-width: 440px;
            width: 100%; text-align: center; box-shadow: 0 25px 60px rgba(0,0,0,0.3);
            animation: popIn 0.4s ease-out;
        }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        .pse-overlay-box h2 { color: #312e81; margin-bottom: 8px; font-size: 1.4em; }
        .pse-overlay-box .sub { color: #64748b; font-size: 0.9em; margin-bottom: 24px; }
        .pse-overlay-box input {
            display: block; width: 100%; padding: 14px 18px; border: 3px solid #c7d2fe;
            border-radius: 12px; font-size: 1.1em; text-align: center; text-transform: uppercase;
            font-weight: 700; letter-spacing: 2px; transition: all 0.2s;
        }
        .pse-overlay-box input:focus { border-color: #6366f1; outline: none; box-shadow: 0 0 0 4px rgba(99,102,241,0.15); }
        .pse-overlay-box input.shake { animation: shake 0.4s; border-color: #ef4444; }
        @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-8px)} 75%{transform:translateX(8px)} }
        .pse-overlay-box .err { color: #ef4444; font-size: 0.85em; margin-top: 8px; display: none; }
        .pse-overlay-box .btn-go {
            display: block; width: 100%; margin-top: 20px; padding: 14px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6); color: #fff;
            border: none; border-radius: 12px; font-size: 1em; font-weight: 700;
            cursor: pointer; transition: all 0.2s;
        }
        .pse-overlay-box .btn-go:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(99,102,241,0.3); }

        /* â”€â”€ AVERTISSEMENT ANTI-TRICHE â”€â”€ */
        .pse-warning-box {
            background: #fff; border-radius: 20px; padding: 36px; max-width: 500px;
            width: 100%; box-shadow: 0 25px 60px rgba(0,0,0,0.3);
            animation: popIn 0.4s ease-out;
        }
        .pse-warning-box h2 { color: #dc2626; margin-bottom: 16px; }
        .pse-warning-box ul { text-align: left; margin: 16px 0; padding-left: 0; list-style: none; }
        .pse-warning-box li { padding: 8px 0; font-size: 0.95em; border-bottom: 1px solid #f1f5f9; }
        .pse-warning-box li::before { margin-right: 8px; }
        .pse-warning-box .btn-accept {
            display: block; width: 100%; margin-top: 20px; padding: 14px;
            background: linear-gradient(135deg, #059669, #10b981); color: #fff;
            border: none; border-radius: 12px; font-size: 1em; font-weight: 700;
            cursor: pointer; transition: all 0.2s;
        }
        .pse-warning-box .btn-accept:hover { transform: translateY(-2px); }

        /* â”€â”€ ALERTE SORTIE DE PAGE â”€â”€ */
        .pse-leave-toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: linear-gradient(135deg, #dc2626, #b91c1c); color: #fff;
            padding: 16px 28px; border-radius: 12px; font-weight: 600; font-size: 0.95em;
            z-index: 10000; box-shadow: 0 8px 30px rgba(220,38,38,0.4);
            animation: toastIn 0.4s ease-out; display: none;
        }
        @keyframes toastIn { from { opacity:0; transform:translateX(-50%) translateY(-20px); } to { opacity:1; transform:translateX(-50%) translateY(0); } }

        /* â”€â”€ MODAL CONFIRMATION ENVOI â”€â”€ */
        .pse-confirm-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.5); z-index: 9998;
            display: none; align-items: center; justify-content: center; padding: 20px;
            backdrop-filter: blur(4px);
        }
        .pse-confirm-overlay.active { display: flex; }
        .pse-confirm-box {
            background: #fff; border-radius: 16px; padding: 32px; max-width: 480px;
            width: 100%; box-shadow: 0 20px 50px rgba(0,0,0,0.25); animation: popIn 0.3s ease-out;
        }
        .pse-confirm-box h3 { margin-bottom: 16px; color: #1e293b; }
        .pse-confirm-box .missing-list { background: #fef2f2; border-radius: 8px; padding: 12px 16px; margin: 12px 0; color: #991b1b; font-size: 0.9em; }
        .pse-confirm-box .btn-row { display: flex; gap: 12px; margin-top: 20px; }
        .pse-confirm-box .btn-row button { flex: 1; padding: 12px; border: none; border-radius: 10px; font-weight: 700; font-size: 0.95em; cursor: pointer; }
        .pse-confirm-box .btn-cancel { background: #f1f5f9; color: #475569; }
        .pse-confirm-box .btn-send { background: linear-gradient(135deg, #6366f1, #8b5cf6); color: #fff; }

        /* â”€â”€ RÃ‰CÃ‰PISSÃ‰ â”€â”€ */
        .pse-recepisse {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6); z-index: 9999;
            display: none; align-items: center; justify-content: center; padding: 20px;
        }
        .pse-recepisse.active { display: flex; }
        .pse-recepisse-box {
            background: #fff; border-radius: 16px; padding: 36px; max-width: 460px;
            width: 100%; box-shadow: 0 20px 50px rgba(0,0,0,0.25); text-align: center;
        }
        .pse-recepisse-box .check-icon { font-size: 3em; margin-bottom: 12px; }
        .pse-recepisse-box h2 { color: #059669; margin-bottom: 16px; }
        .pse-recepisse-box .info-grid { text-align: left; margin: 20px 0; }
        .pse-recepisse-box .info-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f1f5f9; font-size: 0.95em; }
        .pse-recepisse-box .info-label { color: #64748b; }
        .pse-recepisse-box .info-value { font-weight: 600; color: #1e293b; }
        .pse-recepisse-box .btn-print {
            margin-top: 20px; padding: 12px 32px; background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: #fff; border: none; border-radius: 10px; font-weight: 700; cursor: pointer;
        }
        @media print {
            body > * { display: none !important; }
            .pse-recepisse, .pse-recepisse * { display: block !important; }
            .pse-recepisse { position: static !important; background: none !important; }
            .pse-recepisse-box { box-shadow: none !important; max-width: 100% !important; }
            .pse-recepisse-box .btn-print { display: none !important; }
        }
        /* â”€â”€ ChronomÃ¨tre â”€â”€ */
        .pse-chrono-bar {
            position: fixed; top: 0; left: 0; right: 0; z-index: 800;
            background: linear-gradient(135deg, #1e293b, #334155); color: #fff; display: none;
            align-items: center; justify-content: center; gap: 12px;
            padding: 8px 16px; font-size: 1em; font-weight: 700;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .pse-chrono-bar.visible { display: flex; }
        .pse-chrono-bar.warning { background: linear-gradient(135deg, #dc2626, #b91c1c); animation: pulse-chrono 1s infinite; }
        .pse-chrono-bar.warning-soon { background: linear-gradient(135deg, #f59e0b, #d97706); }
        @keyframes pulse-chrono { 0%,100%{opacity:1;} 50%{opacity:0.7;} }
        .pse-chrono-bar + .pse-overlay { top: 42px; }
        body.has-chrono { padding-top: 42px; }
        #pse-chrono-display { font-size: 1.3em; letter-spacing: 2px; font-variant-numeric: tabular-nums; }
        /* â”€â”€ 2Ã¨me chance overlay â”€â”€ */
        .pse-2chance-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6); z-index: 9997;
            display: none; align-items: center; justify-content: center; padding: 20px;
        }
        .pse-2chance-overlay.active { display: flex; }
        /* â”€â”€ 2Ã¨me chance : choix des options â”€â”€ */
        .pse-2chance-options {
            display: none; flex-direction: column; gap: 10px;
            background: #fff; border-radius: 16px; padding: 30px;
            max-width: 440px; width: 100%; text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .pse-2chance-options.active { display: flex; }
        .pse-2chance-opt-btn {
            display: flex; align-items: center; gap: 12px;
            padding: 14px 18px; border: 2px solid #e2e8f0; border-radius: 12px;
            background: #fff; cursor: pointer; text-align: left; font-size: 0.95em;
            transition: all 0.2s;
        }
        .pse-2chance-opt-btn:hover { border-color: #6366f1; background: #f5f3ff; }
        .pse-2chance-opt-btn .opt-icon { font-size: 1.5em; }
        .pse-2chance-opt-btn .opt-label { font-weight: 600; }
        .pse-2chance-opt-btn .opt-desc { font-size: 0.8em; color: #64748b; margin-top: 2px; }
        .pse-2chance-status {
            display: none; flex-direction: column; align-items: center; gap: 12px;
            background: #fff; border-radius: 16px; padding: 30px;
            max-width: 440px; width: 100%; text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .pse-2chance-status.active { display: flex; }
        .pse-2chance-spinner { width: 40px; height: 40px; border: 4px solid #e2e8f0; border-top-color: #6366f1; border-radius: 50%; animation: spin2c 0.8s linear infinite; }
        @keyframes spin2c { to { transform: rotate(360deg); } }
        .pse-2chance-box {
            background: #fff; border-radius: 16px; padding: 30px; max-width: 420px;
            text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .pse-2chance-box input {
            width: 160px; text-align: center; font-size: 1.5em; letter-spacing: 8px;
            padding: 10px; border: 2px solid #cbd5e1; border-radius: 10px; margin: 16px 0;
        }
    </style>
</head>
<body data-id-exercice="quiz_01">

<!-- â”€â”€ CHRONOMÃˆTRE (discret, en haut) â”€â”€ -->
<div class="pse-chrono-bar" id="pse-chrono-bar">
    <span>â±ï¸</span>
    <span id="pse-chrono-display">--:--</span>
    <span id="pse-chrono-label" style="font-weight:400; font-size:0.85em; opacity:0.8;">restantes</span>
</div>

<!-- â”€â”€ 2ÃˆME CHANCE (code prof) â”€â”€ -->
<div class="pse-2chance-overlay" id="pse-2chance-overlay">
    <div class="pse-2chance-box">
        <h2>ğŸ”„ 2Ã¨me tentative</h2>
        <p style="color:#64748b; margin:8px 0 16px;">Votre copie a dÃ©jÃ  Ã©tÃ© envoyÃ©e.<br>Pour une 2Ã¨me tentative, entrez le <b>code enseignant</b>.</p>
        <input type="text" id="pse-2chance-input" placeholder="Â·Â·Â·Â·" maxlength="4" autocomplete="off" inputmode="numeric">
        <p class="err" id="pse-2chance-err" style="color:#dc2626; font-size:0.85em; display:none;">Code incorrect</p>
        <div style="display:flex; gap:10px; justify-content:center; margin-top:12px;">
            <button onclick="document.getElementById('pse-2chance-overlay').classList.remove('active')" style="padding:10px 20px; border:1px solid #cbd5e1; background:#fff; border-radius:8px; cursor:pointer;">Annuler</button>
            <button id="pse-btn-2chance-valider" style="padding:10px 20px; background:#6366f1; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:600;">Valider</button>
        </div>
    </div>
</div>

<!-- â”€â”€ 2ÃˆME CHANCE : choix du mode â”€â”€ -->
<div class="pse-2chance-overlay" id="pse-2chance-choice-overlay">
    <div class="pse-2chance-options" id="pse-2chance-options" style="display:flex;">
        <h2 style="margin:0 0 4px;">ğŸ”„ 2Ã¨me tentative</h2>
        <p style="color:#64748b; margin:0 0 16px; font-size:0.9em;">Votre copie a dÃ©jÃ  Ã©tÃ© envoyÃ©e. Choisissez comment obtenir une 2Ã¨me tentative :</p>
        <button class="pse-2chance-opt-btn" onclick="choisir2eChanceCode()">
            <span class="opt-icon">ğŸ”‘</span>
            <div><div class="opt-label">Code enseignant (en classe)</div><div class="opt-desc">Demandez le code Ã  votre professeur</div></div>
        </button>
        <button class="pse-2chance-opt-btn" id="btn-2chance-distance" onclick="choisir2eChanceDistance()">
            <span class="opt-icon">ğŸ“©</span>
            <div><div class="opt-label">Demander Ã  distance</div><div class="opt-desc">Envoyez une demande, le professeur validera</div></div>
        </button>
        <button onclick="document.getElementById('pse-2chance-choice-overlay').classList.remove('active')" style="margin-top:8px; padding:10px 20px; border:1px solid #cbd5e1; background:#fff; border-radius:8px; cursor:pointer; color:#64748b;">Annuler</button>
    </div>
</div>

<!-- â”€â”€ 2ÃˆME CHANCE : attente validation Ã  distance â”€â”€ -->
<div class="pse-2chance-overlay" id="pse-2chance-wait-overlay">
    <div class="pse-2chance-status" id="pse-2chance-wait-box" style="display:flex;">
        <div class="pse-2chance-spinner"></div>
        <h2 style="margin:0;">ğŸ“© Demande envoyÃ©e</h2>
        <p style="color:#64748b; margin:0; font-size:0.9em;" id="pse-2chance-wait-msg">Votre demande a Ã©tÃ© transmise au professeur.<br>Cette page se met Ã  jour automatiquement.</p>
        <p style="color:#94a3b8; font-size:0.8em; margin:0;" id="pse-2chance-wait-timer">VÃ©rification dans 5s...</p>
        <button onclick="annuler2eChanceAttente()" style="margin-top:8px; padding:10px 20px; border:1px solid #cbd5e1; background:#fff; border-radius:8px; cursor:pointer; color:#64748b;">Annuler</button>
    </div>
</div>

<!-- â”€â”€ OVERLAY IDENTIFICATION â”€â”€ -->
<div class="pse-overlay" id="pse-overlay-id">
    <div class="pse-overlay-box" id="pse-step-code">
        <h2>ğŸ” Identification</h2>
        <p class="sub">Ã‰valuation PSE : L'addiction au tÃ©lÃ©phone portable et les risques numÃ©riques</p>
        <input type="text" id="pse-code-input" placeholder="Code Ã©lÃ¨ve" maxlength="10" autocomplete="off">
        <p class="err" id="pse-code-err">Code non reconnu. VÃ©rifiez et rÃ©essayez.</p>
        <button class="btn-go" id="pse-btn-valider-code">Valider</button>
    </div>
    <div class="pse-warning-box" id="pse-step-warning" style="display:none;">
        <h2>âš ï¸ RÃ¨gles de l'Ã©valuation</h2>
        <ul>
            <li>ğŸš« Le copier-coller depuis des sources externes est <b>interdit et dÃ©tectÃ©</b></li>
            <li>ğŸ“± Les sorties de page (changement d'onglet, autre application) sont <b>enregistrÃ©es</b></li>
            <li>ğŸ“ RÃ©pondez Ã  <b>toutes les questions</b> avant d'envoyer</li>
            <li>âœ… Une fois envoyÃ©, vous ne pourrez <b>pas modifier</b> vos rÃ©ponses</li>
        </ul>
        <div id="pse-chrono-warning" style="display:none; margin:16px 0 8px; padding:14px; background:linear-gradient(135deg,#fef3c7,#fffbeb); border:2px solid #f59e0b; border-radius:12px; text-align:center;">
            <div style="font-size:1.8em; margin-bottom:6px;">â±ï¸</div>
            <div style="font-size:1.1em; font-weight:700; color:#92400e;">Ã‰preuve chronomÃ©trÃ©e</div>
            <div style="font-size:1.4em; font-weight:800; color:#dc2626; margin:6px 0;" id="pse-chrono-announce">--:--</div>
            <div style="font-size:0.85em; color:#78716c;">Le chronomÃ¨tre dÃ©marre dÃ¨s que vous cliquez sur <b>Commencer</b>.<br>L'envoi sera <b>automatique</b> Ã  la fin du temps.</div>
        </div>
        <button class="btn-accept" id="pse-btn-accepter">J'ai compris, commencer l'Ã©valuation</button>
    </div>
</div>

<!-- â”€â”€ TOAST SORTIE DE PAGE â”€â”€ -->
<div class="pse-leave-toast" id="pse-leave-toast"></div>

<!-- â”€â”€ MODAL CONFIRMATION ENVOI â”€â”€ -->
<div class="pse-confirm-overlay" id="pse-confirm-overlay">
    <div class="pse-confirm-box">
        <h3>ğŸ“¤ Confirmer l'envoi</h3>
        <div id="pse-confirm-body"></div>
        <div class="btn-row">
            <button class="btn-cancel" onclick="document.getElementById('pse-confirm-overlay').classList.remove('active')">Revenir</button>
            <button class="btn-send" id="pse-btn-confirm-send">Envoyer dÃ©finitivement</button>
        </div>
    </div>
</div>

<!-- â”€â”€ RÃ‰CÃ‰PISSÃ‰ â”€â”€ -->
<div class="pse-recepisse" id="pse-recepisse">
    <div class="pse-recepisse-box">
        <div class="check-icon">âœ…</div>
        <h2>Copie envoyÃ©e avec succÃ¨s !</h2>
        <div class="info-grid" id="pse-recepisse-info"></div>
        <button class="btn-print" id="pse-btn-print" style="display:none;" onclick="window.print()">ğŸ–¨ï¸ Imprimer mon rÃ©cÃ©pissÃ©</button>
    </div>
</div>

<div class="container">
    <div class="header">
        <h1>Ã‰valuation PSE : L'addiction au tÃ©lÃ©phone portable et les risques numÃ©riques</h1>
    </div>
    <div class="competences-box">
        <h3>CompÃ©tences Ã©valuÃ©es</h3>
        <ul><li><span class="comp-tag">C1</span></li><li><span class="comp-tag">C2</span></li><li><span class="comp-tag">C3</span></li><li><span class="comp-tag">C4</span></li><li><span class="comp-tag">C5</span></li></ul>
    </div>
    <div class="body-content">

    <input type="hidden" id="code-eleve" class="reponse-eleve" data-qid="code_eleve" value="">

    
                        <div class="question-block">
                            <span class="q-label">1</span><span class="q-comp">C3</span><span class="q-points">1 pts</span>
                            <div class="q-text">Qu'est-ce que la Â« nomophobie Â» ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053064030_178" value="q_1771053064030_178_opt1" class="reponse-eleve" data-qid="q_1771053064030_178"> La peur des ondes Ã©lectromagnÃ©tiques</label><label><input type="radio" name="q_1771053064030_178" value="q_1771053064030_178_opt2" class="reponse-eleve" data-qid="q_1771053064030_178"> La peur d'Ãªtre sans son tÃ©lÃ©phone portable</label><label><input type="radio" name="q_1771053064030_178" value="q_1771053064030_178_opt3" class="reponse-eleve" data-qid="q_1771053064030_178"> La peur de recevoir des appels inconnus</label></div></div>
                        <div class="question-block">
                            <span class="q-label">2</span><span class="q-comp">C3</span><span class="q-points">1 pts</span>
                            <div class="q-text">Quel est l'effet principal de la lumiÃ¨re bleue des Ã©crans sur le sommeil ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053064474_100" value="q_1771053064474_100_opt1" class="reponse-eleve" data-qid="q_1771053064474_100"> Elle aide Ã  s'endormir plus vite</label><label><input type="radio" name="q_1771053064474_100" value="q_1771053064474_100_opt2" class="reponse-eleve" data-qid="q_1771053064474_100"> Elle retarde l'endormissement en bloquant la mÃ©latonine</label><label><input type="radio" name="q_1771053064474_100" value="q_1771053064474_100_opt3" class="reponse-eleve" data-qid="q_1771053064474_100"> Elle amÃ©liore la qualitÃ© des rÃªves</label></div></div>
                        <div class="question-block">
                            <span class="q-label">3</span><span class="q-comp">C2</span><span class="q-points">1 pts</span>
                            <div class="q-text">Qu'appelle-t-on le Â« Text-Neck Â» ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053064828_294" value="q_1771053064828_294_opt1" class="reponse-eleve" data-qid="q_1771053064828_294"> Des douleurs cervicales liÃ©es Ã  la posture penchÃ©e</label><label><input type="radio" name="q_1771053064828_294" value="q_1771053064828_294_opt2" class="reponse-eleve" data-qid="q_1771053064828_294"> Une crampe au pouce Ã  force d'Ã©crire</label><label><input type="radio" name="q_1771053064828_294" value="q_1771053064828_294_opt3" class="reponse-eleve" data-qid="q_1771053064828_294"> Une fatigue visuelle intense</label></div></div>
                        <div class="question-block">
                            <span class="q-label">4</span><span class="q-comp">C2</span><span class="q-points">1 pts</span>
                            <div class="q-text">Qu'est-ce que le Â« Phubbing Â» ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053065085_237" value="q_1771053065085_237_opt1" class="reponse-eleve" data-qid="q_1771053065085_237"> Le piratage de donnÃ©es personnelles</label><label><input type="radio" name="q_1771053065085_237" value="q_1771053065085_237_opt2" class="reponse-eleve" data-qid="q_1771053065085_237"> L'envoi de messages publicitaires</label><label><input type="radio" name="q_1771053065085_237" value="q_1771053065085_237_opt3" class="reponse-eleve" data-qid="q_1771053065085_237"> Le fait d'ignorer son entourage pour regarder son tÃ©lÃ©phone</label></div></div>
                        <div class="question-block">
                            <span class="q-label">5</span><span class="q-comp">C2</span><span class="q-points">1 pts</span>
                            <div class="q-text">Quel est un risque majeur de l'Ã©coute prolongÃ©e de musique Ã  fort volume avec un casque ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053065302_451" value="q_1771053065302_451_opt1" class="reponse-eleve" data-qid="q_1771053065302_451"> La dÃ©shydratation</label><label><input type="radio" name="q_1771053065302_451" value="q_1771053065302_451_opt2" class="reponse-eleve" data-qid="q_1771053065302_451"> La perte d'audition irrÃ©versible</label><label><input type="radio" name="q_1771053065302_451" value="q_1771053065302_451_opt3" class="reponse-eleve" data-qid="q_1771053065302_451"> L'augmentation de la vue</label></div></div>
                        <div class="question-block">
                            <span class="q-label">6</span><span class="q-comp">C2</span><span class="q-points">1 pts</span>
                            <div class="q-text">Quel signe peut indiquer une cyberaddiction ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053065644_345" value="q_1771053065644_345_opt1" class="reponse-eleve" data-qid="q_1771053065644_345"> L'isolement social et le dÃ©laissement des activitÃ©s</label><label><input type="radio" name="q_1771053065644_345" value="q_1771053065644_345_opt2" class="reponse-eleve" data-qid="q_1771053065644_345"> Une meilleure organisation du travail</label><label><input type="radio" name="q_1771053065644_345" value="q_1771053065644_345_opt3" class="reponse-eleve" data-qid="q_1771053065644_345"> L'augmentation de l'activitÃ© physique</label></div></div>
                        <div class="question-block">
                            <span class="q-label">7</span><span class="q-comp">C3</span><span class="q-points">1 pts</span>
                            <div class="q-text">Que signifie le DAS (DÃ©bit d'Absorption SpÃ©cifique) d'un tÃ©lÃ©phone ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053067716_632" value="q_1771053067716_632_opt1" class="reponse-eleve" data-qid="q_1771053067716_632"> La vitesse de connexion internet</label><label><input type="radio" name="q_1771053067716_632" value="q_1771053067716_632_opt2" class="reponse-eleve" data-qid="q_1771053067716_632"> La quantitÃ© d'ondes absorbÃ©es par le corps</label><label><input type="radio" name="q_1771053067716_632" value="q_1771053067716_632_opt3" class="reponse-eleve" data-qid="q_1771053067716_632"> La capacitÃ© de stockage de la mÃ©moire</label></div></div>
                    <div class="question-block">
                        <span class="q-label">8</span><span class="q-comp">C3</span><span class="q-points">1 pts</span>
                        <div class="q-text">Consulter son tÃ©lÃ©phone au volant multiplie le risque d'accident par 3.</div>
                        <div class="checkbox-group">
                            <label><input type="radio" name="q_1771053072173_189" value="vrai" class="reponse-eleve" data-qid="q_1771053072173_189"> Vrai</label>
                            <label><input type="radio" name="q_1771053072173_189" value="faux" class="reponse-eleve" data-qid="q_1771053072173_189"> Faux</label>
                        </div>
                    </div>
                
                    <div class="question-block">
                        <span class="q-label">9</span><span class="q-comp">C1</span><span class="q-points">1 pts</span>
                        <div class="q-text">Le cerveau des adolescents est plus sensible aux addictions que celui des adultes.</div>
                        <div class="checkbox-group">
                            <label><input type="radio" name="q_1771053072607_1" value="vrai" class="reponse-eleve" data-qid="q_1771053072607_1"> Vrai</label>
                            <label><input type="radio" name="q_1771053072607_1" value="faux" class="reponse-eleve" data-qid="q_1771053072607_1"> Faux</label>
                        </div>
                    </div>
                
                    <div class="question-block">
                        <span class="q-label">10</span><span class="q-comp">C5</span><span class="q-points">1 pts</span>
                        <div class="q-text">Combien d'heures avant le coucher est-il conseillÃ© d'arrÃªter les Ã©crans ?</div>
                        <div><input type="number" class="reponse-eleve answer-input" data-qid="q_1771053074151_115" placeholder="Votre rÃ©ponse"></div>
                    </div>
                
                        <div class="question-block">
                            <span class="q-label">11</span><span class="q-comp">C2</span><span class="q-points">1 pts</span>
                            <div class="q-text">Quelle astuce permet de rÃ©duire la fatigue visuelle liÃ©e aux Ã©crans ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053079684_41" value="q_1771053079684_41_opt1" class="reponse-eleve" data-qid="q_1771053079684_41"> Augmenter la luminositÃ© au maximum</label><label><input type="radio" name="q_1771053079684_41" value="q_1771053079684_41_opt2" class="reponse-eleve" data-qid="q_1771053079684_41"> Regarder l'Ã©cran dans le noir complet</label><label><input type="radio" name="q_1771053079684_41" value="q_1771053079684_41_opt3" class="reponse-eleve" data-qid="q_1771053079684_41"> Faire des pauses rÃ©guliÃ¨res pour regarder au loin</label></div></div>
                        <div class="question-block">
                            <span class="q-label">12</span><span class="q-comp">C3</span><span class="q-points">1 pts</span>
                            <div class="q-text">Comment limiter son exposition aux ondes lors d'un appel ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053080232_609" value="q_1771053080232_609_opt1" class="reponse-eleve" data-qid="q_1771053080232_609"> Utiliser un kit mains-libres</label><label><input type="radio" name="q_1771053080232_609" value="q_1771053080232_609_opt2" class="reponse-eleve" data-qid="q_1771053080232_609"> Coller le tÃ©lÃ©phone Ã  l'oreille</label><label><input type="radio" name="q_1771053080232_609" value="q_1771053080232_609_opt3" class="reponse-eleve" data-qid="q_1771053080232_609"> Appeler uniquement dans les ascenseurs</label></div></div>
                    <div class="question-block">
                        <span class="q-label">13</span><span class="q-comp">C2</span><span class="q-points">1 pts</span>
                        <div class="q-text">Le cyberharcÃ¨lement est puni par la loi.</div>
                        <div class="checkbox-group">
                            <label><input type="radio" name="q_1771053088182_449" value="vrai" class="reponse-eleve" data-qid="q_1771053088182_449"> Vrai</label>
                            <label><input type="radio" name="q_1771053088182_449" value="faux" class="reponse-eleve" data-qid="q_1771053088182_449"> Faux</label>
                        </div>
                    </div>
                
                    <div class="question-block">
                        <span class="q-label">14</span><span class="q-comp">C4</span><span class="q-points">1 pts</span>
                        <div class="q-text">Quel est le seuil de danger pour l'audition (en dÃ©cibels) ?</div>
                        <div><input type="number" class="reponse-eleve answer-input" data-qid="q_1771053088786_643" placeholder="Votre rÃ©ponse"></div>
                    </div>
                
                    <div class="question-block">
                        <span class="q-label">15</span><span class="q-comp">C3</span><span class="q-points">1 pts</span>
                        <div class="q-text">Quelle distance minimale (en cm) est recommandÃ©e entre les yeux et l'Ã©cran ?</div>
                        <div><input type="number" class="reponse-eleve answer-input" data-qid="q_1771053093307_270" placeholder="Votre rÃ©ponse"></div>
                    </div>
                
                        <div class="question-block">
                            <span class="q-label">16</span><span class="q-comp">C1</span><span class="q-points">1 pts</span>
                            <div class="q-text">Quel est l'impact environnemental majeur de la fabrication des smartphones ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053095339_103" value="q_1771053095339_103_opt1" class="reponse-eleve" data-qid="q_1771053095339_103"> L'utilisation de papier</label><label><input type="radio" name="q_1771053095339_103" value="q_1771053095339_103_opt2" class="reponse-eleve" data-qid="q_1771053095339_103"> L'extraction de mÃ©taux rares et la pollution</label><label><input type="radio" name="q_1771053095339_103" value="q_1771053095339_103_opt3" class="reponse-eleve" data-qid="q_1771053095339_103"> La consommation d'eau potable lors de l'appel</label></div></div>
                        <div class="question-block">
                            <span class="q-label">17</span><span class="q-comp">C2</span><span class="q-points">1 pts</span>
                            <div class="q-text">Quelle est une bonne pratique de Â« Digital Detox Â» ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053099587_595" value="q_1771053099587_595_opt1" class="reponse-eleve" data-qid="q_1771053099587_595"> Acheter un deuxiÃ¨me tÃ©lÃ©phone</label><label><input type="radio" name="q_1771053099587_595" value="q_1771053099587_595_opt2" class="reponse-eleve" data-qid="q_1771053099587_595"> Dormir avec son tÃ©lÃ©phone</label><label><input type="radio" name="q_1771053099587_595" value="q_1771053099587_595_opt3" class="reponse-eleve" data-qid="q_1771053099587_595"> DÃ©sactiver les notifications non essentielles</label></div></div>
                        <div class="question-block">
                            <span class="q-label">18</span><span class="q-comp">C4</span><span class="q-points">1 pts</span>
                            <div class="q-text">Pourquoi est-il dangereux de marcher en regardant son tÃ©lÃ©phone (Â« Smombie Â») ?</div>
                            
                            <div class="checkbox-group">
                    <label><input type="radio" name="q_1771053105855_707" value="q_1771053105855_707_opt1" class="reponse-eleve" data-qid="q_1771053105855_707"> Risque de chute ou de collision par inattention</label><label><input type="radio" name="q_1771053105855_707" value="q_1771053105855_707_opt2" class="reponse-eleve" data-qid="q_1771053105855_707"> Risque d'amÃ©liorer son endurance</label><label><input type="radio" name="q_1771053105855_707" value="q_1771053105855_707_opt3" class="reponse-eleve" data-qid="q_1771053105855_707"> Risque de perdre du rÃ©seau</label></div></div>
                    <div class="question-block">
                        <span class="q-label">19</span><span class="q-comp">C3</span><span class="q-points">1 pts</span>
                        <div class="q-text">Le tÃ©lÃ©phone portable est autorisÃ© en classe au lycÃ©e et en CFA sans restriction.</div>
                        <div class="checkbox-group">
                            <label><input type="radio" name="q_1771053107025_83" value="vrai" class="reponse-eleve" data-qid="q_1771053107025_83"> Vrai</label>
                            <label><input type="radio" name="q_1771053107025_83" value="faux" class="reponse-eleve" data-qid="q_1771053107025_83"> Faux</label>
                        </div>
                    </div>
                
                    <div class="question-block">
                        <span class="q-label">20</span><span class="q-comp">C2</span><span class="q-points">1 pts</span>
                        <div class="q-text">Les notifications stimulent le circuit de la rÃ©compense (dopamine) dans le cerveau.</div>
                        <div class="checkbox-group">
                            <label><input type="radio" name="q_1771053110503_999" value="vrai" class="reponse-eleve" data-qid="q_1771053110503_999"> Vrai</label>
                            <label><input type="radio" name="q_1771053110503_999" value="faux" class="reponse-eleve" data-qid="q_1771053110503_999"> Faux</label>
                        </div>
                    </div>
                

    <div class="submit-section">
        <button class="submit-btn" id="btn-envoyer" onclick="window.tenterEnvoi()">Envoyer ma copie ğŸ“¤</button>
        <p id="envoi-status" style="font-size:0.85em; color:#666; margin-top:12px;">Le systÃ¨me se charge...</p>
    </div>

    </div>
</div>

<script>
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ANTI-TRICHE & SÃ‰CURITÃ‰
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const focus = { focusLeaves: 0, copyAttempts: 0, pasteBlocked: 0 };
    let examStarted = false;
    let studentCode = '';

    function getAntiCheatOptions() {
        return (window.__PSE_BLUEPRINT && window.__PSE_BLUEPRINT.options) || { antiLeave: true, antiPaste: true, maxLeaves: 2 };
    }

    // â”€â”€ Ã‰TAPE 1 : Identification â”€â”€
    document.addEventListener('DOMContentLoaded', function() {
        const codeInput = document.getElementById('pse-code-input');
        const btnValider = document.getElementById('pse-btn-valider-code');
        const errMsg = document.getElementById('pse-code-err');

        function validerCode() {
            const code = (codeInput.value || '').trim().toUpperCase();
            if (code.length < 2) {
                codeInput.classList.add('shake');
                errMsg.textContent = 'Entrez votre code Ã©lÃ¨ve (minimum 2 caractÃ¨res).';
                errMsg.style.display = 'block';
                setTimeout(() => codeInput.classList.remove('shake'), 400);
                return;
            }
            // VÃ©rifier dans l'annuaire si disponible
            if (window.ANNUAIRE && typeof window.ANNUAIRE === 'object') {
                if (!window.ANNUAIRE[code]) {
                    codeInput.classList.add('shake');
                    errMsg.textContent = 'Code non reconnu. VÃ©rifiez et rÃ©essayez.';
                    errMsg.style.display = 'block';
                    setTimeout(() => codeInput.classList.remove('shake'), 400);
                    return;
                }
                // Stocker la classe
                localStorage.setItem('userClasse', window.ANNUAIRE[code]);
            }
            studentCode = code;
            localStorage.setItem('userCode', code);
            localStorage.setItem('codeEleve', code);
            document.getElementById('code-eleve').value = code;

            // Passer Ã  l'Ã©cran d'avertissement
            document.getElementById('pse-step-code').style.display = 'none';
            document.getElementById('pse-step-warning').style.display = 'block';

            // Afficher l'info chrono si activÃ©
            const optsWarn = getAntiCheatOptions();
            if (optsWarn.chrono && optsWarn.chronoMinutes > 0) {
                const m = optsWarn.chronoMinutes;
                document.getElementById('pse-chrono-warning').style.display = 'block';
                document.getElementById('pse-chrono-announce').textContent = m + ' minute' + (m > 1 ? 's' : '');
            }
        }

        btnValider.addEventListener('click', validerCode);
        codeInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') validerCode(); });
        codeInput.focus();

        // â”€â”€ Ã‰TAPE 2 : Avertissement â†’ Commencer â”€â”€
        document.getElementById('pse-btn-accepter').addEventListener('click', function() {
            document.getElementById('pse-overlay-id').classList.add('hidden');
            examStarted = true;
            // Enregistrer l'heure de dÃ©but
            const devoirId = document.body.dataset.idExercice || 'unknown';
            localStorage.setItem('devoir_start_time_' + devoirId, Date.now().toString());

            // â”€â”€ ChronomÃ¨tre (si activÃ©) â”€â”€
            const opts = getAntiCheatOptions();
            if (opts.chrono && opts.chronoMinutes > 0) {
                startChrono(opts.chronoMinutes);
            }
        });

        // Auto-resize textareas
        const textInputs = document.querySelectorAll('textarea, input[type="text"]');
        textInputs.forEach(input => {
            if (input.tagName === 'TEXTAREA') {
                input.addEventListener('input', () => autoResize(input));
                autoResize(input);
            }
        });
    });

    // â”€â”€ Auto-resize â”€â”€
    function autoResize(el) {
        el.style.height = 'auto';
        el.style.height = el.scrollHeight + 'px';
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // CHRONOMÃˆTRE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    let chronoInterval = null;
    let chronoSecondsLeft = 0;

    function startChrono(minutes) {
        const bar = document.getElementById('pse-chrono-bar');
        const display = document.getElementById('pse-chrono-display');
        bar.classList.add('visible');
        bar.classList.remove('warning');
        document.body.classList.add('has-chrono');
        document.getElementById('pse-chrono-label').textContent = 'restantes';
        chronoSecondsLeft = minutes * 60;

        // Affichage immÃ©diat
        display.textContent = String(minutes).padStart(2, '0') + ':00';

        let chrono5minWarned = false;
        let chrono2minWarned = false;

        chronoInterval = setInterval(() => {
            chronoSecondsLeft--;
            if (chronoSecondsLeft <= 0) {
                clearInterval(chronoInterval);
                display.textContent = "00:00";
                bar.classList.remove('warning-soon');
                bar.classList.add('warning');
                document.getElementById('pse-chrono-label').textContent = "TEMPS Ã‰COULÃ‰ â€” envoi automatique !";
                // Envoi automatique SANS confirmation
                const code = (document.getElementById('code-eleve').value || '').trim().toUpperCase();
                const totalQ = (window.__PSE_BLUEPRINT?.content || []).filter(i => i.type === 'question').length;
                const missing = typeof getUnansweredQuestions === 'function' ? getUnansweredQuestions() : [];
                const answered = totalQ - missing.length;
                envoyerDefinitivement(code, totalQ, answered);
                return;
            }
            const m = Math.floor(chronoSecondsLeft / 60);
            const s = chronoSecondsLeft % 60;
            display.textContent = String(m).padStart(2, '0') + ':' + String(s).padStart(2, '0');

            // Alerte Ã  5 minutes (orange)
            if (chronoSecondsLeft <= 300 && !chrono5minWarned) {
                chrono5minWarned = true;
                bar.classList.add('warning-soon');
                document.getElementById('pse-chrono-label').textContent = 'âš ï¸ Plus que 5 minutes !';
                showLeaveToast('â±ï¸ Attention : il ne reste que 5 minutes !');
            }

            // Alerte Ã  2 minutes (rouge clignotant)
            if (chronoSecondsLeft <= 120 && !chrono2minWarned) {
                chrono2minWarned = true;
                bar.classList.remove('warning-soon');
                bar.classList.add('warning');
                document.getElementById('pse-chrono-label').textContent = 'ğŸš¨ DerniÃ¨res 2 minutes !';
                showLeaveToast('ğŸš¨ ATTENTION : 2 minutes restantes ! Envoi automatique Ã  la fin !');
            }
        }, 1000);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // 2ÃˆME CHANCE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    let isSecondeChance = false;

    function demander2eChance() {
        const opts = getAntiCheatOptions();
        if (!opts.secondeChance || !opts.codeProf) {
            alert("La 2Ã¨me tentative n'est pas activÃ©e pour cet exercice.");
            return;
        }
        document.getElementById('pse-2chance-overlay').classList.add('active');
        const input = document.getElementById('pse-2chance-input');
        input.value = '';
        input.focus();
    }

    // Event listeners pour 2Ã¨me chance
    document.addEventListener('DOMContentLoaded', function() {
        const btn2 = document.getElementById('pse-btn-2chance-valider');
        const input2 = document.getElementById('pse-2chance-input');
        if (btn2) {
            btn2.addEventListener('click', valider2eChance);
        }
        if (input2) {
            input2.addEventListener('keypress', (e) => { if (e.key === 'Enter') valider2eChance(); });
        }
    });

    function valider2eChance() {
        const opts = getAntiCheatOptions();
        const input = document.getElementById('pse-2chance-input');
        const err = document.getElementById('pse-2chance-err');
        const code = (input.value || '').trim();
        if (code === opts.codeProf) {
            isSecondeChance = true;
            document.getElementById('pse-2chance-overlay').classList.remove('active');
            // RÃ©activer le bouton d'envoi
            const btn = document.getElementById('btn-envoyer');
            if (btn) {
                btn.disabled = false;
                btn.textContent = 'ğŸ“¤ Envoyer (2Ã¨me tentative)';
                btn.style.background = 'linear-gradient(135deg, #f59e0b, #d97706)';
            }
            // Reset le chrono si actif
            if (opts.chrono && opts.chronoMinutes > 0) {
                if (chronoInterval) clearInterval(chronoInterval);
                const bar = document.getElementById('pse-chrono-bar');
                bar.classList.remove('warning');
                document.getElementById('pse-chrono-label').textContent = 'restantes';
                startChrono(opts.chronoMinutes);
            }
        } else {
            err.style.display = 'block';
            input.classList.add('shake');
            setTimeout(() => input.classList.remove('shake'), 400);
        }
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // 2ÃˆME CHANCE : OPTIONS (code prof OU demande Ã  distance)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    let pollingInterval2c = null;

    function afficher2eChanceOptions(btn, opts) {
        // DÃ©sactiver le bouton d'envoi
        btn.textContent = 'â›” DÃ©jÃ  envoyÃ©';
        btn.style.background = '#94a3b8';
        btn.disabled = true;

        // Si code prof configurÃ© â†’ montrer le bouton "en classe"
        const btnCodeProf = document.querySelector('#pse-2chance-options .pse-2chance-opt-btn:first-of-type');
        if (btnCodeProf) btnCodeProf.style.display = opts.codeProf ? 'flex' : 'none';

        // Toujours montrer le bouton distance (Firestore)
        const btnDistance = document.getElementById('btn-2chance-distance');
        if (btnDistance) btnDistance.style.display = 'flex';

        // Si un seul mode est disponible, on saute directement
        if (!opts.codeProf) {
            // Pas de code prof â†’ directement demande Ã  distance
            choisir2eChanceDistance();
            return;
        }

        // Ouvrir l'overlay de choix (les deux modes sont disponibles)
        document.getElementById('pse-2chance-choice-overlay').classList.add('active');
    }

    function choisir2eChanceCode() {
        // Fermer l'overlay de choix, ouvrir l'overlay code prof
        document.getElementById('pse-2chance-choice-overlay').classList.remove('active');
        demander2eChance();
    }

    function choisir2eChanceDistance() {
        const devoirId = document.body.dataset.idExercice || 'unknown';
        const eleveCode = (localStorage.getItem('userCode') || '').toUpperCase().trim();
        const classe = (localStorage.getItem('userClasse') || '').trim() || '?';

        if (!eleveCode || eleveCode.length < 2) {
            alert('Code Ã©lÃ¨ve introuvable. Rechargez la page.');
            return;
        }

        // Fermer l'overlay de choix
        document.getElementById('pse-2chance-choice-overlay').classList.remove('active');

        // Envoyer la demande via Firestore
        if (typeof window.demander2eChanceFirestore === 'function') {
            window.demander2eChanceFirestore(eleveCode, devoirId, classe).then(() => {
                // Ouvrir l'overlay d'attente
                document.getElementById('pse-2chance-wait-overlay').classList.add('active');
                // DÃ©marrer le polling
                demarrerPolling2eChance(eleveCode, devoirId);
            }).catch(err => {
                console.error('Erreur demande 2Ã¨me chance:', err);
                alert('Erreur lors de la demande. RÃ©essayez.');
            });
        } else {
            alert("Le systÃ¨me de demande Ã  distance n'est pas disponible.");
        }
    }

    function demarrerPolling2eChance(eleveCode, devoirId) {
        let countdown = 5;
        const timerEl = document.getElementById('pse-2chance-wait-timer');
        const msgEl = document.getElementById('pse-2chance-wait-msg');

        // Countdown visuel
        const countdownTimer = setInterval(() => {
            countdown--;
            if (countdown > 0) {
                timerEl.textContent = 'VÃ©rification dans ' + countdown + 's...';
            } else {
                timerEl.textContent = 'VÃ©rification en cours...';
            }
        }, 1000);

        // Polling toutes les 5 secondes
        pollingInterval2c = setInterval(async () => {
            try {
                if (typeof window.verifier2eChanceFirestore !== 'function') return;
                const status = await window.verifier2eChanceFirestore(eleveCode, devoirId);

                if (status === 'acceptee') {
                    // ApprouvÃ© !
                    clearInterval(pollingInterval2c);
                    clearInterval(countdownTimer);
                    pollingInterval2c = null;

                    isSecondeChance = true;

                    // Fermer l'overlay d'attente
                    document.getElementById('pse-2chance-wait-overlay').classList.remove('active');

                    // RÃ©activer le bouton d'envoi
                    const btn = document.getElementById('btn-envoyer');
                    if (btn) {
                        btn.disabled = false;
                        btn.textContent = 'ğŸ“¤ Envoyer (2Ã¨me tentative)';
                        btn.style.background = 'linear-gradient(135deg, #f59e0b, #d97706)';
                    }

                    // Reset le chrono si actif
                    const opts = getAntiCheatOptions();
                    if (opts.chrono && opts.chronoMinutes > 0) {
                        if (chronoInterval) clearInterval(chronoInterval);
                        const bar = document.getElementById('pse-chrono-bar');
                        if (bar) bar.classList.remove('warning');
                        const label = document.getElementById('pse-chrono-label');
                        if (label) label.textContent = 'restantes';
                        startChrono(opts.chronoMinutes);
                    }

                } else if (status === 'refusee') {
                    // RefusÃ©
                    clearInterval(pollingInterval2c);
                    clearInterval(countdownTimer);
                    pollingInterval2c = null;

                    msgEl.innerHTML = 'âŒ <b>Demande refusÃ©e</b> par le professeur.';
                    timerEl.textContent = '';
                    // Masquer le spinner
                    const spinner = document.querySelector('#pse-2chance-wait-box .pse-2chance-spinner');
                    if (spinner) spinner.style.display = 'none';

                } else {
                    // Toujours en attente â€” reset countdown
                    countdown = 5;
                    timerEl.textContent = 'VÃ©rification dans 5s...';
                }
            } catch (err) {
                console.error('Erreur polling 2Ã¨me chance:', err);
            }
        }, 5000);
    }

    function annuler2eChanceAttente() {
        if (pollingInterval2c) {
            clearInterval(pollingInterval2c);
            pollingInterval2c = null;
        }
        document.getElementById('pse-2chance-wait-overlay').classList.remove('active');
    }

    // â”€â”€ ANTI-TRICHE : Sortie de page â”€â”€
    function showLeaveToast(msg) {
        const toast = document.getElementById('pse-leave-toast');
        toast.textContent = msg;
        toast.style.display = 'block';
        setTimeout(() => { toast.style.display = 'none'; }, 4000);
    }

    document.addEventListener('visibilitychange', () => {
        if (!examStarted) return;
        const opts = getAntiCheatOptions();
        if (opts.antiLeave !== false && document.visibilityState === 'hidden') {
            focus.focusLeaves += 1;
            const max = opts.maxLeaves || 2;
            if (focus.focusLeaves >= max) {
                showLeaveToast('âš ï¸ Attention ! Vous avez quittÃ© la page ' + focus.focusLeaves + ' fois. Toutes les sorties sont enregistrÃ©es.');
            }
        }
    });

    window.addEventListener('blur', () => {
        if (!examStarted) return;
        const opts = getAntiCheatOptions();
        if (opts.antiLeave !== false) {
            focus.focusLeaves += 1;
        }
    });

    // â”€â”€ ANTI-TRICHE : Copier-coller â”€â”€
    document.addEventListener('copy', () => {
        focus.copyAttempts += 1;
    });

    document.addEventListener('paste', (event) => {
        const opts = getAntiCheatOptions();
        focus.copyAttempts += 1;
        if (opts.antiPaste !== false) {
            event.preventDefault();
            focus.pasteBlocked += 1;
            showLeaveToast('ğŸš« Copier-coller externe interdit ! (' + focus.pasteBlocked + ' tentative' + (focus.pasteBlocked > 1 ? 's' : '') + ')');
        }
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // VÃ‰RIFICATION RÃ‰PONSES MANQUANTES
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function getUnansweredQuestions() {
        const items = Array.isArray(window.__PSE_BLUEPRINT?.content) ? window.__PSE_BLUEPRINT.content : [];
        const missing = [];
        items.forEach((item, idx) => {
            if (item.type !== 'question') return;
            const qid = String(item.qid || '').trim();
            if (!qid) return;
            const controls = Array.from(document.querySelectorAll('.reponse-eleve[data-qid="' + qid + '"]:not([data-fallback="1"])'));
            let answered = false;
            controls.forEach((el) => {
                const type = (el.type || '').toLowerCase();
                if (type === 'radio' || type === 'checkbox') {
                    if (el.checked) answered = true;
                } else if (el.tagName === 'SELECT') {
                    if ((el.value || '').trim() !== '') answered = true;
                } else if ((el.value || '').trim() !== '') {
                    answered = true;
                }
            });
            if (!answered) {
                missing.push(item.label || ('Q' + (idx + 1)));
            }
        });
        return missing;
    }

    function ensureEmptyAnswerBindings() {
        const items = Array.isArray(window.__PSE_BLUEPRINT?.content) ? window.__PSE_BLUEPRINT.content : [];
        const expectedQids = items.map((item) => String(item?.qid || '').trim()).filter(Boolean);
        expectedQids.forEach((qid) => {
            const existingFallback = document.querySelector('input.reponse-eleve[type="hidden"][data-qid="' + qid + '"][data-fallback="1"]');
            const controls = Array.from(document.querySelectorAll('.reponse-eleve[data-qid="' + qid + '"]:not([data-fallback="1"])'));
            let answered = false;
            controls.forEach((el) => {
                const tag = (el.tagName || '').toUpperCase();
                const type = (el.type || '').toLowerCase();
                if (type === 'radio' || type === 'checkbox') { if (el.checked) answered = true; }
                else if (tag === 'SELECT') { if ((el.value || '').trim() !== '') answered = true; }
                else if ((el.value || '').trim() !== '') { answered = true; }
            });
            if (!answered && !existingFallback) {
                const fb = document.createElement('input');
                fb.type = 'hidden'; fb.value = ''; fb.className = 'reponse-eleve';
                fb.setAttribute('data-qid', qid); fb.setAttribute('data-fallback', '1');
                document.body.appendChild(fb);
            }
            if (answered && existingFallback) { existingFallback.remove(); }
        });
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ENVOI AVEC CONFIRMATION
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    window.tenterEnvoi = function() {
        const code = (document.getElementById('code-eleve').value || '').trim().toUpperCase();
        if (!code || code.length < 2) { alert('Code Ã©lÃ¨ve requis !'); return; }

        // VÃ©rifier les questions manquantes
        const missing = getUnansweredQuestions();
        const totalQ = (window.__PSE_BLUEPRINT?.content || []).filter(i => i.type === 'question').length;
        const answered = totalQ - missing.length;
        let bodyHTML = '<p style="margin-bottom:12px;">Vous avez rÃ©pondu Ã  <b>' + answered + '/' + totalQ + '</b> questions.</p>';

        if (missing.length > 0) {
            bodyHTML += '<div class="missing-list">âš ï¸ Questions sans rÃ©ponse : <b>' + missing.join(', ') + '</b></div>';
            bodyHTML += '<p style="font-size:0.85em; color:#64748b; margin-top:8px;">Vous pouvez envoyer quand mÃªme ou revenir complÃ©ter.</p>';
        } else {
            bodyHTML += '<p style="color:#059669;">âœ… Toutes les questions ont Ã©tÃ© rÃ©pondues.</p>';
        }

        document.getElementById('pse-confirm-body').innerHTML = bodyHTML;
        document.getElementById('pse-confirm-overlay').classList.add('active');

        // Attacher le bouton envoyer
        document.getElementById('pse-btn-confirm-send').onclick = function() {
            document.getElementById('pse-confirm-overlay').classList.remove('active');
            envoyerDefinitivement(code, totalQ, answered);
        };
    };

    async function envoyerDefinitivement(code, totalQ, answered) {
        ensureEmptyAnswerBindings();
        const btn = document.getElementById('btn-envoyer');
        btn.disabled = true;
        btn.textContent = 'Envoi en cours...';

        if (typeof window.envoyerCopie === 'function') {
            try {
                const classeLS = (localStorage.getItem('userClasse') || '').trim();
                const opts = getAntiCheatOptions();
                // Calcul du temps utilisÃ©
                const devoirId = document.body.dataset.idExercice || 'unknown';
                const startTime = localStorage.getItem('devoir_start_time_' + devoirId);
                const tempsUtiliseSec = startTime ? Math.floor((Date.now() - parseInt(startTime)) / 1000) : null;

                const elevePayload = {
                    code: code,
                    blueprintEmbedded: true,
                    focus: focus,
                    secondeChance: isSecondeChance,
                    chrono: {
                        actif: !!(opts.chrono && opts.chronoMinutes > 0),
                        minutesAllouees: (opts.chrono ? opts.chronoMinutes : 0),
                        secondesRestantes: chronoSecondsLeft,
                        tempsUtiliseSec: tempsUtiliseSec,
                        tempsEcoule: chronoSecondsLeft <= 0
                    }
                };
                if (classeLS) elevePayload.classe = classeLS;
                await window.envoyerCopie(code, { external: focus.pasteBlocked }, elevePayload);
                btn.textContent = 'âœ… EnvoyÃ© !';
                btn.style.background = 'linear-gradient(135deg, #2ecc71, #27ae60)';
                // ArrÃªter le chrono
                if (chronoInterval) clearInterval(chronoInterval);

                // Afficher le rÃ©cÃ©pissÃ©
                showRecepisse(code, totalQ, answered);
            } catch(e) {
                console.error(e);
                if (e.message && e.message.includes('dÃ©jÃ  envoyÃ©')) {
                    const opts = getAntiCheatOptions();
                    if (opts.secondeChance && !isSecondeChance) {
                        // 2Ã¨me chance disponible â€” afficher les deux options
                        afficher2eChanceOptions(btn, opts);
                    } else {
                        btn.textContent = 'â›” DÃ©jÃ  envoyÃ©';
                        btn.style.background = '#94a3b8';
                        alert(e.message);
                    }
                } else {
                    alert('Erreur: ' + e.message);
                    btn.disabled = false;
                    btn.textContent = 'RÃ©essayer';
                }
            }
        } else {
            alert('SystÃ¨me non prÃªt. Rechargez la page.');
            btn.disabled = false;
        }
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // RÃ‰CÃ‰PISSÃ‰
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function showRecepisse(code, totalQ, answered) {
        const opts = getAntiCheatOptions();
        const titre = document.querySelector('.header h1')?.textContent || 'Ã‰valuation';
        const now = new Date();
        const dateStr = now.toLocaleDateString('fr-FR') + ' Ã  ' + now.toLocaleTimeString('fr-FR', {hour:'2-digit', minute:'2-digit'});

        // Calcul du temps utilisÃ©
        const devoirId = document.body.dataset.idExercice || 'unknown';
        const startTime = localStorage.getItem('devoir_start_time_' + devoirId);
        let tempsUtilise = '';
        if (startTime) {
            const elapsed = Math.floor((Date.now() - parseInt(startTime)) / 1000);
            const mins = Math.floor(elapsed / 60);
            const secs = elapsed % 60;
            tempsUtilise = mins + ' min ' + String(secs).padStart(2, '0') + ' s';
        }

        let infoHTML = '';
        infoHTML += '<div class="info-row"><span class="info-label">ğŸ“‹ Devoir</span><span class="info-value">' + titre + '</span></div>';
        infoHTML += '<div class="info-row"><span class="info-label">ğŸ‘¤ Code</span><span class="info-value">' + code + '</span></div>';
        infoHTML += '<div class="info-row"><span class="info-label">ğŸ• EnvoyÃ© le</span><span class="info-value">' + dateStr + '</span></div>';
        infoHTML += '<div class="info-row"><span class="info-label">ğŸ“ RÃ©ponses</span><span class="info-value">' + answered + ' / ' + totalQ + '</span></div>';

        // Afficher le temps utilisÃ©
        if (tempsUtilise) {
            infoHTML += '<div class="info-row"><span class="info-label">â±ï¸ Temps utilisÃ©</span><span class="info-value">' + tempsUtilise + '</span></div>';
        }

        // Afficher info chrono si activÃ©
        if (opts.chrono && opts.chronoMinutes > 0) {
            infoHTML += '<div class="info-row"><span class="info-label">â³ Temps allouÃ©</span><span class="info-value">' + opts.chronoMinutes + ' minutes</span></div>';
            // Temps restant
            if (chronoSecondsLeft > 0) {
                const rm = Math.floor(chronoSecondsLeft / 60);
                const rs = chronoSecondsLeft % 60;
                infoHTML += '<div class="info-row"><span class="info-label">âœ… Temps restant</span><span class="info-value" style="color:#059669;">' + rm + ' min ' + String(rs).padStart(2, '0') + ' s</span></div>';
            } else {
                infoHTML += '<div class="info-row"><span class="info-label">âš ï¸ Chrono</span><span class="info-value" style="color:#dc2626;">Temps Ã©coulÃ© â€” envoi automatique</span></div>';
            }
        }

        // Info 2Ã¨me tentative
        if (isSecondeChance) {
            infoHTML += '<div class="info-row"><span class="info-label">ğŸ”„ Tentative</span><span class="info-value" style="color:#f59e0b;">2Ã¨me chance</span></div>';
        }

        document.getElementById('pse-recepisse-info').innerHTML = infoHTML;

        // Bouton imprimer seulement si l'option est activÃ©e
        if (opts.recepisse) {
            document.getElementById('pse-btn-print').style.display = 'inline-block';
        }

        document.getElementById('pse-recepisse').classList.add('active');
    }
</script>


<script>
    window.__PSE_BLUEPRINT = {
  "id": "quiz_01",
  "devoirId": "quiz_01",
  "titre": "Ã‰valuation PSE : L'addiction au tÃ©lÃ©phone portable et les risques numÃ©riques",
  "niveau": "Bac Pro",
  "competences": [
    "C1",
    "C2",
    "C3",
    "C4",
    "C5"
  ],
  "version": "v1",
  "autocorrect": true,
  "options": {
    "antiLeave": true,
    "antiPaste": true,
    "maxLeaves": 2,
    "recepisse": true,
    "secondeChance": true,
    "codeProf": "2021",
    "chrono": true,
    "chronoMinutes": 2
  },
  "content": [
    {
      "type": "question",
      "qid": "q_1771053064030_178",
      "label": "1",
      "competence": "C3",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Qu'est-ce que la Â« nomophobie Â» ?",
      "reponseCorrecte": "q_1771053064030_178_opt2",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "La nomophobie est la peur excessive d'Ãªtre sÃ©parÃ© de son tÃ©lÃ©phone portable (ou d'Ãªtre sans rÃ©seau/batterie).",
      "options": [
        {
          "value": "q_1771053064030_178_opt1",
          "label": "La peur des ondes Ã©lectromagnÃ©tiques"
        },
        {
          "value": "q_1771053064030_178_opt2",
          "label": "La peur d'Ãªtre sans son tÃ©lÃ©phone portable"
        },
        {
          "value": "q_1771053064030_178_opt3",
          "label": "La peur de recevoir des appels inconnus"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053064474_100",
      "label": "2",
      "competence": "C3",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Quel est l'effet principal de la lumiÃ¨re bleue des Ã©crans sur le sommeil ?",
      "reponseCorrecte": "q_1771053064474_100_opt2",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "Elle bloque la sÃ©crÃ©tion de mÃ©latonine, l'hormone qui favorise l'endormissement.",
      "options": [
        {
          "value": "q_1771053064474_100_opt1",
          "label": "Elle aide Ã  s'endormir plus vite"
        },
        {
          "value": "q_1771053064474_100_opt2",
          "label": "Elle retarde l'endormissement en bloquant la mÃ©latonine"
        },
        {
          "value": "q_1771053064474_100_opt3",
          "label": "Elle amÃ©liore la qualitÃ© des rÃªves"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053064828_294",
      "label": "3",
      "competence": "C2",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Qu'appelle-t-on le Â« Text-Neck Â» ?",
      "reponseCorrecte": "q_1771053064828_294_opt1",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "Ce sont des douleurs cervicales causÃ©es par la posture tÃªte penchÃ©e pour regarder l'Ã©cran.",
      "options": [
        {
          "value": "q_1771053064828_294_opt1",
          "label": "Des douleurs cervicales liÃ©es Ã  la posture penchÃ©e"
        },
        {
          "value": "q_1771053064828_294_opt2",
          "label": "Une crampe au pouce Ã  force d'Ã©crire"
        },
        {
          "value": "q_1771053064828_294_opt3",
          "label": "Une fatigue visuelle intense"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053065085_237",
      "label": "4",
      "competence": "C2",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Qu'est-ce que le Â« Phubbing Â» ?",
      "reponseCorrecte": "q_1771053065085_237_opt3",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "Le Phubbing (tÃ©lÃ©-snobisme) est le fait d'ignorer les personnes prÃ©sentes physiquement pour consulter son tÃ©lÃ©phone.",
      "options": [
        {
          "value": "q_1771053065085_237_opt1",
          "label": "Le piratage de donnÃ©es personnelles"
        },
        {
          "value": "q_1771053065085_237_opt2",
          "label": "L'envoi de messages publicitaires"
        },
        {
          "value": "q_1771053065085_237_opt3",
          "label": "Le fait d'ignorer son entourage pour regarder son tÃ©lÃ©phone"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053065302_451",
      "label": "5",
      "competence": "C2",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Quel est un risque majeur de l'Ã©coute prolongÃ©e de musique Ã  fort volume avec un casque ?",
      "reponseCorrecte": "q_1771053065302_451_opt2",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "Le risque principal est la perte d'audition irrÃ©versible (surditÃ© prÃ©coce) et les acouphÃ¨nes.",
      "options": [
        {
          "value": "q_1771053065302_451_opt1",
          "label": "La dÃ©shydratation"
        },
        {
          "value": "q_1771053065302_451_opt2",
          "label": "La perte d'audition irrÃ©versible"
        },
        {
          "value": "q_1771053065302_451_opt3",
          "label": "L'augmentation de la vue"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053065644_345",
      "label": "6",
      "competence": "C2",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Quel signe peut indiquer une cyberaddiction ?",
      "reponseCorrecte": "q_1771053065644_345_opt1",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "Le repli sur soi, l'isolement social et l'abandon des autres activitÃ©s sont des signes d'alerte.",
      "options": [
        {
          "value": "q_1771053065644_345_opt1",
          "label": "L'isolement social et le dÃ©laissement des activitÃ©s"
        },
        {
          "value": "q_1771053065644_345_opt2",
          "label": "Une meilleure organisation du travail"
        },
        {
          "value": "q_1771053065644_345_opt3",
          "label": "L'augmentation de l'activitÃ© physique"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053067716_632",
      "label": "7",
      "competence": "C3",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Que signifie le DAS (DÃ©bit d'Absorption SpÃ©cifique) d'un tÃ©lÃ©phone ?",
      "reponseCorrecte": "q_1771053067716_632_opt2",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "C'est l'indice qui mesure la quantitÃ© d'Ã©nergie (ondes) absorbÃ©e par le corps lors de l'utilisation de l'appareil.",
      "options": [
        {
          "value": "q_1771053067716_632_opt1",
          "label": "La vitesse de connexion internet"
        },
        {
          "value": "q_1771053067716_632_opt2",
          "label": "La quantitÃ© d'ondes absorbÃ©es par le corps"
        },
        {
          "value": "q_1771053067716_632_opt3",
          "label": "La capacitÃ© de stockage de la mÃ©moire"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053072173_189",
      "label": "8",
      "competence": "C3",
      "bareme": 1,
      "inputType": "vrai_faux",
      "autocorrect": true,
      "questionText": "Consulter son tÃ©lÃ©phone au volant multiplie le risque d'accident par 3.",
      "reponseCorrecte": "vrai",
      "reponseAttendue": "Vrai"
    },
    {
      "type": "question",
      "qid": "q_1771053072607_1",
      "label": "9",
      "competence": "C1",
      "bareme": 1,
      "inputType": "vrai_faux",
      "autocorrect": true,
      "questionText": "Le cerveau des adolescents est plus sensible aux addictions que celui des adultes.",
      "reponseCorrecte": "vrai",
      "reponseAttendue": "Vrai"
    },
    {
      "type": "question",
      "qid": "q_1771053074151_115",
      "label": "10",
      "competence": "C5",
      "bareme": 1,
      "inputType": "number",
      "autocorrect": true,
      "questionText": "Combien d'heures avant le coucher est-il conseillÃ© d'arrÃªter les Ã©crans ?",
      "reponseCorrecte": 1,
      "reponseAttendue": "1",
      "tolerance": 0
    },
    {
      "type": "question",
      "qid": "q_1771053079684_41",
      "label": "11",
      "competence": "C2",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Quelle astuce permet de rÃ©duire la fatigue visuelle liÃ©e aux Ã©crans ?",
      "reponseCorrecte": "q_1771053079684_41_opt3",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "La rÃ¨gle du 20-20-20 : toutes les 20 minutes, regarder Ã  20 pieds (6m) pendant 20 secondes.",
      "options": [
        {
          "value": "q_1771053079684_41_opt1",
          "label": "Augmenter la luminositÃ© au maximum"
        },
        {
          "value": "q_1771053079684_41_opt2",
          "label": "Regarder l'Ã©cran dans le noir complet"
        },
        {
          "value": "q_1771053079684_41_opt3",
          "label": "Faire des pauses rÃ©guliÃ¨res pour regarder au loin"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053080232_609",
      "label": "12",
      "competence": "C3",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Comment limiter son exposition aux ondes lors d'un appel ?",
      "reponseCorrecte": "q_1771053080232_609_opt1",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "Utiliser un kit mains-libres ou le haut-parleur Ã©loigne le tÃ©lÃ©phone de la tÃªte.",
      "options": [
        {
          "value": "q_1771053080232_609_opt1",
          "label": "Utiliser un kit mains-libres"
        },
        {
          "value": "q_1771053080232_609_opt2",
          "label": "Coller le tÃ©lÃ©phone Ã  l'oreille"
        },
        {
          "value": "q_1771053080232_609_opt3",
          "label": "Appeler uniquement dans les ascenseurs"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053088182_449",
      "label": "13",
      "competence": "C2",
      "bareme": 1,
      "inputType": "vrai_faux",
      "autocorrect": true,
      "questionText": "Le cyberharcÃ¨lement est puni par la loi.",
      "reponseCorrecte": "vrai",
      "reponseAttendue": "Vrai"
    },
    {
      "type": "question",
      "qid": "q_1771053088786_643",
      "label": "14",
      "competence": "C4",
      "bareme": 1,
      "inputType": "number",
      "autocorrect": true,
      "questionText": "Quel est le seuil de danger pour l'audition (en dÃ©cibels) ?",
      "reponseCorrecte": 85,
      "reponseAttendue": "85",
      "tolerance": 0
    },
    {
      "type": "question",
      "qid": "q_1771053093307_270",
      "label": "15",
      "competence": "C3",
      "bareme": 1,
      "inputType": "number",
      "autocorrect": true,
      "questionText": "Quelle distance minimale (en cm) est recommandÃ©e entre les yeux et l'Ã©cran ?",
      "reponseCorrecte": 30,
      "reponseAttendue": "30",
      "tolerance": 0
    },
    {
      "type": "question",
      "qid": "q_1771053095339_103",
      "label": "16",
      "competence": "C1",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Quel est l'impact environnemental majeur de la fabrication des smartphones ?",
      "reponseCorrecte": "q_1771053095339_103_opt2",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "L'extraction de mÃ©taux rares (terres rares) qui est trÃ¨s polluante.",
      "options": [
        {
          "value": "q_1771053095339_103_opt1",
          "label": "L'utilisation de papier"
        },
        {
          "value": "q_1771053095339_103_opt2",
          "label": "L'extraction de mÃ©taux rares et la pollution"
        },
        {
          "value": "q_1771053095339_103_opt3",
          "label": "La consommation d'eau potable lors de l'appel"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053099587_595",
      "label": "17",
      "competence": "C2",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Quelle est une bonne pratique de Â« Digital Detox Â» ?",
      "reponseCorrecte": "q_1771053099587_595_opt3",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "DÃ©sactiver les notifications et dÃ©finir des zones Â« sans tÃ©lÃ©phone Â» (ex: Ã  table).",
      "options": [
        {
          "value": "q_1771053099587_595_opt1",
          "label": "Acheter un deuxiÃ¨me tÃ©lÃ©phone"
        },
        {
          "value": "q_1771053099587_595_opt2",
          "label": "Dormir avec son tÃ©lÃ©phone"
        },
        {
          "value": "q_1771053099587_595_opt3",
          "label": "DÃ©sactiver les notifications non essentielles"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053105855_707",
      "label": "18",
      "competence": "C4",
      "bareme": 1,
      "inputType": "checkbox",
      "autocorrect": true,
      "besoinCorrectionManuelle": false,
      "questionText": "Pourquoi est-il dangereux de marcher en regardant son tÃ©lÃ©phone (Â« Smombie Â») ?",
      "reponseCorrecte": "q_1771053105855_707_opt1",
      "reponseEleve": "",
      "correctionMode": "single_exact",
      "reponseAttendue": "On perd la perception de l'environnement (visuelle et auditive), risquant chutes et collisions.",
      "options": [
        {
          "value": "q_1771053105855_707_opt1",
          "label": "Risque de chute ou de collision par inattention"
        },
        {
          "value": "q_1771053105855_707_opt2",
          "label": "Risque d'amÃ©liorer son endurance"
        },
        {
          "value": "q_1771053105855_707_opt3",
          "label": "Risque de perdre du rÃ©seau"
        }
      ]
    },
    {
      "type": "question",
      "qid": "q_1771053107025_83",
      "label": "19",
      "competence": "C3",
      "bareme": 1,
      "inputType": "vrai_faux",
      "autocorrect": true,
      "questionText": "Le tÃ©lÃ©phone portable est autorisÃ© en classe au lycÃ©e et en CFA sans restriction.",
      "reponseCorrecte": "faux",
      "reponseAttendue": "Faux"
    },
    {
      "type": "question",
      "qid": "q_1771053110503_999",
      "label": "20",
      "competence": "C2",
      "bareme": 1,
      "inputType": "vrai_faux",
      "autocorrect": true,
      "questionText": "Les notifications stimulent le circuit de la rÃ©compense (dopamine) dans le cerveau.",
      "reponseCorrecte": "vrai",
      "reponseAttendue": "Vrai"
    }
  ]
};
</script>
        

<script type="module" src="https://mapse.fr/annuaire.js"></script>
<script type="module" src="https://mapse.fr/assets/pse-runner.js"></script>

<script>
    const statusEl = document.getElementById("envoi-status");
    statusEl.textContent = "Chargement des modules...";

    // VÃ©rification simple : si window.envoyerCopie existe, c'est chargÃ©
    const checkLoaded = setInterval(() => {
        if (window.envoyerCopie) {
            statusEl.textContent = "SystÃ¨me prÃªt.";
            statusEl.style.color = "green";
            console.log("Modules chargÃ©s avec succÃ¨s (mÃ©thode directe).");
            clearInterval(checkLoaded);
        }
    }, 500);

    // SÃ©curitÃ© au bout de 10 secondes
    setTimeout(() => {
        if (!window.envoyerCopie) {
            statusEl.textContent = "Si ce message persiste, vÃ©rifiez votre connexion ou contactez le support.";
            statusEl.style.color = "#d35400";
        }
    }, 10000);
</script>
</body>
</html>
