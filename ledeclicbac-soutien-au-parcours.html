<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>S√©ance 4 : Le D√©clic - Pourquoi ce dipl√¥me compte</title>
  <style>
    * { box-sizing: border-box; }

    html { font-size: 16px; }

    body {
      margin: 0; padding: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      background: #fdfbf7; color: #333;
      line-height: 1.6;
      overflow-x: hidden;
    }

    .container {
      max-width: 1000px;
      margin: 22px auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      overflow: hidden;
      border: 1px solid #e5e7eb;
    }

    .font-controls{
      position: sticky;
      top: 10px;
      z-index: 50;
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      padding: 10px 12px 0;
      background: transparent;
    }

    .font-btn{
      border: none;
      border-radius: 999px;
      padding: 8px 12px;
      font-weight: 800;
      cursor: pointer;
      background: #c2410c;
      color: #fff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.10);
      touch-action: manipulation;
    }

    .font-btn:active{ transform: translateY(1px); }

    header {
      background: linear-gradient(135deg, #ea580c, #c2410c);
      color: white;
      padding: 25px 30px;
    }

    header h1 { margin: 0; font-size: 1.6rem; }
    header p { margin: 5px 0 0; opacity: 0.9; font-size: 0.95rem; }

    .progress-bar {
      display: flex;
      justify-content: space-between;
      padding: 20px 30px;
      background: #fff7ed;
      border-bottom: 1px solid #fed7aa;
      gap: 12px;
      flex-wrap: wrap;
    }

    .step {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      color: #9ca3af;
      font-weight: 700;
      flex: 1 1 210px;
      min-width: 200px;
    }

    .step-circle {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #e5e7eb;
      color: #6b7280;
      display: flex;
      align-items: center;
      justify-content: center;
      flex: 0 0 auto;
    }

    .step.active { color: #ea580c; }
    .step.active .step-circle { background: #ea580c; color: white; }
    .step.completed .step-circle { background: #16a34a; color: white; }

    .page-content {
      padding: 30px 40px;
      display: none;
      animation: fadeIn 0.4s ease;
    }

    .page-content.active { display: block; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      color: #9a3412;
      font-size: 1.4rem;
      border-bottom: 2px solid #fed7aa;
      padding-bottom: 10px;
      margin-top: 0;
    }

    h3 {
      color: #ea580c;
      font-size: 1.1rem;
      margin-top: 25px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .intro-box {
      background: #eff6ff;
      border-left: 4px solid #3b82f6;
      padding: 15px;
      margin-bottom: 20px;
      font-size: 0.95rem;
      color: #1e3a8a;
      border-radius: 6px;
      overflow-wrap: anywhere;
    }

    .card-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .info-card {
      background: #fafafa;
      border: 1px solid #e5e7eb;
      padding: 20px;
      border-radius: 8px;
      overflow-wrap: anywhere;
    }

    .info-card strong { color: #ea580c; display: block; margin-bottom: 5px; }

    .salary-table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
      font-size: 0.92rem;
      display: block;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .salary-table thead, .salary-table tbody, .salary-table tr {
      display: table;
      width: 100%;
      table-layout: fixed;
    }

    .salary-table th { background: #ea580c; color: white; padding: 10px; text-align: center; }
    .salary-table td { border: 1px solid #fed7aa; padding: 10px; text-align: center; }
    .salary-highlight { background: #fff7ed; font-weight: 800; color: #c2410c; }

    textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      min-height: 80px;
      margin-top: 8px;
      font-family: inherit;
      font-size: 0.95rem;
      background: #f9fafb;
      resize: none;
      overflow-y: hidden;
    }

    textarea:focus { outline: none; border-color: #ea580c; background: #fff; box-shadow: 0 0 0 2px rgba(234,88,12,0.18); }

    .chip-container { display: flex; flex-wrap: wrap; gap: 10px; margin: 10px 0; }
    .chip {
      padding: 8px 12px;
      border: 1px solid #cbd5e1;
      border-radius: 999px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: 0.2s;
      background: white;
      user-select: none;
      max-width: 100%;
      overflow-wrap: anywhere;
      touch-action: manipulation;
    }

    .chip:hover { background: #f1f5f9; }
    .chip.selected { background: #ea580c; color: white; border-color: #ea580c; }

    .nav-buttons {
      padding: 20px 40px;
      background: #f9fafb;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 10px 24px;
      border-radius: 10px;
      font-weight: 800;
      cursor: pointer;
      border: none;
      font-size: 0.98rem;
      transition: 0.2s;
      touch-action: manipulation;
    }

    .btn-prev { background: #e5e7eb; color: #374151; }
    .btn-next { background: #ea580c; color: white; }
    .btn-save { background: #16a34a; color: white; }
    .btn:hover { opacity: 0.92; transform: translateY(-1px); }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

    .hidden { display: none; }

    .highlight-box {
      background: #fffbeb;
      border: 1px dashed #f59e0b;
      padding: 15px;
      border-radius: 10px;
      margin-top: 10px;
      overflow-wrap: anywhere;
    }

    @media (max-width: 900px){
      .container { margin: 14px 12px; }
      header { padding: 18px 16px; }
      .progress-bar { padding: 14px 16px; }
      .page-content { padding: 18px 16px; }
      .nav-buttons { padding: 14px 16px; }
      .card-grid { grid-template-columns: 1fr; }
      header h1 { font-size: 1.35rem; }
      h2 { font-size: 1.22rem; }
      .step { min-width: 180px; }
    }

    @media (max-width: 520px){
      .step { flex: 1 1 100%; min-width: 0; }
      .btn { width: 100%; }
      .nav-buttons > div { display: none; }
      .font-controls{ justify-content: center; }
    }
  </style>
</head>

<body>

<div class="container">
  <div class="font-controls" aria-label="Taille du texte">
    <button class="font-btn" type="button" onclick="changeSize(-1)">A-</button>
    <button class="font-btn" type="button" onclick="changeSize(1)">A+</button>
  </div>

  <header>
    <h1>S√©ance 4 : Le D√©clic üöÄ</h1>
    <p>Comprendre la valeur r√©elle de ton dipl√¥me : Social, Financier, International.</p>
  </header>

  <div class="progress-bar">
    <div class="step active" id="step1">
      <div class="step-circle">1</div>
      <span>Statut & Intellect</span>
    </div>
    <div class="step" id="step2">
      <div class="step-circle">2</div>
      <span>Argent & Carri√®re</span>
    </div>
    <div class="step" id="step3">
      <div class="step-circle">3</div>
      <span>Passeport Mondial</span>
    </div>
    <div class="step" id="step4">
      <div class="step-circle">4</div>
      <span>Mon Engagement</span>
    </div>
  </div>

  <div class="page-content active" id="page1">
    <h2>Page 1 : Au-del√† du lyc√©e, ton statut social</h2>

    <div class="intro-box">
      <strong>Le Saviez-vous ?</strong> Le Baccalaur√©at a √©t√© cr√©√© par Napol√©on en 1808. √Ä l'√©poque, c'√©tait pour s√©lectionner l'√©lite. Aujourd'hui, il s'est d√©mocratis√©, mais il garde sa fonction premi√®re : prouver que tu sais <strong>r√©fl√©chir</strong>, pas seulement ob√©ir.
    </div>

    <h3>1. La diff√©rence invisible : Niveau 3 vs Niveau 4</h3>
    <p>Dans le monde du travail et de l'administration, on te classe par "Niveau".</p>

    <div class="card-grid">
      <div class="info-card">
        <strong>Niveau 3 (CAP / Brevet)</strong>
        <p><em>L'Ex√©cutant</em></p>
        <ul style="font-size:0.95rem; padding-left:20px; margin: 0;">
          <li>On te dit quoi faire.</li>
          <li>Tu appliques des consignes simples.</li>
          <li>Tu es remplacable facilement.</li>
        </ul>
      </div>

      <div class="info-card" style="border-color: #ea580c; background: #fff7ed;">
        <strong>Niveau 4 (BAC PRO / G√©n√©ral)</strong>
        <p><em>Le Technicien / Le Pilote</em></p>
        <ul style="font-size:0.95rem; padding-left:20px; margin: 0;">
          <li>Tu comprends <strong>pourquoi</strong> tu le fais.</li>
          <li>Tu sais g√©rer des impr√©vus et organiser.</li>
          <li>Tu as acc√®s aux responsabilit√©s.</li>
        </ul>
      </div>
    </div>

    <label>Qu'est-ce que cela t'inspire ?</label>
    <textarea id="p1_reflexion" placeholder="Est-ce que tu savais que le Bac te faisait changer de cat√©gorie sociale ? √âcris ton avis ici..."></textarea>
  </div>

  <div class="page-content" id="page2">
    <h2>Page 2 : La R√©alit√© √âconomique üí∞</h2>

    <p>√Ä 18 ans, la diff√©rence de salaire est faible. Mais regarde ce qu'il se passe apr√®s 10 ou 20 ans. La diff√©rence se creuse √©norm√©ment.</p>

    <h3>1. Simulation de Carri√®re (Exemple Tertiaire/Commerce)</h3>
    <table class="salary-table">
      <thead>
        <tr>
          <th>√Çge</th>
          <th>Sans le Bac (Niveau 3)</th>
          <th>Avec le Bac Pro (Niveau 4)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>20 ans (D√©but)</td>
          <td>1 400 ‚Ç¨ net (SMIC)</td>
          <td>1 450 ‚Ç¨ net (SMIC + prime qualif)</td>
        </tr>
        <tr>
          <td>30 ans (+10 ans exp)</td>
          <td>1 500 ‚Ç¨ net (Plafonn√©)</td>
          <td>1 800 ‚Ç¨ net (Chef d'√©quipe)</td>
        </tr>
        <tr>
          <td>45 ans (Confirm√©)</td>
          <td>1 600 ‚Ç¨ net (Plafonn√©)</td>
          <td class="salary-highlight">2 300 ‚Ç¨ net (Responsable / Cadre)</td>
        </tr>
        <tr>
          <td><strong>Bilan Retraite</strong></td>
          <td>Retraite faible</td>
          <td><strong>Meilleure retraite</strong></td>
        </tr>
      </tbody>
    </table>

    <div class="highlight-box">
      <strong>Le pi√®ge :</strong> Sans le Bac, tu restes souvent bloqu√© au SMIC toute ta vie car tu ne peux pas passer les concours internes ou pr√©tendre aux postes de management.
    </div>

    <h3>2. Ton calcul personnel</h3>
    <label>Imagine ta vie √† 30 ans. Est-ce que cette diff√©rence de salaire (environ 300-400‚Ç¨ par mois) est importante pour toi ? Pourquoi ?</label>
    <textarea id="p2_finance" placeholder="Oui, car je voudrais acheter une maison / voyager / avoir une famille..."></textarea>
  </div>

  <div class="page-content" id="page3">
    <h2>Page 3 : Ton Passeport Universel üåç</h2>

    <h3>1. Reconnaissance Internationale</h3>
    <p>Le Baccalaur√©at est un standard. Si tu veux travailler au Canada, en Australie ou ailleurs en Europe :</p>

    <div class="card-grid">
      <div class="info-card">
        <strong>Sans le Bac</strong>
        <p>Tu es consid√©r√© comme "travailleur non qualifi√©". L'obtention de Visa de travail est tr√®s difficile.</p>
      </div>

      <div class="info-card" style="border-color:#16a34a; background:#f0fdf4;">
        <strong>Avec le Bac</strong>
        <p>Ton dipl√¥me est reconnu (Cadre Europ√©en CEC niveau 4). Tu peux t'inscrire en universit√© √† l'√©tranger ou postuler √† des jobs qualifi√©s.</p>
      </div>
    </div>

    <h3>2. Les Portes D√©rob√©es (Concours)</h3>
    <p>Tu n'aimes pas la gestion ? Pas grave. Le Bac AGOrA te donne le droit de passer ces concours (chose impossible sans Bac) :</p>

    <div class="chip-container" id="concoursChips">
      <div class="chip" onclick="toggleChip(this)">üëÆ Gendarmerie (Sous-officier)</div>
      <div class="chip" onclick="toggleChip(this)">üöí Pompier Professionnel</div>
      <div class="chip" onclick="toggleChip(this)">‚úàÔ∏è Personnel Navigant (Steward)</div>
      <div class="chip" onclick="toggleChip(this)">üöÜ Conducteur de Train (SNCF)</div>
      <div class="chip" onclick="toggleChip(this)">üè• Infirmier (via IFSI)</div>
      <div class="chip" onclick="toggleChip(this)">üíº Fonction Publique (Mairie, Imp√¥ts)</div>
    </div>

    <input type="hidden" id="concours_interet" />

    <label>Y a-t-il un m√©tier dans cette liste qui pourrait t'int√©resser plus tard ?</label>
    <textarea id="p3_projet" placeholder="Peut-√™tre gendarme ou..."></textarea>
  </div>

  <div class="page-content" id="page4">
    <h2>Page 4 : Mon Bilan & Strat√©gie üéØ</h2>

    <div class="intro-box" style="border-color: #ea580c; background: #fff7ed; color: #9a3412;">
      <strong>Conclusion :</strong> Tu n'es peut-√™tre pas en AGOrA par passion. Mais tu comprends maintenant que ce dipl√¥me est un outil. C'est ta s√©curit√©.
    </div>

    <h3>1. Ma d√©cision</h3>
    <label>Compte tenu de ce que tu as lu (Salaire, Statut, Concours), quel est ton √©tat d'esprit aujourd'hui ?</label>

    <div class="chip-container" id="decisionChips">
      <div class="chip" onclick="selectSingleChip(this)">Je vais avoir ce Bac par strat√©gie (pour mon futur).</div>
      <div class="chip" onclick="selectSingleChip(this)">Je suis toujours perdu(e), mais je comprends l'enjeu.</div>
      <div class="chip" onclick="selectSingleChip(this)">Je commence √† trouver de l'int√©r√™t √† la formation.</div>
    </div>

    <input type="hidden" id="decision_finale" />

    <h3>2. Lettre √† moi-m√™me</h3>
    <label>√âcris une phrase pour te motiver quand tu auras envie de baisser les bras cette ann√©e :</label>
    <textarea id="p4_lettre" style="border: 2px solid #ea580c;" placeholder="Je m'accroche jusqu'au Bac parce que je veux avoir le choix de ma vie plus tard, et gagner ma libert√©..."></textarea>

    <div style="margin-top: 30px; padding: 20px; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 10px;">
      <h4 style="margin-top:0; color:#166534;">üéâ F√©licitations !</h4>
      <p style="margin:0; font-size:0.95rem;">Tu as termin√© cette r√©flexion en profondeur. N'oublie pas d'enregistrer ton travail pour le garder pour toi.</p>
    </div>
  </div>

  <div class="nav-buttons">
    <button class="btn btn-prev" id="prevBtn" onclick="changePage(-1)" disabled>Pr√©c√©dent</button>
    <div style="flex-grow:1;"></div>
    <button class="btn btn-next" id="nextBtn" onclick="changePage(1)">Suivant</button>
    <button class="btn btn-save hidden" id="saveBtn" onclick="saveWork()">üíæ Enregistrer mon fichier</button>
  </div>
</div>

<script>
  let currentSize = 16;

  function changeSize(delta) {
    currentSize += delta;
    if (currentSize < 12) currentSize = 12;
    if (currentSize > 24) currentSize = 24;
    document.documentElement.style.fontSize = currentSize + "px";
    const h1 = document.querySelector("h1");
    if (h1) h1.style.fontSize = (2 * (currentSize / 16)) + "rem";
    document.querySelectorAll("textarea").forEach(ta => autoResize(ta));
  }

  function autoResize(el) {
    el.style.height = "auto";
    el.style.height = (el.scrollHeight + 2) + "px";
  }

  document.querySelectorAll("textarea").forEach(ta => {
    autoResize(ta);
    ta.addEventListener("input", () => autoResize(ta));
  });

  let currentPage = 1;
  const totalPages = 4;

  function changePage(direction) {
    document.getElementById(`page${currentPage}`).classList.remove("active");
    document.getElementById(`step${currentPage}`).classList.remove("active");
    if (direction > 0) document.getElementById(`step${currentPage}`).classList.add("completed");

    currentPage += direction;

    document.getElementById(`page${currentPage}`).classList.add("active");
    document.getElementById(`step${currentPage}`).classList.add("active");

    document.getElementById("prevBtn").disabled = (currentPage === 1);

    if (currentPage === totalPages) {
      document.getElementById("nextBtn").classList.add("hidden");
      document.getElementById("saveBtn").classList.remove("hidden");
    } else {
      document.getElementById("nextBtn").classList.remove("hidden");
      document.getElementById("saveBtn").classList.add("hidden");
    }

    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  function toggleChip(chip) {
    chip.classList.toggle("selected");
    updateHiddenInput("concours_interet", "#concoursChips .chip.selected");
  }

  function selectSingleChip(chip) {
    chip.parentElement.querySelectorAll(".chip").forEach(c => c.classList.remove("selected"));
    chip.classList.add("selected");
    document.getElementById("decision_finale").value = chip.innerText.trim();
  }

  function updateHiddenInput(id, selector) {
    const values = Array.from(document.querySelectorAll(selector)).map(c => c.innerText.trim());
    document.getElementById(id).value = values.join(", ");
  }

  function safeFileStamp() {
    const d = new Date();
    const pad = n => String(n).padStart(2, "0");
    return d.getFullYear() + pad(d.getMonth() + 1) + pad(d.getDate()) + "_" + pad(d.getHours()) + pad(d.getMinutes());
  }

  function saveWork() {
    document.querySelectorAll("input, textarea").forEach(el => {
      if (el.tagName === "INPUT") el.setAttribute("value", el.value);
      if (el.tagName === "TEXTAREA") el.textContent = el.value;
    });

    const htmlContent = "<!DOCTYPE html>\n" + document.documentElement.outerHTML;
    const blob = new Blob([htmlContent], { type: "text/html" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "Seance4_Declic_ANONYME_" + safeFileStamp() + ".html";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(a.href);
  }
</script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
  import { getFirestore, collection, addDoc, updateDoc, doc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAWdCMvOiAJln3eT9LIAQD3RWJUD0lQcLI",
    authDomain: "devoirs-pse.firebaseapp.com",
    projectId: "devoirs-pse",
    storageBucket: "devoirs-pse.appspot.com",
    messagingSenderId: "614730413904",
    appId: "1:614730413904:web:a5dd478af5de30f6bede55"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  let currentDocId = null;
  let startTime = Date.now();

  function getIdentity() { return localStorage.getItem("cockpit_student_id"); }

  async function demarrerVisite() {
    try {
      let userCode = getIdentity() || "ANONYME";
      let userClass = localStorage.getItem("cockpit_student_class") || "VISITEUR";
      const pageName = document.title || window.location.pathname.split("/").pop();
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);

      const ref = await addDoc(collection(db, "statistiques_usage"), {
        page: pageName,
        userCode: userCode,
        classe: userClass,
        device: isMobile ? "Mobile" : "Desktop",
        action: "Consultation",
        duree: 0,
        timestamp: serverTimestamp(),
        date: new Date().toISOString()
      });

      currentDocId = ref.id;

      setInterval(async () => {
        if (currentDocId && document.visibilityState === "visible") {
          try {
            await updateDoc(doc(db, "statistiques_usage", currentDocId), {
              duree: Math.floor((Date.now() - startTime) / 1000)
            });
          } catch (e) {}
        }
      }, 10000);

    } catch (e) { console.warn("Erreur Tracker", e); }
  }

  demarrerVisite();
</script>

</body>
</html>
