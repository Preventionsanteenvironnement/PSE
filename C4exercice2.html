<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PSE Bac Pro — Compétence C4 — Exercice 2</title>
  <style>
    :root{--bg:#071018;--card:#0e1b2a;--card2:#0c1623;--txt:#eaf3ff;--muted:#b7c8e6;--accent:#8bf1ff;--accent2:#b0ff9e;--warn:#ffd79a;--bad:#ff7aa0;--ok:#7cff8a}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:radial-gradient(1000px 700px at 10% 10%, #173b7a 0%, rgba(7,16,24,0) 55%),radial-gradient(900px 700px at 90% 20%, #0e6b63 0%, rgba(7,16,24,0) 55%),linear-gradient(180deg,#071018,#050a10);color:var(--txt);line-height:1.35}
    .wrap{max-width:1050px;margin:0 auto;padding:22px 16px 44px}
    header{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap}
    .left{display:flex;gap:12px;align-items:flex-start}
    .badge{padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.06);font-weight:800}
    h1{font-size:22px;margin:0 0 6px 0}
    .sub{margin:0;color:var(--muted)}
    .chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .chip{font-size:12px;padding:6px 8px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:14px;margin-top:14px}
    @media(max-width:920px){.grid{grid-template-columns:1fr}}
    .card{background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));border:1px solid rgba(255,255,255,.12);border-radius:18px;padding:14px}
    .card h2{font-size:16px;margin:0 0 10px 0}
    .mini{background:rgba(0,0,0,.18);border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:12px}
    .muted{color:var(--muted)}
    .q{margin-top:10px;padding:12px;border-radius:16px;background:rgba(0,0,0,.18);border:1px solid rgba(255,255,255,.10)}
    .q h3{font-size:14px;margin:0 0 8px 0}
    .cols{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media(max-width:700px){.cols{grid-template-columns:1fr}}
    .zone{min-height:170px;padding:10px;border-radius:16px;border:1px dashed rgba(255,255,255,.25);background:rgba(15,22,35,.55)}
    .zone strong{display:block;margin-bottom:8px}
    .cardItem{user-select:none;cursor:grab;display:flex;gap:10px;align-items:flex-start;padding:10px;border-radius:14px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);margin:8px 0}
    .cardItem:active{cursor:grabbing}
    .dot{width:10px;height:10px;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--accent2));margin-top:5px;flex:0 0 auto}
    button{appearance:none;border:0;border-radius:14px;padding:10px 12px;font-weight:900;color:#06101a;background:var(--accent);cursor:pointer}
    button.secondary{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.16);color:var(--txt)}
    button.ghost{background:transparent;border:1px dashed rgba(255,255,255,.25);color:var(--muted)}
    .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .scorebox{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .bar{flex:1;height:12px;border-radius:999px;background:rgba(255,255,255,.10);border:1px solid rgba(255,255,255,.14);overflow:hidden}
    .fill{height:100%;width:0%;background:linear-gradient(90deg,var(--warn),var(--accent),var(--accent2));transition:width .35s ease}
    .score{font-weight:950}
    .ok{color:var(--ok);font-weight:800}
    .bad{color:var(--bad);font-weight:800}
    .model{display:none;margin-top:10px;padding:10px;border-radius:14px;background:rgba(124,255,138,.08);border:1px solid rgba(124,255,138,.22)}
    textarea{width:100%;border-radius:12px;border:1px solid rgba(255,255,255,.14);background:rgba(15,22,35,.75);color:var(--txt);padding:10px 10px;font-size:14px;min-height:90px;resize:vertical}
    .checkline{display:flex;gap:10px;align-items:flex-start;padding:10px;border-radius:14px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.10);margin-top:8px}
    .checkline input{margin-top:3px;transform:scale(1.1)}
    .footer{margin-top:12px;color:var(--muted);font-size:12px}
    @media print{
      body{background:#fff;color:#000}
      .wrap{max-width:none}
      .card,.q,.mini,.zone{background:#fff;border:1px solid #ccc}
      button,.footer{display:none !important}
      textarea{border:1px solid #777;color:#000;background:#fff}
      .model{display:block !important;border:1px solid #7a7a7a;background:#f7fff8}
      .cardItem{border:1px solid #aaa}
    }
  
    .token{touch-action:none;-webkit-user-select:none;user-select:none;}
    .token.dragging{opacity:.92;box-shadow:0 18px 50px rgba(0,0,0,.35);}
    .drop-hover{outline:3px solid rgba(124,92,255,.6);outline-offset:4px;}
    .placeholder{border:2px dashed rgba(124,92,255,.6);border-radius:14px;min-height:44px;}

</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="left">
      <div class="badge">PSE</div>
      <div>
        <h1>Compétence C4 — Proposer une solution pour résoudre un problème</h1>
        <p class="sub">Exercice 2 — Environnement (transport/alimentation) + Sécurité (chantier)</p>
        <div class="chips">
          <span class="chip">C4</span>
          <span class="chip">C6</span>
          <span class="chip">Glisser‑déposer</span>
          <span class="chip">Auto‑évaluation</span>
        </div>
      </div>
    </div>
    <div class="badge">Score / 12</div>
  </header>

  <div class="grid">
    <main class="card">
      <h2>1) Glisser‑déposer — Trier des mesures</h2>
      <div class="mini">
        <div class="muted">
          Fais glisser chaque carte dans la bonne zone :
          <b>mesure collective</b> (organisation) ou <b>mesure individuelle</b> (personne).
        </div>
      </div>

      <div class="q">
        <h3>Thème Transport — Réduire les émissions de GES</h3>
        <div class="cols">
          <div class="zone" data-zone="collectif">
            <strong>Collectif</strong>
            <div class="muted">Exemples : organiser, développer, aménager, mettre en place…</div>
          </div>
          <div class="zone" data-zone="individuel">
            <strong>Individuel</strong>
            <div class="muted">Exemples : choisir, utiliser, se déplacer, réduire…</div>
          </div>
        </div>

        <div class="mini" style="margin-top:10px">
          <strong>Cartes à trier</strong>
          <div id="pool" class="zone" style="min-height:120px">
            <div class="cardItem" draggable="true" data-good="collectif"><div class="dot"></div><div>Développer des transports en commun utilisant des énergies vertes</div></div>
            <div class="cardItem" draggable="true" data-good="collectif"><div class="dot"></div><div>Encourager le covoiturage (organisation, plateformes, incitations)</div></div>
            <div class="cardItem" draggable="true" data-good="collectif"><div class="dot"></div><div>Mettre en place des mobilités douces autour des lieux (pistes, parkings vélo)</div></div>
            <div class="cardItem" draggable="true" data-good="individuel"><div class="dot"></div><div>Se déplacer à vélo</div></div>
            <div class="cardItem" draggable="true" data-good="individuel"><div class="dot"></div><div>Aller à pied quand c’est possible</div></div>
          </div>
        </div>

        <div class="btns">
          <button class="secondary" id="checkDrag">Vérifier</button>
          <button class="ghost" id="resetDrag">Réinitialiser</button>
        </div>
        <div class="muted" id="dragFeedback" style="margin-top:8px"></div>
      </div>

      <div class="q">
        <h3>2) Choisir 2 solutions — Gaspillage alimentaire</h3>
        <div class="muted">Coche exactement 2 solutions adaptées pour réduire le gaspillage dans des lieux de restauration.</div>
        <div class="checkline"><input type="checkbox" class="waste" data-ok="1"><div>Réduire les quantités servies (adapter les portions)</div></div>
        <div class="checkline"><input type="checkbox" class="waste" data-ok="1"><div>Améliorer la gestion des stocks</div></div>
        <div class="checkline"><input type="checkbox" class="waste" data-ok="1"><div>Donner les invendus à des associations alimentaires</div></div>
        <div class="checkline"><input type="checkbox" class="waste" data-ok="0"><div>Augmenter les portions pour satisfaire tout le monde</div></div>
        <div class="checkline"><input type="checkbox" class="waste" data-ok="0"><div>Ne rien changer, c’est normal de jeter</div></div>

        <div class="btns">
          <button class="secondary" id="checkWaste">Vérifier</button>
          <button class="ghost" id="resetWaste">Réinitialiser</button>
          <button id="showWasteModel">Voir les réponses attendues</button>
        </div>
        <div class="muted" id="wasteFeedback" style="margin-top:8px"></div>
        <div class="model" id="wasteModel">
          <b>Réponses attendues possibles</b><br>
          Réduire les quantités • Bonne gestion des stocks • Don aux associations alimentaires.
        </div>
      </div>

      <div class="q">
        <h3>3) Réponse ouverte guidée — Mesures de prévention (chantier)</h3>
        <div class="muted">
          Situation : un risque lié à la circulation d’engins et de piétons est jugé prioritaire.<br>
          Propose <b>2 mesures différentes</b> : <b>1 collective</b> et <b>1 individuelle</b>.
        </div>

        <div class="cols" style="margin-top:10px">
          <div class="mini">
            <strong>Mesure collective</strong>
            <textarea id="taC" placeholder="Ex : équiper les engins… organiser les circulations… installer…"></textarea>
          </div>
          <div class="mini">
            <strong>Mesure individuelle</strong>
            <textarea id="taI" placeholder="Ex : porter… utiliser… respecter…"></textarea>
          </div>
        </div>

        <div class="btns">
          <button id="showModel3">Afficher les réponses modèles</button>
          <button class="secondary" id="scoreOpen">Auto‑évaluer</button>
          <button class="ghost" id="resetOpen">Réinitialiser</button>
        </div>

        <div class="model" id="model3">
          <b>Réponses modèles (exemples)</b><br>
          <span class="muted">
            <b>Collectif</b> : équiper les engins de rétroviseurs performants, caméra/radar de recul, caméra intelligente ; brider la vitesse ; séparer les sens de circulation engins/piétons.<br>
            <b>Individuel</b> : porter un gilet réfléchissant (haute visibilité).
          </span>
        </div>

        <div class="checkline"><input type="checkbox" class="openChk" data-pts="1"><div>Ma mesure collective est <b>réaliste</b> et adaptée au chantier.</div></div>
        <div class="checkline"><input type="checkbox" class="openChk" data-pts="1"><div>Ma mesure individuelle est une <b>action de la personne</b> (EPI/consigne…).</div></div>
        <div class="checkline"><input type="checkbox" class="openChk" data-pts="1"><div>J’ai utilisé au moins <b>1 verbe d’action</b> (installer, équiper, brider, porter…).</div></div>
        <div class="checkline"><input type="checkbox" class="openChk" data-pts="1"><div>J’ai écrit en phrases claires avec au moins <b>1 connecteur</b> (pour, afin de, donc…).</div></div>

        <div class="muted" id="openFeedback" style="margin-top:8px"></div>
      </div>

      <div class="footer">Impression : les réponses modèles s’affichent automatiquement.</div>
    </main>

    <aside class="card">
      <h2>Tableau de bord</h2>
      <div class="mini">
        <div class="scorebox">
          <div class="bar"><div class="fill" id="fill"></div></div>
          <div class="score" id="scoreTxt">0 / 12</div>
        </div>
        <div class="muted" id="globalMsg" style="margin-top:8px">Commence par le glisser‑déposer.</div>
      </div>

      <div class="mini" style="margin-top:10px">
        <h2 style="font-size:16px;margin:0 0 10px">Rappel C4</h2>
        <div class="muted">
          C4 = <b>proposer une action</b> (mesure).<br>
          Si la consigne précise :<br><br>
          <b>Collective</b> : organisation, matériel, aménagement, règles, plan d’action.<br>
          <b>Individuelle</b> : gestes, choix, EPI, habitudes, comportements.
        </div>
      </div>

      <div class="mini" style="margin-top:10px">
        <h2 style="font-size:16px;margin:0 0 10px">Rappel C6</h2>
        <div class="muted">
          Phrases complètes + vocabulaire PSE.<br>
          Connecteurs utiles : pour, afin de, car, donc, ainsi.
        </div>
      </div>
    </aside>
  </div>
</div>

<script>
  const MAX = 12;
  const state = {drag:0, waste:0, open:0};

  function total(){
    return state.drag + state.waste + state.open;
  }
  function refresh(){
    const t = total();
    const pct = Math.round((t/MAX)*100);
    document.getElementById('fill').style.width = pct + '%';
    document.getElementById('scoreTxt').textContent = t + ' / ' + MAX;
    const msg = document.getElementById('globalMsg');
    if(t===0) msg.textContent = 'Commence par le glisser‑déposer.';
    else if(t<5) msg.textContent = 'Continue : vise des mesures mieux catégorisées.';
    else if(t<9) msg.textContent = 'Bien : passe à la réponse ouverte.';
    else msg.textContent = 'Très bien : tu maîtrises C4 + C6.';
  }

  // Drag & drop
  const pool = document.getElementById('pool');
  const zones = document.querySelectorAll('.zone[data-zone]');
  let dragged = null;

  function allowDrop(e){ e.preventDefault(); }
  function onDragStart(e){ dragged = e.currentTarget; e.dataTransfer.setData('text/plain','x'); }
  function onDrop(e){
    e.preventDefault();
    const z = e.currentTarget;
    if(!dragged) return;
    z.appendChild(dragged);
    dragged = null;
  }

  document.querySelectorAll('.cardItem').forEach(el => el.addEventListener('dragstart', onDragStart));
  zones.forEach(z => { z.addEventListener('dragover', allowDrop); z.addEventListener('drop', onDrop); });

  function countCards(where){
    return [...where.querySelectorAll('.cardItem')];
  }

  document.getElementById('checkDrag').addEventListener('click', () => {
    const cZone = document.querySelector('.zone[data-zone="collectif"]');
    const iZone = document.querySelector('.zone[data-zone="individuel"]');

    const cCards = countCards(cZone);
    const iCards = countCards(iZone);

    const allPlaced = (cCards.length + iCards.length) === 5;
    if(!allPlaced){
      document.getElementById('dragFeedback').innerHTML = '<span class="bad">Il manque des cartes</span> : place les 5 cartes dans une zone.';
      state.drag = 0; refresh(); return;
    }

    let ok = 0;
    cCards.forEach(card => { if(card.dataset.good==='collectif') ok++; });
    iCards.forEach(card => { if(card.dataset.good==='individuel') ok++; });

    if(ok===5){
      document.getElementById('dragFeedback').innerHTML = '<span class="ok">Parfait</span> : bon tri collectif/individuel.';
      state.drag = 4; // /4
    }else if(ok>=3){
      document.getElementById('dragFeedback').innerHTML = '<span class="warn">Presque</span> : corrige les cartes mal placées.';
      state.drag = 2;
    }else{
      document.getElementById('dragFeedback').innerHTML = '<span class="bad">À revoir</span> : relis la définition collectif/individuel.';
      state.drag = 0;
    }
    refresh();
  });

  document.getElementById('resetDrag').addEventListener('click', () => {
    const cZone = document.querySelector('.zone[data-zone="collectif"]');
    const iZone = document.querySelector('.zone[data-zone="individuel"]');
    [...cZone.querySelectorAll('.cardItem'), ...iZone.querySelectorAll('.cardItem')].forEach(card => pool.appendChild(card));
    document.getElementById('dragFeedback').textContent = '';
    state.drag = 0; refresh();
  });

  // Waste (4 points)
  const wasteModel = document.getElementById('wasteModel');
  document.getElementById('showWasteModel').addEventListener('click', () => {
    wasteModel.style.display = (wasteModel.style.display==='block') ? 'none' : 'block';
  });

  document.getElementById('checkWaste').addEventListener('click', () => {
    const checks = [...document.querySelectorAll('.waste')];
    const chosen = checks.filter(c => c.checked);
    if(chosen.length !== 2){
      document.getElementById('wasteFeedback').innerHTML = '<span class="bad">Consigne</span> : coche exactement 2 propositions.';
      state.waste = 0; refresh(); return;
    }
    const ok = chosen.every(c => c.dataset.ok === '1');
    if(ok){
      document.getElementById('wasteFeedback').innerHTML = '<span class="ok">Correct</span> : solutions adaptées.';
      state.waste = 4;
    }else{
      document.getElementById('wasteFeedback').innerHTML = '<span class="bad">À corriger</span> : une proposition cochée n’est pas une solution.';
      state.waste = 1;
    }
    refresh();
  });

  document.getElementById('resetWaste').addEventListener('click', () => {
    document.querySelectorAll('.waste').forEach(c => c.checked=false);
    document.getElementById('wasteFeedback').textContent = '';
    wasteModel.style.display='none';
    state.waste = 0; refresh();
  });

  // Open response (4 points via checklist)
  const model3 = document.getElementById('model3');
  document.getElementById('showModel3').addEventListener('click', () => {
    model3.style.display = (model3.style.display==='block') ? 'none' : 'block';
  });

  function updateOpen(){
    const pts = Math.min(4, [...document.querySelectorAll('.openChk')].reduce((s,c)=> s + (c.checked ? Number(c.dataset.pts) : 0), 0));
    state.open = pts;
    const fb = document.getElementById('openFeedback');
    if(pts===0) fb.textContent = 'Compare tes réponses au modèle, puis coche la checklist.';
    else if(pts<3) fb.innerHTML = '<span class="warn">Tu progresses</span> : rends tes mesures plus précises.';
    else fb.innerHTML = '<span class="ok">Très bien</span> : tu proposes des mesures adaptées et claires.';
    refresh();
  }
  document.querySelectorAll('.openChk').forEach(c => c.addEventListener('change', updateOpen));

  document.getElementById('scoreOpen').addEventListener('click', () => {
    updateOpen();
    document.getElementById('openFeedback').scrollIntoView({behavior:'smooth', block:'nearest'});
  });

  document.getElementById('resetOpen').addEventListener('click', () => {
    document.getElementById('taC').value='';
    document.getElementById('taI').value='';
    document.querySelectorAll('.openChk').forEach(c => c.checked=false);
    model3.style.display='none';
    document.getElementById('openFeedback').textContent='';
    state.open = 0; refresh();
  });

  refresh();
</script>
</body>
</html>
