<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSE Speed Run : L'Activit√© Physique</title>
    <style>
        :root {
            --color-bg-dark: #1e1e1e;
            --color-text-light: #f5f5f5;
            --color-primary-green: #4caf50;
            --color-danger-red: #f44336;
            --color-card-dark: #2c2c2c;
            --color-card-border: #444;
            --color-progress: #03a9f4;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--color-bg-dark);
            color: var(--color-text-light);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        header {
            width: 100%;
            max-width: 600px;
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            color: var(--color-primary-green);
            font-size: 2em;
            margin-bottom: 5px;
        }

        #stats {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 600px;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .stat-box {
            background-color: var(--color-card-dark);
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid var(--color-card-border);
            min-width: 100px;
            text-align: center;
        }

        #card-container {
            width: 100%;
            max-width: 400px;
            height: 200px;
            perspective: 1000px;
            margin-bottom: 30px;
        }

        #flashcard {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
        }

        .flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            font-size: 1.4em;
            text-align: center;
            border: 2px solid var(--color-card-border);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
        }

        #front-content {
            background-color: var(--color-card-dark);
            z-index: 2;
        }

        #back-content {
            background-color: var(--color-primary-green);
            color: var(--color-bg-dark);
            transform: rotateY(180deg);
        }

        #controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            max-width: 400px;
        }

        .btn {
            padding: 15px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.1s;
        }

        #flip-btn {
            background-color: #555;
            color: var(--color-text-light);
        }

        #flip-btn:hover {
            background-color: #777;
        }

        #answer-buttons {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        #answer-buttons .btn-answer {
            flex-grow: 1;
        }

        #btn-wrong {
            background-color: var(--color-danger-red);
            color: white;
        }

        #btn-wrong:hover {
            background-color: #d32f2f;
        }

        #btn-correct {
            background-color: var(--color-primary-green);
            color: var(--color-bg-dark);
        }

        #btn-correct:hover {
            background-color: #388e3c;
        }

        #progress-bar-container {
            width: 100%;
            max-width: 600px;
            background-color: #333;
            border-radius: 10px;
            margin-bottom: 20px;
            height: 20px;
            overflow: hidden;
            border: 1px solid var(--color-card-border);
        }

        #progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--color-progress);
            transition: width 0.4s ease-in-out;
        }

        #end-screen {
            background-color: var(--color-card-dark);
            border: 2px solid var(--color-card-border);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.6);
            display: none; /* Hidden by default */
        }

        #end-screen h2 {
            color: var(--color-progress);
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        #end-screen p {
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        #end-screen button {
            background-color: var(--color-progress);
            color: var(--color-bg-dark);
            padding: 12px 25px;
            font-size: 1.2em;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #end-screen button:hover {
            background-color: #0288d1;
        }
    </style>
</head>
<body>

    <header>
        <h1>‚ö° PSE Speed Run ‚ö°</h1>
        <h2>L'Activit√© Physique</h2>
    </header>

    <div id="stats">
        <div class="stat-box">
            Carte: <span id="card-count">0/0</span>
        </div>
        <div class="stat-box">
            Combo: <span id="streak-count">0</span>
        </div>
    </div>

    <div id="progress-bar-container">
        <div id="progress-bar"></div>
    </div>

    <div id="card-container">
        <div id="flashcard">
            <div id="front-content" class="card-face">Cliquez sur ¬´ Retourner ¬ª pour commencer !</div>
            <div id="back-content" class="card-face">...</div>
        </div>
    </div>

    <div id="controls">
        <button id="flip-btn" class="btn" onclick="flipCard()">Retourner la carte</button>
        <div id="answer-buttons" style="display: none;">
            <button id="btn-wrong" class="btn btn-answer" onclick="handleAnswer(false)">‚ùå Je ne savais pas</button>
            <button id="btn-correct" class="btn btn-answer" onclick="handleAnswer(true)">‚úÖ Je savais</button>
        </div>
    </div>

    <div id="end-screen">
        <h2>Partie Termin√©e !</h2>
        <p>Score Final: <span id="final-score">0</span> bonnes r√©ponses sur <span id="total-cards-end">0</span></p>
        <button onclick="initGame(true)">Revoir les erreurs (0 cartes)</button>
    </div>

    <script>
        const allFlashcards = [
            { front: "Probl√®me principal en France (PSE)", back: "Manque d'activit√© physique", type: "D√©finition" },
            { front: "Pourcentage de Fran√ßais inactifs", back: "51%", type: "Chiffre Cl√©" },
            { front: "Cons√©quence du manque d'activit√©", back: "√âvite de nombreuses maladies", type: "R√®gle" },
            { front: "R√¥le de l'activit√© physique", back: "Constituer un capital sant√©", type: "D√©finition" },
            { front: "Qu'augmente l'effort physique ?", back: "Fr√©quence cardiaque et respiratoire", type: "R√®gle" },
            { front: "But de l'augmentation des fr√©quences", back: "Fournir O‚ÇÇ et nutriments aux muscles", type: "R√®gle" },
            { front: "Syst√®me Cardiorespiratoire", back: "Apport d'O‚ÇÇ (dioxyg√®ne) au muscle", type: "D√©finition" },
            { front: "Syst√®me Nerveux", back: "D√©tecte besoin et adapte le corps", type: "D√©finition" },
            { front: "√âl√©ments consomm√©s par le muscle", back: "O‚ÇÇ et nutriments", type: "D√©finition" },
            { front: "Produit l'√©nergie n√©cessaire", back: "Contraction musculaire", type: "R√®gle" },
            { front: "√âl√©ments rejet√©s par le muscle", back: "D√©chets (CO‚ÇÇ)", type: "D√©finition" },
            { front: "D√©finition de la S√©dentarit√©", back: "D√©pense √©nerg√©tique proche du repos", type: "D√©finition" },
            { front: "Niveau de s√©dentarit√© ¬´ √âlev√© ¬ª", back: "> 7h/j (assis ou allong√©)", type: "Chiffre Cl√©" },
            { front: "Recommandation pour 12-17 ans", back: "< 2h d'√©cran / jour", type: "Chiffre Cl√©" },
            { front: "Cons√©quence d'un mode de vie s√©dentaire", back: "AVC, Diab√®te, Cancer, D√©c√®s", type: "D√©finition" },
            { front: "Solution pour lutter contre s√©dentarit√©", back: "Pratiquer une activit√© physique", type: "R√®gle" },
            { front: "Bienfait Physique de l'activit√©", back: "Muscler, √™tre plus endurant", type: "D√©finition" },
            { front: "Bienfait Mental de l'activit√©", back: "G√©rer agressivit√©, am√©liorer concentration", type: "D√©finition" },
            { front: "Bienfait Social de l'activit√©", back: "Rencontrer des gens, appartenir √† un groupe", type: "D√©finition" },
            { front: "Action pour lutter au quotidien", back: "Prendre les escaliers au lieu de l'ascenseur", type: "R√®gle" },
            { front: "L‚ÄôO‚ÇÇ est aussi appel√©...", back: "Dioxyg√®ne", type: "D√©finition" },
            { front: "Le corps d√©tecte le besoin par ce syst√®me", back: "Syst√®me nerveux", type: "R√®gle" }
        ];

        let cards = [];
        let missedCards = [];
        let currentCardIndex = 0;
        let streak = 0;
        let score = 0;
        let isFlipped = false;
        let isReviewMode = false;

        const flashcardElement = document.getElementById('flashcard');
        const frontContent = document.getElementById('front-content');
        const backContent = document.getElementById('back-content');
        const cardCountElement = document.getElementById('card-count');
        const streakCountElement = document.getElementById('streak-count');
        const progressBar = document.getElementById('progress-bar');
        const answerButtons = document.getElementById('answer-buttons');
        const flipButton = document.getElementById('flip-btn');
        const controls = document.getElementById('controls');
        const endScreen = document.getElementById('end-screen');

        /**
         * Initializes the game, either with all cards or missed cards.
         * @param {boolean} reviewMode - If true, starts a review session with missed cards.
         */
        function initGame(reviewMode) {
            isReviewMode = reviewMode;
            cards = reviewMode ? [...missedCards] : [...allFlashcards];
            // Shuffle the cards
            for (let i = cards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [cards[i], cards[j]] = [cards[j], cards[i]];
            }

            missedCards = [];
            currentCardIndex = 0;
            streak = 0;
            score = 0;
            isFlipped = false;

            // Update UI elements
            endScreen.style.display = 'none';
            controls.style.display = 'flex';
            answerButtons.style.display = 'none';
            flipButton.style.display = 'block';
            flashcardElement.classList.remove('flipped');

            if (cards.length === 0) {
                frontContent.textContent = isReviewMode ? "F√©licitations, toutes les cartes ont √©t√© ma√Ætris√©es !" : "Aucune carte √† charger.";
                backContent.textContent = "...";
                cardCountElement.textContent = "0/0";
                updateProgress();
                return;
            }
            
            loadCard();
            updateStats();
        }

        function loadCard() {
            if (currentCardIndex < cards.length) {
                const card = cards[currentCardIndex];
                frontContent.textContent = card.front;
                backContent.textContent = card.back;
                isFlipped = false;
                flashcardElement.classList.remove('flipped');
                answerButtons.style.display = 'none';
                flipButton.style.display = 'block';
            } else {
                endGame();
            }
            updateStats();
            updateProgress();
        }

        function flipCard() {
            if (flashcardElement.classList.contains('flipped')) return; // Avoid re-flip
            flashcardElement.classList.add('flipped');
            isFlipped = true;
            answerButtons.style.display = 'flex';
            flipButton.style.display = 'none';
        }

        /**
         * Handles the user's answer (correct or incorrect).
         * @param {boolean} correct - True if the answer was correct, false otherwise.
         */
        function handleAnswer(correct) {
            if (!isFlipped) return;

            if (correct) {
                score++;
                streak++;
            } else {
                // Add the missed card to the review list
                missedCards.push(cards[currentCardIndex]);
                streak = 0; // Reset combo/streak
            }

            currentCardIndex++;
            loadCard();
        }

        function updateStats() {
            cardCountElement.textContent = `${Math.min(currentCardIndex + 1, cards.length)}/${cards.length}`;
            streakCountElement.textContent = streak;
            if (currentCardIndex >= cards.length) {
                 cardCountElement.textContent = `${cards.length}/${cards.length}`;
            }
        }

        function updateProgress() {
            const percentage = cards.length > 0 ? (currentCardIndex / cards.length) * 100 : 100;
            progressBar.style.width = `${percentage}%`;
        }

        function endGame() {
            controls.style.display = 'none';
            flashcardElement.style.display = 'none';
            endScreen.style.display = 'block';

            document.getElementById('final-score').textContent = score;
            document.getElementById('total-cards-end').textContent = cards.length;
            
            const reviewButton = endScreen.querySelector('button');
            reviewButton.textContent = `Revoir les erreurs (${missedCards.length} cartes)`;
            reviewButton.disabled = missedCards.length === 0;

            if (missedCards.length === 0 && !isReviewMode) {
                endScreen.querySelector('h2').textContent = "Victoire Totale ! üèÜ";
            } else if (missedCards.length === 0 && isReviewMode) {
                 endScreen.querySelector('h2').textContent = "Session de R√©vision Parfaite ! ‚ú®";
            }
        }

        // Secure startup
        window.onload = () => {
             // Delay to ensure the DOM is fully rendered before showing the first card
             setTimeout(() => {
                initGame(false);
                flashcardElement.style.display = 'block';
            }, 100);
        };
    </script>

</body>
</html>
