<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>S√©ance 2 : Mon Stage et Mes Atouts ‚Äì Seconde Bac Pro AGOrA</title>
  <style>
    * { box-sizing: border-box; }

    html { font-size: 16px; }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f4f6fb;
      color: #222;
      overflow-x: hidden;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }

    header {
      background: linear-gradient(135deg, #a32454, #d93c83);
      color: #fff;
      padding: 20px 24px;
      border-radius: 14px;
      margin-bottom: 14px;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
    }

    header h1 { margin: 0 0 6px; font-size: 1.5rem; }
    header h2 { margin: 0; font-weight: 400; font-size: 1.05rem; opacity: 0.95; }

    .badge {
      display: inline-block;
      margin-top: 10px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.15);
      font-size: 0.8rem;
    }

    .font-controls {
      position: sticky;
      top: 10px;
      z-index: 50;
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      margin: 0 0 10px;
    }

    .font-btn {
      border: none;
      border-radius: 999px;
      padding: 8px 12px;
      font-weight: 700;
      cursor: pointer;
      background: #a32454;
      color: #fff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.10);
    }

    .font-btn:active { transform: translateY(1px); }

    .info-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      background: #ffffff;
      border-radius: 12px;
      padding: 12px 16px;
      margin-bottom: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    .info-field {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      flex: 1 1 260px;
      min-width: 240px;
    }

    .info-field label { font-weight: 600; }

    .info-field input[type="text"],
    .info-field input[type="date"] {
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid #c3c8d8;
      font-size: 0.95rem;
      width: 100%;
      max-width: 280px;
    }

    input[type="range"] { width: min(260px, 100%); }

    .scale-help {
      background: #ffffff;
      border-radius: 12px;
      padding: 8px 14px;
      margin-bottom: 18px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.04);
      font-size: 0.8rem;
      color: #555;
    }

    .scale-help strong { color: #a32454; }

    .section {
      background: #ffffff;
      border-radius: 16px;
      padding: 18px 20px 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      border: 1px solid #f0e0e4;
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    .section-title {
      font-size: 1.1rem;
      font-weight: 650;
      color: #a32454;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title span.icon { font-size: 1.4rem; }

    .section-subtitle {
      font-size: 0.85rem;
      color: #555;
      margin-bottom: 8px;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
    }

    .chip {
      padding: 6px 10px;
      border-radius: 999px;
      background: #ffeef2;
      font-size: 0.78rem;
      color: #a52c4a;
      border: 1px solid #ffd4dd;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: background 0.1s;
      user-select: none;
      max-width: 100%;
      overflow-wrap: anywhere;
    }

    .chip span { font-size: 1rem; }

    .chip.active { background: #ffc9d4; }

    .field-block { margin-bottom: 18px; }

    .field-block label {
      display: block;
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .field-block small {
      display: block;
      font-size: 0.78rem;
      color: #666;
      margin-bottom: 3px;
    }

    textarea {
      width: 100%;
      min-height: 60px;
      resize: none;
      padding: 10px 10px;
      border-radius: 10px;
      border: 1px solid #c7cedf;
      font-size: 0.95rem;
      line-height: 1.35;
      transition: border-color 0.15s, box-shadow 0.15s;
      background: #fafbff;
      overflow-y: hidden;
    }

    textarea:focus {
      outline: none;
      border-color: #d93c83;
      box-shadow: 0 0 0 2px rgba(217,60,131,0.18);
      background: #ffffff;
    }

    .range-label {
      font-size: 0.85rem;
      margin-left: 8px;
      font-weight: 600;
      color: #a32454;
      white-space: nowrap;
    }

    .aide-toggle {
      border: none;
      background: #fff0f3;
      color: #a32454;
      font-size: 0.78rem;
      padding: 6px 10px;
      border-radius: 999px;
      cursor: pointer;
    }

    .aide-toggle:hover { background: #f2e0e6; }

    .aide-box {
      margin-top: 6px;
      padding: 8px 10px;
      background: #fff8f9;
      border-radius: 10px;
      border: 1px dashed #dfc7cf;
      font-size: 0.78rem;
      color: #555;
      display: none;
    }

    .checklist-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 10px;
      font-size: 0.95rem;
    }

    .checklist-item input { margin-top: 2px; }

    .dnd-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 6px;
      font-size: 0.85rem;
    }

    .dnd-pool,
    .dnd-dropzone {
      flex: 1 1 280px;
      min-height: 110px;
      border-radius: 12px;
      border: 1px dashed #e5c6d0;
      padding: 10px 10px;
      background: #fff9fa;
    }

    .dnd-title {
      font-weight: 700;
      margin-bottom: 8px;
      font-size: 0.85rem;
      color: #a32454;
    }

    .dnd-item {
      background: #f2e8ff;
      border-radius: 999px;
      padding: 8px 12px;
      display: inline-block;
      margin: 4px 6px 0 0;
      cursor: move;
      user-select: none;
      border: 1px solid #dbc7e5;
      max-width: 100%;
      overflow-wrap: anywhere;
    }

    .dnd-dropzone.over { background: #ffe0e7; border-style: solid; }

    footer {
      text-align: center;
      margin-top: 24px;
      font-size: 0.78rem;
      color: #666;
    }

    .page-break {
      margin-top: 20px;
      border-top: 1px dashed #d0d5e5;
      padding-top: 16px;
    }

    @media (max-width: 720px) {
      .container { padding: 18px 12px 34px; }
      header { padding: 16px 14px; }
      header h1 { font-size: 1.25rem; }
      header h2 { font-size: 0.95rem; }
      .section { padding: 16px 14px; }
      .info-field { min-width: 200px; }
      .range-label { margin-left: 6px; }
    }

    @media print {
      body { background: #ffffff; }
      .font-controls, .aide-toggle, .chip-row { display: none !important; }
      header { box-shadow: none; }
      .section { box-shadow: none; border-radius: 0; }
      .page-break { page-break-before: always; border: none; padding-top: 0; }
      .dnd-dropzone, .dnd-pool { border: 1px solid #ccc; min-height: 50px; }
    }
  </style>
</head>

<body>
  <div class="container">

    <div class="font-controls" aria-label="Taille du texte">
      <button class="font-btn" type="button" onclick="changeSize(-1)">A-</button>
      <button class="font-btn" type="button" onclick="changeSize(1)">A+</button>
    </div>

    <header>
      <h1>S√©ance 2 : Mon Stage et Mes Atouts</h1>
      <h2>Pr√©paration de la PFMP et Exploration des Comp√©tences</h2>
      <div class="badge">Classe : Seconde Bac Pro AGOrA</div>
    </header>

    <div class="info-bar">
      <div class="info-field">
        <label for="dateTravail">Date :</label>
        <input type="date" id="dateTravail" />
      </div>
      <div class="info-field">
        <span>Motivation pour le stage :</span>
        <input type="range" id="motivationStage" min="0" max="10" value="7" />
        <span class="range-label" id="valeurMotivation">7 / 10</span>
      </div>
    </div>

    <div class="scale-help">
      <strong>Motivation pour le stage :</strong> 0 = Je n‚Äôai aucune envie de faire un stage ¬∑ 10 = Je suis tr√®s motiv√©(e) et pr√™t(e).
    </div>

    <section class="section" id="partiePFMP">
      <div class="section-header">
        <div class="section-title"><span class="icon">üè≠</span>Partie 1 ‚Äì Mon Stage Professionnel (PFMP)</div>
      </div>
      <div class="section-subtitle">Pr√©paration concr√®te : logistique, objectifs et exigences du monde du travail.</div>

      <div class="field-block">
        <label for="rechercheEntreprise">1. Ma recherche d'entreprise</label>
        <small>O√π en es-tu dans la recherche de ton lieu de stage ?</small>
        <div class="chip-row">
          <div class="chip" data-input="statutRecherche" data-value="J'ai le nom de l'entreprise."><span>üè¢</span>J'ai le nom</div>
          <div class="chip" data-input="statutRecherche" data-value="J'ai envoy√© des e-mails/courriers."><span>üìß</span>J'ai fait les d√©marches</div>
          <div class="chip" data-input="statutRecherche" data-value="Mon CV et ma lettre sont pr√™ts."><span>üìÑ</span>CV et Lettre OK</div>
          <div class="chip" data-input="statutRecherche" data-value="J'ai un rendez-vous (entretien)."><span>üóìÔ∏è</span>J'ai rendez-vous</div>
          <div class="chip" data-input="statutRecherche" data-value="Je n'ai rien encore trouv√©."><span>‚ùå</span>Je n'ai rien encore</div>
        </div>
        <input type="hidden" id="statutRecherche" value="" />
        <textarea id="rechercheEntreprise" placeholder="Dans quel type de structure souhaites-tu aller (Mairie, petite PME, grande entreprise, association...) et pourquoi ?"></textarea>
      </div>

      <div class="field-block">
        <label for="attentesPFMP">2. Mes attentes concr√®tes du stage</label>
        <small>Quelles t√¢ches aimerais-tu vraiment apprendre ou pratiquer ?</small>
        <textarea id="attentesPFMP" placeholder="Exemples : utiliser un logiciel sp√©cifique, faire des t√¢ches d'accueil client, classer des documents, faire des devis..."></textarea>
        <div class="chip-row">
          <div class="chip" onclick="addSuggestion('attentesPFMP','Apprendre √† r√©diger des documents professionnels.')"><span>‚úçÔ∏è</span>R√©daction pro</div>
          <div class="chip" onclick="addSuggestion('attentesPFMP','Utiliser un logiciel de gestion.')"><span>üíª</span>Logiciel gestion</div>
          <div class="chip" onclick="addSuggestion('attentesPFMP','G√©rer l‚Äôaccueil physique ou t√©l√©phonique.')"><span>üìû</span>Accueil/Standard</div>
        </div>
      </div>

      <div class="field-block">
        <label>3. Les contraintes du monde du travail</label>
        <small>√âvalue √† quel point ces contraintes te pr√©occupent.</small>

        <div class="info-field" style="margin-bottom: 10px;">
          <span>Avoir peur d'arriver en retard :</span>
          <input type="range" id="peurRetard" min="0" max="10" value="5" />
          <span class="range-label" id="valeurRetard">5 / 10</span>
        </div>

        <div class="info-field" style="margin-bottom: 10px;">
          <span>Avoir peur de ne pas comprendre les consignes :</span>
          <input type="range" id="peurConsignes" min="0" max="10" value="5" />
          <span class="range-label" id="valeurConsignes">5 / 10</span>
        </div>

        <div class="info-field">
          <span>Avoir peur de parler aux coll√®gues ou aux clients :</span>
          <input type="range" id="peurCommunication" min="0" max="10" value="5" />
          <span class="range-label" id="valeurCommunication">5 / 10</span>
        </div>
      </div>

      <div class="field-block">
        <label for="questionsTuteur">4. Mes questions pratiques pour l'entreprise</label>
        <small>Liste les questions que tu devras poser √† ton tuteur ou lors de l'entretien (hors t√¢ches).</small>
        <textarea id="questionsTuteur" placeholder="Exemples : les horaires exacts, le code vestimentaire, le lieu de d√©jeuner, qui contacter en cas de probl√®me..."></textarea>
        <button class="aide-toggle" type="button" onclick="toggleAide('aideQuestions')">üí° Aide : Que demander au tuteur ?</button>
        <div class="aide-box" id="aideQuestions">
          Tu peux demander : Qui dois-je contacter le premier jour ? Y a-t-il un code vestimentaire ? O√π puis-je laisser mes affaires ? Y a-t-il des r√®gles importantes √† conna√Ætre sur le lieu de travail ?
        </div>
      </div>

      <div class="field-block">
        <label>5. Mes documents et mon mat√©riel</label>
        <small>Coche ce qui est d√©j√† pr√™t pour le stage.</small>
        <div class="checklist-item"><input type="checkbox" id="checkCV" /><label for="checkCV">Mon CV et ma lettre sont finaux.</label></div>
        <div class="checklist-item"><input type="checkbox" id="checkConvention" /><label for="checkConvention">La convention de stage est sign√©e par l'√©cole et l'entreprise.</label></div>
        <div class="checklist-item"><input type="checkbox" id="checkItineraire" /><label for="checkItineraire">Je connais l'itin√©raire et le temps de trajet.</label></div>
        <div class="checklist-item"><input type="checkbox" id="checkMatos" /><label for="checkMatos">J'ai de quoi noter (carnet, stylos) et une tenue correcte.</label></div>
      </div>
    </section>

    <div class="page-break"></div>

    <section class="section" id="partieCPS">
      <div class="section-header">
        <div class="section-title"><span class="icon">üß†</span>Partie 2 ‚Äì Mes Comp√©tences Psychosociales (CPS)</div>
      </div>
      <div class="section-subtitle">Mon savoir-√™tre : comment je g√®re mes √©motions et interagis avec les autres.</div>

      <div class="field-block">
        <label>6. L'Auto-√©valuation des Savoir-√ätre</label>
        <small>√âvalue-toi de 0 (Tr√®s difficile) √† 10 (Tr√®s facile) sur ces qualit√©s professionnelles.</small>

        <div class="info-field" style="margin-bottom: 10px;">
          <span>J'arrive √† prendre des initiatives :</span>
          <input type="range" id="autoInitiative" min="0" max="10" value="5" />
          <span class="range-label" id="valeurInitiative">5 / 10</span>
        </div>

        <div class="info-field" style="margin-bottom: 10px;">
          <span>Je g√®re bien mon stress avant un √©v√©nement important :</span>
          <input type="range" id="autoStress" min="0" max="10" value="5" />
          <span class="range-label" id="valeurStress">5 / 10</span>
        </div>

        <div class="info-field" style="margin-bottom: 10px;">
          <span>Je m'adapte facilement √† un nouvel environnement ou √† une nouvelle t√¢che :</span>
          <input type="range" id="autoAdaptation" min="0" max="10" value="5" />
          <span class="range-label" id="valeurAdaptation">5 / 10</span>
        </div>

        <div class="info-field">
          <span>Je travaille efficacement en √©quipe (sans me laisser distraire) :</span>
          <input type="range" id="autoEquipe" min="0" max="10" value="5" />
          <span class="range-label" id="valeurEquipe">5 / 10</span>
        </div>
      </div>

      <div class="field-block">
        <label>7. Ma gestion du temps et de l'effort</label>
        <small>D√©place les √©tiquettes dans la colonne qui te correspond le mieux en ce moment.</small>
        <div class="dnd-container">
          <div class="dnd-pool" id="dndPoolOrganisation">
            <div class="dnd-title">√Ä placer</div>
            <div class="dnd-item" draggable="true">Je me fixe des objectifs clairs.</div>
            <div class="dnd-item" draggable="true">J'ai du mal √† finir ce que j'ai commenc√©.</div>
            <div class="dnd-item" draggable="true">Je me laisse souvent distraire (par mon t√©l√©phone, le bruit).</div>
            <div class="dnd-item" draggable="true">Je v√©rifie toujours mon travail avant de le rendre.</div>
            <div class="dnd-item" draggable="true">Je reporte souvent les t√¢ches importantes au dernier moment.</div>
          </div>
          <div class="dnd-dropzone" data-zone="habitudePositive">
            <div class="dnd-title">Mes habitudes positives</div>
          </div>
          <div class="dnd-dropzone" data-zone="pointAmeliorer">
            <div class="dnd-title">Mes points √† am√©liorer</div>
          </div>
        </div>
      </div>

      <div class="field-block">
        <label for="scenarioCommunication">8. La Communication en Situation Professionnelle</label>
        <small>Que ferais-tu si tu faisais une erreur en stage ? Choisis la r√©ponse qui te ressemble le plus.</small>
        <textarea id="scenarioCommunication" placeholder="R√©ponds ici en fonction des propositions ci-dessous."></textarea>
        <div class="chip-row">
          <div class="chip" onclick="addSuggestion('scenarioCommunication','Je n‚Äôose pas le dire et j‚Äôessaie de la corriger seul(e).')"><span>üôà</span>Corriger seul(e)</div>
          <div class="chip" onclick="addSuggestion('scenarioCommunication','J‚Äôattends la fin de la journ√©e pour en parler √† mon tuteur.')"><span>‚è±Ô∏è</span>Attendre la fin</div>
          <div class="chip" onclick="addSuggestion('scenarioCommunication','J‚Äôen parle imm√©diatement √† mon tuteur pour qu‚Äôil m‚Äôaide √† la r√©parer.')"><span>üó£Ô∏è</span>En parler tout de suite</div>
        </div>
      </div>

      <div class="field-block">
        <label for="objectifCPS">9. Mon objectif CPS pour le stage</label>
        <small>Choisis une seule comp√©tence psychosociale que tu veux travailler et explique comment.</small>
        <textarea id="objectifCPS" placeholder="J'aimerais am√©liorer ma..., pour cela, je vais essayer de..."></textarea>
      </div>
    </section>

    <footer>S√©ance 2 : Pr√©paration PFMP & Comp√©tences ‚Äì Seconde Bac Pro AGOrA</footer>
  </div>

  <script>
    let currentSize = 16;

    function changeSize(delta) {
      currentSize += delta;
      if (currentSize < 12) currentSize = 12;
      if (currentSize > 24) currentSize = 24;
      document.documentElement.style.fontSize = currentSize + 'px';
      const h1 = document.querySelector('h1');
      if(h1) h1.style.fontSize = (2 * (currentSize/16)) + 'rem';
    }

    function updateRangeLabel(sliderId, labelId) {
      const slider = document.getElementById(sliderId);
      const label = document.getElementById(labelId);
      if (slider && label) {
        slider.addEventListener('input', function () {
          label.textContent = this.value + ' / 10';
        });
      }
    }

    updateRangeLabel('motivationStage', 'valeurMotivation');
    updateRangeLabel('peurRetard', 'valeurRetard');
    updateRangeLabel('peurConsignes', 'valeurConsignes');
    updateRangeLabel('peurCommunication', 'valeurCommunication');
    updateRangeLabel('autoInitiative', 'valeurInitiative');
    updateRangeLabel('autoStress', 'valeurStress');
    updateRangeLabel('autoAdaptation', 'valeurAdaptation');
    updateRangeLabel('autoEquipe', 'valeurEquipe');

    function autoResizeTextarea(el) {
      el.style.height = 'auto';
      el.style.height = (el.scrollHeight + 2) + 'px';
    }

    document.querySelectorAll('textarea').forEach(function (ta) {
      autoResizeTextarea(ta);
      ta.addEventListener('input', function () { autoResizeTextarea(ta); });
    });

    function toggleAide(id) {
      const box = document.getElementById(id);
      if (!box) return;
      box.style.display = box.style.display === 'block' ? 'none' : 'block';
    }

    function addSuggestion(textareaId, text) {
      const ta = document.getElementById(textareaId);
      if (!ta) return;
      let currentValue = ta.value.trim();
      if (currentValue && !currentValue.endsWith('\n')) ta.value += '\n';
      if (!ta.value.includes(text)) ta.value += '‚Ä¢ ' + text.trim() + '\n';
      autoResizeTextarea(ta);
      ta.focus();
    }

    document.querySelectorAll('.chip[data-input="statutRecherche"]').forEach(chip => {
      chip.addEventListener('click', function() {
        const inputId = this.getAttribute('data-input');
        const value = this.getAttribute('data-value');
        const inputHidden = document.getElementById(inputId);

        this.classList.toggle('active');

        let currentValues = (inputHidden.value || '').split(',').map(v => v.trim()).filter(v => v);
        const index = currentValues.indexOf(value);

        if (index > -1) currentValues.splice(index, 1);
        else currentValues.push(value);

        inputHidden.value = currentValues.join(', ');
      });
    });

    let draggedItem = null;

    function initDragAndDrop() {
      document.querySelectorAll('.dnd-item').forEach(function (item) {
        item.addEventListener('dragstart', function (e) {
          draggedItem = item;
          e.dataTransfer.effectAllowed = 'move';
          item.style.opacity = '0.4';
        });
        item.addEventListener('dragend', function () {
          item.style.opacity = '1';
          draggedItem = null;
        });
      });

      document.querySelectorAll('.dnd-dropzone, .dnd-pool').forEach(function (zone) {
        zone.addEventListener('dragover', function (e) {
          e.preventDefault();
          zone.classList.add('over');
        });
        zone.addEventListener('dragleave', function () {
          zone.classList.remove('over');
        });
        zone.addEventListener('drop', function (e) {
          e.preventDefault();
          if (draggedItem) {
            const dropZone = zone.closest('.dnd-dropzone') || zone.closest('.dnd-pool');
            if (e.target.classList.contains('dnd-title')) dropZone.insertBefore(draggedItem, e.target.nextSibling);
            else dropZone.appendChild(draggedItem);
          }
          zone.classList.remove('over');
        });
      });
    }

    document.addEventListener('DOMContentLoaded', initDragAndDrop);
  </script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
    import { getFirestore, collection, addDoc, updateDoc, doc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAWdCMvOiAJln3eT9LIAQD3RWJUD0lQcLI",
      authDomain: "devoirs-pse.firebaseapp.com",
      projectId: "devoirs-pse",
      storageBucket: "devoirs-pse.appspot.com",
      messagingSenderId: "614730413904",
      appId: "1:614730413904:web:a5dd478af5de30f6bede55"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let currentDocId = null;
    let startTime = Date.now();

    function getIdentity() { return localStorage.getItem("cockpit_student_id"); }

    async function demarrerVisite() {
      try {
        let userCode = getIdentity() || "ANONYME";
        let userClass = localStorage.getItem("cockpit_student_class") || "VISITEUR";
        const pageName = document.title || window.location.pathname.split("/").pop();
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);

        const ref = await addDoc(collection(db, "statistiques_usage"), {
          page: pageName,
          userCode: userCode,
          classe: userClass,
          device: isMobile ? "Mobile" : "Desktop",
          action: "Consultation",
          duree: 0,
          timestamp: serverTimestamp(),
          date: new Date().toISOString()
        });

        currentDocId = ref.id;

        setInterval(async () => {
          if (currentDocId && document.visibilityState === 'visible') {
            try {
              await updateDoc(doc(db, "statistiques_usage", currentDocId), {
                duree: Math.floor((Date.now() - startTime) / 1000)
              });
            } catch (e) {}
          }
        }, 10000);

      } catch (e) { console.warn("Erreur Tracker", e); }
    }

    demarrerVisite();
  </script>
</body>
</html>
