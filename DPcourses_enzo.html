<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Projet de Tom - Ã‰pargne</title>
    <style>
        :root {
            --bg: #e3f2fd;
            --card-bg: white;
            --primary: #1565c0;
            --accent: #ffca28;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        h1 { margin-bottom: 20px; color: #333; text-align:center; }

        /* BOUTONS */
        .controls {
            display: flex;
            gap: 12px;
            margin-bottom: 22px;
            flex-wrap: wrap;
            justify-content: center;
        }
        button {
            padding: 12px 18px;
            font-size: 1.1rem;
            cursor: pointer;
            border: none;
            border-radius: 50px;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
            transition: transform 0.1s;
            user-select: none;
        }
        button:active { transform: translateY(4px); box-shadow: none; }
        .audio-btn { background: #e91e63; }
        .sound-btn { background: #2c3e50; }
        .reset-btn { background: #607d8b; }

        /* ZONE DE CHOIX (Les RÃªves) */
        .dreams-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .dream-card {
            background: white;
            border: 4px solid #ccc;
            border-radius: 15px;
            padding: 15px;
            width: 170px;
            cursor: pointer;
            text-align: center;
            transition: transform 0.2s, border-color 0.2s;
            user-select: none;
            touch-action: manipulation;
            box-shadow: 0 6px 10px rgba(0,0,0,0.08);
        }

        .dream-card:hover { transform: scale(1.03); }
        .dream-card.selected { border-color: var(--primary); background-color: #e3f2fd; }

        .dream-icon { font-size: 4rem; display: block; margin-bottom: 10px; }
        .dream-title { font-weight: bold; margin-bottom: 8px; }
        .dream-price { font-size: 1.5rem; font-weight: bold; color: #333; background: #eee; padding: 5px; border-radius: 8px;}

        /* ZONE DE CALCUL */
        .calc-zone {
            background: white;
            padding: 26px;
            border-radius: 20px;
            width: 92%;
            max-width: 720px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            text-align: center;
            display: none;
        }

        .scenario-row {
            display: flex;
            justify-content: center;
            align-items: stretch;
            gap: 18px;
            margin-bottom: 18px;
            font-size: 1.2rem;
            flex-wrap: wrap;
        }

        .info-box {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 12px;
            border: 2px solid #ddd;
            min-width: 190px;
        }

        /* INPUT REPONSE */
        .answer-section {
            background: var(--primary);
            color: white;
            padding: 18px;
            border-radius: 15px;
            margin-top: 16px;
        }

        input[type="number"] {
            font-size: 2rem;
            width: 120px;
            text-align: center;
            padding: 10px;
            border-radius: 10px;
            border: none;
            font-weight: bold;
        }

        /* BARRE DE PROGRESSION */
        .progress-container {
            margin-top: 22px;
            width: 100%;
            height: 40px;
            background-color: #ddd;
            border-radius: 25px;
            overflow: hidden;
            display: none;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: #4caf50;
            text-align: center;
            line-height: 40px;
            color: white;
            font-weight: bold;
            transition: width 0.6s ease-in-out;
        }

        /* MESSAGE FEEDBACK */
        #feedback {
            margin-top: 16px;
            font-size: 1.35rem;
            font-weight: bold;
            min-height: 1.6em;
        }

        .btn-check {
            background: #ffca28;
            color: #333;
            font-weight: bold;
            font-size: 1.15rem;
            margin: 14px auto 0 auto;
            border: 2px solid #ffb300;
            padding: 10px 18px;
            border-radius: 14px;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }
        .btn-check:active { transform: translateY(4px); box-shadow: none; }

        @media (max-width: 520px) {
            .dream-card { width: 92%; max-width: 340px; }
            input[type="number"] { width: 110px; }
        }
    </style>
</head>
<body>

    <h1>ðŸ“… Le Projet de Tom</h1>

    <div class="controls">
        <button class="audio-btn" onclick="lireConsigne()">ðŸ”Š Consigne</button>
        <button class="sound-btn" id="btn-sound" onclick="toggleSound()">ðŸ”ˆ Son : ON</button>
        <button class="reset-btn" onclick="location.reload()">ðŸ”„ Recommencer</button>
    </div>

    <h2 id="step1-title">1. Qu'est-ce que Tom veut acheter ?</h2>

    <div class="dreams-container">
        <div class="dream-card" onclick="selectDream(this, 200, 'ðŸ“±', 'La Tablette', 50)">
            <span class="dream-icon">ðŸ“±</span>
            <div class="dream-title">La Tablette</div>
            <div class="dream-price">200 â‚¬</div>
            <div style="margin-top:8px; opacity:.85;">+ 50 â‚¬ / mois</div>
        </div>

        <div class="dream-card" onclick="selectDream(this, 120, 'ðŸš²', 'Le VÃ©lo', 20)">
            <span class="dream-icon">ðŸš²</span>
            <div class="dream-title">Le VÃ©lo</div>
            <div class="dream-price">120 â‚¬</div>
            <div style="margin-top:8px; opacity:.85;">+ 20 â‚¬ / mois</div>
        </div>

        <div class="dream-card" onclick="selectDream(this, 400, 'ðŸŽ®', 'La Console', 100)">
            <span class="dream-icon">ðŸŽ®</span>
            <div class="dream-title">La Console</div>
            <div class="dream-price">400 â‚¬</div>
            <div style="margin-top:8px; opacity:.85;">+ 100 â‚¬ / mois</div>
        </div>
    </div>

    <div id="calc-zone" class="calc-zone">
        <h2>2. Calcule le temps nÃ©cessaire</h2>

        <div class="scenario-row">
            <div class="info-box">
                <div>Prix Ã  payer</div>
                <div style="font-size:2rem; font-weight:bold; color:#d32f2f;" id="display-price">...</div>
            </div>

            <div class="info-box">
                <div>Tom Ã©conomise</div>
                <div style="font-size:2rem; font-weight:bold; color:#388e3c;" id="display-saving">...</div>
                <div>chaque mois</div>
            </div>
        </div>

        <p style="font-size:1.1rem; margin-top:0;">
            Utilise ta calculatrice :<br>
            Ajoute l'Ã©conomie (exemple : 20 + 20 + 20...) jusqu'Ã  avoir au moins le prix.
        </p>

        <div class="answer-section">
            <label>Combien de mois faut-il attendre ?</label><br><br>
            <input type="number" id="input-months" placeholder="?" min="1" inputmode="numeric"> MOIS
            <div>
                <button class="btn-check" onclick="verifier()">âœ… VÃ©rifier</button>
            </div>
        </div>

        <div class="progress-container" id="prog-cont">
            <div class="progress-bar" id="prog-bar">0%</div>
        </div>

        <div id="feedback"></div>
    </div>

<script>
    let currentPrice = 0;
    let currentSaving = 0;
    let currentName = "";
    let soundEnabled = true;

    function toggleSound() {
        soundEnabled = !soundEnabled;
        const btn = document.getElementById('btn-sound');
        btn.textContent = soundEnabled ? "ðŸ”ˆ Son : ON" : "ðŸ”‡ Son : OFF";
        try { if (!soundEnabled && window.speechSynthesis) window.speechSynthesis.cancel(); } catch(e) {}
    }

    function speak(txt) {
        if (!soundEnabled) return;
        try {
            if (!window.speechSynthesis) return;
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(txt);
            msg.lang = 'fr-FR';
            window.speechSynthesis.speak(msg);
        } catch(e) {}
    }

    function lireConsigne() {
        speak("Choisis un objet que Tom veut acheter. Regarde combien il Ã©conomise par mois. Calcule le nombre de mois nÃ©cessaires pour avoir au moins le prix.");
    }

    function selectDream(cardEl, price, icon, name, saving) {
        currentPrice = price;
        currentSaving = saving;
        currentName = name;

        // Visuel sÃ©lection
        const cards = document.querySelectorAll('.dream-card');
        cards.forEach(c => c.classList.remove('selected'));
        if (cardEl) cardEl.classList.add('selected');

        // Affichage Zone Calcul
        const cz = document.getElementById('calc-zone');
        cz.style.display = 'block';
        document.getElementById('display-price').innerText = price + " â‚¬";
        document.getElementById('display-saving').innerText = "+ " + saving + " â‚¬";

        // Reset
        document.getElementById('input-months').value = '';
        document.getElementById('feedback').innerText = '';
        document.getElementById('prog-cont').style.display = 'none';
        const bar = document.getElementById('prog-bar');
        bar.style.width = '0%';
        bar.innerText = "0%";
        bar.style.backgroundColor = "#4caf50";

        speak(`Tom veut ${name}. Il coÃ»te ${price} euros. Tom met ${saving} euros de cÃ´tÃ© par mois.`);

        cz.scrollIntoView({behavior: "smooth", block: "start"});
    }

    function verifier() {
        const inputEl = document.getElementById('input-months');
        const userMonths = parseInt(inputEl.value, 10);
        const feedback = document.getElementById('feedback');

        if (!currentPrice || !currentSaving) {
            feedback.style.color = "red";
            feedback.innerText = "Choisis d'abord un objet.";
            speak("Choisis d'abord un objet.");
            return;
        }

        if (!userMonths || userMonths < 1) {
            feedback.style.color = "red";
            feedback.innerText = "Ã‰cris un nombre de mois.";
            speak("Ã‰cris un nombre de mois.");
            return;
        }

        const correctMonths = Math.ceil(currentPrice / currentSaving);
        const totalSaved = userMonths * currentSaving;

        const progCont = document.getElementById('prog-cont');
        const progBar = document.getElementById('prog-bar');
        progCont.style.display = 'block';

        if (userMonths === correctMonths) {
            feedback.style.color = "green";
            feedback.innerHTML = `ðŸŽ‰ BRAVO ! En ${userMonths} mois, Tom aura ${totalSaved} â‚¬ !`;
            speak(`Bravo ! En ${userMonths} mois, Tom aura Ã©conomisÃ© ${totalSaved} euros. Il peut l'acheter !`);

            setTimeout(() => {
                progBar.style.backgroundColor = "#4caf50";
                progBar.style.width = '100%';
                progBar.innerText = "OBJECTIF ATTEINT !";
            }, 80);

        } else if (userMonths < correctMonths) {
            feedback.style.color = "orange";
            feedback.innerHTML = `âš ï¸ Pas assez. ${userMonths} mois Ã— ${currentSaving} â‚¬ = ${totalSaved} â‚¬. Il faut ${currentPrice} â‚¬.`;
            speak(`Ce n'est pas assez. Avec ${userMonths} mois, il a seulement ${totalSaved} euros. Continue d'ajouter.`);

            const percent = Math.max(0, Math.min(99, (totalSaved / currentPrice) * 100));
            progBar.style.backgroundColor = "orange";
            progBar.style.width = percent + '%';
            progBar.innerText = totalSaved + " â‚¬";

        } else {
            feedback.style.color = "blue";
            feedback.innerHTML = `â„¹ï¸ Oui, il peut acheter, mais il pouvait le faire plus tÃ´t. Le bon nombre de mois est ${correctMonths}.`;
            speak(`Tu as trop de mois. Il pouvait acheter plus tÃ´t. Essaie de trouver le bon nombre de mois.`);

            progBar.style.backgroundColor = "#1565c0";
            progBar.style.width = '100%';
            progBar.innerText = totalSaved + " â‚¬";
        }
    }
</script>

</body>
</html>
