<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Budget d'Amira - Escape Game</title>
    <style>
        /* Styles de base conserv√©s */
        :root {
            --recettes-color: #d4edda;
            --recettes-border: #28a745;
            --dette-color: #fce4ec; 
            --dette-border: #e91e63;
            --fixe-color: #cce5ff;
            --fixe-border: #007bff;
            --courant-color: #fff3cd;
            --courant-border: #ffc107;
            --occas-color: #f8d7da;
            --occas-border: #dc3545;
            --epargne-color: #e6e0ff;
            --epargne-border: #6f42c1;
            
            --bg-color: #f9f9f9;
            --text-color: #333;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { color: #2c3e50; margin-bottom: 10px; }

        .context-box {
            background: #ffe0e0; /* Couleur d'alerte pour le contexte */
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            max-width: 900px;
            width: 100%;
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 1.15rem;
            position: relative;
            border: 3px solid var(--dette-border);
        }

        .context-box h2 {
            color: var(--dette-border);
            margin-top: 0;
            border-bottom: 1px dashed var(--dette-border);
            padding-bottom: 10px;
        }

        #item-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            background: white;
            padding: 15px;
            border-radius: 10px;
            min-height: 80px;
            width: 100%;
            max-width: 1300px;
            margin-bottom: 20px;
            border: 2px dashed #ccc;
        }

        .draggable-item {
            padding: 10px 20px;
            background-color: white;
            border: 2px solid #555;
            border-radius: 8px;
            cursor: grab;
            user-select: none;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Le Tableau - 6 colonnes */
        .budget-container {
            display: grid;
            grid-template-columns: repeat(6, 1fr); 
            gap: 8px;
            width: 100%;
            max-width: 1300px;
        }

        .column {
            background: white;
            border-radius: 10px;
            padding: 10px 5px;
            display: flex;
            flex-direction: column;
            min-height: 300px; /* R√©duire pour concentrer */
            border-top: 6px solid #ccc;
        }
        
        /* Styles de colonnes sp√©cifiques (identique) */
        #col-recettes { border-top-color: var(--recettes-border); }
        #col-dettes { border-top-color: var(--dette-border); }
        #col-fixes { border-top-color: var(--fixe-border); }
        #col-courantes { border-top-color: var(--courant-border); }
        #col-occas { border-top-color: var(--occas-border); }
        #col-epargne { border-top-color: var(--epargne-border); }
        
        .calc-zone {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 2px solid #eee;
            text-align: center;
        }

        /* Zones d'√©nigme */
        .puzzle-zone {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-top: 30px;
            width: 100%;
            max-width: 900px;
        }
        .puzzle-title {
            font-size: 1.4rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .puzzle-input {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }
        .puzzle-input input {
            width: 100px;
            padding: 8px;
            font-size: 1.1rem;
            border: 2px solid #dc3545;
            border-radius: 5px;
            text-align: right;
        }
        .unlocked { border-color: #28a745 !important; background-color: #e8f5e9; color: #28a745; }
        .locked { border-color: #6c757d !important; background-color: #f1f1f1; }
        .locked-btn { background-color: #6c757d; }
        .unlocked-btn { background-color: #28a745; }
        
        /* Zone du Code Final */
        #final-escape-zone {
            margin-top: 40px;
            background: #2c3e50;
            color: white;
            padding: 30px;
            border-radius: 15px;
            width: 100%;
            max-width: 500px;
            text-align: center;
            opacity: 0.3;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        #final-escape-zone.active {
            opacity: 1;
            pointer-events: auto;
        }
        #final-escape-zone input {
            width: 150px;
            font-size: 1.5rem;
            text-align: center;
            letter-spacing: 5px;
            border: 3px solid white;
            color: #2c3e50;
        }
        #final-escape-zone button {
            background-color: #f39c12;
            padding: 10px 30px;
            font-size: 1.2rem;
            margin-top: 15px;
        }
        
        /* Ajustements Responsive */
        @media (max-width: 1300px) {
            .budget-container { grid-template-columns: repeat(3, 1fr); } 
            #col-recettes { grid-column: span 1; }
        }
        @media (max-width: 900px) {
            .budget-container { grid-template-columns: 1fr 1fr; } 
        }

    </style>
</head>
<body>

    <h1>üîê Le Budget d'Amira - Escape Game Financier</h1>

    <div class="context-box">
        <h2>MISSION : Sortir Amira de l'alerte !</h2>
        <p>Amira est dans une situation financi√®re critique. Vous devez **classer ses postes budg√©taires** puis **r√©soudre les trois √©nigmes** ci-dessous pour trouver le **code de sortie** √† 7 chiffres.</p>
        
        <div id="text-content">
            Amira touche un **salaire net de 2 100 ‚Ç¨**. Elle re√ßoit des **tickets restaurant** de **120 ‚Ç¨**. Elle a re√ßu le **remboursement m√©dical de 30 ‚Ç¨** (encaiss√©).<br>
            
            Elle rembourse : **cr√©dit immobilier (750 ‚Ç¨)** et **cr√©dit √† la consommation (150 ‚Ç¨)**.<br>
            
            Ses autres charges fixes : Assurance maladie (50 ‚Ç¨), Taxe d'habitation (40 ‚Ç¨).<br>
            
            Ses d√©penses courantes : Courses (380 ‚Ç¨), Transport (100 ‚Ç¨), Coiffeur (30 ‚Ç¨).<br><br>
            
            Ce mois-ci, elle a :
            * Mis **200 ‚Ç¨** dans son √©pargne (Livret A).
            * Achet√© un nouvel ordinateur portable pour **600 ‚Ç¨** (pay√© cash).
            * Elle a fait un don √† une association de **50 ‚Ç¨** (DO).
        </div>
    </div>

    <div style="width:100%; max-width:1300px; text-align:left; margin-bottom:5px; font-size:1.1rem;">
        <strong>1. Classez tous les postes :</strong>
    </div>
    
    <div id="item-bank" ondrop="drop(event)" ondragover="allowDrop(event)">
    </div>

    <div class="budget-container">
        <div class="column" id="col-recettes"><h3>Recettes</h3><div class="recette-sub-zones"><div class="sub-zone drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-category="recette-travail"><h4>Travail (S, TR)</h4></div><div class="sub-zone drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-category="recette-social"><h4>Social/√âtat</h4></div><div class="sub-zone drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-category="recette-autre"><h4>Autre</h4></div></div>
            <div class="calc-zone"><label>Total R : </label><input type="number" id="input-recettes" placeholder="?"> ‚Ç¨<br><button class="verify-btn" onclick="verifierColonneGlobale('recette', 'input-recettes', 'msg-recettes')">V√©rifier</button><span id="msg-recettes" class="feedback-msg"></span></div>
        </div>
        <div class="column" id="col-dettes"><h3>Dette/Pr√™t</h3><div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-category="dette"></div>
            <div class="calc-zone"><label>Total Dt : </label><input type="number" id="input-dettes" placeholder="?"> ‚Ç¨<br><button class="verify-btn" onclick="verifierColonneGlobale('dette', 'input-dettes', 'msg-dettes')">V√©rifier</button><span id="msg-dettes" class="feedback-msg"></span></div>
        </div>
        <div class="column" id="col-fixes"><h3>D√©penses Fixes</h3><div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-category="fixe"></div>
            <div class="calc-zone"><label>Total DF : </label><input type="number" id="input-fixes" placeholder="?"> ‚Ç¨<br><button class="verify-btn" onclick="verifierColonneGlobale('fixe', 'input-fixes', 'msg-fixes')">V√©rifier</button><span id="msg-fixes" class="feedback-msg"></span></div>
        </div>
        <div class="column" id="col-courantes"><h3>D√©penses Courantes</h3><div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-category="courante"></div>
            <div class="calc-zone"><label>Total DC : </label><input type="number" id="input-courantes" placeholder="?"> ‚Ç¨<br><button class="verify-btn" onclick="verifierColonneGlobale('courante', 'input-courantes', 'msg-courantes')">V√©rifier</button><span id="msg-courantes" class="feedback-msg"></span></div>
        </div>
        <div class="column" id="col-occas"><h3>D√©penses Occas.</h3><div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-category="occas"></div>
            <div class="calc-zone"><label>Total DO : </label><input type="number" id="input-occas" placeholder="?"> ‚Ç¨<br><button class="verify-btn" onclick="verifierColonneGlobale('occas', 'input-occas', 'msg-occas')">V√©rifier</button><span id="msg-occas" class="feedback-msg"></span></div>
        </div>
        <div class="column" id="col-epargne"><h3>√âpargne/Trans.</h3><div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-category="epargne"></div>
            <div class="calc-zone"><label>Total E : </label><input type="number" id="input-epargne" placeholder="?"> ‚Ç¨<br><button class="verify-btn" onclick="verifierColonneGlobale('epargne', 'input-epargne', 'msg-epargne')">V√©rifier</button><span id="msg-epargne" class="feedback-msg"></span></div>
        </div>
    </div>

    <div class="puzzle-zone">
        <h2>2. R√©solution des √ânigmes (Codes √† 3 chiffres)</h2>

        <div id="puzzle-1-container" style="margin-bottom: 20px;">
            <div class="puzzle-title locked" id="puzzle-1-title">
                üö® √ânigme 1 : Taux d'Endettement (TE) - **L'Alerte Banquier**
            </div>
            <p style="font-size:0.95rem; margin-top:-10px;">Calcul : **Total Dettes / Total Recettes**. Prenez les 3 premiers chiffres du taux (avec la d√©cimale si elle existe). Ex: 34.5% donne 345.</p>
            <div class="puzzle-input">
                <input type="number" id="code-1" placeholder="Code (3 chif.)" maxlength="3">
                <button class="verify-btn locked-btn" onclick="unlockPuzzle(1, 400)">D√©verrouiller</button>
                <span id="msg-puzzle-1" class="feedback-msg"></span>
            </div>
        </div>
        
        <div id="puzzle-2-container" style="margin-bottom: 20px;">
            <div class="puzzle-title locked" id="puzzle-2-title">
                üè° √ânigme 2 : Reste √† Vivre (RAV) - **Le Seuil de Survie**
            </div>
            <p style="font-size:0.95rem; margin-top:-10px;">Calcul : **Total Recettes - Total Dettes - Total D√©penses Fixes HORS Dette**. Prenez les 3 derniers chiffres du r√©sultat. Ex: 1260 donne 260.</p>
            <div class="puzzle-input">
                <input type="number" id="code-2" placeholder="Code (3 chif.)" maxlength="3">
                <button class="verify-btn locked-btn" onclick="unlockPuzzle(2, 260)">D√©verrouiller</button>
                <span id="msg-puzzle-2" class="feedback-msg"></span>
            </div>
        </div>
        
        <div id="puzzle-3-container">
            <div class="puzzle-title locked" id="puzzle-3-title">
                üè¶ √ânigme 3 : Marge de Man≈ìuvre (MM) - **La Libert√© Budg√©taire**
            </div>
            <p style="font-size:0.95rem; margin-top:-10px;">Calcul : **Reste √† Vivre - (Total D√©penses Courantes + Total D√©penses Occasionnelles)**. Prenez la valeur exacte (2 ou 3 chiffres). Ex: 150 donne 150.</p>
            <div class="puzzle-input">
                <input type="number" id="code-3" placeholder="Code (2/3 chif.)">
                <button class="verify-btn locked-btn" onclick="unlockPuzzle(3, 150)">D√©verrouiller</button>
                <span id="msg-puzzle-3" class="feedback-msg"></span>
            </div>
        </div>
    </div>

    <div id="final-escape-zone">
        <h2>3. Code de Sortie !</h2>
        <p>Entrez le code √† **7 chiffres** en combinant les √©nigmes 1, 2 et 3 :</p>
        <p style="font-size: 0.9rem;">(Les 3 chiffres du TE + Les 3 derniers chiffres du RAV + Le dernier chiffre de la MM)</p>
        
        <div style="margin-bottom: 15px;">
            <input type="text" id="final-code" placeholder="***-***-*" maxlength="7">
        </div>
        <button class="verify-btn" onclick="verifierCodeFinal()">ENTRER LE CODE</button>
        <div id="msg-final-code" class="feedback-msg" style="color:white;"></div>
    </div>

    <script>
        // --- DONN√âES D'AMIRA (Identiques √† l'exercice pr√©c√©dent) ---
        const items = [
            { id: 1, name: "Salaire Net", val: 2100, cat: "recette-travail", globalCat: "recette" },
            { id: 2, name: "Tickets Restaurant", val: 120, cat: "recette-travail", globalCat: "recette" },
            { id: 3, name: "Remboursement M√©dical", val: 30, cat: "recette-social", globalCat: "recette" },
            { id: 4, name: "Cr√©dit Immobilier (mensualit√©)", val: 750, cat: "dette", globalCat: "depense" },
            { id: 5, name: "Cr√©dit Consommation (mensualit√©)", val: 150, cat: "dette", globalCat: "depense" },
            { id: 6, name: "Assurance Maladie", val: 50, cat: "fixe", globalCat: "depense" },
            { id: 7, name: "Taxe Habitation (mensualis√©e)", val: 40, cat: "fixe", globalCat: "depense" },
            { id: 8, name: "Courses Alimentaires", val: 380, cat: "courante", globalCat: "depense" },
            { id: 9, name: "Transport", val: 100, cat: "courante", globalCat: "depense" },
            { id: 10, name: "Coiffeur", val: 30, cat: "courante", globalCat: "depense" },
            { id: 11, name: "Achat Ordinateur Portable", val: 600, cat: "occas", globalCat: "depense" },
            { id: 12, name: "√âpargne Livret A", val: 200, cat: "epargne", globalCat: "epargne" },
            { id: 13, name: "Don Association", val: 50, cat: "occas", globalCat: "depense" } // Ajout d'un poste
        ];

        // --- CALCULS R√âELS ET CODES SECRETS ---
        
        const totalRecettes = 2100 + 120 + 30; // 2250
        const totalDettes = 750 + 150; // 900
        const totalFixes = 50 + 40; // 90
        const totalCourantes = 380 + 100 + 30; // 510
        const totalOccasionnelles = 600 + 50; // 650
        const totalEpargne = 200; // 200
        
        // √âNIGMES
        const tauxEndettement = (totalDettes / totalRecettes) * 100; // 40.0%
        const code1_secret = 400; // 40.0 * 10 
        
        const resteAVivre = totalRecettes - totalDettes - totalFixes; // 2250 - 900 - 90 = 1260
        const code2_secret = 260; // Les 3 derniers chiffres de 1260
        
        const margeDeManoeuvre = resteAVivre - (totalCourantes + totalOccasionnelles); // 1260 - (510 + 650) = 100
        const code3_secret = 100; 

        // CODE FINAL : 400 + 260 + 0 (Dernier chiffre de 100) -> 4002600
        const finalCodeSecret = '4002600'; 
        
        // √âtat des √©nigmes
        let puzzleSolved = { 1: false, 2: false, 3: false };

        // --- FONCTIONS DE BASE (Drag & Drop) ---
        // (Les fonctions de base : selectItem, allowDrop, drag, drop sont les m√™mes que dans l'exercice pr√©c√©dent)
        const bank = document.getElementById("item-bank");
        items.sort(() => Math.random() - 0.5); 

        items.forEach(item => {
            let el = document.createElement("div");
            el.classList.add("draggable-item");
            el.setAttribute("draggable", "true");
            el.setAttribute("id", "item-" + item.id);
            el.setAttribute("data-val", item.val);
            el.setAttribute("data-cat", item.cat); 
            el.setAttribute("data-global-cat", item.globalCat); 
            el.innerText = `${item.name} (${item.val} ‚Ç¨)`;
            
            el.addEventListener("dragstart", drag);
            el.addEventListener("click", function() { selectItem(el); });
            bank.appendChild(el);
        });
        let selectedItem = null;
        function selectItem(el) { /* ... logique de s√©lection ... */
            if(selectedItem) { selectedItem.style.backgroundColor = "white"; selectedItem.style.borderColor = "#555"; }
            if (selectedItem === el) { selectedItem = null; return; }
            selectedItem = el;
            el.style.backgroundColor = "#e2e6ea"; el.style.borderColor = "#007bff";
        }
        function allowDrop(ev) { ev.preventDefault(); ev.currentTarget.classList.add("drag-over"); }
        function drag(ev) { ev.dataTransfer.setData("text", ev.target.id); selectItem(ev.target); }
        function drop(ev) {
            ev.preventDefault();
            document.querySelectorAll('.drop-zone, .sub-zone, #item-bank').forEach(z => z.classList.remove('drag-over'));
            let data = ev.dataTransfer ? ev.dataTransfer.getData("text") : null;
            let draggedElement;
            if (data) draggedElement = document.getElementById(data);
            else if (selectedItem) draggedElement = selectedItem;
            else return;
            let target = ev.target;
            while (!target.classList.contains("drop-zone") && !target.classList.contains("sub-zone") && target.id !== "item-bank" && target.tagName !== "BODY") { target = target.parentElement; }
            if (target.classList.contains("drop-zone") || target.classList.contains("sub-zone") || target.id === "item-bank") { target.appendChild(draggedElement); }
            if(selectedItem) { selectedItem.style.backgroundColor = "white"; selectedItem.style.borderColor = "#555"; selectedItem = null; }
        }
        document.querySelectorAll('.drop-zone, .sub-zone, #item-bank').forEach(zone => {
            zone.addEventListener('click', function(e) {
                if (selectedItem && e.target !== selectedItem && !e.target.closest('.draggable-item')) {
                    zone.appendChild(selectedItem);
                    selectedItem.style.backgroundColor = "white"; selectedItem.style.borderColor = "#555"; selectedItem = null;
                }
            });
            zone.addEventListener('dragleave', function() { zone.classList.remove("drag-over"); });
        });

        function verifierColonneGlobale(globalCatName, inputId, msgId) {
            // Logique de v√©rification de colonne (simplifi√©e pour l'escape game)
            let totalReelAttendu = 0;
            if (globalCatName === 'recette') totalReelAttendu = totalRecettes;
            else if (globalCatName === 'dette') totalReelAttendu = totalDettes;
            else if (globalCatName === 'fixe') totalReelAttendu = totalFixes;
            else if (globalCatName === 'courante') totalReelAttendu = totalCourantes;
            else if (globalCatName === 'occas') totalReelAttendu = totalOccasionnelles;
            else if (globalCatName === 'epargne') totalReelAttendu = totalEpargne;

            const input = document.getElementById(inputId);
            const msg = document.getElementById(msgId);
            const userVal = parseInt(input.value);

            // V√©rification simple du calcul (on ignore la v√©rification de placement des items pour l'√©nigme)
            if (userVal === totalReelAttendu) {
                msg.innerHTML = "‚úÖ Total correct !";
                msg.className = "feedback-msg correct";
                input.style.borderColor = "#28a745";
                input.disabled = true; 
            } else {
                msg.innerHTML = "‚ùå Le calcul est faux. Revoyez votre addition. (Attendu : " + totalReelAttendu + " ‚Ç¨)";
                msg.className = "feedback-msg incorrect";
            }
        }
        
        // --- LOGIQUE DES √âNIGMES ---

        function unlockPuzzle(id, expectedCode) {
            // V√©rification que tous les totaux sont valid√©s avant de commencer les √©nigmes
            if (document.getElementById('input-recettes').disabled === false || 
                document.getElementById('input-dettes').disabled === false ||
                document.getElementById('input-fixes').disabled === false ||
                document.getElementById('input-courantes').disabled === false ||
                document.getElementById('input-occas').disabled === false ||
                document.getElementById('input-epargne').disabled === false) {
                
                document.getElementById(`msg-puzzle-${id}`).innerHTML = "‚ö†Ô∏è Terminez d'abord la classification et validez tous les totaux ci-dessus.";
                document.getElementById(`msg-puzzle-${id}`).className = "feedback-msg incorrect";
                return;
            }

            const inputElement = document.getElementById(`code-${id}`);
            const userCode = parseInt(inputElement.value);
            const msgElement = document.getElementById(`msg-puzzle-${id}`);
            const titleElement = document.getElementById(`puzzle-${id}-title`);
            const buttonElement = inputElement.nextElementSibling;

            if (userCode === expectedCode) {
                msgElement.innerHTML = `‚úÖ √ânigme ${id} d√©verrouill√©e ! Code: ${expectedCode}`;
                msgElement.className = "feedback-msg correct";
                titleElement.classList.add('unlocked');
                titleElement.classList.remove('locked');
                buttonElement.classList.add('unlocked-btn');
                buttonElement.classList.remove('locked-btn');
                inputElement.disabled = true;
                buttonElement.disabled = true;
                puzzleSolved[id] = true;
                
                // V√©rifier si toutes les √©nigmes sont r√©solues
                if (puzzleSolved[1] && puzzleSolved[2] && puzzleSolved[3]) {
                    document.getElementById('final-escape-zone').classList.add('active');
                    document.getElementById('msg-final-code').innerHTML = "Assemblez les codes pour le d√©verrouillage final !";
                }
            } else {
                msgElement.innerHTML = "‚ùå Code incorrect. Revoyez votre calcul.";
                msgElement.className = "feedback-msg incorrect";
            }
        }
        
        // --- V√âRIFICATION DU CODE FINAL ---
        
        function verifierCodeFinal() {
            const finalCodeInput = document.getElementById('final-code').value.trim();
            const msgElement = document.getElementById('msg-final-code');
            
            if (finalCodeInput === finalCodeSecret) {
                msgElement.innerHTML = "üéâ **CODE CORRECT !** Amira est sauv√©e ! Son taux d'endettement est trop √©lev√© (40%), mais sa marge de man≈ìuvre positive de 100‚Ç¨ lui permet de r√©agir.";
                msgElement.className = "feedback-msg correct";
                document.getElementById('final-escape-zone').style.backgroundColor = '#28a745';
                document.body.style.backgroundColor = "#e8f5e9";
                
            } else {
                msgElement.innerHTML = "‚ùå **CODE FAUX !** V√©rifiez l'ordre des 7 chiffres (E1-3 chif. + E2-3 chif. + E3-1 chif.).";
                msgElement.className = "feedback-msg incorrect";
                document.getElementById('final-code').style.borderColor = '#dc3545';
                setTimeout(() => document.getElementById('final-code').style.borderColor = 'white', 2000);
            }
        }
        
        // --- AUDIO GESTION (Play/Stop & Clean Text) ---
        let isSpeaking = false;
        
        function toggleAudio() {
            const btn = document.getElementById('main-audio-btn');
            
            if (isSpeaking) {
                window.speechSynthesis.cancel();
                isSpeaking = false;
                btn.classList.remove('playing');
                btn.innerHTML = '<span>‚ñ∂Ô∏è Lire l\'histoire</span>';
            } else {
                let text = document.getElementById('text-content').innerText;
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                
                utterance.onend = function() {
                    isSpeaking = false;
                    btn.classList.remove('playing');
                    btn.innerHTML = '<span>‚ñ∂Ô∏è Lire l\'histoire</span>';
                };

                window.speechSynthesis.speak(utterance);
                isSpeaking = true;
                btn.classList.add('playing');
                btn.innerHTML = '<span>‚èπÔ∏è Arr√™ter</span>';
            }
        }
    </script>
</body>
</html>