<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module C.7 - Laboratoire virtuel : Les d√©fenses immunitaires - Terminale Bac Pro</title>
    <style>
        :root {
            --primary-pse: #2E86AB;
            --secondary-pse: #A23B72;
            --success-pse: #219653;
            --warning-pse: #F2994A;
            --danger-pse: #EB5757;
            --dark-pse: #2F3542;
            --light-pse: #F1F2F6;
            --ligne1-color: #E74C3C;
            --ligne2-color: #F39C12;
            --ligne3-color: #2ECC71;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
        }

        .exercice-container {
            width: 100%;
            max-width: 100vw;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        /* EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE */
        .cadre-pedagogique {
            background: linear-gradient(135deg, var(--primary-pse) 0%, var(--secondary-pse) 100%);
            color: white;
            padding: 20px;
        }

        .module-info h2 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            text-align: center;
        }

        .objectif {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
        }

        .competences-travaillees {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
        }

        .competences-travaillees h3 {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .competences-list {
            list-style: none;
            padding: 0;
        }

        .competences-list li {
            margin-bottom: 8px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            font-size: 0.95rem;
        }

        .niveau-cible {
            text-align: center;
            font-weight: bold;
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 8px;
        }

        /* EXERCICE PRINCIPAL */
        .exercice-principal {
            padding: 25px;
        }

        .contexte-laboratoire {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
        }

        .contexte-laboratoire h3 {
            margin-bottom: 10px;
            font-size: 1.4rem;
        }

        .instructions-interaction {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid var(--success-pse);
        }

        .instructions-interaction h5 {
            color: var(--success-pse);
            margin-bottom: 8px;
        }

        .navigation-lignes {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .btn-ligne {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .btn-ligne.ligne1 {
            background: var(--ligne1-color);
            color: white;
        }

        .btn-ligne.ligne2 {
            background: var(--ligne2-color);
            color: white;
        }

        .btn-ligne.ligne3 {
            background: var(--ligne3-color);
            color: white;
        }

        .btn-ligne:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .btn-ligne.active {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .ligne-defense {
            display: none;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }

        .ligne-defense.active {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .ligne-header {
            color: white;
            padding: 20px;
            text-align: center;
        }

        .ligne1 .ligne-header {
            background: linear-gradient(135deg, var(--ligne1-color), #C0392B);
        }

        .ligne2 .ligne-header {
            background: linear-gradient(135deg, var(--ligne2-color), #E67E22);
        }

        .ligne3 .ligne-header {
            background: linear-gradient(135deg, var(--ligne3-color), #27AE60);
        }

        .ligne-content {
            padding: 25px;
        }

        .schema-interactif {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            min-height: 300px;
            position: relative;
            border: 2px dashed #dee2e6;
        }

        .zone-depot {
            background: white;
            border: 2px dashed #6c757d;
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .zone-depot:hover {
            border-color: var(--primary-pse);
            background: #e7f3ff;
            transform: translateY(-2px);
        }

        .zone-depot.selected-target {
            border-color: var(--warning-pse);
            background: #fff3cd;
            border-style: solid;
        }

        .zone-depot.occupied {
            background: #d4edda;
            border-color: var(--success-pse);
            border-style: solid;
        }

        .elements-disponibles {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            border: 1px solid #dee2e6;
        }

        .element-clickable {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            user-select: none;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: bold;
            border: 3px solid transparent;
        }

        .element-clickable:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .element-clickable.selected {
            border-color: var(--warning-pse);
            background: linear-gradient(135deg, var(--warning-pse), #E67E22);
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(242, 153, 74, 0.5);
        }

        .element-clickable.used {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
        }

        .questions-manipulation {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .question-interactive {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid var(--primary-pse);
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-pse);
        }

        .reponses-options {
            display: grid;
            gap: 8px;
        }

        .option-button {
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            text-align: left;
        }

        .option-button:hover {
            border-color: var(--primary-pse);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 134, 171, 0.3);
        }

        .option-button.selected {
            background: var(--primary-pse);
            color: white;
            border-color: var(--primary-pse);
        }

        .option-button.correct {
            background: var(--success-pse);
            color: white;
            border-color: var(--success-pse);
        }

        .option-button.incorrect {
            background: var(--danger-pse);
            color: white;
            border-color: var(--danger-pse);
        }

        .btn-valider {
            background: var(--success-pse);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            margin: 20px 0;
            transition: all 0.3s ease;
        }

        .btn-valider:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 83, 0.4);
        }

        .btn-valider:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .correction-explicite {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
            display: none;
        }

        .correction-explicite.show {
            display: block;
        }

        .correction-title {
            color: #856404;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }

        .correction-content {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .bonne-reponse {
            color: var(--success-pse);
            font-weight: bold;
        }

        .explication {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--primary-pse);
        }

        .progression-exercice {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
            text-align: center;
            border: 2px solid var(--primary-pse);
        }

        .barre-progression {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progression-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-pse), var(--secondary-pse));
            width: 0%;
            transition: width 0.6s ease;
        }

        .resultats-finaux {
            background: white;
            border: 2px solid var(--primary-pse);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            text-align: center;
            display: none;
        }

        .resultats-finaux.show {
            display: block;
        }

        .score-global {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-pse);
            margin-bottom: 15px;
        }

        .competences-evaluation {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .competence-score {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 5px solid;
        }

        .competence-c1 { border-left-color: #E74C3C; }
        .competence-c3 { border-left-color: #2ECC71; }
        .competence-c6 { border-left-color: #1ABC9C; }

        /* FEEDBACK VISUEL */
        .feedback-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            padding: 20px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: popIn 0.5s ease;
        }

        .feedback-popup.success {
            background: var(--success-pse);
            color: white;
        }

        .feedback-popup.error {
            background: var(--danger-pse);
            color: white;
        }

        @keyframes popIn {
            from { 
                transform: translate(-50%, -50%) scale(0.5); 
                opacity: 0; 
            }
            to { 
                transform: translate(-50%, -50%) scale(1); 
                opacity: 1; 
            }
        }

        /* FOOTER RGPD */
        .rgpd-notice {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            color: #6c757d;
            font-size: 0.8rem;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .exercice-container {
                margin: 10px;
            }

            .cadre-pedagogique {
                padding: 15px;
            }

            .module-info h2 {
                font-size: 1.5rem;
            }

            .exercice-principal {
                padding: 20px;
            }

            .elements-disponibles {
                justify-content: center;
            }

            .navigation-lignes {
                flex-direction: column;
                align-items: center;
            }

            .element-clickable {
                font-size: 0.8rem;
                padding: 8px 12px;
            }
        }

        @media (min-width: 1024px) {
            .exercice-container {
                max-width: 900px;
                margin: 0 auto;
            }
        }
    </style>
</head>
<body>
    <!-- EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE -->
    <div class="exercice-container">
        <div class="cadre-pedagogique">
            <div class="module-info">
                <h2>Module C.7 : Le suivi de la sant√© au travail</h2>
                <div class="objectif">
                    <strong>Objectif :</strong> Appr√©hender l'importance de la surveillance m√©dicale et des vaccinations obligatoires en milieu professionnel.
                </div>
            </div>
            
            <div class="competences-travaillees">
                <h3>Comp√©tences travaill√©es dans cet exercice :</h3>
                <ul class="competences-list">
                    <li><strong>C1</strong> - Traiter une information</li>
                    <li><strong>C3</strong> - Expliquer un ph√©nom√®ne physiologique en lien avec une mesure de pr√©vention</li>
                    <li><strong>C6</strong> - Communiquer √† l'√©crit et √† l'oral avec une syntaxe claire et un vocabulaire adapt√©</li>
                </ul>
            </div>
            
            <div class="niveau-cible">
                <strong>Niveau :</strong> Terminale Bac Pro
            </div>
        </div>

        <!-- EXERCICE PRINCIPAL -->
        <main class="exercice-principal">
            <div class="contexte-laboratoire">
                <h3>üß¨ LABORATOIRE VIRTUEL : LES D√âFENSES IMMUNITAIRES EN ACTION</h3>
                <p>Explorez les 3 lignes de d√©fense de l'organisme face aux microorganismes pathog√®nes. Manipulez, exp√©rimentez et comprenez les m√©canismes de protection de notre corps !</p>
            </div>

            <div class="instructions-interaction">
                <h5>üì± COMMENT MANIPULER :</h5>
                <p><strong>1.</strong> Cliquez sur un √©l√©ment pour le s√©lectionner (il s'illumine) <strong>2.</strong> Cliquez sur la zone de destination appropri√©e <strong>3.</strong> L'√©l√©ment se place automatiquement !</p>
            </div>

            <div class="progression-exercice">
                <h4>üî¨ PROGRESSION DU LABORATOIRE</h4>
                <div class="barre-progression">
                    <div class="progression-fill" id="progression-fill"></div>
                </div>
                <div id="progression-text">Ligne 1/3 - Barri√®re cutan√©o-muqueuse</div>
            </div>

            <!-- NAVIGATION ENTRE LIGNES -->
            <div class="navigation-lignes">
                <button class="btn-ligne ligne1 active" onclick="afficherLigne(1)">
                    üõ°Ô∏è 1√®re LIGNE - Barri√®res naturelles
                </button>
                <button class="btn-ligne ligne2" onclick="afficherLigne(2)">
                    üî• 2√®me LIGNE - R√©action inflammatoire
                </button>
                <button class="btn-ligne ligne3" onclick="afficherLigne(3)">
                    ‚öîÔ∏è 3√®me LIGNE - Immunit√© sp√©cifique
                </button>
            </div>

            <!-- PREMI√àRE LIGNE DE D√âFENSE -->
            <div class="ligne-defense ligne1 active" id="ligne1">
                <div class="ligne-header">
                    <h3>üõ°Ô∏è PREMI√àRE LIGNE : LA BARRI√àRE CUTAN√âO-MUQUEUSE</h3>
                    <p>La premi√®re protection contre les microorganismes pathog√®nes</p>
                </div>
                <div class="ligne-content">
                    <div class="schema-interactif">
                        <h4>üî¨ MANIPULATION 1 : Classez les barri√®res de protection</h4>
                        <p>Cliquez sur un √©l√©ment puis sur sa cat√©gorie :</p>
                        
                        <div class="elements-disponibles" id="elements-ligne1">
                            <div class="element-clickable" data-type="physique" onclick="selectionnerElement(this)">Peau intacte</div>
                            <div class="element-clickable" data-type="chimique" onclick="selectionnerElement(this)">S√©bum</div>
                            <div class="element-clickable" data-type="biologique" onclick="selectionnerElement(this)">Flore intestinale</div>
                            <div class="element-clickable" data-type="physique" onclick="selectionnerElement(this)">Cils vibratiles</div>
                            <div class="element-clickable" data-type="chimique" onclick="selectionnerElement(this)">Acidit√© gastrique</div>
                            <div class="element-clickable" data-type="biologique" onclick="selectionnerElement(this)">Flore vaginale</div>
                            <div class="element-clickable" data-type="chimique" onclick="selectionnerElement(this)">Lysozyme des larmes</div>
                            <div class="element-clickable" data-type="physique" onclick="selectionnerElement(this)">Muqueuses</div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div>
                                <h5 style="color: var(--ligne1-color); margin-bottom: 10px;">üöß BARRI√àRE PHYSIQUE</h5>
                                <div class="zone-depot" data-accept="physique" onclick="placerElement(this)">
                                    Obstacles m√©caniques
                                </div>
                            </div>
                            <div>
                                <h5 style="color: var(--ligne1-color); margin-bottom: 10px;">‚öóÔ∏è BARRI√àRE CHIMIQUE</h5>
                                <div class="zone-depot" data-accept="chimique" onclick="placerElement(this)">
                                    Substances antimicrobiennes
                                </div>
                            </div>
                            <div>
                                <h5 style="color: var(--ligne1-color); margin-bottom: 10px;">ü¶† BARRI√àRE BIOLOGIQUE</h5>
                                <div class="zone-depot" data-accept="biologique" onclick="placerElement(this)">
                                    Flores protectrices
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="questions-manipulation">
                        <div class="question-interactive">
                            <div class="question-title">1. Quelle est l'efficacit√© de ces barri√®res naturelles ?</div>
                            <div class="reponses-options">
                                <button class="option-button" data-question="1-1" data-correct="false">
                                    Elles arr√™tent environ 50% des microorganismes
                                </button>
                                <button class="option-button" data-question="1-1" data-correct="true">
                                    Elles constituent la premi√®re ligne de d√©fense et sont tr√®s efficaces quand intactes
                                </button>
                                <button class="option-button" data-question="1-1" data-correct="false">
                                    Elles ne sont efficaces que contre les virus
                                </button>
                            </div>
                        </div>

                        <div class="question-interactive">
                            <div class="question-title">2. Que se passe-t-il si cette premi√®re ligne est franchie ?</div>
                            <div class="reponses-options">
                                <button class="option-button" data-question="1-2" data-correct="false">
                                    L'organisme n'a plus de d√©fense
                                </button>
                                <button class="option-button" data-question="1-2" data-correct="true">
                                    La deuxi√®me ligne de d√©fense s'active (r√©action inflammatoire)
                                </button>
                                <button class="option-button" data-question="1-2" data-correct="false">
                                    Les antibiotiques s'activent automatiquement
                                </button>
                            </div>
                        </div>

                        <button class="btn-valider" onclick="validerLigne(1)">Valider la Ligne 1</button>

                        <div class="correction-explicite" id="correction-ligne1">
                            <div class="correction-title">‚ùå CORRECTION LIGNE 1</div>
                            <div class="correction-content">
                                <div class="bonne-reponse">‚úÖ LES BONNES R√âPONSES √âTAIENT :</div>
                                <p><strong>Barri√®res physiques :</strong> Peau intacte, Cils vibratiles, Muqueuses</p>
                                <p><strong>Barri√®res chimiques :</strong> S√©bum, Acidit√© gastrique, Lysozyme des larmes</p>
                                <p><strong>Barri√®res biologiques :</strong> Flore intestinale, Flore vaginale</p>
                            </div>
                            <div class="explication">
                                <strong>üí° EXPLICATION :</strong> La barri√®re cutan√©o-muqueuse constitue la premi√®re ligne de d√©fense de l'organisme. Elle agit selon 3 modes : physique (obstacle m√©canique), chimique (substances antimicrobiennes) et biologique (comp√©tition entre flores). Cette ligne est tr√®s efficace tant qu'elle reste intacte.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DEUXI√àME LIGNE DE D√âFENSE -->
            <div class="ligne-defense ligne2" id="ligne2">
                <div class="ligne-header">
                    <h3>üî• DEUXI√àME LIGNE : R√âACTION INFLAMMATOIRE ET PHAGOCYTOSE</h3>
                    <p>La r√©ponse immunitaire non sp√©cifique quand la premi√®re ligne est franchie</p>
                </div>
                <div class="ligne-content">
                    <div class="schema-interactif">
                        <h4>üî¨ MANIPULATION 2 : Reconstituez les √©tapes de la r√©action inflammatoire</h4>
                        <p>Cliquez sur chaque √©tape puis sur sa position chronologique :</p>
                        
                        <div class="elements-disponibles" id="elements-ligne2">
                            <div class="element-clickable" data-order="1" onclick="selectionnerElement(this)">L√©sion de la barri√®re cutan√©e</div>
                            <div class="element-clickable" data-order="4" onclick="selectionnerElement(this)">Phagocytose des microorganismes</div>
                            <div class="element-clickable" data-order="2" onclick="selectionnerElement(this)">Dilatation des vaisseaux sanguins</div>
                            <div class="element-clickable" data-order="3" onclick="selectionnerElement(this)">Diap√©d√®se des globules blancs</div>
                            <div class="element-clickable" data-order="5" onclick="selectionnerElement(this)">√âlimination des d√©chets</div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div>
                                <h5>√âTAPE 1</h5>
                                <div class="zone-depot" data-order="1" onclick="placerElement(this)">
                                    Le d√©but...
                                </div>
                            </div>
                            <div>
                                <h5>√âTAPE 2</h5>
                                <div class="zone-depot" data-order="2" onclick="placerElement(this)">
                                    Puis...
                                </div>
                            </div>
                            <div>
                                <h5>√âTAPE 3</h5>
                                <div class="zone-depot" data-order="3" onclick="placerElement(this)">
                                    Ensuite...
                                </div>
                            </div>
                            <div>
                                <h5>√âTAPE 4</h5>
                                <div class="zone-depot" data-order="4" onclick="placerElement(this)">
                                    Apr√®s...
                                </div>
                            </div>
                            <div>
                                <h5>√âTAPE 5</h5>
                                <div class="zone-depot" data-order="5" onclick="placerElement(this)">
                                    Enfin...
                                </div>
                            </div>
                        </div>

                        <!-- Animation des 4 signes de l'inflammation -->
                        <div style="margin-top: 20px; padding: 20px; background: #fff; border-radius: 10px;">
                            <h5>üî• Les 4 signes de l'inflammation :</h5>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; text-align: center; margin-top: 15px;">
                                <div style="padding: 10px; background: #ffebee; border-radius: 8px;">
                                    <div style="font-size: 2rem;">üî¥</div>
                                    <strong>ROUGEUR</strong>
                                </div>
                                <div style="padding: 10px; background: #fff3e0; border-radius: 8px;">
                                    <div style="font-size: 2rem;">üå°Ô∏è</div>
                                    <strong>CHALEUR</strong>
                                </div>
                                <div style="padding: 10px; background: #f3e5f5; border-radius: 8px;">
                                    <div style="font-size: 2rem;">üíß</div>
                                    <strong>GONFLEMENT</strong>
                                </div>
                                <div style="padding: 10px; background: #ffecb3; border-radius: 8px;">
                                    <div style="font-size: 2rem;">‚ö°</div>
                                    <strong>DOULEUR</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="questions-manipulation">
                        <div class="question-interactive">
                            <div class="question-title">1. Quel est le r√¥le de la diap√©d√®se ?</div>
                            <div class="reponses-options">
                                <button class="option-button" data-question="2-1" data-correct="true">
                                    Permettre aux globules blancs de sortir des vaisseaux sanguins
                                </button>
                                <button class="option-button" data-question="2-1" data-correct="false">
                                    Dilater les vaisseaux sanguins
                                </button>
                                <button class="option-button" data-question="2-1" data-correct="false">
                                    Provoquer la douleur
                                </button>
                            </div>
                        </div>

                        <div class="question-interactive">
                            <div class="question-title">2. Pourquoi cette d√©fense est-elle qualifi√©e de "non sp√©cifique" ?</div>
                            <div class="reponses-options">
                                <button class="option-button" data-question="2-2" data-correct="false">
                                    Car elle ne fonctionne pas bien
                                </button>
                                <button class="option-button" data-question="2-2" data-correct="true">
                                    Car elle agit contre tous les microorganismes sans distinction
                                </button>
                                <button class="option-button" data-question="2-2" data-correct="false">
                                    Car elle n'est pas cibl√©e sur une zone pr√©cise
                                </button>
                            </div>
                        </div>

                        <button class="btn-valider" onclick="validerLigne(2)">Valider la Ligne 2</button>

                        <div class="correction-explicite" id="correction-ligne2">
                            <div class="correction-title">‚ùå CORRECTION LIGNE 2</div>
                            <div class="correction-content">
                                <div class="bonne-reponse">‚úÖ LES BONNES R√âPONSES √âTAIENT :</div>
                                <p><strong>1.</strong> La diap√©d√®se permet aux globules blancs de rejoindre le site d'infection</p>
                                <p><strong>2.</strong> Cette d√©fense est non sp√©cifique car universelle</p>
                            </div>
                            <div class="explication">
                                <strong>üí° EXPLICATION :</strong> La r√©action inflammatoire est d√©clench√©e par la l√©sion tissulaire. Elle se caract√©rise par 4 signes cardinaux et permet le recrutement des phagocytes qui vont √©liminer les pathog√®nes par phagocytose. C'est une r√©ponse imm√©diate mais non sp√©cifique.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TROISI√àME LIGNE DE D√âFENSE -->
            <div class="ligne-defense ligne3" id="ligne3">
                <div class="ligne-header">
                    <h3>‚öîÔ∏è TROISI√àME LIGNE : IMMUNIT√â SP√âCIFIQUE</h3>
                    <p>La r√©ponse adaptative cibl√©e avec m√©moire immunologique</p>
                </div>
                <div class="ligne-content">
                    <div class="schema-interactif">
                        <h4>üî¨ MANIPULATION 3 : M√©canisme de la vaccination</h4>
                        <p>Cliquez sur chaque √©tape puis sur sa position dans le processus :</p>
                        
                        <div class="elements-disponibles" id="elements-ligne3">
                            <div class="element-clickable" data-step="1" onclick="selectionnerElement(this)">Injection vaccin (antig√®ne att√©nu√©)</div>
                            <div class="element-clickable" data-step="2" onclick="selectionnerElement(this)">Reconnaissance par lymphocytes B</div>
                            <div class="element-clickable" data-step="3" onclick="selectionnerElement(this)">Production d'anticorps sp√©cifiques</div>
                            <div class="element-clickable" data-step="4" onclick="selectionnerElement(this)">Formation lymphocytes m√©moire</div>
                            <div class="element-clickable" data-step="5" onclick="selectionnerElement(this)">Contact avec pathog√®ne r√©el</div>
                            <div class="element-clickable" data-step="6" onclick="selectionnerElement(this)">R√©ponse immunitaire rapide et efficace</div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px;">
                            <div class="zone-depot" data-step="1" onclick="placerElement(this)">
                                <strong>√âTAPE 1</strong><br>Vaccination
                            </div>
                            <div class="zone-depot" data-step="2" onclick="placerElement(this)">
                                <strong>√âTAPE 2</strong><br>Reconnaissance
                            </div>
                            <div class="zone-depot" data-step="3" onclick="placerElement(this)">
                                <strong>√âTAPE 3</strong><br>Production
                            </div>
                            <div class="zone-depot" data-step="4" onclick="placerElement(this)">
                                <strong>√âTAPE 4</strong><br>M√©morisation
                            </div>
                            <div class="zone-depot" data-step="5" onclick="placerElement(this)">
                                <strong>√âTAPE 5</strong><br>Nouveau contact
                            </div>
                            <div class="zone-depot" data-step="6" onclick="placerElement(this)">
                                <strong>√âTAPE 6</strong><br>Protection
                            </div>
                        </div>

                        <!-- Visualisation vaccins obligatoires -->
                        <div style="margin-top: 20px; padding: 20px; background: #e8f5e8; border-radius: 10px;">
                            <h5>üíâ VACCINS OBLIGATOIRES EN MILIEU PROFESSIONNEL</h5>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                                <div style="background: white; padding: 15px; border-radius: 8px;">
                                    <strong>üè• SECTEUR SANT√â</strong>
                                    <ul style="margin-top: 8px; font-size: 0.9rem;">
                                        <li>H√©patite B (obligatoire)</li>
                                        <li>DTP (obligatoire)</li>
                                        <li>Grippe (recommand√©)</li>
                                    </ul>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 8px;">
                                    <strong>üë∂ PETITE ENFANCE</strong>
                                    <ul style="margin-top: 8px; font-size: 0.9rem;">
                                        <li>ROR (recommand√©)</li>
                                        <li>Varicelle (recommand√©)</li>
                                        <li>Coqueluche (recommand√©)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="questions-manipulation">
                        <div class="question-interactive">
                            <div class="question-title">1. Quelle est la diff√©rence majeure avec les lignes 1 et 2 ?</div>
                            <div class="reponses-options">
                                <button class="option-button" data-question="3-1" data-correct="false">
                                    Elle est plus lente √† se mettre en place
                                </button>
                                <button class="option-button" data-question="3-1" data-correct="true">
                                    Elle est sp√©cifique √† chaque pathog√®ne et garde une m√©moire
                                </button>
                                <button class="option-button" data-question="3-1" data-correct="false">
                                    Elle ne produit pas d'anticorps
                                </button>
                            </div>
                        </div>

                        <div class="question-interactive">
                            <div class="question-title">2. Pourquoi les rappels de vaccins sont-ils n√©cessaires ?</div>
                            <div class="reponses-options">
                                <button class="option-button" data-question="3-2" data-correct="false">
                                    Car les vaccins perdent leur efficacit√©
                                </button>
                                <button class="option-button" data-question="3-2" data-correct="true">
                                    Pour r√©activer et entretenir la m√©moire immunitaire
                                </button>
                                <button class="option-button" data-question="3-2" data-correct="false">
                                    Car les virus mutent constamment
                                </button>
                            </div>
                        </div>

                        <button class="btn-valider" onclick="validerLigne(3)">Valider la Ligne 3</button>

                        <div class="correction-explicite" id="correction-ligne3">
                            <div class="correction-title">‚ùå CORRECTION LIGNE 3</div>
                            <div class="correction-content">
                                <div class="bonne-reponse">‚úÖ LES BONNES R√âPONSES √âTAIENT :</div>
                                <p><strong>1.</strong> L'immunit√© sp√©cifique est adaptative et m√©morielle</p>
                                <p><strong>2.</strong> Les rappels entretiennent la m√©moire immunitaire</p>
                            </div>
                            <div class="explication">
                                <strong>üí° EXPLICATION :</strong> L'immunit√© sp√©cifique fait intervenir les lymphocytes B (production d'anticorps) et T (destruction cellulaire). Elle cr√©e une m√©moire immunitaire durable. C'est le principe de la vaccination : exposer l'organisme √† un antig√®ne inoffensif pour cr√©er une protection sp√©cifique.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- R√âSULTATS FINAUX -->
            <div class="resultats-finaux" id="resultats-finaux">
                <h3>üéì BILAN DU LABORATOIRE VIRTUEL</h3>
                <div class="score-global" id="score-global"></div>
                <p id="message-performance"></p>

                <div class="competences-evaluation">
                    <div class="competence-score competence-c1">
                        <h4>Comp√©tence C1</h4>
                        <p><strong>Traiter une information</strong></p>
                        <div id="score-c1"></div>
                    </div>
                    <div class="competence-score competence-c3">
                        <h4>Comp√©tence C3</h4>
                        <p><strong>Expliquer ph√©nom√®nes</strong></p>
                        <div id="score-c3"></div>
                    </div>
                    <div class="competence-score competence-c6">
                        <h4>Comp√©tence C6</h4>
                        <p><strong>Communiquer</strong></p>
                        <div id="score-c6"></div>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <button class="btn-valider" onclick="recommencerLaboratoire()">
                        üîÑ Recommencer le laboratoire
                    </button>
                </div>
            </div>
        </main>

        <!-- FOOTER RGPD -->
        <div class="rgpd-notice">
            üîí Conformit√© RGPD : Cet exercice respecte votre anonymat.
        </div>
    </div>

    <script>
        // Variables globales
        let ligneActive = 1;
        let scores = {
            global: 0,
            c1: 0, // Manipulation/traitement info
            c3: 0, // Explication m√©canismes
            c6: 0  // Communication scientifique
        };
        let lignesValidees = new Set();
        let manipulationsReussies = {
            ligne1: false,
            ligne2: false,
            ligne3: false
        };
        let elementSelectionne = null;

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            initialiserInteractions();
            mettreAJourProgression();
        });

        // Navigation entre lignes
        function afficherLigne(numeroLigne) {
            // Cacher toutes les lignes
            document.querySelectorAll('.ligne-defense').forEach(ligne => {
                ligne.classList.remove('active');
            });
            document.querySelectorAll('.btn-ligne').forEach(btn => {
                btn.classList.remove('active');
            });

            // Afficher la ligne s√©lectionn√©e
            document.getElementById(`ligne${numeroLigne}`).classList.add('active');
            document.querySelector(`.btn-ligne.ligne${numeroLigne}`).classList.add('active');
            
            ligneActive = numeroLigne;
            mettreAJourProgression();
            
            // R√©initialiser la s√©lection
            elementSelectionne = null;
        }

        function mettreAJourProgression() {
            const pourcentage = (ligneActive / 3) * 100;
            document.getElementById('progression-fill').style.width = pourcentage + '%';
            
            const textes = [
                'Ligne 1/3 - Barri√®re cutan√©o-muqueuse',
                'Ligne 2/3 - R√©action inflammatoire',
                'Ligne 3/3 - Immunit√© sp√©cifique'
            ];
            document.getElementById('progression-text').textContent = textes[ligneActive - 1];
        }

        // Syst√®me clic-s√©lection
        function initialiserInteractions() {
            document.querySelectorAll('.option-button').forEach(button => {
                button.addEventListener('click', function() {
                    const questionId = this.dataset.question;
                    document.querySelectorAll(`[data-question="${questionId}"]`).forEach(btn => {
                        btn.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
            });
        }

        function selectionnerElement(element) {
            if (element.classList.contains('used')) return;
            
            // D√©s√©lectionner l'ancien √©l√©ment
            if (elementSelectionne) {
                elementSelectionne.classList.remove('selected');
            }
            
            // S√©lectionner le nouveau
            elementSelectionne = element;
            element.classList.add('selected');
            
            // Feedback visuel pour les zones disponibles
            const ligneActive = document.querySelector('.ligne-defense.active');
            ligneActive.querySelectorAll('.zone-depot:not(.occupied)').forEach(zone => {
                zone.classList.add('selected-target');
            });
        }

        function placerElement(zoneDestination) {
            if (!elementSelectionne || zoneDestination.classList.contains('occupied')) {
                return;
            }

            let placementValide = false;
            let texteElement = elementSelectionne.textContent;

            // Ligne 1 : Classification par type
            if (elementSelectionne.dataset.type && zoneDestination.dataset.accept) {
                placementValide = elementSelectionne.dataset.type === zoneDestination.dataset.accept;
            }
            
            // Ligne 2 : Ordre chronologique
            if (elementSelectionne.dataset.order && zoneDestination.dataset.order) {
                placementValide = elementSelectionne.dataset.order === zoneDestination.dataset.order;
            }
            
            // Ligne 3 : √âtapes vaccination
            if (elementSelectionne.dataset.step && zoneDestination.dataset.step) {
                placementValide = elementSelectionne.dataset.step === zoneDestination.dataset.step;
            }

            if (placementValide) {
                // Placement r√©ussi
                if (zoneDestination.dataset.order) {
                    // Pour ligne 2 : garder le titre d'√©tape
                    const titre = zoneDestination.innerHTML.split('<br>')[0] || zoneDestination.textContent;
                    zoneDestination.innerHTML = `${titre}<br><em>${texteElement}</em>`;
                } else if (zoneDestination.dataset.step) {
                    // Pour ligne 3 : garder le titre d'√©tape
                    const titre = zoneDestination.innerHTML.split('<br>')[0] || zoneDestination.textContent;
                    zoneDestination.innerHTML = `${titre}<br><em>${texteElement}</em>`;
                } else {
                    // Pour ligne 1 : remplacer compl√®tement
                    zoneDestination.innerHTML = `<strong>${texteElement}</strong>`;
                }
                
                zoneDestination.classList.add('occupied');
                elementSelectionne.classList.add('used');
                elementSelectionne.classList.remove('selected');
                
                afficherFeedback('‚úÖ Excellent placement !', 'success');
                verifierManipulation();
                
            } else {
                // Placement incorrect
                afficherFeedback('‚ùå Mauvais emplacement, r√©essayez !', 'error');
            }

            // Nettoyer les indications visuelles
            document.querySelectorAll('.zone-depot').forEach(zone => {
                zone.classList.remove('selected-target');
            });
            
            elementSelectionne = null;
        }

        function verifierManipulation() {
            const ligneActuelle = document.querySelector('.ligne-defense.active');
            const zonesOccupees = ligneActuelle.querySelectorAll('.zone-depot.occupied').length;
            
            let zonesAttendues = 0;
            let ligneNum = 0;
            
            if (ligneActuelle.classList.contains('ligne1')) {
                zonesAttendues = 3;
                ligneNum = 1;
            } else if (ligneActuelle.classList.contains('ligne2')) {
                zonesAttendues = 5;
                ligneNum = 2;
            } else if (ligneActuelle.classList.contains('ligne3')) {
                zonesAttendues = 6;
                ligneNum = 3;
            }
            
            if (zonesOccupees === zonesAttendues) {
                manipulationsReussies[`ligne${ligneNum}`] = true;
                scores.c1++; // Traitement information
                afficherSuccesManipulation(`üéâ Ligne ${ligneNum} parfaitement ma√Ætris√©e !`);
            }
        }

        function afficherFeedback(message, type) {
            const feedback = document.createElement('div');
            feedback.className = `feedback-popup ${type}`;
            feedback.textContent = message;
            document.body.appendChild(feedback);
            
            setTimeout(() => {
                feedback.remove();
            }, 2000);
        }

        function afficherSuccesManipulation(message) {
            const div = document.createElement('div');
            div.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 1000;
                background: var(--success-pse); color: white; padding: 15px;
                border-radius: 10px; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                animation: slideIn 0.5s ease;
            `;
            div.textContent = message;
            document.body.appendChild(div);
            
            setTimeout(() => {
                div.remove();
            }, 3000);
        }

        function validerLigne(ligneNum) {
            if (lignesValidees.has(ligneNum)) return;

            const questions = [
                `${ligneNum}-1`,
                `${ligneNum}-2`
            ];

            let correct = 0;
            let allAnswered = true;

            questions.forEach(questionId => {
                const selectedButton = document.querySelector(`[data-question="${questionId}"].selected`);
                
                if (!selectedButton) {
                    allAnswered = false;
                    return;
                }

                const allButtons = document.querySelectorAll(`[data-question="${questionId}"]`);
                allButtons.forEach(btn => {
                    if (btn.dataset.correct === 'true') {
                        btn.classList.add('correct');
                    } else {
                        btn.classList.add('incorrect');
                    }
                });

                if (selectedButton.dataset.correct === 'true') {
                    correct++;
                }
            });

            if (!allAnswered) {
                alert('‚ö†Ô∏è Veuillez r√©pondre √† toutes les questions avant de valider.');
                return;
            }

            // Attribution points par comp√©tence
            scores.c3 += correct; // Explication ph√©nom√®nes
            scores.c6 += (manipulationsReussies[`ligne${ligneNum}`] ? 1 : 0); // Communication
            scores.global += correct + (manipulationsReussies[`ligne${ligneNum}`] ? 1 : 0);

            lignesValidees.add(ligneNum);
            document.getElementById(`correction-ligne${ligneNum}`).classList.add('show');

            // D√©sactiver le bouton
            const btnValider = document.querySelector(`#ligne${ligneNum} .btn-valider`);
            btnValider.disabled = true;
            btnValider.textContent = '‚úÖ Ligne valid√©e';

            // V√©rifier si toutes les lignes sont valid√©es
            if (lignesValidees.size === 3) {
                setTimeout(() => {
                    afficherResultatsFinaux();
                }, 1000);
            }
        }

        function afficherResultatsFinaux() {
            const maxScore = 9; // 3 manips + 6 questions
            const pourcentage = Math.round((scores.global / maxScore) * 100);
            
            document.getElementById('score-global').textContent = `${scores.global}/${maxScore} (${pourcentage}%)`;
            
            let message = '';
            if (pourcentage >= 90) {
                message = 'üèÜ Extraordinaire ! Vous ma√Ætrisez parfaitement les d√©fenses immunitaires !';
            } else if (pourcentage >= 75) {
                message = 'üéâ Excellent ! Tr√®s bonne compr√©hension des m√©canismes de d√©fense.';
            } else if (pourcentage >= 60) {
                message = 'üëç Bien ! Quelques r√©visions pour parfaire vos connaissances.';
            } else {
                message = 'üìö Courage ! R√©visez les 3 lignes de d√©fense et recommencez.';
            }
            
            document.getElementById('message-performance').textContent = message;

            // Scores par comp√©tence
            document.getElementById('score-c1').innerHTML = `<strong>${scores.c1}/3</strong><br>Manipulations r√©ussies`;
            document.getElementById('score-c3').innerHTML = `<strong>${scores.c3}/6</strong><br>M√©canismes expliqu√©s`;
            document.getElementById('score-c6').innerHTML = `<strong>${scores.c6}/3</strong><br>Communication scientifique`;

            document.getElementById('resultats-finaux').classList.add('show');
            document.getElementById('resultats-finaux').scrollIntoView({ behavior: 'smooth' });
        }

        function recommencerLaboratoire() {
            location.reload();
        }

        // Styles d'animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>