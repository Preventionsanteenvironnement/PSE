<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module D2 : Le Budget de Lina</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #2563eb; --success: #16a34a; --error: #dc2626; --bg: #f1f5f9; }

        * , *::before, *::after {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: var(--bg);
            color: #333;
            padding: 15px;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            max-width: 1100px;
            width: 100%;
        }

        header {
            background: #2563eb;
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .obj-box {
            background: rgba(255,255,255,0.15);
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .context-box {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            line-height: 1.6;
            word-wrap: break-word;
        }

        #item-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            background: #fff;
            padding: 15px;
            border-radius: 12px;
            border: 2px dashed #cbd5e1;
            margin-bottom: 20px;
            min-height: 80px;
        }

        .draggable-item {
            padding: 12px 15px;
            background: white;
            border: 2px solid #64748b;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.2s;
            user-select: none;
            max-width: 100%;
        }

        .draggable-item.selected {
            border-color: #2563eb;
            background: #eff6ff;
            transform: scale(1.05);
        }

        .budget-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 15px;
            width: 100%;
        }

        .column {
            background: white;
            border-radius: 12px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            min-height: 400px;
            border-top: 8px solid #ccc;
        }

        #col-recettes { border-top-color: #28a745; }
        #col-fixes { border-top-color: #007bff; }
        #col-courantes { border-top-color: #ffc107; }
        #col-occas { border-top-color: #dc3545; }

        .drop-zone {
            flex-grow: 1;
            padding: 10px;
            border-radius: 8px;
            background: #f8fafc;
            min-height: 150px;
            cursor: pointer;
        }

        .sub-zone {
            background: #e2f3e5;
            margin-bottom: 10px;
            border-radius: 8px;
            padding: 10px;
            min-height: 80px;
        }

        .calc-zone {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid #eee;
            text-align: center;
        }

        input[type="number"] {
            width: 110px;
            padding: 8px;
            border: 2px solid #cbd5e1;
            border-radius: 6px;
            text-align: center;
        }

        .btn-valider {
            background: #1e293b;
            color: white;
            border: none;
            padding: 20px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 800;
            cursor: pointer;
            margin-top: 30px;
            width: 100%;
        }

        #result-zone {
            display: none;
            width: 100%;
            background: white;
            padding: 25px;
            border-radius: 20px;
            border: 4px solid #2563eb;
            margin-top: 30px;
            text-align: center;
        }

        .synthesis-card {
            background: #eff6ff;
            border: 2px solid #2563eb;
            padding: 15px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: left;
        }

        .syn-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .status-options {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            padding: 10px;
            background: #fff;
            border-radius: 8px;
            border: 1px solid #cbd5e1;
        }

        @media (max-width: 600px) {
            body {
                padding: 10px;
            }

            header {
                padding: 15px;
            }

            .context-box {
                padding: 15px;
            }

            .budget-container {
                grid-template-columns: 1fr;
            }

            .column {
                min-height: auto;
            }

            input[type="number"] {
                width: 100%;
                max-width: 140px;
            }

            #item-bank {
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1 style="margin:0;">Module D2 : Le Budget de Lina</h1>
        <div class="obj-box">Objectif : Identifier un budget exc√©dentaire apr√®s calcul du solde.</div>
    </header>

    <div class="context-box">
        <strong>Situation :</strong> Lina est architecte. Elle per√ßoit un <b>salaire net de 4 673,73 ‚Ç¨</b>. Elle n'a aucune prime ce mois-ci. <br><br>
        Ses op√©rations : Cr√©dit immobilier (1 230,56 ‚Ç¨), Assurance (72,43 ‚Ç¨), Abonnements t√©l√©phone/fibre (55,12 ‚Ç¨), Courses alimentaires (485,34 ‚Ç¨), Carburant (120,50 ‚Ç¨), Produits d'hygi√®ne (42,25 ‚Ç¨), Nouvel am√©nagement bureau (850,45 ‚Ç¨) et Sorties restaurant (210,00 ‚Ç¨).
    </div>

    <p style="font-weight:bold;">1. Cliquez sur une √©tiquette, puis sur sa cat√©gorie :</p>
    <div id="item-bank"></div>

    <div class="budget-container">
        <div class="column" id="col-recettes">
            <h3>Recettes</h3>
            <div class="drop-zone sub-zone" data-category="recette-travail"><h4>Travail</h4></div>
            <div class="calc-zone">Total : <input type="number" step="0.01" id="in-recettes"> ‚Ç¨</div>
        </div>
        <div class="column" id="col-fixes">
            <h3>Fixes (Incompressibles)</h3>
            <div class="drop-zone" data-category="fixe"></div>
            <div class="calc-zone">Total : <input type="number" step="0.01" id="in-fixes"> ‚Ç¨</div>
        </div>
        <div class="column" id="col-courantes">
            <h3>Courantes</h3>
            <div class="drop-zone" data-category="courante"></div>
            <div class="calc-zone">Total : <input type="number" step="0.01" id="in-courantes"> ‚Ç¨</div>
        </div>
        <div class="column" id="col-occas">
            <h3>Occas. (Exceptionnelles)</h3>
            <div class="drop-zone" data-category="occas"></div>
            <div class="calc-zone">Total : <input type="number" step="0.01" id="in-occas"> ‚Ç¨</div>
        </div>
    </div>

    <div class="context-box" style="margin-top: 20px;">
        <span style="font-weight: bold;">2. Calcul du Solde et √âtat du budget :</span>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px; flex-wrap: wrap; gap: 10px;">
            <span>Quel est le solde final de Lina ?</span>
            <input type="number" step="0.01" id="in-solde" style="width: 120px; padding: 10px; border: 2px solid var(--primary); border-radius: 8px;">
        </div>
        <div class="status-options">
            <label><input type="radio" name="status" value="excedentaire"> Exc√©dentaire</label>
            <label><input type="radio" name="status" value="equilibre"> √âquilibr√©</label>
            <label><input type="radio" name="status" value="deficitaire"> D√©ficitaire</label>
        </div>
    </div>

    <button class="btn-valider" onclick="analyser()">V√âRIFIER MES R√âPONSES</button>

    <div id="result-zone">
        <h2 id="final-score">Score : -- / 20</h2>
        <div class="synthesis-card">
            <div class="syn-row" id="syn-rec"><span>Total Recettes :</span> <span class="val">--</span></div>
            <div class="syn-row" id="syn-dep"><span>Total D√©penses :</span> <span class="val">--</span></div>
            <hr><div class="syn-row" id="syn-sol" style="color:#16a34a"><span>SOLDE FINAL :</span> <span class="val">--</span></div>
            <div class="syn-row" id="syn-status"><span>√âTAT DU BUDGET :</span> <span class="val">--</span></div>
        </div>
        <button class="btn-valider" style="background: #64748b;" onclick="location.reload()">üîÑ RECOMMENCER</button>
    </div>
</div>

<script>
    const items = [
        { id: 1, name: "Salaire", val: 4673.73, cat: "recette-travail" },
        { id: 2, name: "Cr√©dit immo", val: 1230.56, cat: "fixe" },
        { id: 3, name: "Assurance", val: 72.43, cat: "fixe" },
        { id: 4, name: "Abonnements", val: 55.12, cat: "fixe" },
        { id: 5, name: "Alimentation", val: 485.34, cat: "courante" },
        { id: 6, name: "Carburant", val: 120.50, cat: "courante" },
        { id: 7, name: "Hygi√®ne", val: 42.25, cat: "courante" },
        { id: 8, name: "Am√©nagement bureau", val: 850.45, cat: "occas" },
        { id: 9, name: "Restaurants", val: 210.00, cat: "occas" }
    ];

    let selectedItem = null;
    const bank = document.getElementById("item-bank");

    items.sort(() => Math.random() - 0.5).forEach(item => {
        let el = document.createElement("div");
        el.className = "draggable-item"; el.id = "i-" + item.id;
        el.innerHTML = `${item.name} (${item.val.toFixed(2)}‚Ç¨)`;
        el.onclick = (e) => {
            e.stopPropagation();
            if(selectedItem) selectedItem.classList.remove('selected');
            selectedItem = el; el.classList.add('selected');
        };
        bank.appendChild(el);
    });

    document.querySelectorAll('.drop-zone, #item-bank').forEach(zone => {
        zone.onclick = () => {
            if(selectedItem) {
                zone.appendChild(selectedItem);
                selectedItem.classList.remove('selected');
                selectedItem = null;
            }
        };
    });

    function analyser() {
        let score = 0;
        items.forEach(item => {
            let el = document.getElementById("i-" + item.id);
            let parent = el.parentElement;
            let parentCat = parent ? parent.dataset.category : null;
            if (parentCat === item.cat) { score += 1.5; el.style.borderColor = "#28a745"; }
            else { el.style.borderColor = "#dc3545"; }
        });

        const inR = parseFloat(document.getElementById("in-recettes").value) || 0;
        const inF = parseFloat(document.getElementById("in-fixes").value) || 0;
        const inC = parseFloat(document.getElementById("in-courantes").value) || 0;
        const inO = parseFloat(document.getElementById("in-occas").value) || 0;
        const inSolde = parseFloat(document.getElementById("in-solde").value) || 0;
        const statusEl = document.querySelector('input[name="status"]:checked');
        const inStatus = statusEl ? statusEl.value : null;

        const totalD = Number((inF + inC + inO).toFixed(2));

        if (Math.abs(inR - 4673.73) < 0.01) score += 2;
        if (Math.abs(inF - 1358.11) < 0.01) score += 1.5;
        if (Math.abs(inC - 648.09) < 0.01) score += 1.5;
        if (Math.abs(inO - 1060.45) < 0.01) score += 1;
        if (Math.abs(inSolde - 1607.08) < 0.01) score += 0.5;
        if (inStatus === "excedentaire") score += 0.5;

        document.getElementById("result-zone").style.display = "block";
        document.getElementById("final-score").innerText = `Score : ${Math.round(Math.min(20, score))} / 20`;

        document.querySelector("#syn-rec .val").innerHTML = `${inR.toFixed(2)}‚Ç¨ ${Math.abs(inR - 4673.73) < 0.01 ? '‚úÖ' : '‚ùå'}`;
        document.querySelector("#syn-dep .val").innerHTML = `${totalD.toFixed(2)}‚Ç¨ ${Math.abs(totalD - 3066.65) < 0.01 ? '‚úÖ' : '‚ùå'}`;
        document.querySelector("#syn-sol .val").innerHTML = `${inSolde.toFixed(2)}‚Ç¨ ${Math.abs(inSolde - 1607.08) < 0.01 ? '‚úÖ' : '‚ùå'}`;
        document.querySelector("#syn-status .val").innerHTML = `${inStatus === "excedentaire" ? "Exc√©dentaire ‚úÖ" : "Erreur ‚ùå"}`;

        window.scrollTo({ top: document.getElementById("result-zone").offsetTop, behavior: 'smooth' });
    }
</script>
</body>
</html>
