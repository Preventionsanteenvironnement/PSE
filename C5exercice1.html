<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>PSE — Compétence C5 — Exercice 1</title>
  <style>
:root{
  --bg:#0b1020;
  --card:#111a33;
  --card2:#0f1730;
  --text:#eaf0ff;
  --muted:#b8c4e6;
  --line:rgba(255,255,255,.12);
  --ok:#33d17a;
  --bad:#ff5c7a;
  --warn:#ffd166;
  --accent:#7aa2ff;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:linear-gradient(180deg,#080b17 0%,#0b1020 35%,#070a14 100%);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
a{color:inherit}
.wrap{max-width:980px;margin:0 auto;padding:18px 14px 40px}
.header{
  padding:16px 16px 14px;border:1px solid var(--line);border-radius:18px;
  background:radial-gradient(1200px 350px at 20% 0%, rgba(122,162,255,.22), transparent 55%),
             radial-gradient(900px 320px at 90% 10%, rgba(51,209,122,.15), transparent 55%),
             linear-gradient(180deg, rgba(17,26,51,.92), rgba(15,23,48,.92));
}
.h-top{display:flex;gap:12px;align-items:flex-start;justify-content:space-between;flex-wrap:wrap}
.badge{
  display:inline-flex;align-items:center;gap:8px;
  padding:7px 10px;border-radius:999px;border:1px solid var(--line);
  background:rgba(255,255,255,.04);color:var(--muted);font-size:12.5px
}
.badge b{color:var(--text)}
h1{margin:6px 0 6px;font-size:22px;letter-spacing:.2px}
.sub{margin:0;color:var(--muted);font-size:14px;line-height:1.35}
.grid{display:grid;grid-template-columns:1fr;gap:12px;margin-top:12px}
@media(min-width:840px){.grid{grid-template-columns:1.05fr .95fr}}
.card{
  border:1px solid var(--line);border-radius:18px;background:rgba(17,26,51,.68);
  padding:14px 14px 12px;box-shadow:0 10px 34px rgba(0,0,0,.25)
}
.card h2{margin:0 0 10px;font-size:16px}
.p{margin:0 0 10px;color:var(--muted);line-height:1.45;font-size:14px}
.steps{display:grid;gap:8px;margin:10px 0 0}
.step{
  display:flex;gap:10px;align-items:flex-start;padding:10px;border-radius:14px;border:1px solid var(--line);
  background:rgba(255,255,255,.03)
}
.num{
  width:28px;height:28px;border-radius:9px;border:1px solid var(--line);
  display:grid;place-items:center;color:var(--text);font-weight:700;background:rgba(122,162,255,.12)
}
.step b{display:block;margin-bottom:2px}
.kit{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
.pill{
  display:inline-flex;gap:6px;align-items:center;padding:7px 10px;border-radius:999px;
  border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--muted);font-size:13px
}
.pill span{color:var(--text);font-weight:650}
hr.sep{border:0;border-top:1px dashed rgba(255,255,255,.15);margin:12px 0}
.ex{margin-top:12px}
.ex-head{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;flex-wrap:wrap}
.ex h3{margin:0;font-size:16px}
.meta{color:var(--muted);font-size:13px}
.box{
  border:1px solid var(--line);border-radius:16px;background:rgba(15,23,48,.65);
  padding:12px;margin-top:10px
}
.q{margin:0 0 10px;font-size:14px;line-height:1.4}
.opts{display:grid;gap:8px}
.opt{
  display:flex;gap:10px;align-items:flex-start;padding:10px;border-radius:14px;border:1px solid var(--line);
  background:rgba(255,255,255,.03)
}
.opt input{margin-top:2px;transform:scale(1.05)}
.opt label{cursor:pointer;display:block}
.btnrow{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
button{
  appearance:none;border:1px solid var(--line);background:rgba(255,255,255,.06);
  color:var(--text);padding:10px 12px;border-radius:14px;font-weight:650;cursor:pointer;
  transition:transform .06s ease, background .15s ease
}
button:active{transform:scale(.98)}
button.primary{background:rgba(122,162,255,.18)}
button.good{background:rgba(51,209,122,.14)}
button.bad{background:rgba(255,92,122,.14)}
.small{font-size:13px;color:var(--muted)}
.feedback{
  margin-top:10px;padding:10px;border-radius:14px;border:1px solid var(--line);
  background:rgba(255,255,255,.03);color:var(--muted);font-size:13.5px;line-height:1.45
}
.feedback b{color:var(--text)}
.scorebar{
  display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;
  padding:10px 12px;border-radius:16px;border:1px solid var(--line);
  background:rgba(255,255,255,.03);margin-top:12px
}
.total{font-weight:800}
.progress{
  flex:1;min-width:170px;height:10px;border-radius:999px;border:1px solid var(--line);
  background:rgba(0,0,0,.25);overflow:hidden
}
.progress > div{height:100%;width:0%;background:linear-gradient(90deg, rgba(122,162,255,.8), rgba(51,209,122,.8))}
.bank{
  display:flex;flex-wrap:wrap;gap:8px;padding:10px;border-radius:14px;border:1px dashed rgba(255,255,255,.18);
  background:rgba(0,0,0,.18);min-height:54px
}
.token{
  user-select:none;touch-action:manipulation;
  display:inline-flex;align-items:center;gap:8px;
  padding:8px 10px;border-radius:999px;border:1px solid var(--line);
  background:rgba(255,255,255,.04);color:var(--text);font-size:13px;font-weight:650;
}
.token[data-selected="true"]{outline:2px solid rgba(122,162,255,.7);background:rgba(122,162,255,.14)}
.dropgrid{display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px}
@media(min-width:720px){.dropgrid{grid-template-columns:1fr 1fr}}
.drop{
  padding:10px;border-radius:14px;border:1px solid var(--line);
  background:rgba(255,255,255,.03);min-height:64px
}
.drop .cap{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:6px}
.drop .cap b{font-size:13px}
.drop .cap span{font-size:12px;color:var(--muted)}
.slot{display:flex;flex-wrap:wrap;gap:8px;min-height:38px}
.note{
  margin-top:10px;padding:10px;border-radius:14px;border:1px solid rgba(255,255,255,.14);
  background:rgba(255,209,102,.08);color:var(--muted);font-size:13.5px;line-height:1.45
}
.note b{color:var(--text)}
textarea, input[type="text"]{
  width:100%;border:1px solid var(--line);background:rgba(0,0,0,.18);
  color:var(--text);padding:10px;border-radius:14px;font-size:14px;line-height:1.4
}
textarea{min-height:92px;resize:vertical}
.footer{margin-top:14px;color:var(--muted);font-size:12.5px;line-height:1.45}

/* C5 extras */
.chips{display:flex;flex-wrap:wrap;gap:10px}
.chip{display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.05);cursor:pointer;user-select:none}
.chip input{accent-color:#7aa7ff}
textarea{width:100%;min-height:110px;border-radius:14px;border:1px solid rgba(255,255,255,.14);background:rgba(8,12,22,.55);color:var(--txt);padding:12px 12px;resize:vertical}
select{width:100%;border-radius:14px;border:1px solid rgba(255,255,255,.14);background:rgba(8,12,22,.55);color:var(--txt);padding:10px 12px}
.kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:.9em;padding:2px 6px;border-radius:8px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06)}
.builder{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:860px){.builder{grid-template-columns:1fr 1fr}}
.dropzone{border:1px dashed rgba(255,255,255,.22);border-radius:16px;padding:12px;background:rgba(255,255,255,.03)}
.tag{display:inline-flex;align-items:center;gap:8px;border-radius:999px;border:1px solid rgba(255,255,255,.16);padding:8px 10px;background:rgba(255,255,255,.05)}
.tag button{all:unset;cursor:pointer;opacity:.9}
.tag button:hover{opacity:1}
.tags{display:flex;flex-wrap:wrap;gap:8px}
.small{font-size:0.95rem;color:var(--muted)}
.card.locked{opacity:0.98}
.hint.ok{color:#9be18d}
</style>
</head>
<body>
<div class="wrap">
  <header class="header">
    <div class="brand">
      <div class="logo" aria-hidden="true">PSE</div>
      <div>
        <div class="title">Compétence C5</div>
        <div class="sub">Argumenter un choix</div>
      </div>
    </div>
    <div class="right">
      <div class="score" id="scoreBox" aria-live="polite">
        <div class="scoreLabel">Score</div>
        <div class="scoreVal"><span id="score">0</span> / <span id="maxScore">14</span></div>
      </div>
    </div>
  </header>

  <div class="hero">
    <h1>PSE — Compétence C5 — Exercice 1</h1>
    <p class="muted">Objectif : choisir une option et la défendre avec des arguments précis (faits, données, conséquences, prévention).</p>
    <div class="tip">
      <strong>Méthode C5</strong><br/>
      <span class="kbd">1</span> Je choisis <span class="kbd">2</span> Je donne 2 arguments <span class="kbd">3</span> Je conclus (donc…).
    </div>
    <ul class="bullets"><li>Un argument = un fait + un lien avec le choix.</li><li>2 arguments minimum (si possible : santé / sécurité / environnement).</li><li>Connecteurs : parce que, car, en effet, donc, ainsi, de plus…</li></ul>
  </div>

  <div class="grid">
    
<div class="card" id="ex1" data-ex="ex1" data-max="4">
  <div class="cardHead">
    <div>
      <div class="kicker">Exercice 1 • 4 points</div>
      <h2>Sommeil : je choisis une mesure et je la défends</h2>
      <div class="small">Choisis la mesure qui te correspond et explique pourquoi avec au moins 2 idées.</div>
    </div>
    <div class="pill">4 pts</div>
  </div>

  <div class="cardBody">
    
  <div class="q">
    <p><strong>Consigne</strong> : sélectionne <strong>1 mesure</strong> qui favorise ton sommeil, puis écris une justification.</p>
    <div class="chips">
      <label class="chip"><input type="radio" name="ex1_choice" value="diner"/> Dîner léger</label>
      <label class="chip"><input type="radio" name="ex1_choice" value="calme"/> Activité calme le soir</label>
      <label class="chip"><input type="radio" name="ex1_choice" value="regulier"/> Se coucher à heures régulières</label>
    </div>
    <p class="small">Aide : utilise un connecteur logique (parce que, car, donc, en effet…).</p>
    <textarea name="ex1_arg" placeholder="J’ai choisi… parce que… (2 arguments minimum)"></textarea>
  </div>

    <div class="actions">
      <button class="btn" data-action="check" data-target="ex1">Vérifier</button>
      <button class="btn ghost" data-action="reset" data-target="ex1">Réinitialiser</button>
      <span class="hint" data-out="ex1"></span>
    </div>

    <details class="corrige">
      <summary>Voir la correction</summary>
      <div class="corrigeBody">
        
  <p><strong>Exemples d’arguments attendus</strong> (au choix) :</p>
  <ul>
    <li><strong>Dîner léger</strong> : facilite la digestion ; évite les réveils nocturnes liés à l’inconfort.</li>
    <li><strong>Activité calme</strong> : baisse l’excitation ; favorise la relaxation et l’endormissement.</li>
    <li><strong>Heures régulières</strong> : stabilise l’horloge biologique ; améliore l’endormissement et la qualité du sommeil.</li>
  </ul>
  <p><strong>Structure possible</strong> : Je choisis… <span class="kbd">car</span> … <span class="kbd">De plus</span> … <span class="kbd">donc</span> …</p>

      </div>
    </details>
  </div>
</div>

<div class="card" id="ex2" data-ex="ex2" data-max="4">
  <div class="cardHead">
    <div>
      <div class="kicker">Exercice 2 • 4 points</div>
      <h2>Éco-citoyen : pourquoi acheter reconditionné ?</h2>
      <div class="small">Sélectionne les arguments les plus solides (2 à 3).</div>
    </div>
    <div class="pill">4 pts</div>
  </div>

  <div class="cardBody">
    
  <div class="q">
    <p><strong>Consigne</strong> : pour défendre l’achat d’un téléphone reconditionné, coche <strong>2 ou 3 arguments</strong> pertinents.</p>
    <div class="chips" role="group" aria-label="Arguments">
      <label class="chip"><input type="checkbox" name="ex2_args" value="reutiliser"/> Réutiliser des composants électroniques</label>
      <label class="chip"><input type="checkbox" name="ex2_args" value="limiter_extraction"/> Limiter l’extraction polluante des métaux rares</label>
      <label class="chip"><input type="checkbox" name="ex2_args" value="limiter_dechets"/> Limiter les déchets et leur traitement</label>
      <label class="chip"><input type="checkbox" name="ex2_args" value="mode"/> C’est plus à la mode</label>
      <label class="chip"><input type="checkbox" name="ex2_args" value="gaming"/> Il est meilleur pour les jeux vidéo</label>
      <label class="chip"><input type="checkbox" name="ex2_args" value="camera"/> La caméra est forcément meilleure</label>
    </div>
    <p class="small">Astuce : un argument C5 = un fait + un lien avec le choix.</p>
  </div>

    <div class="actions">
      <button class="btn" data-action="check" data-target="ex2">Vérifier</button>
      <button class="btn ghost" data-action="reset" data-target="ex2">Réinitialiser</button>
      <span class="hint" data-out="ex2"></span>
    </div>

    <details class="corrige">
      <summary>Voir la correction</summary>
      <div class="corrigeBody">
        
  <p><strong>Arguments solides</strong> :</p>
  <ul>
    <li>Réutiliser des composants (on prolonge la durée de vie du matériel).</li>
    <li>Limiter l’extraction de métaux rares (moins de pollution liée aux mines et à la fabrication).</li>
    <li>Limiter les déchets (moins d’équipements jetés, moins de traitement polluant).</li>
  </ul>
  <p><strong>Conclusion type</strong> : Je privilégie le reconditionné car il réduit la pression sur les ressources et les déchets.</p>

      </div>
    </details>
  </div>
</div>

<div class="card" id="ex3" data-ex="ex3" data-max="6">
  <div class="cardHead">
    <div>
      <div class="kicker">Exercice 3 • 6 points</div>
      <h2>Travail répétitif : je choisis la meilleure mesure et j’argumente</h2>
      <div class="small">Construis ton argument avec 2 faits de situation + 1 effet attendu + une conclusion.</div>
    </div>
    <div class="pill">6 pts</div>
  </div>

  <div class="cardBody">
    
  <div class="q">
    <p><strong>Situation</strong> : un salarié réalise un geste répétitif pendant de longues heures et adopte parfois une posture contraignante.</p>
    <p><strong>Consigne</strong> : choisis <strong>1 mesure</strong> de prévention, puis construis une argumentation.</p>
    <div class="chips">
      <label class="chip"><input type="radio" name="ex3_choice" value="auto"/> Automatiser une partie du geste / outils</label>
      <label class="chip"><input type="radio" name="ex3_choice" value="amenagement"/> Aménager le poste (hauteur, appuis, ergonomie)</label>
      <label class="chip"><input type="radio" name="ex3_choice" value="pauses"/> Augmenter les pauses / diminuer le temps d’exposition</label>
      <label class="chip"><input type="radio" name="ex3_choice" value="rotation"/> Varier les tâches (rotation)</label>
    </div>

    <div class="builder" data-builder="b_ex3" data-maxitems="6">
      <div class="dropzone">
        <p><strong>Étape 1</strong> : appuie sur <strong>2 faits</strong> qui décrivent la situation.</p>
        <div class="chips" data-pool>
          <button class="chip" type="button" data-add="Geste répétitif sur une longue durée">Geste répétitif sur une longue durée</button>
          <button class="chip" type="button" data-add="Posture penchée / bras en tension">Posture penchée / bras en tension</button>
          <button class="chip" type="button" data-add="Risque de douleur au poignet, main, épaule">Risque de douleur au poignet, main, épaule</button>
          <button class="chip" type="button" data-add="Fatigue + baisse de vigilance">Fatigue + baisse de vigilance</button>
        </div>
      </div>

      <div class="dropzone">
        <p><strong>Étape 2</strong> : appuie sur <strong>1 effet attendu</strong> (le lien avec ta mesure).</p>
        <div class="chips" data-pool>
          <button class="chip" type="button" data-add="Moins de gestes répétitifs = moins de contraintes">Moins de gestes répétitifs</button>
          <button class="chip" type="button" data-add="Posture plus neutre = moins de tensions musculaires">Posture plus neutre</button>
          <button class="chip" type="button" data-add="Moins d’exposition = moins de risque de TMS">Moins d’exposition</button>
        </div>
      </div>

      <div class="dropzone">
        <p><strong>Mon argument</strong> (les étiquettes choisies s’affichent ici) :</p>
        <div class="tags" data-tags></div>
        <input type="hidden" data-hidden name="ex3_tags" value="[]"/>
      </div>
    </div>

    <p class="small">Termine par une phrase de conclusion avec <span class="kbd">donc</span> / <span class="kbd">ainsi</span>.</p>
    <textarea name="ex3_concl" placeholder="Donc… (conclusion en 1–2 phrases)"></textarea>
  </div>

    <div class="actions">
      <button class="btn" data-action="check" data-target="ex3">Vérifier</button>
      <button class="btn ghost" data-action="reset" data-target="ex3">Réinitialiser</button>
      <span class="hint" data-out="ex3"></span>
    </div>

    <details class="corrige">
      <summary>Voir la correction</summary>
      <div class="corrigeBody">
        
  <p><strong>Exemple de réponse (mesure : aménagement du poste)</strong> :</p>
  <ul>
    <li><em>Faits</em> : geste répétitif + posture contraignante.</li>
    <li><em>Lien</em> : un poste réglé (hauteur, appuis, outils) réduit les tensions et les mouvements inutiles.</li>
    <li><em>Conclusion</em> : donc le risque de TMS diminue.</li>
  </ul>
  <p><strong>Autres mesures possibles</strong> : automatisation, rotation des tâches, pauses, formation gestes et postures.</p>

      </div>
    </details>
  </div>
</div>

  </div>

  <footer class="footer">
    <div class="muted">Astuce : sur smartphone, tout se fait par appui / sélection (pas besoin de glisser-déposer).</div>
  </footer>
</div>

<div class="toast" id="toast" role="status" aria-live="polite"></div>

<script>
(() => {
  const $ = (sel, root=document) => root.querySelector(sel);
  const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

  const KEY = "pse_c5_C5_exercice1_mobile_style_commun.html_v2";
  const maxScore = Number($("#maxScore").textContent.trim());
  let state = { score: 0, done: {}, builders: {} };

  function toast(msg) {
    const t = $("#toast");
    t.textContent = msg;
    t.classList.add("show");
    clearTimeout(toast._to);
    toast._to = setTimeout(() => t.classList.remove("show"), 2200);
  }

  function save() {
    try { localStorage.setItem(KEY, JSON.stringify(state)); } catch(e) {}
  }

  function load() {
    try {
      const raw = localStorage.getItem(KEY);
      if(!raw) return;
      const s = JSON.parse(raw);
      if(typeof s?.score === "number") state.score = s.score;
      if(s?.done && typeof s.done === "object") state.done = s.done;
      if(s?.builders && typeof s.builders === "object") state.builders = s.builders;
    } catch(e) {}
  }

  function setScore(val) {
    state.score = Math.max(0, Math.min(maxScore, val));
    $("#score").textContent = String(state.score);
    save();
  }

  function addScore(exId, pts) {
    if(state.done[exId]) return;
    state.done[exId] = true;
    setScore(state.score + pts);
  }

  function escapeHtml(str){
    return String(str).replace(/[&<>"']/g, s => ({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[s]));
  }

  // -------- builder chips (tap to add tags) ----------
  function initBuilders() {
    $$(".builder[data-builder]").forEach(box => {
      const bId = box.getAttribute("data-builder");
      const out = box.querySelector("[data-tags]");
      const hidden = box.querySelector("input[type=hidden][data-hidden]");
      const existing = state.builders[bId] || [];
      renderTags(existing);

      function renderTags(arr) {
        if(!out) return;
        out.innerHTML = "";
        arr.forEach((txt, idx) => {
          const span = document.createElement("span");
          span.className = "tag";
          span.innerHTML = `<span>${escapeHtml(txt)}</span><button aria-label="Retirer">✕</button>`;
          span.querySelector("button").addEventListener("click", () => {
            const next = arr.filter((_,i)=>i!==idx);
            state.builders[bId] = next;
            renderTags(next);
            sync(next);
          });
          out.appendChild(span);
        });
        sync(arr);
      }

      function sync(arr) {
        if(hidden) hidden.value = JSON.stringify(arr);
        save();
      }

      // wire all pools inside the builder
      box.querySelectorAll("[data-pool] [data-add]").forEach(btn => {
        btn.addEventListener("click", () => {
          const txt = btn.getAttribute("data-add");
          const arr = state.builders[bId] ? [...state.builders[bId]] : [];
          if(arr.includes(txt)) return;
          const maxItems = Number(box.getAttribute("data-maxitems")||"6");
          if(arr.length >= maxItems) {
            toast("Maximum atteint");
            return;
          }
          arr.push(txt);
          state.builders[bId] = arr;
          renderTags(arr);
          toast("Ajouté");
        });
      });
    });
  }

  // -------- checks ----------
  function wordCount(s) {
    return String(s||"").trim().split(/\s+/).filter(Boolean).length;
  }

  function lock(ex) {
    ex.classList.add("locked");
    $$("input, textarea, select, button[data-add]", ex).forEach(i => {
      if(i.matches("button[data-add]")) i.setAttribute("disabled","disabled");
      else i.disabled = true;
    });
  }

  function unlock(ex) {
    ex.classList.remove("locked");
    $$("input, textarea, select, button[data-add]", ex).forEach(i => {
      if(i.matches("button[data-add]")) i.removeAttribute("disabled");
      else i.disabled = false;
    });
  }

  function markOut(exId, msg, ok=false) {
    const el = $(`[data-out="${exId}"]`);
    if(!el) return;
    el.textContent = msg;
    el.classList.toggle("ok", !!ok);
  }

  function resetEx(exId) {
    const ex = document.getElementById(exId);
    if(!ex) return;
    $$("input[type=radio], input[type=checkbox]", ex).forEach(i => i.checked = false);
    $$("textarea", ex).forEach(t => t.value = "");
    $$("select", ex).forEach(s => s.selectedIndex = 0);

    $$(".builder[data-builder]", ex).forEach(box => {
      const bId = box.getAttribute("data-builder");
      state.builders[bId] = [];
      const out = box.querySelector("[data-tags]");
      if(out) out.innerHTML = "";
      const hidden = box.querySelector("input[type=hidden][data-hidden]");
      if(hidden) hidden.value = "[]";
    });

    unlock(ex);
    delete state.done[exId];
    markOut(exId, "");
    save();
    toast("Réinitialisé");
  }

  const checkers = {};

  function installCheckers(obj) {
    Object.assign(checkers, obj);
  }

  function initButtons() {
    $$("button[data-action]").forEach(btn => {
      btn.addEventListener("click", () => {
        const act = btn.getAttribute("data-action");
        const exId = btn.getAttribute("data-target");
        if(act === "reset") return resetEx(exId);
        if(act === "check") {
          const ex = document.getElementById(exId);
          if(!ex) return;
          const res = checkers[exId] ? checkers[exId](ex) : {pts:0,msg:"Aucune vérification disponible"};
          const max = Number(ex.getAttribute("data-max")||0);
          const pts = Math.max(0, Math.min(max, res.pts||0));
          markOut(exId, `${pts} / ${max} • ${res.msg||""}`, pts===max);
          if(pts>0) addScore(exId, pts);
          lock(ex);
          toast("Corrigé");
        }
      });
    });
  }

  function restoreDone() {
    setScore(state.score);
    Object.keys(state.done||{}).forEach(exId => {
      const ex = document.getElementById(exId);
      if(ex) lock(ex);
    });
  }

  // expose installer
  window.__INSTALL_CHECKERS__ = installCheckers;

  load();
  initBuilders();
  initButtons();
  restoreDone();
})();
</script>

<script>
// Checkers for this file
(() => {
  const install = window.__INSTALL_CHECKERS__;
  install({
    ex1: (ex) => {
      const chosen = ex.querySelector('input[name="ex1_choice"]:checked');
      const txt = ex.querySelector('textarea[name="ex1_arg"]')?.value || "";
      let pts = 0;
      if(chosen) pts += 2;
      const wc = txt.trim().split(/\s+/).filter(Boolean).length;
      if(wc >= 12 && /parce que|car|donc|afin|en effet|puisque/i.test(txt)) pts += 2;
      return {pts, msg: chosen ? (pts===4 ? "Choix + argumentation convaincante" : "Choix OK, argument à renforcer (connecteur + précision)") : "Choisis une option"};
    },
    ex2: (ex) => {
      const checks = Array.from(ex.querySelectorAll('input[type="checkbox"][name="ex2_args"]:checked')).map(i=>i.value);
      const must = new Set(['reutiliser', 'limiter_extraction', 'limiter_dechets']);
      let good = 0;
      checks.forEach(v => { if(must.has(v)) good++; });
      let pts = 0;
      if(good>=2 && checks.length<=3) pts = 4;
      else if(good>=1) pts = Math.max(1, 4-2);
      return {pts, msg: (pts=== 4) ? "Arguments pertinents" : "Sélectionne 2 ou 3 arguments vraiment liés au choix"};
    },
    ex3: (ex) => {
      const choice = ex.querySelector('input[name="ex3_choice"]:checked')?.value || "";
      const tags = (() => {
        const h = ex.querySelector('input[type="hidden"][data-hidden][name="ex3_tags"]');
        try { return JSON.parse(h?.value || "[]"); } catch(e) { return []; }
      })();
      const txt = ex.querySelector('textarea[name="ex3_concl"]')?.value || "";
      let pts = 0;
      if(choice) pts += 2;
      if(tags.length >= 2) pts += 2;
      if(wordCount(txt) >= 8 && /donc|ainsi|c'est pourquoi|par conséquent/i.test(txt)) pts += 2;
      return {pts, msg: pts===6 ? "Argumentation structurée (faits + effet + conclusion)" : "Ajoute 2 faits + une conclusion claire (donc…)"};

      function wordCount(s) {
        return String(s||"").trim().split(/\s+/).filter(Boolean).length;
      }
    },
  });
})();
</script>
</body>
</html>
