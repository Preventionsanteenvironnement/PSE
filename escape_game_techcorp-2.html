<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üö® Escape Game - Urgence √† TechCorp</title>
    <style>
        :root {
            --primary: #DC2626;
            --secondary: #7C2D12;
            --success: #16A34A;
            --warning: #EA580C;
            --danger: #DC2626;
            --info: #2563EB;
            --light: #F8FAFC;
            --dark: #0F172A;
            --emergency: linear-gradient(135deg, #DC2626 0%, #7F1D1D 100%);
            --tech: linear-gradient(135deg, #1E3A8A 0%, #1E40AF 100%);
            --shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--emergency);
            min-height: 100vh;
            color: var(--dark);
            line-height: 1.6;
            padding: 12px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        /* Header simple (non-sticky) */
        .header {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 16px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            display: none; /* Masqu√© pendant le jeu */
        }

        .header.game-mode {
            display: block;
            padding: 12px 20px;
        }

        .header.game-mode h1 {
            font-size: 1.3rem;
            margin-bottom: 0;
        }

        /* Page d'accueil */
        .welcome-screen {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            display: block;
        }

        .header h1 {
            background: var(--emergency);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .scenario {
            font-size: 1rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 16px;
            padding: 12px;
            background: rgba(220, 38, 38, 0.1);
            border-radius: 12px;
        }

        .module-info {
            background: rgba(248, 250, 252, 0.8);
            border-radius: 16px;
            padding: 16px;
            margin-top: 16px;
        }

        .module-info h3 {
            color: var(--primary);
            font-size: 1.1rem;
            margin-bottom: 12px;
            font-weight: 700;
        }

        .competence-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 8px;
        }

        .competence-badge {
            background: var(--tech);
            color: white;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        /* Dashboard */
        .dashboard {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            display: none; /* Masqu√© au d√©but */
        }

        .dashboard.show {
            display: block;
        }

        .progress-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .stat {
            text-align: center;
            padding: 16px;
            background: rgba(248, 250, 252, 0.8);
            border-radius: 16px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 800;
            background: var(--emergency);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #6B7280;
            font-weight: 500;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(229, 231, 235, 0.5);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--emergency);
            width: 0%;
            transition: width 1s ease;
            border-radius: 10px;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Page d'accueil */
        .welcome-screen {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            display: block;
        }

        .welcome-screen.hidden {
            display: none;
        }

        .start-btn {
            background: var(--emergency);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 20px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            margin-top: 30px;
            box-shadow: 0 6px 20px rgba(220, 38, 38, 0.4);
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(220, 38, 38, 0.6);
        }

        /* Timer */
        .timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(220, 38, 38, 0.95);
            color: white;
            padding: 12px 20px;
            border-radius: 16px;
            font-weight: 700;
            font-size: 1.2rem;
            box-shadow: var(--shadow);
            z-index: 1000;
            display: none; /* Masqu√© au d√©but */
        }

        .timer.show {
            display: block;
        }

        /* Missions */
        .mission-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 32px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            display: none;
            position: relative;
            overflow: hidden;
        }

        .mission-card.active {
            display: block;
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .mission-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--emergency);
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .mission-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .mission-number {
            background: var(--emergency);
            color: white;
            padding: 12px 24px;
            border-radius: 20px;
            font-weight: 800;
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4);
        }

        .mission-competence {
            background: var(--tech);
            color: white;
            padding: 8px 16px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .mission-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--primary);
        }

        .mission-description {
            font-size: 1.1rem;
            margin-bottom: 24px;
            padding: 20px;
            background: rgba(254, 226, 226, 0.8);
            border-radius: 16px;
            border-left: 4px solid var(--primary);
        }

        /* Contenu des missions */
        .pictogram-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .pictogram-card {
            background: white;
            border: 3px solid #E5E7EB;
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .pictogram-card:hover {
            border-color: var(--primary);
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(220, 38, 38, 0.2);
        }

        .pictogram-card.selected {
            border-color: var(--primary);
            background: rgba(220, 38, 38, 0.05);
            transform: translateY(-2px);
        }

        .pictogram-card.correct {
            border-color: var(--success);
            background: rgba(22, 163, 74, 0.1);
            animation: successPulse 0.6s ease;
        }

        .pictogram-card.incorrect {
            border-color: var(--danger);
            background: rgba(220, 38, 38, 0.1);
            animation: shake 0.6s ease;
        }

        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }

        .pictogram-image {
            width: 100%;
            height: 120px;
            object-fit: contain;
            margin-bottom: 12px;
            border-radius: 12px;
        }

        .pictogram-label {
            font-weight: 600;
            font-size: 1rem;
            color: var(--dark);
        }

        /* Zones de drop */
        .drop-zones {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }

        .drop-zone {
            background: rgba(248, 250, 252, 0.8);
            border: 2px dashed #CBD5E0;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .drop-zone.drag-over {
            border-color: var(--primary);
            background: rgba(220, 38, 38, 0.05);
        }

        .drop-zone.filled {
            border-color: var(--success);
            background: rgba(22, 163, 74, 0.1);
        }

        /* Options de choix */
        .choice-options {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 24px;
        }

        .choice-option {
            background: white;
            border: 3px solid #E5E7EB;
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            line-height: 1.5;
        }

        .choice-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(220, 38, 38, 0.15);
        }

        .choice-option.selected {
            border-color: var(--primary);
            background: rgba(220, 38, 38, 0.05);
        }

        /* Zone de texte */
        .text-input {
            width: 100%;
            padding: 20px;
            border: 3px solid #E5E7EB;
            border-radius: 16px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            min-height: 120px;
            transition: all 0.3s ease;
            background: white;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(220, 38, 38, 0.1);
        }

        /* Boutons */
        .action-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 24px;
        }

        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 16px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            min-width: 140px;
        }

        .btn-primary {
            background: var(--emergency);
            color: white;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(220, 38, 38, 0.5);
        }

        .btn-secondary {
            background: rgba(107, 114, 128, 0.1);
            border: 2px solid #6B7280;
            color: #6B7280;
        }

        .btn-secondary:hover {
            background: #6B7280;
            color: white;
        }

        .btn-help {
            background: var(--tech);
            color: white;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);
        }

        .btn-help:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.5);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Feedback */
        .feedback {
            margin-top: 24px;
            padding: 24px;
            border-radius: 20px;
            display: none;
            position: relative;
            overflow: hidden;
        }

        .feedback::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .feedback.show {
            display: block;
            animation: slideInDown 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .feedback.success {
            background: rgba(22, 163, 74, 0.1);
            border: 2px solid var(--success);
        }

        .feedback.success::before {
            background: var(--success);
        }

        .feedback.error {
            background: rgba(220, 38, 38, 0.1);
            border: 2px solid var(--danger);
        }

        .feedback.error::before {
            background: var(--danger);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .feedback-icon {
            font-size: 1.5rem;
            margin-right: 12px;
        }

        .feedback.success .feedback-header {
            color: var(--success);
        }

        .feedback.error .feedback-header {
            color: var(--danger);
        }

        .feedback-content {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.7);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
        }

        /* Syst√®me d'aide */
        .help-system {
            background: rgba(37, 99, 235, 0.1);
            border: 2px solid var(--info);
            border-radius: 20px;
            padding: 20px;
            margin-top: 16px;
            display: none;
        }

        .help-system.show {
            display: block;
            animation: slideInLeft 0.5s ease;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .help-title {
            color: var(--info);
            font-weight: 700;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .help-content {
            font-size: 1rem;
            line-height: 1.5;
        }

        /* √âcran final */
        .final-screen {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            text-align: center;
            display: none;
            box-shadow: var(--shadow);
        }

        .final-screen.show {
            display: block;
            animation: zoomIn 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .final-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 16px;
            background: var(--emergency);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .final-score {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 20px;
            background: var(--tech);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .achievement-badges {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin: 24px 0;
        }

        .badge {
            background: var(--emergency);
            color: white;
            padding: 8px 16px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3);
        }

        .badge.earned {
            background: var(--success);
            animation: badgeEarn 0.6s ease;
        }

        @keyframes badgeEarn {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .objectives-summary {
            background: rgba(248, 250, 252, 0.8);
            padding: 24px;
            border-radius: 16px;
            margin: 24px 0;
            text-align: left;
        }

        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: 8px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .mission-card {
                padding: 24px;
            }
            
            .mission-title {
                font-size: 1.3rem;
            }
            
            .pictogram-grid {
                grid-template-columns: 1fr;
            }
            
            .timer {
                position: static;
                margin-bottom: 16px;
                text-align: center;
            }
            
            .progress-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .competence-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.3rem;
            }
            
            .scenario {
                font-size: 0.9rem;
            }
            
            .mission-number {
                padding: 10px 20px;
                font-size: 1rem;
            }
            
            .final-score {
                font-size: 3rem;
            }
            
            .competence-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Page d'accueil -->
        <div class="welcome-screen" id="welcomeScreen">
            <h1>üö® ESCAPE GAME - Urgence √† TechCorp</h1>
            <div class="scenario">
                <strong>SITUATION :</strong> Stagiaire responsable s√©curit√©, vous devez g√©rer une s√©rie d'incidents simultan√©s chez TechCorp. 
                Objectif : √âvacuer tout le personnel en s√©curit√© en appliquant vos connaissances.
            </div>
            
            <div class="module-info">
                <h3>C.4 - L'assistance et le secours en milieu professionnel</h3>
                <p><strong>Objectif g√©n√©ral :</strong> Agir de mani√®re responsable face √† une situation d'urgence en milieu professionnel</p>
                
                <div class="competence-grid">
                    <div class="competence-badge">C1 - Traiter une information</div>
                    <div class="competence-badge">C2 - Appliquer une d√©marche d'analyse</div>
                    <div class="competence-badge">C3 - Expliquer un ph√©nom√®ne</div>
                    <div class="competence-badge">C4 - Proposer une solution</div>
                    <div class="competence-badge">C5 - Argumenter un choix</div>
                    <div class="competence-badge">C6 - Communiquer clairement</div>
                </div>
            </div>

            <button class="start-btn" onclick="startGame()">üöÄ COMMENCER L'ESCAPE GAME</button>
        </div>

        <!-- Header pendant le jeu (masqu√© au d√©but) -->
        <div class="header game-mode" id="gameHeader">
            <h1>üö® TechCorp - Mission en cours</h1>
        </div>

        <!-- Timer -->
        <div class="timer" id="timer">‚è∞ 30:00</div>

        <!-- Dashboard -->
        <div class="dashboard">
            <div class="progress-stats">
                <div class="stat">
                    <div class="stat-number" id="currentMission">1</div>
                    <div class="stat-label">Mission actuelle</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="completedMissions">0</div>
                    <div class="stat-label">Missions r√©ussies</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="totalScore">0</div>
                    <div class="stat-label">Score s√©curit√©</div>
                </div>
                <div class="stat">
                    <div class="stat-number">6</div>
                    <div class="stat-label">Missions totales</div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <!-- Mission 1: D√©codage des pictogrammes [C1] -->
        <div class="mission-card" data-mission="1">
            <div class="mission-header">
                <span class="mission-number">MISSION 1</span>
                <span class="mission-competence">C1</span>
            </div>
            <div class="mission-title">üîç D√âCODAGE DES PICTOGRAMMES</div>
            <div class="mission-description">
                <strong>SITUATION :</strong> Les √©crans de s√©curit√© de TechCorp affichent des erreurs ! 
                Vous devez identifier correctement chaque pictogramme pour r√©tablir le syst√®me d'alerte.
            </div>

            <div class="pictogram-grid">
                <div class="pictogram-card" data-pictogram="evacuation">
                    <img src="C4/images/evacuationsortie.jpg" alt="Pictogramme √©vacuation" class="pictogram-image">
                    <div class="pictogram-label">Pictogramme A</div>
                </div>
                <div class="pictogram-card" data-pictogram="alarme">
                    <img src="C4/images/alarme_incendie.jpg" alt="Pictogramme alarme" class="pictogram-image">
                    <div class="pictogram-label">Pictogramme B</div>
                </div>
                <div class="pictogram-card" data-pictogram="extincteur">
                    <img src="C4/images/extincteur.jpg" alt="Pictogramme extincteur" class="pictogram-image">
                    <div class="pictogram-label">Pictogramme C</div>
                </div>
                <div class="pictogram-card" data-pictogram="interdiction">
                    <img src="C4/images/interdiction_entrer.jpg" alt="Pictogramme interdiction" class="pictogram-image">
                    <div class="pictogram-label">Pictogramme D</div>
                </div>
            </div>

            <div class="drop-zones">
                <div class="drop-zone" data-target="evacuation">
                    <span>1. Sortie de secours / √âvacuation</span>
                </div>
                <div class="drop-zone" data-target="alarme">
                    <span>2. D√©clencheur d'alarme incendie</span>
                </div>
                <div class="drop-zone" data-target="extincteur">
                    <span>3. Emplacement extincteur</span>
                </div>
                <div class="drop-zone" data-target="interdiction">
                    <span>4. Acc√®s interdit / Zone dangereuse</span>
                </div>
            </div>

            <div class="help-system" id="help1">
                <div class="help-title">üí° Aide</div>
                <div class="help-content">
                    Les pictogrammes verts indiquent g√©n√©ralement les sorties et la s√©curit√©. 
                    Les pictogrammes rouges signalent soit le mat√©riel de lutte contre l'incendie, soit les interdictions.
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="checkMission1()" disabled id="validateBtn1">Valider</button>
                <button class="btn btn-help" onclick="showHelp(1)">Demander de l'aide</button>
                <button class="btn btn-secondary" onclick="skipMission()">Passer cette mission</button>
            </div>

            <div class="feedback" id="feedback1">
                <div class="feedback-header">
                    <span class="feedback-icon"></span>
                    <span class="feedback-title"></span>
                </div>
                <div class="feedback-content">
                    <div class="feedback-explanation">
                        <strong>Correction :</strong>
                        <p><strong>A (Vert)</strong> = Sortie de secours - Le bonhomme qui court indique l'√©vacuation</p>
                        <p><strong>B (Rouge)</strong> = Alarme incendie - La main sur le bouton d√©clenche l'alerte</p>
                        <p><strong>C (Rouge)</strong> = Extincteur - Mat√©riel de lutte contre l'incendie</p>
                        <p><strong>D (Rouge barr√©)</strong> = Interdiction d'acc√®s - Zone ou action interdite</p>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="nextMission()">Mission suivante üöÄ</button>
            </div>
        </div>

        <!-- Mission 2: Analyse des priorit√©s [C2] -->
        <div class="mission-card" data-mission="2">
            <div class="mission-header">
                <span class="mission-number">MISSION 2</span>
                <span class="mission-competence">C2</span>
            </div>
            <div class="mission-title">‚ö° ANALYSE DES PRIORIT√âS</div>
            <div class="mission-description">
                <strong>URGENCE :</strong> Plusieurs incidents se d√©clarent simultan√©ment ! 
                Appliquez votre d√©marche d'analyse pour prioriser les actions.
            </div>

            <div style="background: rgba(255, 255, 255, 0.8); padding: 20px; border-radius: 16px; margin-bottom: 24px;">
                <h4 style="margin-bottom: 16px; color: var(--primary);">üö® INCIDENTS D√âTECT√âS :</h4>
                <div style="display: grid; gap: 12px;">
                    <div style="padding: 12px; background: rgba(220, 38, 38, 0.1); border-radius: 8px;">
                        <strong>Zone A :</strong> Fum√©e d√©tect√©e dans l'atelier - 15 personnes pr√©sentes
                    </div>
                    <div style="padding: 12px; background: rgba(234, 88, 12, 0.1); border-radius: 8px;">
                        <strong>Zone B :</strong> Malaise d'un employ√© au bureau - 1 personne inconsciente
                    </div>
                    <div style="padding: 12px; background: rgba(220, 38, 38, 0.1); border-radius: 8px;">
                        <strong>Zone C :</strong> Alarme incendie d√©clench√©e - Signal sonore actif
                    </div>
                    <div style="padding: 12px; background: rgba(107, 114, 128, 0.1); border-radius: 8px;">
                        <strong>Zone D :</strong> Coupure √©lectrique partielle - √âclairage r√©duit
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 24px;">
                <h4 style="margin-bottom: 16px;">Classez ces actions par ordre de priorit√© (1 = le plus urgent) :</h4>
                <div class="choice-options" id="priorityChoices">
                    <div class="choice-option" data-priority="1">
                        <strong>Action 1 :</strong> D√©clencher l'√©vacuation g√©n√©rale de l'entreprise
                    </div>
                    <div class="choice-option" data-priority="2">
                        <strong>Action 2 :</strong> Appeler les secours (15 et 18)
                    </div>
                    <div class="choice-option" data-priority="3">
                        <strong>Action 3 :</strong> Secourir la personne en malaise
                    </div>
                    <div class="choice-option" data-priority="4">
                        <strong>Action 4 :</strong> V√©rifier la cause de la coupure √©lectrique
                    </div>
                </div>
            </div>

            <div class="help-system" id="help2">
                <div class="help-title">üí° Aide</div>
                <div class="help-content">
                    En urgence, priorisez toujours : 1) Alerte aux secours, 2) Sauvegarde du plus grand nombre, 3) Actions de secours sp√©cifiques, 4) Probl√®mes techniques.
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="checkMission2()" disabled id="validateBtn2">Valider</button>
                <button class="btn btn-help" onclick="showHelp(2)">Demander de l'aide</button>
                <button class="btn btn-secondary" onclick="skipMission()">Passer cette mission</button>
            </div>

            <div class="feedback" id="feedback2">
                <div class="feedback-header">
                    <span class="feedback-icon"></span>
                    <span class="feedback-title"></span>
                </div>
                <div class="feedback-content">
                    <div class="feedback-explanation">
                        <strong>Ordre de priorit√© correct :</strong>
                        <p><strong>1¬∞</strong> Appeler les secours (15 et 18) - L'alerte est toujours prioritaire</p>
                        <p><strong>2¬∞</strong> D√©clencher l'√©vacuation g√©n√©rale - Prot√©ger le maximum de personnes</p>
                        <p><strong>3¬∞</strong> Secourir la personne en malaise - Assistance imm√©diate</p>
                        <p><strong>4¬∞</strong> V√©rifier la coupure √©lectrique - Probl√®me technique</p>
                        <p><em>Principe : Alerter d'abord, prot√©ger ensuite, puis secourir.</em></p>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="nextMission()">Mission suivante üöÄ</button>
            </div>
        </div>

        <!-- Mission 3: Responsabilit√© l√©gale [C3] -->
        <div class="mission-card" data-mission="3">
            <div class="mission-header">
                <span class="mission-number">MISSION 3</span>
                <span class="mission-competence">C3</span>
            </div>
            <div class="mission-title">‚öñÔ∏è RESPONSABILIT√â L√âGALE</div>
            <div class="mission-description">
                <strong>CAS PRATIQUE :</strong> Marc, employ√© de TechCorp, assiste √† un accident de travail. 
                Il h√©site √† intervenir par peur des cons√©quences l√©gales. Expliquez-lui ses obligations.
            </div>

            <div style="background: rgba(255, 255, 255, 0.8); padding: 20px; border-radius: 16px; margin-bottom: 24px;">
                <p style="font-style: italic; margin-bottom: 16px;">
                    "Je vois que mon coll√®gue s'est bless√© avec une machine, mais je ne sais pas quoi faire. 
                    Si j'interviens et que √ßa se passe mal, est-ce que je risque des poursuites ? 
                    Et si je ne fais rien, qu'est-ce que je risque ?"
                </p>
                <p style="font-weight: 600; color: var(--primary);">- Marc, ouvrier chez TechCorp</p>
            </div>

            <div class="choice-options">
                <div class="choice-option" data-answer="a">
                    <strong>A)</strong> Marc n'est pas oblig√© d'intervenir car il n'est pas secouriste professionnel
                </div>
                <div class="choice-option" data-answer="b">
                    <strong>B)</strong> Marc doit porter secours "sans risque pour lui ou les tiers" sinon il risque jusqu'√† 5 ans de prison
                </div>
                <div class="choice-option" data-answer="c">
                    <strong>C)</strong> Marc peut choisir d'intervenir ou pas selon son courage personnel
                </div>
            </div>

            <div style="margin-top: 24px;">
                <h4 style="margin-bottom: 16px;">Quelle est la diff√©rence entre responsabilit√© civile et p√©nale ?</h4>
                <textarea class="text-input" placeholder="Expliquez la diff√©rence en quelques phrases..." id="responsabilityText"></textarea>
            </div>

            <div class="help-system" id="help3">
                <div class="help-title">üí° Aide</div>
                <div class="help-content">
                    L'obligation de porter secours est dans le Code p√©nal. La responsabilit√© civile concerne la r√©paration, la p√©nale concerne la punition par la soci√©t√©.
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="checkMission3()" disabled id="validateBtn3">Valider</button>
                <button class="btn btn-help" onclick="showHelp(3)">Demander de l'aide</button>
                <button class="btn btn-secondary" onclick="skipMission()">Passer cette mission</button>
            </div>

            <div class="feedback" id="feedback3">
                <div class="feedback-header">
                    <span class="feedback-icon"></span>
                    <span class="feedback-title"></span>
                </div>
                <div class="feedback-content">
                    <div class="feedback-explanation">
                        <strong>R√©ponse B correcte. Explications :</strong>
                        <p><strong>OBLIGATION L√âGALE :</strong> Marc DOIT porter secours (Code p√©nal art. 223-6)</p>
                        <p><strong>LIMITE :</strong> "Sans risque pour lui ou les tiers"</p>
                        <p><strong>SANCTIONS :</strong> Jusqu'√† 5 ans de prison + 75 000‚Ç¨ d'amende</p>
                        <hr style="margin: 16px 0;">
                        <p><strong>RESPONSABILIT√â CIVILE :</strong> R√©parer les dommages caus√©s √† la victime (‚Ç¨)</p>
                        <p><strong>RESPONSABILIT√â P√âNALE :</strong> Punition par la soci√©t√© (prison + amende)</p>
                        <p><em>On peut √™tre condamn√© sur les deux plans simultan√©ment.</em></p>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="nextMission()">Mission suivante üöÄ</button>
            </div>
        </div>

        <!-- Mission 4: Solutions d'√©quipement [C4] -->
        <div class="mission-card" data-mission="4">
            <div class="mission-header">
                <span class="mission-number">MISSION 4</span>
                <span class="mission-competence">C4</span>
            </div>
            <div class="mission-title">üõ†Ô∏è √âQUIPEMENT DE S√âCURIT√â</div>
            <div class="mission-description">
                <strong>MISSION :</strong> √âquipez 3 zones de TechCorp avec les dispositifs de s√©curit√© adapt√©s. 
                Utilisez les pictogrammes pour proposer des solutions efficaces.
            </div>

            <div style="display: grid; gap: 20px; margin-bottom: 24px;">
                <!-- Zone 1: Atelier bruyant -->
                <div style="background: rgba(255, 255, 255, 0.8); padding: 20px; border-radius: 16px;">
                    <h4 style="color: var(--primary); margin-bottom: 12px;">üè≠ ZONE 1 - Atelier de production (tr√®s bruyant)</h4>
                    <p>25 ouvriers avec casques anti-bruit obligatoires. Machines lourdes, risque d'incendie.</p>
                    <div style="margin-top: 12px;">
                        <label><strong>√âquipements n√©cessaires :</strong></label>
                        <div class="pictogram-grid" style="grid-template-columns: repeat(2, 1fr); margin-top: 12px;">
                            <div class="pictogram-card equipment-choice" data-zone="zone1" data-equipment="visual-alarm">
                                <div style="background: #FEE2E2; padding: 20px; border-radius: 12px;">
                                    <strong>Alarme visuelle</strong><br>
                                    <small>Flashs lumineux puissants</small>
                                </div>
                            </div>
                            <div class="pictogram-card equipment-choice" data-zone="zone1" data-equipment="sound-only">
                                <div style="background: #FEF3C7; padding: 20px; border-radius: 12px;">
                                    <strong>Alarme sonore seule</strong><br>
                                    <small>Signal audio uniquement</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Zone 2: Bureau -->
                <div style="background: rgba(255, 255, 255, 0.8); padding: 20px; border-radius: 16px;">
                    <h4 style="color: var(--primary); margin-bottom: 12px;">üè¢ ZONE 2 - Bureaux administratifs</h4>
                    <p>50 employ√©s, dont 3 personnes malentendantes. Open-space avec cloisons.</p>
                    <div style="margin-top: 12px;">
                        <label><strong>Syst√®me d'alerte optimal :</strong></label>
                        <div class="pictogram-grid" style="grid-template-columns: repeat(2, 1fr); margin-top: 12px;">
                            <div class="pictogram-card equipment-choice" data-zone="zone2" data-equipment="mixed-system">
                                <div style="background: #DCFCE7; padding: 20px; border-radius: 12px;">
                                    <strong>Syst√®me mixte</strong><br>
                                    <small>Sonore + visuel + vibrant</small>
                                </div>
                            </div>
                            <div class="pictogram-card equipment-choice" data-zone="zone2" data-equipment="sound-only">
                                <div style="background: #FEF3C7; padding: 20px; border-radius: 12px;">
                                    <strong>Alarme sonore seule</strong><br>
                                    <small>Plus simple √† installer</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Zone 3: Stockage -->
                <div style="background: rgba(255, 255, 255, 0.8); padding: 20px; border-radius: 16px;">
                    <h4 style="color: var(--primary); margin-bottom: 12px;">üì¶ ZONE 3 - Entrep√¥t de stockage</h4>
                    <p>Zone de stockage de produits chimiques. Acc√®s restreint, personnel qualifi√© uniquement.</p>
                    <div style="margin-top: 12px;">
                        <label><strong>Signalisation requise :</strong></label>
                        <div class="pictogram-grid" style="grid-template-columns: repeat(2, 1fr); margin-top: 12px;">
                            <div class="pictogram-card equipment-choice" data-zone="zone3" data-equipment="restriction-signs">
                                <img src="C4/images/interdiction_entrer.jpg" style="width: 60px; height: 60px; object-fit: contain;" alt="Interdiction">
                                <div><strong>Panneaux d'interdiction</strong><br>
                                <small>Acc√®s restreint</small></div>
                            </div>
                            <div class="pictogram-card equipment-choice" data-zone="zone3" data-equipment="free-access">
                                <img src="C4/images/evacuationsortie.jpg" style="width: 60px; height: 60px; object-fit: contain;" alt="Libre acc√®s">
                                <div><strong>Acc√®s libre</strong><br>
                                <small>Pas de restriction</small></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="help-system" id="help4">
                <div class="help-title">üí° Aide</div>
                <div class="help-content">
                    Adaptez toujours les √©quipements aux contraintes : environnement bruyant = alarmes visuelles, 
                    personnes malentendantes = syst√®mes mixtes, zones dangereuses = restrictions d'acc√®s.
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="checkMission4()" disabled id="validateBtn4">Valider</button>
                <button class="btn btn-help" onclick="showHelp(4)">Demander de l'aide</button>
                <button class="btn btn-secondary" onclick="skipMission()">Passer cette mission</button>
            </div>

            <div class="feedback" id="feedback4">
                <div class="feedback-header">
                    <span class="feedback-icon"></span>
                    <span class="feedback-title"></span>
                </div>
                <div class="feedback-content">
                    <div class="feedback-explanation">
                        <strong>Solutions optimales :</strong>
                        <p><strong>Zone 1 (Atelier bruyant) :</strong> Alarme visuelle - Les casques anti-bruit emp√™chent d'entendre</p>
                        <p><strong>Zone 2 (Bureaux) :</strong> Syst√®me mixte - Inclusif pour les personnes malentendantes</p>
                        <p><strong>Zone 3 (Stockage chimique) :</strong> Panneaux d'interdiction - Acc√®s restreint obligatoire</p>
                        <p><em>Principe : Une bonne solution s'adapte aux contraintes existantes.</em></p>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="nextMission()">Mission suivante üöÄ</button>
            </div>
        </div>

        <!-- Mission 5: Choix d'√©vacuation [C5] -->
        <div class="mission-card" data-mission="5">
            <div class="mission-header">
                <span class="mission-number">MISSION 5</span>
                <span class="mission-competence">C5</span>
            </div>
            <div class="mission-title">üö™ STRAT√âGIE D'√âVACUATION</div>
            <div class="mission-description">
                <strong>SITUATION CRITIQUE :</strong> L'incendie s'√©tend ! Vous devez choisir la meilleure voie d'√©vacuation 
                pour les 90 employ√©s de TechCorp. Argumentez votre d√©cision.
            </div>

            <div style="background: rgba(255, 255, 255, 0.8); padding: 20px; border-radius: 16px; margin-bottom: 24px;">
                <h4 style="margin-bottom: 16px; color: var(--primary);">üìä CONTRAINTES ACTUELLES :</h4>
                <ul style="list-style: none; padding: 0;">
                    <li style="padding: 8px 0; border-bottom: 1px solid #E5E7EB;">üî• Foyer d'incendie : Zone Est</li>
                    <li style="padding: 8px 0; border-bottom: 1px solid #E5E7EB;">üë• Effectif √† √©vacuer : 90 personnes</li>
                    <li style="padding: 8px 0; border-bottom: 1px solid #E5E7EB;">‚ôø Personnel √† mobilit√© r√©duite : 2 personnes</li>
                    <li style="padding: 8px 0; border-bottom: 1px solid #E5E7EB;">üí® Vent : Direction Ouest (pousse la fum√©e)</li>
                    <li style="padding: 8px 0;">‚è∞ Temps estim√© avant propagation : 8 minutes</li>
                </ul>
            </div>

            <div class="choice-options">
                <div class="choice-option route-choice" data-route="east">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>üö™ SORTIE EST</strong><br>
                            <small>Sortie principale - Large - Proche parking</small>
                        </div>
                        <img src="C4/images/interdiction_entrer.jpg" style="width: 40px; height: 40px; object-fit: contain;" alt="Danger">
                    </div>
                    <div style="margin-top: 12px; font-size: 0.9rem; color: #6B7280;">
                        <strong>Avantages :</strong> Sortie la plus large, acc√®s direct parking<br>
                        <strong>Inconv√©nients :</strong> Proche du foyer d'incendie, fum√©es toxiques
                    </div>
                </div>

                <div class="choice-option route-choice" data-route="west">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>üö™ SORTIE OUEST</strong><br>
                            <small>Sortie de secours - √âloign√©e du feu</small>
                        </div>
                        <img src="C4/images/evacuationsortie.jpg" style="width: 40px; height: 40px; object-fit: contain;" alt="S√©curis√©">
                    </div>
                    <div style="margin-top: 12px; font-size: 0.9rem; color: #6B7280;">
                        <strong>Avantages :</strong> √âloign√©e du feu, vent favorable, air plus pur<br>
                        <strong>Inconv√©nients :</strong> Plus √©troite, passage plus long
                    </div>
                </div>

                <div class="choice-option route-choice" data-route="split">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>‚ÜóÔ∏è √âVACUATION MIXTE</strong><br>
                            <small>Diviser les groupes sur 2 sorties</small>
                        </div>
                        <div>ü§î</div>
                    </div>
                    <div style="margin-top: 12px; font-size: 0.9rem; color: #6B7280;">
                        <strong>Avantages :</strong> R√©partit la charge, plus rapide<br>
                        <strong>Inconv√©nients :</strong> Complexe √† organiser, risque de confusion
                    </div>
                </div>
            </div>

            <div style="margin-top: 24px;">
                <h4 style="margin-bottom: 16px;">Justifiez votre choix avec 2 arguments solides :</h4>
                <textarea class="text-input" placeholder="Argumentez votre d√©cision strat√©gique..." id="evacuationJustification"></textarea>
            </div>

            <div class="help-system" id="help5">
                <div class="help-title">üí° Aide</div>
                <div class="help-content">
                    En cas d'incendie, privil√©giez toujours la s√©curit√© des personnes sur la rapidit√©. 
                    √âvitez les zones enfum√©es m√™me si le trajet est plus long.
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="checkMission5()" disabled id="validateBtn5">Valider</button>
                <button class="btn btn-help" onclick="showHelp(5)">Demander de l'aide</button>
                <button class="btn btn-secondary" onclick="skipMission()">Passer cette mission</button>
            </div>

            <div class="feedback" id="feedback5">
                <div class="feedback-header">
                    <span class="feedback-icon"></span>
                    <span class="feedback-title"></span>
                </div>
                <div class="feedback-content">
                    <div class="feedback-explanation">
                        <strong>Meilleur choix : SORTIE OUEST</strong>
                        <p><strong>Argument 1 - S√âCURIT√â :</strong> √âloign√©e du foyer d'incendie = moins de risque d'intoxication</p>
                        <p><strong>Argument 2 - CONDITIONS :</strong> Vent pousse les fum√©es vers l'Est = air plus respirable √† l'Ouest</p>
                        <p><strong>Principe :</strong> En urgence, la s√©curit√© prime sur la rapidit√©. Mieux vaut un trajet plus long mais s√ªr.</p>
                        <p><em>Les 2 personnes √† mobilit√© r√©duite seront assist√©es par le personnel form√©.</em></p>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="nextMission()">Mission suivante üöÄ</button>
            </div>
        </div>

        <!-- Mission 6: Message d'alerte [C6] -->
        <div class="mission-card" data-mission="6">
            <div class="mission-header">
                <span class="mission-number">MISSION 6</span>
                <span class="mission-competence">C6</span>
            </div>
            <div class="mission-title">üìû MESSAGE D'ALERTE FINAL</div>
            <div class="mission-description">
                <strong>URGENCE MAXIMALE :</strong> Vous devez maintenant contacter les secours pour signaler l'accident initial 
                qui a d√©clench√© l'incendie. R√©digez un message d'alerte professionnel et complet.
            </div>

            <div style="background: rgba(220, 38, 38, 0.1); padding: 20px; border-radius: 16px; margin-bottom: 24px; border-left: 4px solid var(--primary);">
                <h4 style="margin-bottom: 16px;">üö® SITUATION √Ä SIGNALER :</h4>
                <p><strong>Accident initial :</strong> Ouvrier bless√© par machine d√©faillante (main coinc√©e)</p>
                <p><strong>Cons√©quence :</strong> Incendie d√©clar√© par court-circuit de la machine</p>
                <p><strong>√âtat actuel :</strong> √âvacuation en cours - Bless√© conscient mais saignements importants</p>
                <p><strong>Localisation :</strong> TechCorp, 45 rue de l'Industrie, 69007 Lyon - Atelier Zone A</p>
            </div>

            <div style="margin-bottom: 24px;">
                <h4 style="margin-bottom: 16px;">R√©digez votre message d'alerte complet :</h4>
                <div style="background: rgba(248, 250, 252, 0.8); padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                    <strong>üí° Rappel - 6 √©l√©ments obligatoires :</strong>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 8px; font-size: 0.9rem;">
                        <div>1. Identit√© + num√©ro rappel</div>
                        <div>2. Lieu pr√©cis</div>
                        <div>3. Nature de l'accident</div>
                        <div>4. Nombre de victimes</div>
                        <div>5. √âtat des victimes</div>
                        <div>6. Actions d√©j√† entreprises</div>
                    </div>
                </div>
                <textarea class="text-input" placeholder="Bonjour, je suis... (R√©digez votre message complet)" id="alertMessage" style="min-height: 150px;"></textarea>
            </div>

            <div class="help-system" id="help6">
                <div class="help-title">üí° Aide</div>
                <div class="help-content">
                    Structurez votre message : Identifiez-vous d'abord, donnez le lieu pr√©cis, d√©crivez la situation, 
                    l'√©tat des victimes et ce que vous avez d√©j√† fait. Restez calme et pr√©cis.
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="checkMission6()" disabled id="validateBtn6">Valider</button>
                <button class="btn btn-help" onclick="showHelp(6)">Demander de l'aide</button>
                <button class="btn btn-secondary" onclick="skipMission()">Passer cette mission</button>
            </div>

            <div class="feedback" id="feedback6">
                <div class="feedback-header">
                    <span class="feedback-icon"></span>
                    <span class="feedback-title"></span>
                </div>
                <div class="feedback-content">
                    <div class="feedback-explanation">
                        <strong>Message mod√®le :</strong>
                        <div style="background: rgba(255, 255, 255, 0.8); padding: 16px; border-radius: 12px; font-style: italic; margin: 16px 0;">
                            "Bonjour, je suis Sarah Martin, responsable s√©curit√©, je vous appelle du 06.12.34.56.78. 
                            Il y a eu un accident du travail avec incendie chez TechCorp, 45 rue de l'Industrie √† Lyon 7√®me, atelier Zone A.
                            Un ouvrier s'est bless√© la main avec une machine, ce qui a provoqu√© un court-circuit et un incendie. 
                            Il y a une victime consciente avec des saignements importants √† la main. 
                            Nous avons d√©clench√© l'√©vacuation et mis un pansement compressif sur la plaie. J'attends vos instructions."
                        </div>
                        <p><strong>‚úÖ Parfait :</strong> Tous les √©l√©ments sont pr√©sents et le message est professionnel.</p>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="showFinalResults()">Terminer la mission üéØ</button>
            </div>
        </div>

        <!-- √âcran final -->
        <div class="final-screen" id="finalResults">
            <div class="final-title">üéâ MISSION ACCOMPLIE</div>
            <div style="font-size: 1.5rem; margin-bottom: 16px; color: var(--success);">TechCorp est en s√©curit√© !</div>
            <div class="final-score" id="finalScore">85/100</div>
            
            <div class="achievement-badges">
                <div class="badge earned">Ma√Ætre des Pictogrammes</div>
                <div class="badge earned">Analyste S√©curit√©</div>
                <div class="badge earned">Expert L√©gal</div>
                <div class="badge earned">Strat√®ge √âquipement</div>
                <div class="badge earned">Tacticien √âvacuation</div>
                <div class="badge earned">Communicateur d'Urgence</div>
            </div>

            <div class="objectives-summary">
                <h3 style="color: var(--primary); margin-bottom: 16px;">Objectif p√©dagogique atteint</h3>
                <p style="font-size: 1.1rem; line-height: 1.6; margin-bottom: 16px;">
                    <strong>Capacit√© d√©velopp√©e :</strong> "Agir de mani√®re responsable face √† une situation d'urgence en milieu professionnel"
                </p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-top: 20px;">
                    <div style="background: rgba(22, 163, 74, 0.1); padding: 16px; border-radius: 12px;">
                        <strong>C1 ‚úì</strong> Traitement des informations de s√©curit√©
                    </div>
                    <div style="background: rgba(22, 163, 74, 0.1); padding: 16px; border-radius: 12px;">
                        <strong>C2 ‚úì</strong> Application de d√©marches d'analyse
                    </div>
                    <div style="background: rgba(22, 163, 74, 0.1); padding: 16px; border-radius: 12px;">
                        <strong>C3 ‚úì</strong> Explication du cadre r√©glementaire
                    </div>
                    <div style="background: rgba(22, 163, 74, 0.1); padding: 16px; border-radius: 12px;">
                        <strong>C4 ‚úì</strong> Proposition de solutions adapt√©es
                    </div>
                    <div style="background: rgba(22, 163, 74, 0.1); padding: 16px; border-radius: 12px;">
                        <strong>C5 ‚úì</strong> Argumentation des choix strat√©giques
                    </div>
                    <div style="background: rgba(22, 163, 74, 0.1); padding: 16px; border-radius: 12px;">
                        <strong>C6 ‚úì</strong> Communication professionnelle
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="restartGame()">üîÑ Recommencer l'escape game</button>
                <a href="https://mapse.fr" class="btn btn-help" target="_blank">üìö Continuer sur mapse.fr</a>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let currentMission = 1;
        let completedMissions = 0;
        let totalScore = 0;
        let startTime = Date.now();
        let timerInterval;
        let gameData = {
            mission1: { attempts: 0, completed: false, score: 0 },
            mission2: { attempts: 0, completed: false, score: 0 },
            mission3: { attempts: 0, completed: false, score: 0 },
            mission4: { attempts: 0, completed: false, score: 0 },
            mission5: { attempts: 0, completed: false, score: 0 },
            mission6: { attempts: 0, completed: false, score: 0 }
        };

        // R√©ponses correctes
        const correctAnswers = {
            mission1: ['evacuation', 'alarme', 'extincteur', 'interdiction'],
            mission2: [2, 1, 3, 4], // Ordre de priorit√© correct
            mission3: { choice: 'b', keywords: ['civile', 'p√©nale', 'r√©paration', 'punition', 'soci√©t√©'] },
            mission4: { zone1: 'visual-alarm', zone2: 'mixed-system', zone3: 'restriction-signs' },
            mission5: { route: 'west', keywords: ['s√©curit√©', '√©loign√©e', 'fum√©e', 'vent', 'ouest'] },
            mission6: { keywords: ['identit√©', 'lieu', 'nature', 'nombre', '√©tat', 'actions', 'Sarah', 'TechCorp', 'Lyon'] }
        };

        // Initialisation
        function initGame() {
            // Ne pas d√©marrer automatiquement - attendre le clic sur "Commencer"
            updateDashboard();
        }

        // D√©marrer le jeu (appel√© par le bouton)
        function startGame() {
            // Masquer la page d'accueil
            document.getElementById('welcomeScreen').classList.add('hidden');
            
            // Afficher les √©l√©ments du jeu
            document.getElementById('gameHeader').style.display = 'block';
            document.querySelector('.dashboard').classList.add('show');
            document.getElementById('timer').classList.add('show');
            
            // Afficher la premi√®re mission
            document.querySelector('[data-mission="1"]').classList.add('active');
            
            // D√©marrer le timer et initialiser la mission 1
            startTimer();
            initMission1();
        }

        // Timer
        function startTimer() {
            const duration = 30 * 60; // 30 minutes en secondes
            let timeLeft = duration;
            
            timerInterval = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('timer').textContent = `‚è∞ ${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    showTimeUp();
                }
                timeLeft--;
            }, 1000);
        }

        function showTimeUp() {
            alert('‚è∞ Temps √©coul√© ! Mais vous pouvez continuer √† votre rythme.');
        }

        // Dashboard
        function updateDashboard() {
            document.getElementById('currentMission').textContent = currentMission;
            document.getElementById('completedMissions').textContent = completedMissions;
            document.getElementById('totalScore').textContent = totalScore;
            
            const progress = (completedMissions / 6) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Mission 1: Pictogrammes
        let mission1Selections = {};

        function initMission1() {
            const pictogramCards = document.querySelectorAll('[data-mission="1"] .pictogram-card');
            const dropZones = document.querySelectorAll('[data-mission="1"] .drop-zone');
            
            pictogramCards.forEach(card => {
                card.addEventListener('click', () => selectPictogram(card));
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('click', () => assignPictogram(zone));
            });
        }

        let selectedPictogram = null;

        function selectPictogram(card) {
            // D√©s√©lectionner les autres
            document.querySelectorAll('[data-mission="1"] .pictogram-card').forEach(c => {
                c.classList.remove('selected');
            });
            
            card.classList.add('selected');
            selectedPictogram = card.dataset.pictogram;
            
            // Activer les zones de drop
            document.querySelectorAll('[data-mission="1"] .drop-zone').forEach(zone => {
                zone.style.cursor = 'pointer';
                zone.style.opacity = '1';
            });
        }

        function assignPictogram(zone) {
            if (!selectedPictogram) return;
            
            const target = zone.dataset.target;
            mission1Selections[target] = selectedPictogram;
            
            zone.classList.add('filled');
            zone.innerHTML = `<strong>‚úì ${selectedPictogram.toUpperCase()}</strong>`;
            
            // V√©rifier si toutes les zones sont remplies
            if (Object.keys(mission1Selections).length === 4) {
                document.getElementById('validateBtn1').disabled = false;
            }
            
            // R√©initialiser la s√©lection
            selectedPictogram = null;
            document.querySelectorAll('[data-mission="1"] .pictogram-card').forEach(c => {
                c.classList.remove('selected');
            });
        }

        function checkMission1() {
            gameData.mission1.attempts++;
            let correct = 0;
            
            for (const [zone, selection] of Object.entries(mission1Selections)) {
                if (selection === zone) {
                    correct++;
                }
            }
            
            const isSuccess = correct === 4;
            gameData.mission1.completed = isSuccess;
            gameData.mission1.score = isSuccess ? 20 : Math.max(0, 20 - (gameData.mission1.attempts * 5));
            
            if (isSuccess) {
                totalScore += gameData.mission1.score;
                completedMissions++;
            }
            
            showFeedback(1, isSuccess);
            updateDashboard();
        }

        // Mission 2: Priorit√©s
        let priorityOrder = [];

        function initMission2() {
            const choices = document.querySelectorAll('[data-mission="2"] .choice-option');
            choices.forEach((choice, index) => {
                choice.addEventListener('click', () => setPriority(choice, index + 1));
            });
        }

        function setPriority(choice, number) {
            const priority = choice.dataset.priority;
            
            if (priorityOrder.includes(number)) {
                // Retirer la s√©lection pr√©c√©dente
                const prevIndex = priorityOrder.indexOf(number);
                priorityOrder.splice(prevIndex, 1);
                document.querySelector(`[data-priority="${number}"]`).classList.remove('selected');
                document.querySelector(`[data-priority="${number}"]`).style.order = '';
            }
            
            priorityOrder.push(parseInt(priority));
            choice.classList.add('selected');
            choice.style.order = priorityOrder.length;
            choice.style.background = `rgba(220, 38, 38, ${0.1 * priorityOrder.length})`;
            
            if (priorityOrder.length === 4) {
                document.getElementById('validateBtn2').disabled = false;
            }
        }

        function checkMission2() {
            gameData.mission2.attempts++;
            const correct = JSON.stringify(priorityOrder.sort((a, b) => a - b)) === JSON.stringify(correctAnswers.mission2);
            
            gameData.mission2.completed = correct;
            gameData.mission2.score = correct ? 15 : Math.max(0, 15 - (gameData.mission2.attempts * 3));
            
            if (correct) {
                totalScore += gameData.mission2.score;
                completedMissions++;
            }
            
            showFeedback(2, correct);
            updateDashboard();
        }

        // Mission 3: Responsabilit√©
        let selectedChoice = null;

        function initMission3() {
            const choices = document.querySelectorAll('[data-mission="3"] .choice-option');
            const textArea = document.getElementById('responsabilityText');
            
            choices.forEach(choice => {
                choice.addEventListener('click', () => {
                    choices.forEach(c => c.classList.remove('selected'));
                    choice.classList.add('selected');
                    selectedChoice = choice.dataset.answer;
                    checkMission3Inputs();
                });
            });
            
            textArea.addEventListener('input', checkMission3Inputs);
        }

        function checkMission3Inputs() {
            const textArea = document.getElementById('responsabilityText');
            if (selectedChoice && textArea.value.trim().length > 10) {
                document.getElementById('validateBtn3').disabled = false;
            }
        }

        function checkMission3() {
            gameData.mission3.attempts++;
            const textAnswer = document.getElementById('responsabilityText').value.toLowerCase();
            
            const choiceCorrect = selectedChoice === correctAnswers.mission3.choice;
            let keywordScore = 0;
            
            correctAnswers.mission3.keywords.forEach(keyword => {
                if (textAnswer.includes(keyword)) keywordScore++;
            });
            
            const textCorrect = keywordScore >= 3;
            const isSuccess = choiceCorrect && textCorrect;
            
            gameData.mission3.completed = isSuccess;
            gameData.mission3.score = isSuccess ? 15 : Math.max(0, 15 - (gameData.mission3.attempts * 3));
            
            if (isSuccess) {
                totalScore += gameData.mission3.score;
                completedMissions++;
            }
            
            showFeedback(3, isSuccess);
            updateDashboard();
        }

        // Mission 4: √âquipement
        let equipmentChoices = {};

        function initMission4() {
            const equipmentCards = document.querySelectorAll('[data-mission="4"] .equipment-choice');
            
            equipmentCards.forEach(card => {
                card.addEventListener('click', () => {
                    const zone = card.dataset.zone;
                    const equipment = card.dataset.equipment;
                    
                    // D√©s√©lectionner les autres options de cette zone
                    document.querySelectorAll(`[data-zone="${zone}"]`).forEach(c => {
                        c.classList.remove('selected');
                    });
                    
                    card.classList.add('selected');
                    equipmentChoices[zone] = equipment;
                    
                    if (Object.keys(equipmentChoices).length === 3) {
                        document.getElementById('validateBtn4').disabled = false;
                    }
                });
            });
        }

        function checkMission4() {
            gameData.mission4.attempts++;
            let correct = 0;
            
            for (const [zone, choice] of Object.entries(equipmentChoices)) {
                if (choice === correctAnswers.mission4[zone]) {
                    correct++;
                }
            }
            
            const isSuccess = correct === 3;
            gameData.mission4.completed = isSuccess;
            gameData.mission4.score = isSuccess ? 20 : Math.max(0, 20 - (gameData.mission4.attempts * 5));
            
            if (isSuccess) {
                totalScore += gameData.mission4.score;
                completedMissions++;
            }
            
            showFeedback(4, isSuccess);
            updateDashboard();
        }

        // Mission 5: √âvacuation
        let selectedRoute = null;

        function initMission5() {
            const routeChoices = document.querySelectorAll('[data-mission="5"] .route-choice');
            const textArea = document.getElementById('evacuationJustification');
            
            routeChoices.forEach(choice => {
                choice.addEventListener('click', () => {
                    routeChoices.forEach(c => c.classList.remove('selected'));
                    choice.classList.add('selected');
                    selectedRoute = choice.dataset.route;
                    checkMission5Inputs();
                });
            });
            
            textArea.addEventListener('input', checkMission5Inputs);
        }

        function checkMission5Inputs() {
            const textArea = document.getElementById('evacuationJustification');
            if (selectedRoute && textArea.value.trim().length > 20) {
                document.getElementById('validateBtn5').disabled = false;
            }
        }

        function checkMission5() {
            gameData.mission5.attempts++;
            const textAnswer = document.getElementById('evacuationJustification').value.toLowerCase();
            
            const routeCorrect = selectedRoute === correctAnswers.mission5.route;
            let keywordScore = 0;
            
            correctAnswers.mission5.keywords.forEach(keyword => {
                if (textAnswer.includes(keyword)) keywordScore++;
            });
            
            const textCorrect = keywordScore >= 2;
            const isSuccess = routeCorrect && textCorrect;
            
            gameData.mission5.completed = isSuccess;
            gameData.mission5.score = isSuccess ? 15 : Math.max(0, 15 - (gameData.mission5.attempts * 3));
            
            if (isSuccess) {
                totalScore += gameData.mission5.score;
                completedMissions++;
            }
            
            showFeedback(5, isSuccess);
            updateDashboard();
        }

        // Mission 6: Message d'alerte
        function initMission6() {
            const textArea = document.getElementById('alertMessage');
            textArea.addEventListener('input', () => {
                if (textArea.value.trim().length > 50) {
                    document.getElementById('validateBtn6').disabled = false;
                }
            });
        }

        function checkMission6() {
            gameData.mission6.attempts++;
            const message = document.getElementById('alertMessage').value.toLowerCase();
            
            let keywordScore = 0;
            correctAnswers.mission6.keywords.forEach(keyword => {
                if (message.includes(keyword.toLowerCase())) keywordScore++;
            });
            
            const isSuccess = keywordScore >= 6;
            gameData.mission6.completed = isSuccess;
            gameData.mission6.score = isSuccess ? 15 : Math.max(0, 15 - (gameData.mission6.attempts * 3));
            
            if (isSuccess) {
                totalScore += gameData.mission6.score;
                completedMissions++;
            }
            
            showFeedback(6, isSuccess);
            updateDashboard();
        }

        // Syst√®me d'aide
        function showHelp(missionNum) {
            const help = document.getElementById(`help${missionNum}`);
            help.classList.add('show');
            
            setTimeout(() => {
                help.classList.remove('show');
            }, 10000);
        }

        // Feedback
        function showFeedback(missionNum, isSuccess) {
            const feedback = document.getElementById(`feedback${missionNum}`);
            const icon = feedback.querySelector('.feedback-icon');
            const title = feedback.querySelector('.feedback-title');
            
            if (isSuccess) {
                feedback.classList.add('success');
                icon.textContent = '‚úÖ';
                title.textContent = 'Mission r√©ussie';
            } else {
                feedback.classList.add('error');
                icon.textContent = '‚ùå';
                title.textContent = 'Mission √©chou√©e';
            }
            
            feedback.classList.add('show');
        }

        // Navigation
        function nextMission() {
            document.querySelector(`[data-mission="${currentMission}"]`).classList.remove('active');
            currentMission++;
            
            if (currentMission <= 6) {
                document.querySelector(`[data-mission="${currentMission}"]`).classList.add('active');
                
                // Initialiser la nouvelle mission
                switch(currentMission) {
                    case 2: initMission2(); break;
                    case 3: initMission3(); break;
                    case 4: initMission4(); break;
                    case 5: initMission5(); break;
                    case 6: initMission6(); break;
                }
                
                updateDashboard();
            }
        }

        function skipMission() {
            if (confirm('√ätes-vous s√ªr de vouloir passer cette mission ? Vous pourrez voir la correction.')) {
                showFeedback(currentMission, false);
            }
        }

        // √âcran final
        function showFinalResults() {
            document.querySelector(`[data-mission="${currentMission}"]`).classList.remove('active');
            
            // Calculer le score final
            const finalScore = Math.min(100, totalScore + (completedMissions * 5));
            document.getElementById('finalScore').textContent = `${finalScore}/100`;
            
            document.getElementById('finalResults').classList.add('show');
            
            // Arr√™ter le timer
            clearInterval(timerInterval);
        }

        function restartGame() {
            location.reload();
        }

        // Initialisation au chargement
        document.addEventListener('DOMContentLoaded', () => {
            initGame();
            // Ne pas initialiser Mission1 au d√©marrage - attendre le clic sur "Commencer"
        });
    </script>
</body>
</html>