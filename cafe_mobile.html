// --- DANS cafe_mobile.html ---

    // 1. Remplacer la fonction renderMeteo par celle-ci :
    function renderMeteo(container) {
        container.innerHTML = `
            <h2 style="margin-bottom:10px;">Votre M√©t√©o du jour ‚òÄÔ∏è</h2>
            
            <p style="color:#94a3b8; font-size:0.9rem; margin-bottom:15px;">Quelle est votre humeur dominante ?</p>
            <div style="display:grid; grid-template-columns:repeat(4, 1fr); gap:10px; margin-bottom:30px;">
                ${['ü§©', 'üôÇ', 'ü§î', 'üò∞'].map((emoji, i) => 
                    `<button class="btn-choice mood-selector" id="mood-${i}" 
                      style="font-size:2rem; justify-content:center; padding:15px; height:auto;" 
                      onclick="selectMood(${i}, '${['super','bien','bof','mauvais'][i]}')">${emoji}</button>`
                ).join('')}
            </div>

            <p style="color:#94a3b8; font-size:0.9rem; margin-bottom:10px;">Votre niveau d'√©nergie ? üîã</p>
            <div style="background:#1e293b; padding:20px; border-radius:16px; border:1px solid #334155; margin-bottom:20px;">
                <input type="range" id="energy-slider" min="0" max="100" value="50" style="width:100%; accent-color:#db2777; cursor:pointer;">
                <div style="display:flex; justify-content:space-between; color:#64748b; font-size:0.8rem; margin-top:10px;">
                    <span>üò¥ √Ä plat</span>
                    <span id="energy-val" style="color:white; font-weight:bold;">50%</span>
                    <span>‚ö° Au max</span>
                </div>
            </div>

            <button class="btn-send" onclick="sendMeteoVote()">Envoyer ma M√©t√©o üöÄ</button>
        `;

        // Petit script pour mettre √† jour la valeur affich√©e du slider
        setTimeout(() => {
            const slider = document.getElementById('energy-slider');
            const valDisplay = document.getElementById('energy-val');
            if(slider) {
                slider.oninput = function() { 
                    valDisplay.innerText = this.value + '%';
                    // Changement de couleur dynamique
                    if(this.value < 30) valDisplay.style.color = "#ef4444"; // Rouge
                    else if(this.value < 70) valDisplay.style.color = "#facc15"; // Jaune
                    else valDisplay.style.color = "#22c55e"; // Vert
                }
            }
        }, 100);
    }

    // 2. Ajouter ces variables et fonctions juste avant ou apr√®s renderMeteo :
    
    let selectedMoodVal = null;

    window.selectMood = function(index, val) {
        selectedMoodVal = val;
        // Visuel de s√©lection
        document.querySelectorAll('.mood-selector').forEach(b => {
            b.style.borderColor = "#334155";
            b.style.background = "#1e293b";
            b.style.transform = "scale(1)";
        });
        const btn = document.getElementById('mood-' + index);
        btn.style.borderColor = "#db2777";
        btn.style.background = "rgba(219, 39, 119, 0.2)";
        btn.style.transform = "scale(1.1)";
    }

    window.sendMeteoVote = function() {
        if(!selectedMoodVal) { alert("S√©lectionnez d'abord une humeur !"); return; }
        const energy = document.getElementById('energy-slider').value;
        
        // On envoie un objet JSON combin√©
        const payload = JSON.stringify({ mood: selectedMoodVal, energy: parseInt(energy) });
        
        sendInput('meteo_full', payload); // Nouveau type 'meteo_full'
        
        // Feedback
        document.getElementById('dynamic-screen').innerHTML = `
            <div style="font-size:4rem; margin-bottom:20px;">üöÄ</div>
            <h2>M√©t√©o envoy√©e !</h2>
            <p style="color:#94a3b8;">Regardez l'√©cran g√©ant...</p>
        `;
    }
