<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©vision B.4 - L'eau et le d√©veloppement durable - Bac Pro Premi√®re</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0984e3 0%, #00cec9 50%, #74b9ff 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .btn-back {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.3);
            cursor: pointer;
        }
        
        .btn-back:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .score-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 50px;
            backdrop-filter: blur(10px);
        }
        
        .score-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .score-item .icon {
            font-size: 18px;
        }
        
        /* √âcrans */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* √âcran d'accueil */
        .welcome-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .welcome-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #74b9ff, #00cec9, #a8e6cf);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: rgba(255,255,255,0.8);
            margin-bottom: 30px;
        }
        
        /* Objectifs */
        .objectifs-card {
            background: linear-gradient(135deg, rgba(0, 206, 201, 0.3), rgba(116, 185, 255, 0.3));
            border: 2px solid rgba(0, 206, 201, 0.5);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: left;
            backdrop-filter: blur(10px);
        }
        
        .objectifs-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .objectif-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            font-size: 14px;
            line-height: 1.5;
        }
        
        .objectif-item:last-child {
            border-bottom: none;
        }
        
        .objectif-item .check {
            color: #00b894;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .competences-row {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .comp-badge {
            background: rgba(255,255,255,0.25);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            backdrop-filter: blur(5px);
        }
        
        .comp-badge.c1 { background: rgba(16, 185, 129, 0.4); border: 1px solid #10b981; }
        .comp-badge.c2 { background: rgba(9, 132, 227, 0.4); border: 1px solid #0984e3; }
        .comp-badge.c3 { background: rgba(0, 206, 201, 0.4); border: 1px solid #00cec9; }
        .comp-badge.c4 { background: rgba(116, 185, 255, 0.4); border: 1px solid #74b9ff; }
        
        /* Niveaux */
        .niveaux-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .niveau-card {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .niveau-card:hover:not(.locked) {
            background: rgba(255,255,255,0.2);
            transform: translateX(5px);
            border-color: rgba(0, 206, 201, 0.5);
        }
        
        .niveau-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .niveau-card.completed {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.2);
        }
        
        .niveau-icon {
            width: 50px;
            height: 50px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            background: linear-gradient(135deg, #74b9ff, #00cec9);
            flex-shrink: 0;
        }
        
        .niveau-info {
            flex: 1;
            min-width: 0;
        }
        
        .niveau-titre {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
            color: white;
        }
        
        .niveau-desc {
            font-size: 13px;
            color: rgba(255,255,255,0.7);
            line-height: 1.4;
        }
        
        .niveau-progress {
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .progress-circle {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: conic-gradient(#00b894 0%, #00b894 0%, rgba(255,255,255,0.2) 0%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 12px;
        }
        
        .progress-bar {
            width: 60px;
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #00b894, #00cec9);
            transition: width 0.5s ease;
            width: 0%;
        }
        
        /* √âcran de jeu */
        .game-screen {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255,255,255,0.1);
            padding: 15px 20px;
            border-radius: 15px;
            flex-wrap: wrap;
            gap: 10px;
            backdrop-filter: blur(10px);
        }
        
        .level-title {
            font-size: 18px;
            font-weight: 700;
            color: white;
        }
        
        .progress-info {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 14px;
            color: rgba(255,255,255,0.8);
        }
        
        .card-container {
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.9));
            border-radius: 20px;
            padding: 30px;
            color: #2d3436;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .card-type {
            display: inline-block;
            background: linear-gradient(135deg, #74b9ff, #00cec9);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .question-section {
            margin-bottom: 25px;
        }
        
        .question-text {
            font-size: 18px;
            font-weight: 600;
            color: #2d3436;
            margin-bottom: 20px;
            line-height: 1.4;
        }
        
        .keyword-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.8);
        }
        
        .keyword-input:focus {
            outline: none;
            border-color: #00cec9;
            background: white;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .option-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: rgba(255,255,255,0.7);
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            text-align: left;
        }
        
        .option-btn:hover {
            border-color: #74b9ff;
            background: rgba(116, 185, 255, 0.1);
        }
        
        .option-btn.selected {
            border-color: #00cec9;
            background: rgba(0, 206, 201, 0.2);
            color: #2d3436;
        }
        
        .option-letter {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #74b9ff;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 12px;
            flex-shrink: 0;
        }
        
        .option-btn.selected .option-letter {
            background: #00cec9;
        }
        
        .vf-container {
            display: flex;
            gap: 15px;
        }
        
        .vf-btn {
            flex: 1;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: rgba(255,255,255,0.7);
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .vf-btn.vrai {
            color: #00b894;
        }
        
        .vf-btn.faux {
            color: #e17055;
        }
        
        .vf-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .vf-btn.selected {
            border-color: #00cec9;
            background: rgba(0, 206, 201, 0.2);
        }
        
        .actions-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .hint-section {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .hint-btn {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }
        
        .hint-btn:hover {
            transform: translateY(-2px);
        }
        
        .hint-text {
            color: #e17055;
            font-size: 14px;
            font-style: italic;
            max-width: 200px;
        }
        
        .validate-btn {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }
        
        .validate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        /* Feedback Overlay - FONDS OPAQUES OBLIGATOIRES */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .feedback-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .feedback-card {
            background: linear-gradient(135deg, #2d3436, #636e72);
            border-radius: 20px;
            padding: 30px;
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            color: white;
            text-align: center;
            position: relative;
            backdrop-filter: blur(15px);
        }
        
        .feedback-card.correct {
            background: linear-gradient(135deg, #00b894, #00cec9);
        }
        
        .feedback-card.incorrect {
            background: linear-gradient(135deg, #e17055, #d63031);
        }
        
        .feedback-header {
            margin-bottom: 20px;
        }
        
        .feedback-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .feedback-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .feedback-points {
            font-size: 18px;
            font-weight: 600;
            color: #ffeaa7;
        }
        
        .feedback-explanation {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }
        
        .feedback-explanation h4 {
            color: #74b9ff;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .keyword-box {
            background: rgba(0, 206, 201, 0.3);
            border: 2px solid #00cec9;
            border-radius: 10px;
            padding: 10px;
            margin: 15px 0;
            font-weight: 600;
            text-align: center;
        }
        
        .tip-box {
            background: rgba(253, 203, 110, 0.3);
            border: 2px solid #fdcb6e;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .tip-box h5 {
            color: #fdcb6e;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .continue-btn {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }
        
        .continue-btn:hover {
            transform: translateY(-2px);
        }
        
        /* √âcran de r√©sultats */
        .results-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .results-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.9));
            border-radius: 20px;
            padding: 40px;
            color: #2d3436;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 25px;
            backdrop-filter: blur(15px);
        }
        
        .results-icon {
            font-size: 64px;
            margin-bottom: 15px;
        }
        
        .results-title {
            font-size: 28px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #74b9ff, #00cec9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .results-score {
            font-size: 48px;
            font-weight: 900;
            color: #00b894;
            margin: 20px 0;
        }
        
        .results-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .result-item {
            text-align: center;
        }
        
        .result-value {
            font-size: 24px;
            font-weight: 700;
            color: #74b9ff;
            margin-bottom: 5px;
        }
        
        .result-label {
            font-size: 12px;
            color: #636e72;
            font-weight: 600;
        }
        
        .errors-recap {
            background: rgba(231, 112, 85, 0.1);
            border: 2px solid rgba(231, 112, 85, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .errors-recap h4 {
            color: #e17055;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .errors-list {
            list-style: none;
            text-align: left;
        }
        
        .errors-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(231, 112, 85, 0.2);
            font-size: 14px;
        }
        
        .errors-list li:last-child {
            border-bottom: none;
        }
        
        .results-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn-secondary {
            background: rgba(116, 185, 255, 0.2);
            color: #74b9ff;
            border: 2px solid #74b9ff;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-secondary:hover {
            background: #74b9ff;
            color: white;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
        }
        
        /* Animations */
        .streak-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            color: #2d3436;
            padding: 20px 40px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 700;
            z-index: 1001;
            display: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: confetti 3s linear forwards;
            z-index: 999;
        }
        
        @keyframes confetti {
            0% { 
                transform: translateY(-100vh) rotateZ(0deg);
                opacity: 1;
            }
            100% { 
                transform: translateY(100vh) rotateZ(720deg);
                opacity: 0;
            }
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .welcome-title {
                font-size: 32px;
            }
            
            .card-container {
                padding: 20px;
            }
            
            .question-text {
                font-size: 16px;
            }
            
            .vf-container {
                flex-direction: column;
            }
            
            .actions-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .hint-section {
                order: 1;
            }
            
            .validate-btn {
                order: 2;
                width: 100%;
            }
            
            .results-score {
                font-size: 36px;
            }
            
            .results-details {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .results-actions {
                flex-direction: column;
                align-items: stretch;
            }
            
            .feedback-card {
                margin: 20px;
                padding: 25px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .score-bar {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <button class="btn-back" onclick="goHome()">‚Üê Menu</button>
            <div class="score-bar">
                <div class="score-item">
                    <span class="icon">üèÜ</span>
                    <span id="totalPoints">0</span>
                </div>
                <div class="score-item">
                    <span class="icon">üî•</span>
                    <span id="currentStreak">0</span>
                </div>
            </div>
        </div>
        
        <!-- √âcran d'accueil -->
        <div id="homeScreen" class="screen active">
            <div class="welcome-screen">
                <h1 class="welcome-title">R√âVISION B.4</h1>
                <p class="welcome-subtitle">L'eau et le d√©veloppement durable</p>
                
                <!-- Objectifs -->
                <div class="objectifs-card">
                    <h3>üéØ Objectifs p√©dagogiques</h3>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <div>
                            <strong>Adopter un comportement √©coresponsable</strong><br>
                            Comprendre les enjeux li√©s √† la pr√©servation des ressources en eau
                        </div>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <div>
                            <strong>Analyser la diversit√© des ressources</strong><br>
                            Ma√Ætriser la r√©partition et l'acc√®s aux ressources en eau dans le monde
                        </div>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <div>
                            <strong>Expliquer les processus de traitement</strong><br>
                            Comprendre la potabilisation et l'√©puration des eaux us√©es
                        </div>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <div>
                            <strong>Proposer des solutions durables</strong><br>
                            Identifier les mesures individuelles et collectives de pr√©servation
                        </div>
                    </div>
                    
                    <div class="competences-row">
                        <span class="comp-badge c1">C1 - Traiter information</span>
                        <span class="comp-badge c2">C2 - D√©marche d'analyse</span>
                        <span class="comp-badge c3">C3 - Expliquer ph√©nom√®nes</span>
                        <span class="comp-badge c4">C4 - Proposer solutions</span>
                    </div>
                </div>
                
                <!-- Niveaux -->
                <div class="niveaux-grid">
                    <div class="niveau-card" onclick="startLevel(1)">
                        <div class="niveau-icon">üåç</div>
                        <div class="niveau-info">
                            <div class="niveau-titre">Niveau 1 - Ressources mondiales</div>
                            <div class="niveau-desc">R√©partition de l'eau sur Terre, stress hydrique, p√©nurie</div>
                        </div>
                        <div class="niveau-progress">
                            <div class="progress-circle" style="background: conic-gradient(#00b894 0%, #00b894 0%, rgba(255,255,255,0.2) 0%);">
                                <span id="level1Percent">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level1Bar"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card locked" onclick="startLevel(2)">
                        <div class="niveau-icon">üíß</div>
                        <div class="niveau-info">
                            <div class="niveau-titre">Niveau 2 - Qualit√© de l'eau</div>
                            <div class="niveau-desc">Param√®tres de potabilit√©, pollution, crit√®res de qualit√©</div>
                        </div>
                        <div class="niveau-progress">
                            <div class="progress-circle">
                                <span id="level2Percent">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level2Bar"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card locked" onclick="startLevel(3)">
                        <div class="niveau-icon">‚öóÔ∏è</div>
                        <div class="niveau-info">
                            <div class="niveau-titre">Niveau 3 - Traitement de l'eau</div>
                            <div class="niveau-desc">Potabilisation, √©puration, stations de traitement</div>
                        </div>
                        <div class="niveau-progress">
                            <div class="progress-circle">
                                <span id="level3Percent">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level3Bar"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card locked" onclick="startLevel(4)">
                        <div class="niveau-icon">üè≠</div>
                        <div class="niveau-info">
                            <div class="niveau-titre">Niveau 4 - Empreinte eau</div>
                            <div class="niveau-desc">Consommation directe/indirecte, eau virtuelle, calculs</div>
                        </div>
                        <div class="niveau-progress">
                            <div class="progress-circle">
                                <span id="level4Percent">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level4Bar"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card locked" onclick="startLevel(5)">
                        <div class="niveau-icon">üå±</div>
                        <div class="niveau-info">
                            <div class="niveau-titre">Niveau 5 - Solutions durables</div>
                            <div class="niveau-desc">Mesures individuelles/collectives, √©co-gestes, innovations</div>
                        </div>
                        <div class="niveau-progress">
                            <div class="progress-circle">
                                <span id="level5Percent">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level5Bar"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- √âcran de jeu -->
        <div id="gameScreen" class="screen">
            <div class="game-screen">
                <div class="game-header">
                    <div class="level-title" id="levelTitle">Niveau 1</div>
                    <div class="progress-info">
                        <span id="cardProgress">1/10</span>
                        <span>‚Ä¢</span>
                        <span>üèÜ <span id="levelPoints">0</span> points</span>
                    </div>
                </div>
                
                <div class="card-container">
                    <div class="card-type" id="cardType">Question</div>
                    <div class="question-section" id="questionSection">
                        <!-- Contenu g√©n√©r√© dynamiquement -->
                    </div>
                    
                    <div class="actions-container">
                        <div class="hint-section">
                            <button class="hint-btn" onclick="showHint()">üí° Indice</button>
                            <div class="hint-text" id="hintText"></div>
                        </div>
                        <button class="validate-btn" onclick="validateAnswer()">Valider</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- √âcran de r√©sultats -->
        <div id="resultsScreen" class="screen">
            <div class="results-screen">
                <div class="results-card">
                    <div class="results-icon" id="resultsIcon">üéâ</div>
                    <h2 class="results-title" id="resultsTitle">Niveau r√©ussi !</h2>
                    <div class="results-score" id="resultsScore">85%</div>
                    
                    <div class="results-details">
                        <div class="result-item">
                            <div class="result-value" id="correctCount">8/10</div>
                            <div class="result-label">BONNES R√âPONSES</div>
                        </div>
                        <div class="result-item">
                            <div class="result-value" id="pointsEarned">+75</div>
                            <div class="result-label">POINTS GAGN√âS</div>
                        </div>
                        <div class="result-item">
                            <div class="result-value" id="bestStreak">5</div>
                            <div class="result-label">MEILLEURE S√âRIE</div>
                        </div>
                    </div>
                    
                    <div class="errors-recap" id="errorsRecap" style="display: none;">
                        <h4>üìö Points √† revoir</h4>
                        <ul class="errors-list" id="errorsList"></ul>
                    </div>
                </div>
                
                <div class="results-actions">
                    <button class="btn-secondary" onclick="goHome()">üè† Menu</button>
                    <button class="btn-secondary" onclick="startLevel(currentLevel)">üîÑ Refaire</button>
                    <button class="btn-primary" id="nextLevelBtn" onclick="nextLevel()" style="display: none;">
                        Niveau suivant ‚Üí
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Overlays -->
    <div id="feedbackOverlay" class="feedback-overlay">
        <div class="feedback-card" id="feedbackCard">
            <div class="feedback-header">
                <div class="feedback-icon" id="feedbackIcon">‚úÖ</div>
                <h3 class="feedback-title" id="feedbackTitle">Bravo !</h3>
                <div class="feedback-points" id="feedbackPoints">+10 points</div>
            </div>
            <div class="feedback-explanation" id="feedbackExplanation">
                <!-- Contenu g√©n√©r√© dynamiquement -->
            </div>
            <button class="continue-btn" onclick="nextCard()">Continuer</button>
        </div>
    </div>
    
    <div class="streak-popup" id="streakPopup">üî• 3 de suite !</div>

    <script>
        // Variables globales
        let currentLevel = 1;
        let currentCardIndex = 0;
        let levelProgress = [0, 0, 0, 0, 0, 0]; // Index 0 inutilis√©
        let totalPoints = 0;
        let levelPoints = 0;
        let levelCorrect = 0;
        let levelErrors = [];
        let currentStreak = 0;
        let bestStreak = 0;
        let hintUsed = false;
        
        // Donn√©es des niveaux
        const levels = {
            1: {
                title: "Niveau 1 - Ressources mondiales",
                icon: "üåç",
                cards: [
                    {
                        type: "keyword",
                        question: "Quel pourcentage de l'eau terrestre est constitu√©e d'eau sal√©e ?",
                        answer: "97,5",
                        keyword: "97,5%",
                        explanation: "Sur Terre, 97,5% de l'eau est sal√©e (oc√©ans et mers), et seulement 2,5% est de l'eau douce. Cette eau douce est majoritairement sous forme de glace (77%) dans les glaciers.",
                        hint: "Pensez aux oc√©ans qui recouvrent la majorit√© de la plan√®te",
                        tip: "Retenez : 97,5% eau sal√©e, 2,5% eau douce, et sur cette eau douce, seulement 1% est facilement accessible."
                    },
                    {
                        type: "qcm",
                        question: "Quand parle-t-on de <strong>stress hydrique</strong> pour un pays ?",
                        options: [
                            "Moins de 500 m¬≥ d'eau par habitant et par an",
                            "Entre 1000 et 1700 m¬≥ d'eau par habitant et par an",
                            "Plus de 4000 m¬≥ d'eau par habitant et par an",
                            "Quand il y a des inondations fr√©quentes"
                        ],
                        answer: 1,
                        keyword: "Stress hydrique : 1000-1700 m¬≥/hab/an",
                        explanation: "Le stress hydrique correspond √† une disponibilit√© en eau entre 1000 et 1700 m¬≥ par habitant et par an. En dessous de 1000 m¬≥, on parle de p√©nurie.",
                        hint: "C'est une situation interm√©diaire, ni abondance ni p√©nurie totale",
                        tip: "Seuils √† retenir : <1000 m¬≥ = p√©nurie, 1000-1700 m¬≥ = stress, >1700 m¬≥ = situation normale"
                    },
                    {
                        type: "vf",
                        question: "Les pays du Maghreb (Maroc, Alg√©rie, Tunisie) sont en situation de p√©nurie d'eau.",
                        answer: true,
                        keyword: "P√©nurie au Maghreb",
                        explanation: "Effectivement, les pays du Maghreb et du Moyen-Orient sont en p√©nurie d'eau avec moins de 1000 m¬≥ par habitant et par an, principalement √† cause du climat aride et de l'accroissement d√©mographique.",
                        hint: "R√©fl√©chis au climat de cette r√©gion g√©ographique",
                        tip: "Zone g√©ographique critique : Afrique du Nord et Moyen-Orient sont les plus touch√©s par la p√©nurie."
                    },
                    {
                        type: "qcm",
                        question: "Quels sont les <strong>9 pays</strong> qui d√©tiennent 60% des r√©serves d'eau douce de la plan√®te ?",
                        options: [
                            "Principalement les pays europ√©ens industrialis√©s",
                            "Les pays avec de grands fleuves et beaucoup de for√™ts",
                            "Les pays les plus peupl√©s du monde",
                            "Les pays situ√©s uniquement en zone tropicale"
                        ],
                        answer: 1,
                        keyword: "Br√©sil, Russie, Canada : grands d√©tenteurs",
                        explanation: "Ces 9 pays (Br√©sil, Russie, Canada, √âtats-Unis, Chine, Colombie, Indon√©sie, P√©rou, Inde) poss√®dent de grands r√©servoirs : fleuves importants, for√™ts pluviales, glaciers, nappes souterraines.",
                        hint: "Pense aux pays avec l'Amazonie, la Sib√©rie, les Grands Lacs...",
                        tip: "G√©ographie cl√© : for√™ts tropicales, grands bassins fluviaux, r√©gions de glaciers = abondance en eau."
                    },
                    {
                        type: "keyword",
                        question: "Combien de personnes dans le monde n'ont pas acc√®s aux services de base d'approvisionnement en eau potable ?",
                        answer: "844",
                        keyword: "844 millions de personnes",
                        explanation: "Selon les donn√©es ONU, 844 millions de personnes n'ont pas acc√®s aux services de base en eau potable, soit plus d'une personne sur dix dans le monde.",
                        hint: "Un chiffre proche du milliard, mais en centaines de millions",
                        tip: "Chiffres ONU √† retenir : 844 millions sans acc√®s de base, 263 millions marchent >30 min pour l'eau."
                    },
                    {
                        type: "vf",
                        question: "En France, il n'y a actuellement aucun risque de p√©nurie d'eau.",
                        answer: true,
                        keyword: "France : pas de p√©nurie actuelle",
                        explanation: "La France dispose d'environ 3000 m¬≥ d'eau par habitant et par an, gr√¢ce √† sa pluviom√©trie, ses montagnes, son r√©seau hydrographique et ses nappes phr√©atiques importantes.",
                        hint: "Pense au climat temp√©r√© oc√©anique et aux nombreuses rivi√®res",
                        tip: "France = situation favorable : climat temp√©r√©, montagnes, nappes phr√©atiques + r√©seau hydrographique √©tendu."
                    },
                    {
                        type: "qcm",
                        question: "La <strong>crise de l'eau</strong> actuelle s'explique principalement par :",
                        options: [
                            "La diminution globale de la quantit√© d'eau sur Terre",
                            "Le d√©r√®glement climatique ET la demande humaine croissante",
                            "Uniquement la pollution des oc√©ans",
                            "La fonte des glaciers exclusivement"
                        ],
                        answer: 1,
                        keyword: "Crise = climat + demande humaine",
                        explanation: "La crise r√©sulte de deux facteurs principaux : le d√©r√®glement climatique qui perturbe le cycle de l'eau, et l'augmentation des activit√©s humaines (industrie, agriculture, d√©mographie) qui exercent une pression croissante.",
                        hint: "Il y a deux causes majeures, l'une naturelle, l'autre humaine",
                        tip: "Double origine de la crise : changement climatique (r√©partition) + pression anthropique (demande)."
                    },
                    {
                        type: "keyword",
                        question: "Combien de m¬≥ d'eau par an la France offre-t-elle environ par personne ?",
                        answer: "3000",
                        keyword: "3000 m¬≥/personne/an",
                        explanation: "La France offre environ 3000 m¬≥ d'eau par personne et par an, ce qui la place largement au-dessus du seuil de stress hydrique (1700 m¬≥) gr√¢ce √† ses ressources hydriques abondantes.",
                        hint: "Un chiffre rond en milliers, sup√©rieur au seuil de stress hydrique",
                        tip: "France = 3000 m¬≥/hab/an, soit quasi 2 fois le seuil de s√©curit√© hydrique (1700 m¬≥)."
                    }
                ]
            },
            2: {
                title: "Niveau 2 - Qualit√© de l'eau",
                icon: "üíß",
                cards: [
                    {
                        type: "qcm",
                        question: "Une eau potable doit r√©pondre √† environ combien de <strong>crit√®res de qualit√©</strong> ?",
                        options: [
                            "15 crit√®res essentiels",
                            "35 param√®tres de base",
                            "70 crit√®res r√©partis en plusieurs cat√©gories",
                            "100 analyses diff√©rentes"
                        ],
                        answer: 2,
                        keyword: "70 crit√®res de qualit√©",
                        explanation: "L'eau potable doit r√©pondre √† environ 70 crit√®res de qualit√© r√©partis entre param√®tres microbiologiques, organoleptiques (go√ªt, odeur, couleur) et physico-chimiques.",
                        hint: "Un nombre important, mais pas excessif pour garantir la s√©curit√©",
                        tip: "70 crit√®res r√©partis : microbiologiques + organoleptiques + physico-chimiques + substances toxiques."
                    },
                    {
                        type: "vf",
                        question: "Les param√®tres organoleptiques de l'eau concernent le go√ªt, l'odeur et la couleur.",
                        answer: true,
                        keyword: "Organoleptiques = sens",
                        explanation: "Exact ! Les param√®tres organoleptiques sont ceux que l'on peut percevoir avec nos sens : go√ªt, odeur, couleur, limpidit√©, saveur. Ils concernent l'aspect sensoriel de l'eau.",
                        hint: "Pense √† ce que tes sens peuvent d√©tecter dans l'eau",
                        tip: "Organoleptique = per√ßu par les organes des sens (vue, go√ªt, odorat)."
                    },
                    {
                        type: "keyword",
                        question: "Quelle est la limite maximale autoris√©e pour les nitrates dans l'eau potable (en mg/L) ?",
                        answer: "50",
                        keyword: "50 mg/L nitrates max",
                        explanation: "La limite r√©glementaire pour les nitrates dans l'eau potable est de 50 mg/L. Au-del√†, l'eau est d√©clar√©e non potable car les nitrates peuvent √™tre toxiques, notamment pour les nourrissons.",
                        hint: "Un chiffre rond, assez √©lev√© en mg/L",
                        tip: "Seuils r√©glementaires : nitrates <50 mg/L, fer <200 ¬µg/L, pesticides <0,1 ¬µg/L."
                    },
                    {
                        type: "qcm",
                        question: "Que signifie l'acronyme <strong>DBO5</strong> dans l'analyse de l'eau ?",
                        options: [
                            "Degr√© de Basicit√© Optimal sur 5 jours",
                            "Demande Biologique en Oxyg√®ne sur 5 jours",
                            "D√©tection de Bact√©ries Organiques sur 5 jours",
                            "Dosage de Biocides Organiques sur 5 jours"
                        ],
                        answer: 1,
                        keyword: "DBO5 = Demande Biologique Oxyg√®ne",
                        explanation: "La DBO5 mesure la quantit√© d'oxyg√®ne consomm√©e en 5 jours par les micro-organismes pour d√©composer la mati√®re organique pr√©sente dans l'eau. Plus elle est √©lev√©e, plus l'eau est pollu√©e.",
                        hint: "Cela concerne l'oxyg√®ne n√©cessaire aux bact√©ries pour d√©composer",
                        tip: "DBO5 √©lev√©e = eau pollu√©e (mati√®re organique) / DBO5 faible = eau peu pollu√©e."
                    },
                    {
                        type: "vf",
                        question: "Si l'analyse d√©tecte des bact√©ries <em>Escherichia coli</em> dans l'eau, celle-ci peut √™tre d√©clar√©e potable.",
                        answer: false,
                        keyword: "E. coli = eau non potable",
                        explanation: "Faux ! La pr√©sence d'Escherichia coli, m√™me en faible quantit√©, rend l'eau impropre √† la consommation car cette bact√©rie indique une contamination f√©cale et des risques sanitaires.",
                        hint: "Cette bact√©rie est un indicateur de contamination grave",
                        tip: "E. coli = contamination f√©cale = danger sanitaire = eau NON potable imm√©diatement."
                    },
                    {
                        type: "keyword",
                        question: "Entre quelles valeurs de pH l'eau potable doit-elle se situer ?",
                        answer: "6.5-8.5",
                        keyword: "pH eau potable : 6,5-8,5",
                        explanation: "Le pH de l'eau potable doit √™tre compris entre 6,5 et 8,5, soit proche de la neutralit√©. Un pH trop acide ou trop basique peut √™tre corrosif et dangereux pour la sant√©.",
                        hint: "Autour de la neutralit√© (7), avec une petite marge",
                        tip: "pH normal eau potable = 6,5-8,5 (proche neutralit√©). pH<6,5 = acide, pH>8,5 = basique."
                    },
                    {
                        type: "qcm",
                        question: "La <strong>pollution diffuse</strong> de l'eau provient principalement de :",
                        options: [
                            "Rejets ponctuels d'usines identifi√©es",
                            "Activit√©s agricoles r√©pandues sur le territoire",
                            "D√©versements accidentels de produits chimiques",
                            "Fuites de canalisations urbaines"
                        ],
                        answer: 1,
                        keyword: "Pollution diffuse = agriculture",
                        explanation: "La pollution diffuse provient d'activit√©s r√©parties sur de vastes territoires, principalement l'agriculture avec les pesticides et engrais qui s'infiltrent dans les nappes et ruissellent vers les cours d'eau.",
                        hint: "Une pollution √©tendue g√©ographiquement, pas localis√©e",
                        tip: "Diffuse = √©tendue g√©ographiquement (agriculture) / Ponctuelle = source identifi√©e (usine)."
                    },
                    {
                        type: "vf",
                        question: "L'eau du robinet est contr√¥l√©e plus fr√©quemment que l'eau en bouteille.",
                        answer: true,
                        keyword: "Eau robinet = plus contr√¥l√©e",
                        explanation: "Vrai ! L'eau du robinet fait l'objet de contr√¥les quotidiens et de milliers d'analyses par an, tandis que l'eau en bouteille n'est contr√¥l√©e qu'√† la source et p√©riodiquement.",
                        hint: "Pense aux enjeux de sant√© publique pour la distribution de masse",
                        tip: "Eau du robinet = contr√¥les permanents / Eau bouteille = contr√¥les ponctuels √† la source."
                    }
                ]
            },
            3: {
                title: "Niveau 3 - Traitement de l'eau",
                icon: "‚öóÔ∏è",
                cards: [
                    {
                        type: "qcm",
                        question: "Quelle est la <strong>derni√®re √©tape</strong> du traitement de potabilisation de l'eau ?",
                        options: [
                            "La filtration sur sable",
                            "La floculation-d√©cantation",
                            "La d√©sinfection (chloration ou ozonation)",
                            "Le d√©grillage des gros d√©chets"
                        ],
                        answer: 2,
                        keyword: "D√©sinfection = derni√®re √©tape",
                        explanation: "La d√©sinfection par chloration ou ozonation est la derni√®re √©tape cruciale qui √©limine tous les micro-organismes pathog√®nes pour garantir la s√©curit√© sanitaire de l'eau distribu√©e.",
                        hint: "Cette √©tape assure la s√©curit√© microbiologique finale",
                        tip: "Ordre traitement : d√©grillage ‚Üí floculation ‚Üí filtration ‚Üí D√âSINFECTION (chlore/ozone)."
                    },
                    {
                        type: "keyword",
                        question: "Comment appelle-t-on les eaux alt√©r√©es par l'activit√© humaine ?",
                        answer: "eaux us√©es",
                        keyword: "Eaux us√©es",
                        explanation: "Les eaux us√©es sont toutes les eaux alt√©r√©es par l'activit√© humaine : domestique (WC, cuisine, douche), industrielle ou pluviale urbaine. Elles n√©cessitent un traitement avant rejet.",
                        hint: "Terme technique pour les eaux pollu√©es par l'homme",
                        tip: "3 types d'eaux us√©es : domestiques + industrielles + pluviales urbaines."
                    },
                    {
                        type: "vf",
                        question: "Une station d'√©puration traite l'eau pour la rendre potable.",
                        answer: false,
                        keyword: "Station √©puration ‚â† potabilisation",
                        explanation: "Faux ! Une station d'√©puration traite les eaux us√©es pour les d√©polluer avant rejet dans le milieu naturel. C'est la station de potabilisation qui rend l'eau potable.",
                        hint: "Attention √† ne pas confondre les deux types de stations",
                        tip: "Station POTABILISATION = rend potable / Station √âPURATION = d√©pollue avant rejet."
                    },
                    {
                        type: "qcm",
                        question: "Le ph√©nom√®ne d'<strong>eutrophisation</strong> est caus√© par un exc√®s de :",
                        options: [
                            "Oxyg√®ne dissous dans l'eau",
                            "Phosphates et nitrates (nutriments)",
                            "M√©taux lourds industriels",
                            "Temp√©rature de l'eau"
                        ],
                        answer: 1,
                        keyword: "Eutrophisation = exc√®s nutriments",
                        explanation: "L'eutrophisation est caus√©e par un exc√®s de nutriments (phosphates, nitrates) qui favorise la prolif√©ration d'algues, consomme l'oxyg√®ne et nuit √† la faune aquatique.",
                        hint: "Ces substances 'nourrissent' trop les plantes aquatiques",
                        tip: "Eutrophisation : phosphates + nitrates ‚Üí algues ‚Üí consommation O2 ‚Üí mort faune."
                    },
                    {
                        type: "keyword",
                        question: "Quel est le pourcentage de d√©perdition d'eau acceptable dans un r√©seau de distribution ?",
                        answer: "20",
                        keyword: "20% pertes r√©seau max",
                        explanation: "Un r√©seau de distribution bien entretenu ne devrait pas perdre plus de 20% de l'eau par fuites. En France, certains r√©seaux v√©tustes perdent jusqu'√† 30-40% de l'eau produite.",
                        hint: "Un cinqui√®me de l'eau peut √™tre perdu dans les canalisations",
                        tip: "Objectif qualit√© r√©seau : pertes <20% / R√©seaux v√©tustes peuvent perdre >40%."
                    },
                    {
                        type: "vf",
                        question: "Le traitement biologique en station d'√©puration utilise des bact√©ries pour d√©composer la pollution.",
                        answer: true,
                        keyword: "Traitement biologique = bact√©ries",
                        explanation: "Exact ! Le traitement biologique utilise des micro-organismes (bact√©ries) qui se nourrissent de la mati√®re organique polluante et la transforment en boues et en eau clarifi√©e.",
                        hint: "On utilise des √™tres vivants microscopiques pour nettoyer",
                        tip: "Traitement biologique : bact√©ries 'mangent' pollution ‚Üí boues + eau claire."
                    },
                    {
                        type: "qcm",
                        question: "Que devient l'eau apr√®s traitement en station d'√©puration ?",
                        options: [
                            "Elle est directement distribu√©e au robinet",
                            "Elle est rejet√©e dans le milieu naturel ou r√©utilis√©e",
                            "Elle est stock√©e ind√©finiment dans des bassins",
                            "Elle est uniquement utilis√©e pour l'industrie"
                        ],
                        answer: 1,
                        keyword: "Eau √©pur√©e ‚Üí rejet naturel",
                        explanation: "Apr√®s √©puration, l'eau trait√©e est rejet√©e dans le milieu naturel (rivi√®re, mer) ou r√©utilis√©e pour l'irrigation, l'industrie, mais elle n'est g√©n√©ralement pas directement potabilis√©e.",
                        hint: "Elle retourne dans le cycle naturel de l'eau",
                        tip: "Circuit eau : pr√©l√®vement ‚Üí potabilisation ‚Üí usage ‚Üí √©puration ‚Üí rejet naturel."
                    },
                    {
                        type: "keyword",
                        question: "Combien de temps faut-il en moyenne pour que l'eau des nappes phr√©atiques se renouvelle ?",
                        answer: "plusieurs ann√©es",
                        keyword: "Renouvellement nappes = ann√©es",
                        explanation: "Le renouvellement des nappes phr√©atiques prend de plusieurs ann√©es √† plusieurs dizaines d'ann√©es selon leur profondeur, contrairement aux eaux de surface qui se renouvellent en semaines/mois.",
                        hint: "Beaucoup plus long que pour les rivi√®res",
                        tip: "Vitesse renouvellement : rivi√®res (semaines) < nappes superficielles (ann√©es) < nappes profondes (si√®cles)."
                    }
                ]
            },
            4: {
                title: "Niveau 4 - Empreinte eau",
                icon: "üè≠",
                cards: [
                    {
                        type: "keyword",
                        question: "Combien de litres d'eau un Fran√ßais consomme-t-il directement par jour ?",
                        answer: "148",
                        keyword: "148 L/jour consommation directe",
                        explanation: "Un Fran√ßais consomme en moyenne 148 litres d'eau par jour pour ses besoins domestiques directs : hygi√®ne (39%), sanitaires (20%), lave-linge (12%), etc.",
                        hint: "Proche de 150 litres, pour tous les usages domestiques",
                        tip: "R√©partition : hygi√®ne 39% > sanitaires 20% > lave-linge 12% > cuisine 6%."
                    },
                    {
                        type: "qcm",
                        question: "L'<strong>empreinte eau totale</strong> d'un Fran√ßais repr√©sente environ :",
                        options: [
                            "500 litres par jour",
                            "1 500 litres par jour",
                            "4 150 litres par jour",
                            "10 000 litres par jour"
                        ],
                        answer: 2,
                        keyword: "4150 L/jour empreinte totale",
                        explanation: "L'empreinte eau totale d'un Fran√ßais est d'environ 4150 L/jour, incluant 148 L directs + 4000 L indirects (production des biens de consommation, alimentation, objets).",
                        hint: "Bien plus que la consommation directe, √† cause de l'eau 'cach√©e'",
                        tip: "Empreinte totale = 148 L direct + 4000 L indirect = 4150 L/jour/personne."
                    },
                    {
                        type: "vf",
                        question: "L'empreinte eau indirecte repr√©sente 96% de notre consommation d'eau totale.",
                        answer: true,
                        keyword: "96% empreinte indirecte",
                        explanation: "Vrai ! L'eau indirecte (virtuelle) repr√©sente 96% de notre empreinte : 4000 L sur 4150 L total. C'est l'eau utilis√©e pour produire nos aliments, v√™tements, objets du quotidien.",
                        hint: "L'eau 'cach√©e' dans nos achats repr√©sente presque tout",
                        tip: "R√©partition empreinte : 4% direct (robinet) + 96% indirect (production biens)."
                    },
                    {
                        type: "keyword",
                        question: "Combien de litres d'eau faut-il pour produire 1 kg de viande de b≈ìuf ?",
                        answer: "15000",
                        keyword: "15 000 L pour 1 kg b≈ìuf",
                        explanation: "Il faut environ 15 000 litres d'eau pour produire 1 kg de viande de b≈ìuf (abreuvement, fourrage, abattage). C'est l'aliment avec la plus forte empreinte eau.",
                        hint: "Un chiffre tr√®s √©lev√©, record de consommation",
                        tip: "Hi√©rarchie empreinte : b≈ìuf 15000L > porc 6000L > poulet 4300L > c√©r√©ales 1500L."
                    },
                    {
                        type: "qcm",
                        question: "Pour produire un <strong>smartphone</strong>, il faut environ :",
                        options: [
                            "50 litres d'eau",
                            "500 litres d'eau",
                            "2 700 litres d'eau",
                            "12 760 litres d'eau"
                        ],
                        answer: 3,
                        keyword: "12 760 L pour 1 smartphone",
                        explanation: "Un smartphone n√©cessite 12 760 litres d'eau pour sa production : extraction des m√©taux rares (8000 L), fabrication des composants (3500 L), assemblage et emballage (1260 L).",
                        hint: "Plus de 10 000 litres √† cause des m√©taux rares",
                        tip: "High-tech = forte empreinte : extraction m√©taux rares + processus industriels complexes."
                    },
                    {
                        type: "vf",
                        question: "Produire 1 kg de tomates n√©cessite plus d'eau que produire 1 kg de riz.",
                        answer: false,
                        keyword: "Riz > tomates en empreinte eau",
                        explanation: "Faux ! Le riz n√©cessite 3000 L/kg (rizi√®res inond√©es) contre 214 L/kg pour les tomates. Les c√©r√©ales ont g√©n√©ralement une empreinte plus √©lev√©e que les l√©gumes.",
                        hint: "Pense aux rizi√®res qui sont des champs inond√©s",
                        tip: "Empreinte l√©gumes : tomates 214L < salade 237L < avocat 1000L << riz 3000L."
                    },
                    {
                        type: "keyword",
                        question: "Combien de litres d'eau sont n√©cessaires pour produire un jean en coton ?",
                        answer: "8000",
                        keyword: "8000 L pour 1 jean",
                        explanation: "Un jean n√©cessite environ 8000 litres d'eau : culture du coton (5500 L), teinture (1800 L), confection (700 L). Le coton est une fibre tr√®s gourmande en eau.",
                        hint: "Un chiffre √©lev√© √† cause de la culture du coton",
                        tip: "Textile coton = grosse empreinte : culture intensive + teinture + confection."
                    },
                    {
                        type: "qcm",
                        question: "L'<strong>eau virtuelle</strong> correspond √† :",
                        options: [
                            "L'eau recycl√©e artificiellement",
                            "L'eau contenue dans les nuages",
                            "L'eau n√©cessaire √† la production des biens",
                            "L'eau stock√©e dans les barrages"
                        ],
                        answer: 2,
                        keyword: "Eau virtuelle = eau de production",
                        explanation: "L'eau virtuelle est la quantit√© d'eau totale n√©cessaire √† la production d'un bien ou service. Ce concept permet de comptabiliser l'eau 'cach√©e' dans nos consommations.",
                        hint: "Une eau qu'on ne voit pas directement mais qui a √©t√© utilis√©e",
                        tip: "Concept cl√© : eau virtuelle permet de mesurer l'impact hydrique r√©el de nos achats."
                    }
                ]
            },
            5: {
                title: "Niveau 5 - Solutions durables",
                icon: "üå±",
                cards: [
                    {
                        type: "qcm",
                        question: "Quelle mesure permet d'√©conomiser le plus d'eau √† la maison ?",
                        options: [
                            "Fermer le robinet pendant le brossage des dents",
                            "Prendre une douche au lieu d'un bain",
                            "Installer des mousseurs sur les robinets",
                            "R√©parer imm√©diatement les fuites"
                        ],
                        answer: 1,
                        keyword: "Douche vs bain = √©conomie majeure",
                        explanation: "Une douche consomme 60-80 L contre 150-200 L pour un bain, soit 2-3 fois moins. C'est l'√©co-geste domestique le plus efficace au quotidien.",
                        hint: "Compare les volumes d'eau pour l'hygi√®ne corporelle",
                        tip: "Hi√©rarchie √©conomies : douche/bain > r√©paration fuites > mousseurs > robinet ferm√©."
                    },
                    {
                        type: "vf",
                        question: "R√©cup√©rer l'eau de pluie pour arroser le jardin est une pratique l√©gale en France.",
                        answer: true,
                        keyword: "R√©cup√©ration eau pluie = l√©gale",
                        explanation: "Vrai ! La r√©cup√©ration d'eau de pluie est autoris√©e et encourag√©e en France pour les usages ext√©rieurs (arrosage, lavage), et m√™me int√©rieurs sous certaines conditions (WC, lave-linge).",
                        hint: "Cette pratique √©cologique est encourag√©e par la loi",
                        tip: "Usages autoris√©s eau pluie : arrosage + lavage v√©hicule + WC/lave-linge (avec traitement)."
                    },
                    {
                        type: "keyword",
                        question: "Sur quel principe repose la loi fran√ßaise sur l'eau (LEMA) ?",
                        answer: "pollueur-payeur",
                        keyword: "Principe pollueur-payeur",
                        explanation: "La LEMA (Loi sur l'Eau et les Milieux Aquatiques) applique le principe 'pollueur-payeur' : celui qui utilise et pollue l'eau paie une taxe pour financer sa d√©pollution.",
                        hint: "Un principe de justice environnementale bien connu",
                        tip: "LEMA : pollueur-payeur ‚Üí taxes ‚Üí financement stations √©puration ‚Üí eau propre."
                    },
                    {
                        type: "qcm",
                        question: "Pour r√©duire son empreinte eau indirecte, il faut prioritairement :",
                        options: [
                            "Prendre des douches plus courtes",
                            "R√©duire sa consommation de viande rouge",
                            "Installer un lave-vaisselle √©conome",
                            "Arroser la nuit plut√¥t que le jour"
                        ],
                        answer: 1,
                        keyword: "Moins de viande = moins d'empreinte",
                        explanation: "R√©duire la viande rouge (15000 L/kg) est l'action la plus efficace car l'alimentation repr√©sente 70% de l'empreinte eau indirecte. Remplacer par volaille/l√©gumes divise l'impact par 3-5.",
                        hint: "L'empreinte indirecte vient surtout de ce qu'on mange",
                        tip: "Impact empreinte indirecte : alimentation 70% > textile 20% > objets 10%."
                    },
                    {
                        type: "vf",
                        question: "En France, la r√©utilisation des eaux us√©es trait√©es repr√©sente moins de 1% des volumes d'eau.",
                        answer: true,
                        keyword: "France : <1% r√©utilisation eaux trait√©es",
                        explanation: "Vrai ! La France r√©utilise moins de 1% de ses eaux us√©es trait√©es, contre 14% en Espagne. L'objectif gouvernemental est d'atteindre 10% en 2030.",
                        hint: "La France est en retard par rapport √† d'autres pays europ√©ens",
                        tip: "Potentiel √©norme : France <1% vs Espagne 14%. Objectif 2030 : 10% r√©utilisation."
                    },
                    {
                        type: "keyword",
                        question: "Combien d'√©conomie d'eau peut r√©aliser un mousseur sur robinet ?",
                        answer: "50",
                        keyword: "Mousseur = 50% √©conomie",
                        explanation: "Un mousseur (a√©rateur) peut r√©duire de 50% le d√©bit d'un robinet en m√©langeant air et eau, sans perte de confort. Investissement de quelques euros pour 30-50% d'√©conomie.",
                        hint: "Cette petite pi√®ce divise quasiment la consommation par deux",
                        tip: "√âquipements √©conomes : mousseurs -50%, chasses double d√©bit -40%, pommeau √©conome -30%."
                    },
                    {
                        type: "qcm",
                        question: "√Ä l'√©chelle mondiale, quel secteur consomme le plus d'eau douce ?",
                        options: [
                            "L'industrie manufacturi√®re (40%)",
                            "L'usage domestique urbain (50%)",
                            "L'agriculture et l'irrigation (70%)",
                            "La production √©nerg√©tique (60%)"
                        ],
                        answer: 2,
                        keyword: "Agriculture = 70% consommation mondiale",
                        explanation: "L'agriculture consomme environ 70% de l'eau douce mondiale pour l'irrigation des cultures. L'industrie ~20% et les usages domestiques ~10%. D'o√π l'enjeu des pratiques agricoles durables.",
                        hint: "Le secteur qui nourrit la population mondiale",
                        tip: "R√©partition mondiale : agriculture 70% > industrie 20% > domestique 10%."
                    },
                    {
                        type: "vf",
                        question: "Acheter des produits locaux et de saison r√©duit significativement l'empreinte eau.",
                        answer: true,
                        keyword: "Local + saison = moins d'empreinte",
                        explanation: "Vrai ! Les produits locaux et de saison n√©cessitent moins d'irrigation artificielle, pas de serres chauff√©es, moins de transport. L'empreinte eau peut √™tre divis√©e par 2-3 par rapport aux produits hors-saison import√©s.",
                        hint: "√âviter les cultures forc√©es et le transport longue distance",
                        tip: "B√©n√©fices local/saison : irrigation naturelle + pas de serres + transport minimal."
                    }
                ]
            }
        };
        
        function startLevel(level) {
            // V√©rifier si le niveau est d√©bloqu√©
            if (level > 1 && levelProgress[level - 1] < 60) {
                alert('Compl√®te d\'abord le niveau pr√©c√©dent avec au moins 60% !');
                return;
            }
            
            currentLevel = level;
            currentCardIndex = 0;
            levelPoints = 0;
            levelCorrect = 0;
            levelErrors = [];
            hintUsed = false;
            
            // Masquer √©crans et afficher le jeu
            document.getElementById('homeScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');
            
            // Mettre √† jour l'interface
            document.getElementById('levelTitle').textContent = levels[level].title;
            
            showCard();
        }
        
        function showCard() {
            const card = levels[currentLevel].cards[currentCardIndex];
            const cardProgress = document.getElementById('cardProgress');
            const levelPointsElement = document.getElementById('levelPoints');
            const questionSection = document.getElementById('questionSection');
            
            // Mise √† jour progression
            cardProgress.textContent = `${currentCardIndex + 1}/${levels[currentLevel].cards.length}`;
            levelPointsElement.textContent = levelPoints;
            
            // Reset hint
            document.getElementById('hintText').innerHTML = '';
            hintUsed = false;
            
            // Type de carte
            const typeLabels = {
                'keyword': 'üî§ Mot-cl√©',
                'qcm': 'üìù QCM',
                'vf': '‚úì‚úó Vrai/Faux'
            };
            document.getElementById('cardType').textContent = typeLabels[card.type];
            
            // G√©n√©rer le contenu selon le type
            if (card.type === 'keyword') {
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <input type="text" class="keyword-input" id="keywordAnswer" placeholder="Tapez votre r√©ponse...">
                `;
            }
            else if (card.type === 'qcm') {
                let optionsHTML = card.options.map((opt, i) => `
                    <button class="option-btn" data-index="${i}" onclick="selectOption(this)">
                        <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                        <span>${opt}</span>
                    </button>
                `).join('');
                
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="options-container">${optionsHTML}</div>
                `;
            }
            else if (card.type === 'vf') {
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="vf-container">
                        <button class="vf-btn vrai" onclick="selectVF(this, true)">‚úì VRAI</button>
                        <button class="vf-btn faux" onclick="selectVF(this, false)">‚úó FAUX</button>
                    </div>
                `;
            }
        }
        
        function selectOption(btn) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }
        
        function selectVF(btn, value) {
            document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            btn.dataset.value = value;
        }
        
        function showHint() {
            const card = levels[currentLevel].cards[currentCardIndex];
            if (card.hint) {
                document.getElementById('hintText').innerHTML = `üí° <strong>Indice :</strong> ${card.hint}`;
                hintUsed = true;
            }
        }
        
        function validateAnswer() {
            const card = levels[currentLevel].cards[currentCardIndex];
            let isCorrect = false;
            let userAnswer = '';
            
            if (card.type === 'keyword') {
                userAnswer = document.getElementById('keywordAnswer').value.trim().toLowerCase();
                // Normaliser (accents, etc.)
                const normalize = str => str.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
                isCorrect = normalize(userAnswer) === normalize(card.answer) || 
                            userAnswer.includes(normalize(card.answer)) ||
                            normalize(card.answer).includes(userAnswer);
            }
            else if (card.type === 'qcm') {
                const selected = document.querySelector('.option-btn.selected');
                if (!selected) { alert('S√©lectionne une r√©ponse'); return; }
                userAnswer = parseInt(selected.dataset.index);
                isCorrect = userAnswer === card.answer;
            }
            else if (card.type === 'vf') {
                const selected = document.querySelector('.vf-btn.selected');
                if (!selected) { alert('S√©lectionne VRAI ou FAUX'); return; }
                userAnswer = selected.dataset.value === 'true';
                isCorrect = userAnswer === card.answer;
            }
            
            showFeedback(isCorrect, card);
        }
        
        function showFeedback(isCorrect, card) {
            const overlay = document.getElementById('feedbackOverlay');
            const feedbackCard = document.getElementById('feedbackCard');
            
            let points = 0;
            if (isCorrect) {
                points = hintUsed ? 5 : 10;
                levelCorrect++;
                currentStreak++;
                if (currentStreak > bestStreak) bestStreak = currentStreak;
                
                // Streak bonus
                if (currentStreak === 3) showStreakPopup('üî• 3 de suite !');
                else if (currentStreak === 5) showStreakPopup('üî•üî• 5 de suite !');
                else if (currentStreak === 10) showStreakPopup('üî•üî•üî• INCROYABLE !');
            } else {
                currentStreak = 0;
                levelErrors.push(card.keyword || card.question.replace(/<[^>]*>/g, '').substring(0, 50) + '...');
            }
            
            levelPoints += points;
            totalPoints += points;
            updateScoreDisplay();
            
            feedbackCard.className = 'feedback-card ' + (isCorrect ? 'correct' : 'incorrect');
            document.getElementById('feedbackIcon').textContent = isCorrect ? '‚úÖ' : '‚ùå';
            document.getElementById('feedbackTitle').textContent = isCorrect ? 
                (currentStreak >= 3 ? 'Excellent ! üî•' : 'Bravo !') : 'Pas tout √† fait...';
            document.getElementById('feedbackPoints').textContent = isCorrect ? `+${points} points` : '0 point';
            document.getElementById('feedbackPoints').style.display = isCorrect ? 'block' : 'none';
            
            document.getElementById('feedbackExplanation').innerHTML = `
                <h4>üìö Explication</h4>
                <p>${card.explanation}</p>
                <div class="keyword-box">üîë <span>${card.keyword}</span></div>
                ${card.tip ? `<div class="tip-box"><h5>üí° Astuce BAC</h5><p>${card.tip}</p></div>` : ''}
            `;
            
            overlay.classList.add('visible');
        }
        
        function showStreakPopup(text) {
            const popup = document.getElementById('streakPopup');
            popup.textContent = text;
            popup.style.display = 'block';
            setTimeout(() => { popup.style.display = 'none'; }, 1500);
        }
        
        function nextCard() {
            document.getElementById('feedbackOverlay').classList.remove('visible');
            currentCardIndex++;
            
            if (currentCardIndex >= levels[currentLevel].cards.length) {
                showResults();
            } else {
                showCard();
            }
        }
        
        function showResults() {
            const total = levels[currentLevel].cards.length;
            const percent = Math.round((levelCorrect / total) * 100);
            
            levelProgress[currentLevel] = Math.max(levelProgress[currentLevel], percent);
            
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');
            
            document.getElementById('resultsIcon').textContent = percent >= 80 ? 'üéâ' : percent >= 50 ? 'üëç' : 'üí™';
            document.getElementById('resultsTitle').textContent = percent >= 80 ? 'Niveau r√©ussi !' : percent >= 50 ? 'Pas mal !' : 'Continue !';
            document.getElementById('resultsScore').textContent = percent + '%';
            document.getElementById('correctCount').textContent = levelCorrect + '/' + total;
            document.getElementById('pointsEarned').textContent = '+' + levelPoints;
            document.getElementById('bestStreak').textContent = bestStreak;
            
            // Erreurs
            const errorsRecap = document.getElementById('errorsRecap');
            if (levelErrors.length > 0) {
                errorsRecap.style.display = 'block';
                document.getElementById('errorsList').innerHTML = levelErrors.map(e => `<li>${e}</li>`).join('');
            } else {
                errorsRecap.style.display = 'none';
            }
            
            // Confettis si r√©ussi
            if (percent >= 80) {
                createConfetti();
            }
            
            // Bouton niveau suivant
            document.getElementById('nextLevelBtn').style.display = (currentLevel < 5 && percent >= 60) ? 'flex' : 'none';
            
            updateHomeProgress();
        }
        
        function createConfetti() {
            const colors = ['#74b9ff', '#00cec9', '#a8e6cf', '#84fab0', '#8fd3f4', '#FFD700'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }
        
        function goHome() {
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('homeScreen').classList.add('active');
            updateHomeProgress();
        }
        
        function nextLevel() {
            if (currentLevel < 5) {
                startLevel(currentLevel + 1);
                document.getElementById('resultsScreen').classList.remove('active');
            }
        }
        
        function updateScoreDisplay() {
            document.getElementById('totalPoints').textContent = totalPoints;
            document.getElementById('currentStreak').textContent = currentStreak;
        }
        
        function updateHomeProgress() {
            for (let i = 1; i <= 5; i++) {
                const percent = levelProgress[i];
                document.getElementById(`level${i}Percent`).textContent = percent + '%';
                document.getElementById(`level${i}Bar`).style.width = percent + '%';
                
                // D√©verrouiller les niveaux
                const card = document.querySelector(`.niveau-card:nth-child(${i})`);
                if (i === 1 || levelProgress[i - 1] >= 60) {
                    card.classList.remove('locked');
                } else {
                    card.classList.add('locked');
                }
                
                // Marquer comme termin√©
                if (percent >= 80) {
                    card.classList.add('completed');
                }
            }
        }
        
        // Initialisation
        updateScoreDisplay();
        updateHomeProgress();
    </script>
</body>
</html>