<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>PSE Bac Pro ‚Äî Module B.3 ‚Äî Le bruit (Fiche de r√©vision + auto‚Äë√©valuation)</title>
  <style>
    :root{
      --bg0:#070B14;
      --bg1:#0B1223;
      --card:#0E1931;
      --card2:#0C152B;
      --ink:#EAF0FF;
      --muted:#B8C4E6;
      --muted2:#93A4D8;
      --line:rgba(255,255,255,.12);
      --good:#26D07C;
      --bad:#FF5A6B;
      --warn:#FFC857;
      --accent:#7C5CFF;
      --accent2:#35D3FF;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --r: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 20% 0%, rgba(124,92,255,.18), transparent 55%),
                  radial-gradient(900px 600px at 90% 10%, rgba(53,211,255,.14), transparent 55%),
                  linear-gradient(180deg, var(--bg0), var(--bg1));
      color:var(--ink);
    }
    a{color:inherit}
    .wrap{max-width:1100px;margin:0 auto;padding:16px 14px 80px}
    .top{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(7,11,20,.88), rgba(7,11,20,.55));
      border-bottom:1px solid rgba(255,255,255,.08);
      padding:10px 0 12px;
    }
    .top .wrap{padding:0 14px}
    .brand{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .chip{
      display:inline-flex; align-items:center; gap:10px;
      padding:8px 12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      border-radius:999px;
      font-weight:650;
      letter-spacing:.2px;
      box-shadow: 0 10px 30px rgba(0,0,0,.18);
      user-select:none;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow:0 0 0 5px rgba(124,92,255,.18);
    }
    .title{
      display:flex; flex-direction:column; gap:2px;
      padding:10px 2px 0;
    }
    h1{
      margin:8px 0 0;
      font-size: clamp(22px, 4.8vw, 34px);
      line-height:1.08;
      letter-spacing:-.5px;
    }
    .subtitle{
      color:var(--muted);
      font-size:14px;
      line-height:1.35;
      margin:4px 0 0;
    }
    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
      margin-top:14px;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns:1fr}
    }
    .card{
      background: linear-gradient(180deg, rgba(14,25,49,.92), rgba(12,21,43,.92));
      border:1px solid rgba(255,255,255,.10);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:14px 14px 10px;
      border-bottom:1px solid rgba(255,255,255,.08);
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
    }
    .k{
      font-weight:800; letter-spacing:.2px;
      display:flex; align-items:center; gap:10px;
    }
    .k small{
      display:inline-flex; align-items:center; gap:8px;
      font-weight:750;
      color:var(--muted);
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }
    .pts{
      font-weight:800;
      color:var(--muted);
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      white-space:nowrap;
    }
    .bd{padding:14px}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 11px;
      border-radius:999px;
      border:1px dashed rgba(124,92,255,.55);
      background: rgba(124,92,255,.10);
      color:#DAD5FF;
      font-weight:750;
      font-size:13px;
    }
    .list{
      display:grid; gap:10px; margin:10px 0 0;
    }
    .note{
      border-left:3px solid rgba(53,211,255,.65);
      padding:10px 12px;
      background: rgba(53,211,255,.07);
      border-radius: 12px;
      color: var(--muted);
      line-height:1.35;
      font-size:14px;
    }
    .bullets{
      margin:10px 0 0;
      padding:0 0 0 18px;
      color:var(--muted);
      line-height:1.5;
      font-size:14px;
    }
    .bullets li{margin:6px 0}
    .mini{
      color:var(--muted2);
      font-size:12.5px;
      line-height:1.35;
      margin-top:10px;
    }
    .divider{height:1px;background:rgba(255,255,255,.08);margin:12px 0}
    .btnrow{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
    button{
      appearance:none; border:none;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color:var(--ink);
      padding:10px 12px;
      border-radius: 14px;
      font-weight:780;
      cursor:pointer;
      box-shadow: 0 10px 24px rgba(0,0,0,.18);
      transition: transform .06s ease, background .2s ease, border-color .2s ease;
    }
    button:active{transform: translateY(1px)}
    .primary{
      background: linear-gradient(135deg, rgba(124,92,255,.92), rgba(53,211,255,.64));
      border-color: rgba(255,255,255,.18);
    }
    .ghost{background: rgba(255,255,255,.03);}

    select, input[type="text"], textarea{
      width:100%;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      color: var(--ink);
      padding:10px 12px;
      outline:none;
      font-size:15px;
    }
    textarea{min-height:90px; resize:vertical}
    label{display:block; color:var(--muted); font-size:13px; font-weight:750; margin:10px 0 6px}
    .q{
      margin:10px 0 0;
      padding:12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
    }
    .q h3{margin:0 0 8px; font-size:16px; letter-spacing:-.2px}
    .q .help{color:var(--muted2); font-size:13px; line-height:1.35}
    .fb{
      margin-top:10px;
      padding:10px 12px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      font-size:14px;
      line-height:1.4;
      display:none;
    }
    .fb.good{border-color: rgba(38,208,124,.35); background: rgba(38,208,124,.08); color:#CFF7E5}
    .fb.bad{border-color: rgba(255,90,107,.35); background: rgba(255,90,107,.08); color:#FFD4D9}
    .fb.warn{border-color: rgba(255,200,87,.35); background: rgba(255,200,87,.08); color:#FFE9BC}
    .scorebar{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      margin-top:12px;
      padding:12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
    }
    .scorebar .big{font-weight:900; letter-spacing:-.2px}
    .scorebar .small{color:var(--muted); font-weight:750}
    .progress{
      height:12px; width:100%;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
    }
    .progress > div{
      height:100%;
      width:0%;
      background: linear-gradient(135deg, rgba(38,208,124,.92), rgba(53,211,255,.62));
    }

    .bank{
      padding:10px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
    }
    .bankhd{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-bottom:10px;
    }
    .bankhd .ttl{font-weight:850}
    .chipset{
      display:flex; flex-wrap:wrap; gap:10px;
      min-height:40px;
    }
    .dragchip{
      display:inline-flex; align-items:center;
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      font-weight:800;
      cursor: grab;
      user-select:none;
      touch-action: manipulation;
      transition: transform .06s ease, border-color .15s ease, background .15s ease;
    }
    .dragchip.selected{
      border-color: rgba(124,92,255,.75);
      background: rgba(124,92,255,.18);
      box-shadow: 0 0 0 4px rgba(124,92,255,.14);
    }
    .zones{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    @media (max-width: 520px){
      .zones{grid-template-columns:1fr}
    }
    .zone{
      padding:10px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      min-height:86px;
      position:relative;
    }
    .zone .zh{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-bottom:8px;
    }
    .zone .zh strong{font-size:14px}
    .zone .zh span{color:var(--muted2); font-size:12px; font-weight:800}
    .drop{
      border:1px dashed rgba(124,92,255,.55);
      background: rgba(124,92,255,.08);
      border-radius: 14px;
      min-height:44px;
      padding:8px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-content:flex-start;
    }
    .drop.over{outline:3px solid rgba(53,211,255,.22)}
    .drop .dragchip{cursor:pointer}
    .hint{
      margin-top:10px;
      color: var(--muted2);
      font-size:13px;
      line-height:1.35;
    }

    .mcq{display:grid; gap:8px; margin-top:10px}
    .opt{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px 12px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      cursor:pointer;
      user-select:none;
    }
    .opt input{margin-top:3px; transform: scale(1.1)}
    .opt span{color:var(--muted); font-weight:650; line-height:1.3}
    .opt strong{color:var(--ink)}
    .opt:active{transform: translateY(1px)}

    input[type="range"]{width:100%}
    .rangeline{
      display:flex; align-items:center; justify-content:space-between;
      color:var(--muted); font-weight:800; font-size:13px;
      margin-top:8px;
    }

    .foot{
      margin-top:16px;
      color: var(--muted2);
      font-size:12.5px;
      line-height:1.35;
      text-align:center;
      opacity:.95;
    }
  </style>
</head>
<body>
  <div class="top">
    <div class="wrap">
      <div class="brand">
        <div class="chip"><span class="dot"></span> PSE Bac Pro</div>
        <div class="chip">Module B.3 ¬∑ Bruit</div>
      </div>
      <div class="title">
        <h1>Le bruit : comprendre, rep√©rer l‚Äôinfo, analyser, pr√©venir</h1>
        <p class="subtitle">Fiche de r√©vision + auto‚Äë√©valuation (mobile + PC). Objectif : conna√Ætre l‚Äôessentiel et s‚Äôentra√Æner comme en devoir.</p>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="grid">
      <section class="card" id="cours">
        <div class="hd">
          <div class="k">R√©sum√© du cours <small>√† conna√Ætre</small></div>
          <div class="pts">Lecture</div>
        </div>
        <div class="bd">
          <div class="list">
            <div class="note">
              Le <b>son</b> est une <b>onde</b> qui se propage dans l‚Äôair et fait vibrer une <b>source</b> jusqu‚Äô√† notre oreille.
              Le <b>bruit</b> est un son <b>g√™nant</b> ou <b>d√©sagr√©able</b>.
            </div>

            <div>
              <span class="pill">Caract√©ristiques du son</span>
              <ul class="bullets">
                <li><b>Intensit√©</b> : exprim√©e en <b>d√©cibel (dB)</b> ‚Üí dit si le son est fort ou faible.</li>
                <li><b>Fr√©quence</b> : exprim√©e en <b>hertz (Hz)</b> ‚Üí dit si le son est <b>aigu</b> ou <b>grave</b>.</li>
                <li>Pour pr√©server le <b>capital auditif</b>, on regarde <b>niveau sonore</b> + <b>dur√©e d‚Äôexposition</b>.</li>
                <li><b>Seuil de nocivit√©</b> : <b>80 dB(A)</b> pour une exposition de <b>8 heures</b>.</li>
              </ul>
            </div>

            <div>
              <span class="pill">Syst√®me auditif (3 parties)</span>
              <ul class="bullets">
                <li><b>Oreille externe</b> : capte et transmet le son au <b>tympan</b>.</li>
                <li><b>Oreille moyenne</b> : transmet l‚Äôonde sonore jusqu‚Äô√† l‚Äôoreille interne.</li>
                <li><b>Oreille interne</b> : transforme l‚Äôonde m√©canique en <b>influx nerveux</b> envoy√© au cerveau via le <b>nerf auditif</b>.</li>
              </ul>
            </div>

            <div>
              <span class="pill">Cons√©quences du bruit</span>
              <ul class="bullets">
                <li><b>Effets auditifs</b> : acouph√®nes, baisse d‚Äôaudition.</li>
                <li><b>Effets extra‚Äëauditifs</b> : stress, fatigue, troubles du sommeil‚Ä¶</li>
                <li><b>Vie sociale</b> : conflits.</li>
                <li><b>Surdit√© de transmission</b> : atteinte de l‚Äôoreille <b>externe/moyenne</b>.</li>
                <li><b>Surdit√© de perception</b> : atteinte de l‚Äôoreille <b>interne</b>.</li>
              </ul>
            </div>

            <div>
              <span class="pill">Pr√©vention : collectif + individuel</span>
              <ul class="bullets">
                <li><b>Collectif</b> : r√©glementation (limitation du niveau sonore, sanctions en cas d‚Äôatteinte √† la tranquillit√© du voisinage‚Ä¶).</li>
                <li><b>Individuel</b> : comportement civique (baisser le volume‚Ä¶), protections individuelles (bouchons d‚Äôoreille) pour la musique amplifi√©e.</li>
              </ul>
            </div>

            <div class="divider"></div>

            <div class="mini">
              Mots‚Äëcl√©s : bruit ¬∑ son ¬∑ intensit√© ¬∑ fr√©quence ¬∑ d√©cibel ¬∑ hertz ¬∑ onde sonore ¬∑ seuil ¬∑ dur√©e d‚Äôexposition ¬∑ syst√®me auditif ¬∑ oreille externe/moyenne/interne ¬∑ influx nerveux ¬∑ nerf auditif ¬∑ pr√©vention ¬∑ r√©glementation ¬∑ protection individuelle ¬∑ sanctions ¬∑ surdit√© de transmission ¬∑ surdit√© de perception.
            </div>
          </div>
        </div>
      </section>

      <aside class="card" id="score">
        <div class="hd">
          <div class="k">Auto‚Äë√©valuation <small>score /20</small></div>
          <div class="pts" id="totalPts">20 pts</div>
        </div>
        <div class="bd">
          <div class="scorebar">
            <div>
              <div class="big" id="scoreTxt">0 / 20</div>
              <div class="small" id="levelTxt">Commence l‚Äôexercice 1</div>
            </div>
            <button class="primary" id="btnCorrigerAll">Corriger tout</button>
          </div>
          <div class="progress" aria-label="progression"><div id="bar"></div></div>
          <div class="btnrow">
            <button class="ghost" id="btnResetAll">R√©initialiser</button>
            <button class="ghost" id="btnSave">Sauvegarder</button>
            <button class="ghost" id="btnLoad">Charger</button>
          </div>
          <div class="mini">
            Sauvegarde locale : si tu reviens plus tard sur ce t√©l√©phone/PC, tu peux reprendre.
          </div>
        </div>
      </aside>
    </div>

    <section class="card" id="ex1">
      <div class="hd">
        <div class="k">Exercice 1 <small>Texte √† trous</small></div>
        <div class="pts">4 pts ¬∑ C1/C3</div>
      </div>
      <div class="bd">
        <div class="q">
          <h3>Compl√®te avec le bon mot (menu d√©roulant)</h3>
          <div class="help">Astuce : relis le r√©sum√© si besoin.</div>

          <label>1) L‚Äô<b>intensit√©</b> d‚Äôun son est exprim√©e en</label>
          <select id="ex1a">
            <option value="">Choisir‚Ä¶</option>
            <option value="dB">d√©cibel (dB)</option>
            <option value="Hz">hertz (Hz)</option>
            <option value="min">minutes (min)</option>
          </select>

          <label>2) La <b>fr√©quence</b> d‚Äôun son est exprim√©e en</label>
          <select id="ex1b">
            <option value="">Choisir‚Ä¶</option>
            <option value="dB">d√©cibel (dB)</option>
            <option value="Hz">hertz (Hz)</option>
            <option value="cm">centim√®tres (cm)</option>
          </select>

          <label>3) La fr√©quence permet de dire si un son est</label>
          <select id="ex1c">
            <option value="">Choisir‚Ä¶</option>
            <option value="aigugrave">aigu ou grave</option>
            <option value="fortfaible">fort ou faible</option>
            <option value="rapidelent">rapide ou lent</option>
          </select>

          <label>4) Le seuil de nocivit√© est de</label>
          <select id="ex1d">
            <option value="">Choisir‚Ä¶</option>
            <option value="80-8">80 dB(A) pour 8 h</option>
            <option value="80-1">80 dB(A) pour 1 h</option>
            <option value="120-8">120 dB(A) pour 8 h</option>
          </select>

          <div class="btnrow">
            <button class="primary" onclick="gradeEx1()">Corriger</button>
            <button class="ghost" onclick="resetEx1()">R√©initialiser</button>
          </div>
          <div class="fb" id="fb1"></div>
        </div>
      </div>
    </section>

    <section class="card" id="ex2">
      <div class="hd">
        <div class="k">Exercice 2 <small>QCM</small></div>
        <div class="pts">4 pts ¬∑ C1/C3</div>
      </div>
      <div class="bd">
        <div class="q">
          <h3>Surdit√© : transmission ou perception ?</h3>
          <div class="help">Coche la bonne r√©ponse pour chaque question.</div>

          <div class="divider"></div>

          <div class="help"><b>2.1</b> La surdit√© de <b>transmission</b> concerne surtout :</div>
          <div class="mcq" id="q21">
            <label class="opt"><input type="radio" name="q21" value="A"/><span><strong>A</strong> ¬∑ L‚Äôoreille externe ou moyenne</span></label>
            <label class="opt"><input type="radio" name="q21" value="B"/><span><strong>B</strong> ¬∑ L‚Äôoreille interne uniquement</span></label>
            <label class="opt"><input type="radio" name="q21" value="C"/><span><strong>C</strong> ¬∑ Le nez et la gorge</span></label>
          </div>

          <div class="divider"></div>

          <div class="help"><b>2.2</b> La surdit√© de <b>perception</b> concerne surtout :</div>
          <div class="mcq" id="q22">
            <label class="opt"><input type="radio" name="q22" value="A"/><span><strong>A</strong> ¬∑ L‚Äôoreille externe</span></label>
            <label class="opt"><input type="radio" name="q22" value="B"/><span><strong>B</strong> ¬∑ L‚Äôoreille interne</span></label>
            <label class="opt"><input type="radio" name="q22" value="C"/><span><strong>C</strong> ¬∑ Les doigts</span></label>
          </div>

          <div class="btnrow">
            <button class="primary" onclick="gradeEx2()">Corriger</button>
            <button class="ghost" onclick="resetEx2()">R√©initialiser</button>
          </div>
          <div class="fb" id="fb2"></div>
        </div>
      </div>
    </section>

    <section class="card" id="ex3">
      <div class="hd">
        <div class="k">Exercice 3 <small>Associer (mobile + PC)</small></div>
        <div class="pts">6 pts ¬∑ C2</div>
      </div>
      <div class="bd">
        <div class="q">
          <h3>Classe chaque √©l√©ment dans la bonne famille</h3>
          <div class="help">
            Mode t√©l√©phone : touche un chip (il devient violet), puis touche une zone pour le d√©poser.
            Tu peux retirer un chip d‚Äôune zone en le touchant.
            Sur PC : tu peux aussi glisser‚Äëd√©poser.
          </div>

          <div class="divider"></div>

          <div class="bank">
            <div class="bankhd">
              <div class="ttl">Banque d‚Äô√©l√©ments (√† placer)</div>
              <button class="ghost" type="button" onclick="resetDnD()">R√©initialiser</button>
            </div>
            <div class="chipset" id="bank"></div>
          </div>

          <div class="zones">
            <div class="zone">
              <div class="zh"><strong>Caract√©ristique</strong><span>son</span></div>
              <div class="drop" data-zone="carac"></div>
            </div>
            <div class="zone">
              <div class="zh"><strong>Unit√©</strong><span>mesure</span></div>
              <div class="drop" data-zone="unit"></div>
            </div>
            <div class="zone">
              <div class="zh"><strong>Ce que √ßa d√©crit</strong><span>interpr√©tation</span></div>
              <div class="drop" data-zone="desc"></div>
            </div>
            <div class="zone">
              <div class="zh"><strong>R√©f√©rence</strong><span>seuil</span></div>
              <div class="drop" data-zone="ref"></div>
            </div>
          </div>

          <div class="hint">Rappel : intensit√© ‚Üí dB (fort/faible) ; fr√©quence ‚Üí Hz (aigu/grave) ; seuil ‚Üí 80 dB(A) pour 8 h.</div>

          <div class="btnrow">
            <button class="primary" onclick="gradeDnD()">Corriger</button>
          </div>
          <div class="fb" id="fb3"></div>
        </div>
      </div>
    </section>

    <section class="card" id="ex4">
      <div class="hd">
        <div class="k">Exercice 4 <small>Syst√®me auditif</small></div>
        <div class="pts">4 pts ¬∑ C1/C3</div>
      </div>
      <div class="bd">
        <div class="q">
          <h3>Remets les 3 parties dans l‚Äôordre du trajet du son</h3>
          <div class="help">Du moment o√π le son arrive √† l‚Äôoreille jusqu‚Äô√† la conversion en influx nerveux.</div>

          <label>Ordre (1 ‚Üí 3)</label>
          <select id="ex4_1">
            <option value="">1) Choisir‚Ä¶</option>
            <option value="externe">Oreille externe</option>
            <option value="moyenne">Oreille moyenne</option>
            <option value="interne">Oreille interne</option>
          </select>
          <select id="ex4_2" style="margin-top:8px">
            <option value="">2) Choisir‚Ä¶</option>
            <option value="externe">Oreille externe</option>
            <option value="moyenne">Oreille moyenne</option>
            <option value="interne">Oreille interne</option>
          </select>
          <select id="ex4_3" style="margin-top:8px">
            <option value="">3) Choisir‚Ä¶</option>
            <option value="externe">Oreille externe</option>
            <option value="moyenne">Oreille moyenne</option>
            <option value="interne">Oreille interne</option>
          </select>

          <div class="btnrow">
            <button class="primary" onclick="gradeEx4()">Corriger</button>
            <button class="ghost" onclick="resetEx4()">R√©initialiser</button>
          </div>
          <div class="fb" id="fb4"></div>
        </div>
      </div>
    </section>

    <section class="card" id="ex5">
      <div class="hd">
        <div class="k">Exercice 5 <small>Curseur</small></div>
        <div class="pts">2 pts ¬∑ C1</div>
      </div>
      <div class="bd">
        <div class="q">
          <h3>Dur√©e de r√©f√©rence</h3>
          <div class="help">D√©place le curseur : pour le seuil de nocivit√© √† <b>80 dB(A)</b>, la dur√©e de r√©f√©rence est de‚Ä¶</div>

          <input type="range" id="rangeH" min="0" max="12" step="1" value="0" oninput="document.getElementById('hVal').textContent=this.value+' h'"/>
          <div class="rangeline"><span>0 h</span><span id="hVal">0 h</span><span>12 h</span></div>

          <div class="btnrow">
            <button class="primary" onclick="gradeEx5()">Corriger</button>
            <button class="ghost" onclick="resetEx5()">R√©initialiser</button>
          </div>
          <div class="fb" id="fb5"></div>
        </div>
      </div>
    </section>

    <section class="card" id="ex6">
      <div class="hd">
        <div class="k">Exercice 6 <small>R√©ponse courte</small></div>
        <div class="pts">0 ‚Üí 4 pts ¬∑ C4/C5</div>
      </div>
      <div class="bd">
        <div class="q">
          <h3>Proposer + justifier</h3>
          <div class="help">
            Contexte : musique amplifi√©e ou environnement bruyant.<br>
            1) Propose <b>1 mesure individuelle</b> et <b>1 mesure collective</b> pour limiter les risques li√©s au bruit.<br>
            2) Ajoute <b>une justification</b> (un argument bas√© sur un fait du cours).
          </div>

          <label>Ta r√©ponse (2 √† 5 lignes)</label>
          <textarea id="ex6txt" placeholder="Ex : Individuel : porter des bouchons d‚Äôoreille‚Ä¶ Collectif : limiter les niveaux sonores‚Ä¶ Parce que‚Ä¶"></textarea>

          <div class="btnrow">
            <button class="primary" onclick="gradeEx6()">Corriger</button>
            <button class="ghost" onclick="resetEx6()">R√©initialiser</button>
          </div>
          <div class="fb" id="fb6"></div>

          <div class="mini">
            Bar√®me : 1 pt si mesure individuelle pertinente ¬∑ 1 pt si mesure collective pertinente ¬∑ 1 pt si justification pertinente ¬∑ 1 pt si vocabulaire correct (bruit, dB, dur√©e d‚Äôexposition, pr√©vention‚Ä¶).
          </div>
        </div>
      </div>
    </section>

    <div class="foot">
      Astuce devoir : lire la consigne ‚Üí rep√©rer les mots‚Äëcl√©s ‚Üí r√©pondre court et pr√©cis ‚Üí utiliser les mots du cours (dB, Hz, seuil, pr√©vention‚Ä¶).
    </div>
  </div>

<script>
const TOTAL = 20;
const storeKey = "PSE_B3_BRUIT_REV_v1";

const state = {
  ex1: {score:0, max:4},
  ex2: {score:0, max:4},
  ex3: {score:0, max:6},
  ex4: {score:0, max:4},
  ex5: {score:0, max:2},
  ex6: {score:0, max:4}
};

function sumScore(){ return Object.values(state).reduce((a,b)=>a + (b.score||0), 0); }
function setScoreUI(){
  const s = sumScore();
  document.getElementById("scoreTxt").textContent = `${s} / ${TOTAL}`;
  const pct = Math.round((s / TOTAL) * 100);
  document.getElementById("bar").style.width = pct + "%";
  let level = "Continue";
  if (pct < 25) level = "D√©but : relis le r√©sum√©";
  else if (pct < 50) level = "Bien : encore un effort";
  else if (pct < 75) level = "Tr√®s bien : presque";
  else if (pct < 100) level = "Excellent : tu es pr√™t(e)";
  else level = "Parfait : 20/20";
  document.getElementById("levelTxt").textContent = level;
}
function showFb(id, kind, html){
  const el = document.getElementById(id);
  el.className = "fb " + kind;
  el.innerHTML = html;
  el.style.display = "block";
}
function hideFb(id){ document.getElementById(id).style.display="none"; }

function val(id){return document.getElementById(id).value;}
function setVal(id,v){document.getElementById(id).value = v || "";}
function checked(name){
  const el = document.querySelector(`input[name="${name}"]:checked`);
  return el ? el.value : "";
}
function setChecked(name, value){
  const el = document.querySelector(`input[name="${name}"][value="${value}"]`);
  if(el) el.checked = true;
}

let tmo=null;
function toast(msg){
  let el = document.getElementById("toast");
  if(!el){
    el = document.createElement("div");
    el.id="toast";
    el.style.position="fixed";
    el.style.left="50%";
    el.style.bottom="18px";
    el.style.transform="translateX(-50%)";
    el.style.padding="10px 12px";
    el.style.borderRadius="14px";
    el.style.border="1px solid rgba(255,255,255,.12)";
    el.style.background="rgba(12,21,43,.92)";
    el.style.color="var(--ink)";
    el.style.boxShadow="0 18px 60px rgba(0,0,0,.45)";
    el.style.zIndex="9999";
    el.style.fontWeight="800";
    el.style.maxWidth="92vw";
    el.style.textAlign="center";
    document.body.appendChild(el);
  }
  el.textContent = msg;
  el.style.opacity="1";
  clearTimeout(tmo);
  tmo=setTimeout(()=>{el.style.opacity="0";}, 1700);
}

function save(){
  const payload = {
    ex1a: val("ex1a"), ex1b: val("ex1b"), ex1c: val("ex1c"), ex1d: val("ex1d"),
    q21: checked("q21"), q22: checked("q22"),
    dnd: serializeDnD(),
    ex4_1: val("ex4_1"), ex4_2: val("ex4_2"), ex4_3: val("ex4_3"),
    rangeH: document.getElementById("rangeH").value,
    ex6txt: document.getElementById("ex6txt").value,
    state
  };
  localStorage.setItem(storeKey, JSON.stringify(payload));
  toast("Sauvegard√© ‚úÖ");
}
function saveSilent(){
  try{
    const payload = {
      ex1a: val("ex1a"), ex1b: val("ex1b"), ex1c: val("ex1c"), ex1d: val("ex1d"),
      q21: checked("q21"), q22: checked("q22"),
      dnd: serializeDnD(),
      ex4_1: val("ex4_1"), ex4_2: val("ex4_2"), ex4_3: val("ex4_3"),
      rangeH: document.getElementById("rangeH").value,
      ex6txt: document.getElementById("ex6txt").value,
      state
    };
    localStorage.setItem(storeKey, JSON.stringify(payload));
  }catch(e){}
}
function load(){
  const raw = localStorage.getItem(storeKey);
  if(!raw){toast("Aucune sauvegarde trouv√©e"); return;}
  try{
    const p = JSON.parse(raw);
    setVal("ex1a", p.ex1a); setVal("ex1b", p.ex1b); setVal("ex1c", p.ex1c); setVal("ex1d", p.ex1d);
    setChecked("q21", p.q21); setChecked("q22", p.q22);
    restoreDnD(p.dnd);
    setVal("ex4_1", p.ex4_1); setVal("ex4_2", p.ex4_2); setVal("ex4_3", p.ex4_3);
    document.getElementById("rangeH").value = p.rangeH ?? 0;
    document.getElementById("hVal").textContent = (p.rangeH ?? 0) + " h";
    document.getElementById("ex6txt").value = p.ex6txt ?? "";
    if(p.state){
      for(const k of Object.keys(state)){
        if(p.state[k]) state[k].score = p.state[k].score || 0;
      }
    }
    setScoreUI();
    toast("Charg√© ‚úÖ");
  }catch(e){
    toast("Erreur de chargement");
  }
}
function resetAll(){
  resetEx1(); resetEx2(); resetDnD(); resetEx4(); resetEx5(); resetEx6();
  for(const k of Object.keys(state)) state[k].score = 0;
  setScoreUI();
  localStorage.removeItem(storeKey);
  toast("R√©initialis√©");
}

document.getElementById("btnSave").addEventListener("click", save);
document.getElementById("btnLoad").addEventListener("click", load);
document.getElementById("btnResetAll").addEventListener("click", resetAll);
document.getElementById("btnCorrigerAll").addEventListener("click", () => {
  gradeEx1(); gradeEx2(); gradeDnD(); gradeEx4(); gradeEx5(); gradeEx6();
});

/* Ex1 */
function gradeEx1(){
  const a = val("ex1a")==="dB";
  const b = val("ex1b")==="Hz";
  const c = val("ex1c")==="aigugrave";
  const d = val("ex1d")==="80-8";
  const score = [a,b,c,d].filter(Boolean).length;
  state.ex1.score = score;
  if(score===4){
    showFb("fb1","good",`‚úÖ <b>4/4</b> ¬∑ Parfait : intensit√©‚ÜídB, fr√©quence‚ÜíHz, aigu/grave, seuil 80 dB(A) pour 8 h.`);
  }else{
    const wrong = [];
    if(!a) wrong.push("intensit√© = d√©cibel (dB)");
    if(!b) wrong.push("fr√©quence = hertz (Hz)");
    if(!c) wrong.push("fr√©quence ‚Üí aigu/grave");
    if(!d) wrong.push("seuil : 80 dB(A) pour 8 h");
    showFb("fb1","warn",`üü° <b>${score}/4</b> ¬∑ √Ä revoir : <ul style="margin:8px 0 0 18px">${wrong.map(x=>`<li>${x}</li>`).join("")}</ul>`);
  }
  setScoreUI(); saveSilent();
}
function resetEx1(){
  setVal("ex1a",""); setVal("ex1b",""); setVal("ex1c",""); setVal("ex1d","");
  state.ex1.score = 0;
  hideFb("fb1");
  setScoreUI(); saveSilent();
}

/* Ex2 */
function gradeEx2(){
  const q21 = checked("q21")==="A";
  const q22 = checked("q22")==="B";
  const score = (q21?2:0) + (q22?2:0);
  state.ex2.score = score;
  if(score===4){
    showFb("fb2","good",`‚úÖ <b>4/4</b> ¬∑ Transmission : oreille externe/moyenne ¬∑ Perception : oreille interne.`);
  }else{
    showFb("fb2","warn",`üü° <b>${score}/4</b> ¬∑ Rappel : transmission = externe/moyenne ; perception = interne.`);
  }
  setScoreUI(); saveSilent();
}
function resetEx2(){
  document.querySelectorAll('input[name="q21"], input[name="q22"]').forEach(r=>r.checked=false);
  state.ex2.score = 0;
  hideFb("fb2");
  setScoreUI(); saveSilent();
}

/* Ex3 Drag+Tap */
const items = [
  {id:"i1", txt:"Intensit√©", zone:"carac"},
  {id:"i2", txt:"Fr√©quence", zone:"carac"},
  {id:"i3", txt:"dB", zone:"unit"},
  {id:"i4", txt:"Hz", zone:"unit"},
  {id:"i5", txt:"Fort / faible", zone:"desc"},
  {id:"i6", txt:"Aigu / grave", zone:"desc"},
  {id:"i7", txt:"80 dB(A)", zone:"ref"},
  {id:"i8", txt:"8 h", zone:"ref"}
];
let selectedChipId = null;

function buildDnD(){
  const bank = document.getElementById("bank");
  bank.innerHTML = "";
  items.forEach(it=>{
    const chip = document.createElement("div");
    chip.className = "dragchip";
    chip.textContent = it.txt;
    chip.dataset.id = it.id;
    chip.setAttribute("draggable","true");

    chip.addEventListener("click", ()=>{
      const was = chip.classList.contains("selected");
      document.querySelectorAll(".dragchip").forEach(c=>c.classList.remove("selected"));
      selectedChipId = null;
      if(!was){
        chip.classList.add("selected");
        selectedChipId = it.id;
      }
    });

    chip.addEventListener("dragstart", (e)=>{
      e.dataTransfer.setData("text/plain", it.id);
      setTimeout(()=>{chip.classList.add("selected");}, 0);
    });

    bank.appendChild(chip);
  });

  document.querySelectorAll(".drop").forEach(drop=>{
    drop.addEventListener("dragover",(e)=>{e.preventDefault(); drop.classList.add("over");});
    drop.addEventListener("dragleave",()=>drop.classList.remove("over"));
    drop.addEventListener("drop",(e)=>{
      e.preventDefault();
      drop.classList.remove("over");
      const id = e.dataTransfer.getData("text/plain");
      placeChip(id, drop);
    });
    drop.addEventListener("click", ()=>{
      if(selectedChipId) placeChip(selectedChipId, drop);
    });
  });

  document.querySelectorAll(".drop").forEach(drop=>{
    drop.addEventListener("click", (e)=>{
      const t = e.target;
      if(t && t.classList.contains("dragchip") && !selectedChipId){
        document.getElementById("bank").appendChild(t);
      }
    });
  });
}
function placeChip(id, drop){
  if(!id) return;
  document.querySelectorAll(".dragchip").forEach(c=>c.classList.remove("selected"));
  selectedChipId = null;
  const chip = document.querySelector(`.dragchip[data-id="${id}"]`);
  if(!chip) return;
  if(drop.querySelector(`.dragchip[data-id="${id}"]`)) return;
  drop.appendChild(chip);
}
function resetDnD(){
  hideFb("fb3");
  state.ex3.score = 0;
  const bank = document.getElementById("bank");
  document.querySelectorAll(".drop .dragchip").forEach(ch=>bank.appendChild(ch));
  document.querySelectorAll(".dragchip").forEach(c=>c.classList.remove("selected"));
  selectedChipId = null;
  setScoreUI(); saveSilent();
}
function gradeDnD(){
  let correct = 0;
  items.forEach(it=>{
    const zoneEl = document.querySelector(`.drop[data-zone="${it.zone}"]`);
    if(zoneEl && zoneEl.querySelector(`.dragchip[data-id="${it.id}"]`)) correct++;
  });
  const score = Math.round((correct / items.length) * 6);
  state.ex3.score = score;
  if(correct === items.length){
    showFb("fb3","good",`‚úÖ <b>${score}/6</b> ¬∑ Tout est bien class√©. Bravo !`);
  }else{
    showFb("fb3","warn",`üü° <b>${score}/6</b> ¬∑ Correct : <b>${correct}/${items.length}</b>. V√©rifie : intensit√©‚Üîfr√©quence ; dB‚ÜîHz ; fort/faible‚Üîaigu/grave.`);
  }
  setScoreUI(); saveSilent();
}
function serializeDnD(){
  const out = {};
  out.bank = Array.from(document.querySelectorAll("#bank .dragchip")).map(x=>x.dataset.id);
  out.zones = {};
  document.querySelectorAll(".drop").forEach(z=>{
    out.zones[z.dataset.zone] = Array.from(z.querySelectorAll(".dragchip")).map(x=>x.dataset.id);
  });
  return out;
}
function restoreDnD(data){
  if(!data){ resetDnD(); return; }
  const bank = document.getElementById("bank");
  const all = {};
  document.querySelectorAll(".dragchip").forEach(c=>all[c.dataset.id]=c);
  document.querySelectorAll(".drop .dragchip").forEach(ch=>bank.appendChild(ch));
  if(data.zones){
    for(const [zid, ids] of Object.entries(data.zones)){
      const z = document.querySelector(`.drop[data-zone="${zid}"]`);
      if(!z) continue;
      ids.forEach(id=>{ if(all[id]) z.appendChild(all[id]); });
    }
  }
  if(data.bank){
    data.bank.forEach(id=>{ if(all[id]) bank.appendChild(all[id]); });
  }
}

/* Ex4 */
function gradeEx4(){
  const a = val("ex4_1")==="externe";
  const b = val("ex4_2")==="moyenne";
  const c = val("ex4_3")==="interne";
  const score = [a,b,c].filter(Boolean).length + (a && b && c ? 1 : 0);
  state.ex4.score = Math.min(4, score);
  if(state.ex4.score===4){
    showFb("fb4","good",`‚úÖ <b>4/4</b> ¬∑ Ordre : oreille externe ‚Üí oreille moyenne ‚Üí oreille interne.`);
  }else{
    showFb("fb4","warn",`üü° <b>${state.ex4.score}/4</b> ¬∑ Rappel : externe (tympan) ‚Üí moyenne ‚Üí interne (influx nerveux).`);
  }
  setScoreUI(); saveSilent();
}
function resetEx4(){
  setVal("ex4_1",""); setVal("ex4_2",""); setVal("ex4_3","");
  state.ex4.score = 0;
  hideFb("fb4");
  setScoreUI(); saveSilent();
}

/* Ex5 */
function gradeEx5(){
  const v = parseInt(document.getElementById("rangeH").value, 10);
  const score = (v === 8) ? 2 : (Math.abs(v-8) <= 1 ? 1 : 0);
  state.ex5.score = score;
  if(score===2){
    showFb("fb5","good",`‚úÖ <b>2/2</b> ¬∑ Oui : 80 dB(A) correspond √† 8 h.`);
  }else if(score===1){
    showFb("fb5","warn",`üü° <b>1/2</b> ¬∑ Presque : la bonne valeur est <b>8 h</b>.`);
  }else{
    showFb("fb5","bad",`‚ùå <b>0/2</b> ¬∑ Rappel : seuil de nocivit√© = <b>80 dB(A)</b> pour <b>8 h</b>.`);
  }
  setScoreUI(); saveSilent();
}
function resetEx5(){
  document.getElementById("rangeH").value = 0;
  document.getElementById("hVal").textContent = "0 h";
  state.ex5.score = 0;
  hideFb("fb5");
  setScoreUI(); saveSilent();
}

/* Ex6 */
function gradeEx6(){
  const t = (document.getElementById("ex6txt").value || "").toLowerCase();
  const indiv = /bouchon|protections? (individ|auditive)|casque anti|baisser le bruit|baisser le volume|limiter le volume|s'eloigner|pause|repos auditif/.test(t);
  const coll = /r(√©|e)glement|limitation|sanction|contr(√¥|o)le|affichage|charte|norme|organisation|am(√©|e)nagement|isolation|collective/.test(t);
  const justif = /parce que|car|donc|afin de|pour|permet|r(√©|e)duit|pr(√©|e)server|capital auditif|dur(√©|e)e d'exposition|db|80/.test(t);
  const vocab = /bruit|son|db|d√©cibel|fr√©quence|hz|dur(√©|e)e|exposition|pr√©vention|protection/.test(t);
  let score = 0;
  if(indiv) score += 1;
  if(coll) score += 1;
  if(justif) score += 1;
  if(vocab) score += 1;
  state.ex6.score = score;

  if(score===4){
    showFb("fb6","good",`‚úÖ <b>4/4</b> ¬∑ Tr√®s bonne proposition + justification. Tu utilises le vocabulaire du cours.`);
  }else if(score>=2){
    showFb("fb6","warn",`üü° <b>${score}/4</b> ¬∑ Correct. Pour monter : ajoute <b>1 mesure individuelle</b> + <b>1 collective</b> + <b>1 argument</b> (dur√©e d‚Äôexposition, seuil‚Ä¶).`);
  }else{
    showFb("fb6","bad",`‚ùå <b>${score}/4</b> ¬∑ √Ä renforcer : propose 1 mesure individuelle + 1 collective et justifie (ex : seuil 80 dB(A) sur 8 h).`);
  }
  setScoreUI(); saveSilent();
}
function resetEx6(){
  document.getElementById("ex6txt").value = "";
  state.ex6.score = 0;
  hideFb("fb6");
  setScoreUI(); saveSilent();
}

/* init */
buildDnD();
setScoreUI();
</script>
</body>
</html>
