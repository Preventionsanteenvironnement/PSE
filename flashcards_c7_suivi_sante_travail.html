<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©vision C.7 - Le Suivi de la Sant√© au Travail - Bac Pro Terminale</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .btn-back {
            background: rgba(255,255,255,0.1);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.2);
            cursor: pointer;
        }
        
        .btn-back:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .score-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 50px;
        }
        
        .score-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .score-item .icon {
            font-size: 18px;
        }
        
        /* √âcrans */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* EN-T√äTE P√âDAGOGIQUE */
        .cadre-pedagogique {
            background: linear-gradient(135deg, #2E86AB 0%, #A23B72 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .module-info h2 {
            font-size: 1.8rem;
            margin-bottom: 15px;
        }
        
        .objectif {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
        }
        
        .competences-travaillees {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
        }
        
        .competences-list {
            list-style: none;
            padding: 0;
            text-align: left;
        }
        
        .competences-list li {
            margin-bottom: 8px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            font-size: 0.95rem;
        }
        
        .niveau-cible {
            font-weight: bold;
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 8px;
        }
        
        /* √âcran d'accueil */
        .welcome-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .welcome-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ff9a9e, #fecfef, #fecfef);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 30px;
        }
        
        /* Objectifs */
        .objectifs-card {
            background: linear-gradient(135deg, rgba(255, 154, 158, 0.3), rgba(254, 207, 239, 0.3));
            border: 2px solid rgba(255, 154, 158, 0.5);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: left;
        }
        
        .objectifs-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .objectif-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
            line-height: 1.5;
        }
        
        .objectif-item:last-child {
            border-bottom: none;
        }
        
        .objectif-item .check {
            color: #4CAF50;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .competences-row {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .comp-badge {
            background: rgba(255,255,255,0.15);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .comp-badge.c1 { background: rgba(16, 185, 129, 0.3); border: 1px solid #10b981; }
        .comp-badge.c2 { background: rgba(102, 126, 234, 0.3); border: 1px solid #667eea; }
        .comp-badge.c3 { background: rgba(245, 158, 11, 0.3); border: 1px solid #f59e0b; }
        .comp-badge.c4 { background: rgba(239, 68, 68, 0.3); border: 1px solid #ef4444; }
        .comp-badge.c5 { background: rgba(168, 85, 247, 0.3); border: 1px solid #a855f7; }
        .comp-badge.c6 { background: rgba(34, 197, 94, 0.3); border: 1px solid #22c55e; }
        
        /* Niveaux */
        .niveaux-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .niveau-card {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .niveau-card:hover:not(.locked) {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
            border-color: rgba(255, 154, 158, 0.5);
        }
        
        .niveau-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .niveau-card.completed {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }
        
        .niveau-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }
        
        .niveau-info {
            flex: 1;
        }
        
        .niveau-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .niveau-desc {
            font-size: 14px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 8px;
        }
        
        .niveau-progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-bar {
            flex: 1;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #81C784);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .progress-text {
            font-size: 12px;
            font-weight: 600;
        }
        
        /* √âcran de jeu */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            gap: 10px;
        }
        
        .level-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .level-badge {
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .card-counter {
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }
        
        /* Carte de flashcard */
        .flashcard {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            text-align: center;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            animation: slideInUp 0.5s ease;
        }
        
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card-type-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-keyword { background: rgba(76, 175, 80, 0.3); color: #4CAF50; }
        .badge-qcm { background: rgba(33, 150, 243, 0.3); color: #2196F3; }
        .badge-vf { background: rgba(255, 152, 0, 0.3); color: #FF9800; }
        
        .keyword-display {
            font-size: 36px;
            font-weight: 900;
            margin-bottom: 20px;
            color: #ff9a9e;
        }
        
        .question-text {
            font-size: 18px;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        
        .answer-input {
            width: 100%;
            max-width: 400px;
            padding: 15px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 16px;
            text-align: center;
            margin: 0 auto 20px;
        }
        
        .answer-input::placeholder {
            color: rgba(255,255,255,0.5);
        }
        
        .answer-input:focus {
            outline: none;
            border-color: #ff9a9e;
        }
        
        /* Options QCM */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .option-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            color: white;
            font-size: 14px;
        }
        
        .option-btn:hover {
            background: rgba(255,255,255,0.2);
            border-color: #ff9a9e;
        }
        
        .option-btn.selected {
            background: rgba(255, 154, 158, 0.3);
            border-color: #ff9a9e;
        }
        
        .option-letter {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }
        
        /* Vrai/Faux */
        .vf-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .vf-btn {
            padding: 15px 30px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .vf-btn.vrai:hover { border-color: #4CAF50; background: rgba(76, 175, 80, 0.2); }
        .vf-btn.faux:hover { border-color: #f44336; background: rgba(244, 67, 54, 0.2); }
        .vf-btn.selected.vrai { background: rgba(76, 175, 80, 0.3); border-color: #4CAF50; }
        .vf-btn.selected.faux { background: rgba(244, 67, 54, 0.3); border-color: #f44336; }
        
        /* Contr√¥les de carte */
        .card-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 154, 158, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }
        
        /* Indice */
        .hint-section {
            text-align: center;
            margin: 20px 0;
        }
        
        .hint-text {
            background: rgba(255, 193, 7, 0.2);
            border: 2px solid rgba(255, 193, 7, 0.5);
            border-radius: 10px;
            padding: 15px;
            font-style: italic;
            display: none;
        }
        
        /* Overlay de feedback */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .feedback-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .feedback-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            color: #333;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }
        
        .feedback-overlay.visible .feedback-card {
            transform: scale(1);
        }
        
        .feedback-card.correct {
            border: 3px solid #4CAF50;
        }
        
        .feedback-card.incorrect {
            border: 3px solid #f44336;
        }
        
        .feedback-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        
        .feedback-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .feedback-points {
            font-size: 18px;
            font-weight: 600;
            color: #4CAF50;
            margin-bottom: 20px;
        }
        
        .feedback-explanation {
            text-align: left;
        }
        
        .feedback-explanation h4 {
            margin-bottom: 10px;
            color: #2E86AB;
        }
        
        .keyword-box {
            background: #E3F2FD;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 600;
            color: #1976D2;
        }
        
        .tip-box {
            background: #FFF3E0;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .tip-box h5 {
            color: #F57C00;
            margin-bottom: 8px;
        }
        
        /* √âcran de r√©sultats */
        .results-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .results-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }
        
        .results-title {
            font-size: 32px;
            font-weight: 900;
            margin-bottom: 15px;
        }
        
        .results-score {
            font-size: 48px;
            font-weight: 900;
            color: #ff9a9e;
            margin-bottom: 20px;
        }
        
        .results-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px 10px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            color: rgba(255,255,255,0.7);
        }
        
        .errors-recap {
            background: rgba(244, 67, 54, 0.1);
            border: 2px solid rgba(244, 67, 54, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }
        
        .errors-recap h4 {
            color: #f44336;
            margin-bottom: 10px;
        }
        
        .errors-recap ul {
            list-style: none;
            padding: 0;
        }
        
        .errors-recap li {
            padding: 5px 0;
            border-bottom: 1px solid rgba(244, 67, 54, 0.2);
        }
        
        /* Animations */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: confetti-fall 3s linear forwards;
            z-index: 1001;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        .streak-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
            padding: 20px 30px;
            border-radius: 50px;
            font-size: 20px;
            font-weight: 900;
            z-index: 1002;
            display: none;
            animation: streakPop 1.5s ease;
        }
        
        @keyframes streakPop {
            0% { transform: translate(-50%, -50%) scale(0); }
            20% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .welcome-title {
                font-size: 32px;
            }
            
            .flashcard {
                padding: 20px;
                min-height: 250px;
            }
            
            .keyword-display {
                font-size: 28px;
            }
            
            .question-text {
                font-size: 16px;
            }
            
            .vf-container {
                flex-direction: column;
                align-items: center;
            }
            
            .results-score {
                font-size: 36px;
            }
        }
        
        /* Footer RGPD */
        .rgpd-notice {
            text-align: center;
            padding: 15px;
            margin-top: 30px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            color: rgba(255,255,255,0.6);
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- EN-T√äTE P√âDAGOGIQUE -->
        <div class="cadre-pedagogique">
            <div class="module-info">
                <h2>Module C.7 : Le suivi de la sant√© au travail</h2>
                <div class="objectif">
                    <strong>Objectif :</strong> Appr√©hender l'importance de la surveillance m√©dicale et des vaccinations obligatoires en milieu professionnel.
                </div>
            </div>
            
            <div class="competences-travaillees">
                <h3>Comp√©tences travaill√©es :</h3>
                <ul class="competences-list">
                    <li><strong>C1</strong> - Traiter une information</li>
                    <li><strong>C3</strong> - Expliquer un ph√©nom√®ne physiologique en lien avec une mesure de pr√©vention</li>
                    <li><strong>C6</strong> - Communiquer √† l'√©crit et √† l'oral avec une syntaxe claire et un vocabulaire adapt√©</li>
                </ul>
            </div>
            
            <div class="niveau-cible">
                <strong>Niveau :</strong> Terminale Bac Pro
            </div>
        </div>
        
        <!-- Header avec scores -->
        <div class="header">
            <button class="btn-back" onclick="goHome()">‚Üê Retour</button>
            <div class="score-bar">
                <div class="score-item">
                    <span class="icon">üíé</span>
                    <span id="totalPoints">0</span>
                </div>
                <div class="score-item">
                    <span class="icon">üî•</span>
                    <span id="currentStreak">0</span>
                </div>
            </div>
        </div>
        
        <!-- √âcran d'accueil -->
        <div class="screen active" id="homeScreen">
            <div class="welcome-screen">
                <h1 class="welcome-title">üè• FLASHCARDS C.7</h1>
                <p class="welcome-subtitle">Suivi de la sant√© au travail</p>
                
                <div class="objectifs-card">
                    <h3>üéØ Ce que tu vas r√©viser</h3>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Surveillance m√©dicale des salari√©s (VIP, EMA, types de suivi)</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Vaccinations obligatoires en milieu professionnel</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>D√©fenses immunitaires et m√©canismes de vaccination</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Vocabulaire technique PSE du module</span>
                    </div>
                    
                    <div class="competences-row">
                        <span class="comp-badge c1">C1</span>
                        <span class="comp-badge c3">C3</span>
                        <span class="comp-badge c6">C6</span>
                    </div>
                </div>
                
                <div class="niveaux-grid">
                    <div class="niveau-card" onclick="startLevel(1)">
                        <div class="niveau-icon">üè•</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 1 - Suivi m√©dical</div>
                            <div class="niveau-desc">VIP, EMA et types de suivi des salari√©s</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level1Bar" style="width: 0%"></div>
                                </div>
                                <span class="progress-text" id="level1Percent">0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(2)">
                        <div class="niveau-icon">üíâ</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 2 - Vaccinations</div>
                            <div class="niveau-desc">Vaccins obligatoires par secteur professionnel</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level2Bar" style="width: 0%"></div>
                                </div>
                                <span class="progress-text" id="level2Percent">0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(3)">
                        <div class="niveau-icon">üõ°Ô∏è</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 3 - D√©fenses immunitaires</div>
                            <div class="niveau-desc">3 lignes de d√©fense et immunit√© sp√©cifique</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level3Bar" style="width: 0%"></div>
                                </div>
                                <span class="progress-text" id="level3Percent">0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(4)">
                        <div class="niveau-icon">üß¨</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 4 - M√©canismes</div>
                            <div class="niveau-desc">Vaccination, anticorps et m√©moire immunitaire</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level4Bar" style="width: 0%"></div>
                                </div>
                                <span class="progress-text" id="level4Percent">0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(5)">
                        <div class="niveau-icon">üéì</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 5 - R√©vision BAC</div>
                            <div class="niveau-desc">Questions type examen et synth√®se</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level5Bar" style="width: 0%"></div>
                                </div>
                                <span class="progress-text" id="level5Percent">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- √âcran de jeu -->
        <div class="screen" id="gameScreen">
            <div class="game-header">
                <div class="level-info">
                    <div class="level-badge" id="levelBadge">Niveau 1</div>
                </div>
                <div class="card-counter" id="cardCounter">1/10</div>
            </div>
            
            <div class="flashcard" id="flashcard">
                <div class="card-type-badge badge-keyword" id="cardTypeBadge">MOT-CL√â</div>
                <div id="cardContent"></div>
            </div>
            
            <div class="card-controls">
                <button class="btn btn-secondary" id="hintBtn" onclick="showHint()">üí° Indice</button>
                <button class="btn btn-primary" onclick="validateAnswer()">‚úì Valider</button>
            </div>
            
            <div class="hint-section">
                <div class="hint-text" id="hintText"></div>
            </div>
        </div>
        
        <!-- √âcran de r√©sultats -->
        <div class="screen" id="resultsScreen">
            <div class="results-screen">
                <div class="results-icon" id="resultsIcon">üéâ</div>
                <h2 class="results-title" id="resultsTitle">Niveau r√©ussi !</h2>
                <div class="results-score" id="resultsScore">100%</div>
                
                <div class="results-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="correctCount">10/10</div>
                        <div class="stat-label">Bonnes r√©ponses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="pointsEarned">+100</div>
                        <div class="stat-label">Points gagn√©s</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="bestStreak">10</div>
                        <div class="stat-label">Meilleure s√©rie</div>
                    </div>
                </div>
                
                <div class="errors-recap" id="errorsRecap" style="display: none;">
                    <h4>üìù Points √† revoir</h4>
                    <ul id="errorsList"></ul>
                </div>
                
                <div class="card-controls">
                    <button class="btn btn-secondary" onclick="goHome()">‚Üê Accueil</button>
                    <button class="btn btn-primary" id="nextLevelBtn" onclick="nextLevel()">Niveau suivant ‚Üí</button>
                </div>
            </div>
        </div>
        
        <!-- Overlay de feedback -->
        <div class="feedback-overlay" id="feedbackOverlay">
            <div class="feedback-card" id="feedbackCard">
                <div class="feedback-icon" id="feedbackIcon">‚úÖ</div>
                <h3 class="feedback-title" id="feedbackTitle">Bravo !</h3>
                <div class="feedback-points" id="feedbackPoints">+10 points</div>
                <div class="feedback-explanation" id="feedbackExplanation"></div>
                <button class="btn btn-primary" onclick="nextCard()" style="margin-top: 20px;">Continuer</button>
            </div>
        </div>
        
        <!-- Popup streak -->
        <div class="streak-popup" id="streakPopup"></div>
        
        <!-- Footer RGPD -->
        <div class="rgpd-notice">
            üîí Conformit√© RGPD : Cet exercice respecte votre anonymat.
        </div>
    </div>
    
    <script>
        // Donn√©es des niveaux et cartes
        const levels = {
            1: {
                title: "Suivi m√©dical",
                icon: "üè•",
                cards: [
                    {
                        type: "keyword",
                        keyword: "VIP",
                        question: "Que signifie VIP dans le suivi m√©dical ?",
                        answer: "Visite d'Information et de Pr√©vention",
                        explanation: "La VIP concerne les salari√©s sans risques particuliers. Elle doit avoir lieu dans les 3 mois apr√®s l'embauche.",
                        hint: "C'est pour informer et pr√©venir...",
                        tip: "Retiens : VIP = pas de risques particuliers, dans les 3 mois"
                    },
                    {
                        type: "keyword",
                        keyword: "EMA",
                        question: "Que signifie EMA dans le suivi m√©dical ?",
                        answer: "Examen M√©dical d'Aptitude",
                        explanation: "L'EMA concerne les salari√©s expos√©s √† des risques particuliers. Il doit avoir lieu AVANT la prise de poste.",
                        hint: "C'est un examen pour v√©rifier l'aptitude...",
                        tip: "Retiens : EMA = risques particuliers, AVANT le poste"
                    },
                    {
                        type: "qcm",
                        question: "Quel est le d√©lai pour une VIP apr√®s l'embauche ?",
                        options: [
                            "Dans le mois suivant l'embauche",
                            "Dans les 3 mois suivant l'embauche",
                            "Avant la prise de poste",
                            "Dans les 6 mois suivant l'embauche"
                        ],
                        answer: 1,
                        keyword: "D√©lai VIP",
                        explanation: "La VIP doit √™tre r√©alis√©e dans les 3 mois suivant l'embauche pour les postes sans risques particuliers.",
                        hint: "C'est plus long qu'un mois mais moins que 6 mois..."
                    },
                    {
                        type: "vf",
                        question: "L'EMA doit obligatoirement avoir lieu AVANT la prise de poste.",
                        answer: true,
                        keyword: "Timing EMA",
                        explanation: "VRAI. L'EMA doit imp√©rativement avoir lieu avant la prise de poste car il √©value l'aptitude du salari√© √† occuper le poste √† risques.",
                        hint: "R√©fl√©chis √† la logique : peut-on mettre quelqu'un √† un poste dangereux sans v√©rifier avant ?"
                    },
                    {
                        type: "keyword",
                        keyword: "Suivi adapt√©",
                        question: "Citez 3 cat√©gories de salari√©s b√©n√©ficiant d'un suivi adapt√©",
                        answer: "travailleurs handicap√©s, mineurs, agents biologiques groupe 2",
                        explanation: "Le suivi adapt√© concerne : travailleurs handicap√©s, mineurs, femmes enceintes/allaitantes, agents biologiques groupe 2.",
                        hint: "Pense aux personnes vuln√©rables et aux risques mod√©r√©s...",
                        tip: "Retiens : handicap + √¢ge + biologie groupe 2"
                    },
                    {
                        type: "qcm",
                        question: "Quelle est la p√©riodicit√© maximale du suivi simple ?",
                        options: [
                            "Tous les ans",
                            "Tous les 2 ans", 
                            "Tous les 5 ans",
                            "Tous les 10 ans"
                        ],
                        answer: 2,
                        keyword: "P√©riodicit√© suivi simple",
                        explanation: "Le suivi simple a une p√©riodicit√© maximale de 5 ans (sauf cas particuliers).",
                        hint: "C'est la p√©riodicit√© la plus longue..."
                    },
                    {
                        type: "keyword",
                        keyword: "Suivi renforc√©",
                        question: "Donnez 2 exemples de situations n√©cessitant un suivi renforc√©",
                        answer: "agents CMR, agents biologiques groupes 3-4",
                        explanation: "Le suivi renforc√© concerne : agents CMR, agents biologiques groupes 3-4, rayonnements ionisants, hyperbare, √©chafaudages...",
                        hint: "Pense aux risques les plus graves...",
                        tip: "Retiens : CMR + bio 3-4 + rayons + hyperbare"
                    },
                    {
                        type: "vf",
                        question: "Un mineur peut b√©n√©ficier d'un suivi simple.",
                        answer: false,
                        keyword: "Suivi mineur",
                        explanation: "FAUX. Les mineurs b√©n√©ficient automatiquement d'un suivi adapt√© en raison de leur vuln√©rabilit√©.",
                        hint: "Les mineurs sont-ils consid√©r√©s comme des salari√©s ordinaires ?"
                    },
                    {
                        type: "qcm",
                        question: "Qui r√©alise les visites m√©dicales au travail ?",
                        options: [
                            "Le m√©decin traitant",
                            "Le m√©decin du travail",
                            "Un infirmier dipl√¥m√© d'√âtat",
                            "Le responsable RH"
                        ],
                        answer: 1,
                        keyword: "M√©decin du travail",
                        explanation: "Seul le m√©decin du travail est habilit√© √† r√©aliser les visites m√©dicales professionnelles et √† d√©livrer les avis d'aptitude.",
                        hint: "C'est un m√©decin sp√©cialis√© dans un domaine pr√©cis..."
                    },
                    {
                        type: "keyword",
                        keyword: "Avis d'inaptitude",
                        question: "Que doit faire l'employeur en cas d'avis d'inaptitude ?",
                        answer: "rechercher un reclassement",
                        explanation: "L'employeur doit rechercher des possibilit√©s de reclassement en tenant compte des conclusions du m√©decin du travail.",
                        hint: "L'employeur ne peut pas licencier directement...",
                        tip: "Retiens : inaptitude = obligation de reclassement"
                    }
                ]
            },
            2: {
                title: "Vaccinations",
                icon: "üíâ",
                cards: [
                    {
                        type: "keyword",
                        keyword: "DTP",
                        question: "Que signifie DTP en vaccination ?",
                        answer: "Dipht√©rie T√©tanos Poliomy√©lite",
                        explanation: "Le DTP est le vaccin de base obligatoire pour tous, combinant trois valences essentielles.",
                        hint: "Trois maladies dont une paralysante...",
                        tip: "Retiens : D-T-P = 3 maladies graves"
                    },
                    {
                        type: "vf",
                        question: "Le vaccin h√©patite B est obligatoire pour tous les professionnels de sant√©.",
                        answer: true,
                        keyword: "H√©patite B obligatoire",
                        explanation: "VRAI. L'h√©patite B est obligatoire pour tous les professionnels expos√©s aux liquides biologiques (sant√©, laboratoires).",
                        hint: "Les soignants sont-ils expos√©s au sang ?"
                    },
                    {
                        type: "qcm",
                        question: "Dans quel secteur la vaccination antigrippale est-elle recommand√©e ?",
                        options: [
                            "BTP et construction",
                            "Sant√© et personnes √¢g√©es",
                            "Agriculture et √©levage",
                            "Transport et logistique"
                        ],
                        answer: 1,
                        keyword: "Grippe secteur",
                        explanation: "La vaccination antigrippale est fortement recommand√©e dans le secteur de la sant√© et aupr√®s des personnes √¢g√©es.",
                        hint: "O√π y a-t-il des personnes fragiles ?"
                    },
                    {
                        type: "keyword",
                        keyword: "ROR",
                        question: "Que signifie ROR en vaccination ?",
                        answer: "Rougeole Oreillons Rub√©ole",
                        explanation: "Le ROR prot√®ge contre trois maladies virales. Il est recommand√© pour les professionnels de la petite enfance.",
                        hint: "Trois maladies qui font des boutons ou des gonflements...",
                        tip: "Retiens : ROR = 3 virus, petite enfance"
                    },
                    {
                        type: "vf",
                        question: "Les vaccinations professionnelles sont √† la charge de l'employeur.",
                        answer: true,
                        keyword: "Co√ªt vaccinations",
                        explanation: "VRAI. Les vaccinations rendues obligatoires par l'emploi sont int√©gralement √† la charge de l'employeur.",
                        hint: "Si c'est obligatoire pour le travail, qui doit payer ?"
                    },
                    {
                        type: "keyword",
                        keyword: "Coqueluche",
                        question: "Pour quels professionnels le vaccin coqueluche est-il recommand√© ?",
                        answer: "petite enfance",
                        explanation: "Le vaccin coqueluche est recommand√© pour les professionnels travaillant avec de jeunes enfants (cr√®ches, √©coles).",
                        hint: "Cette maladie est dangereuse pour les tr√®s jeunes...",
                        tip: "Retiens : coqueluche = protection des b√©b√©s"
                    },
                    {
                        type: "qcm",
                        question: "Quelle est la dur√©e de protection du vaccin DTP ?",
                        options: [
                            "1 √† 2 ans",
                            "5 ans",
                            "10 ans",
                            "√Ä vie"
                        ],
                        answer: 2,
                        keyword: "Dur√©e DTP",
                        explanation: "Le vaccin DTP n√©cessite un rappel tous les 10 ans pour maintenir une protection efficace.",
                        hint: "C'est une d√©cennie..."
                    },
                    {
                        type: "vf",
                        question: "Un salari√© peut refuser une vaccination obligatoire pour son poste.",
                        answer: false,
                        keyword: "Refus vaccination",
                        explanation: "FAUX. Si la vaccination est obligatoire pour le poste, le refus peut entra√Æner l'impossibilit√© d'exercer.",
                        hint: "Si c'est 'obligatoire', peut-on refuser ?"
                    },
                    {
                        type: "keyword",
                        keyword: "Immunit√© collective",
                        question: "Quel est le principe de l'immunit√© collective ?",
                        answer: "protection du groupe par vaccination majoritaire",
                        explanation: "L'immunit√© collective prot√®ge l'ensemble du groupe quand un pourcentage suffisant est vaccin√© (g√©n√©ralement 80-95%).",
                        hint: "Quand beaucoup sont prot√©g√©s, √ßa prot√®ge aussi les autres...",
                        tip: "Retiens : 80-95% vaccin√©s = protection collective"
                    },
                    {
                        type: "qcm",
                        question: "Qui √©tablit les recommandations vaccinales annuelles ?",
                        options: [
                            "L'employeur",
                            "Le m√©decin du travail",
                            "Le minist√®re de la Sant√©",
                            "La s√©curit√© sociale"
                        ],
                        answer: 2,
                        keyword: "Recommandations vaccinales",
                        explanation: "C'est le minist√®re de la Sant√© qui publie chaque ann√©e les recommandations vaccinales officielles.",
                        hint: "C'est au niveau national..."
                    }
                ]
            },
            3: {
                title: "D√©fenses immunitaires",
                icon: "üõ°Ô∏è",
                cards: [
                    {
                        type: "keyword",
                        keyword: "Premi√®re ligne",
                        question: "Nommez les 3 types de barri√®res de la premi√®re ligne de d√©fense",
                        answer: "physique chimique biologique",
                        explanation: "La premi√®re ligne comprend : barri√®res physiques (peau, muqueuses), chimiques (s√©bum, acidit√©) et biologiques (flores).",
                        hint: "Il y a du m√©canique, du chimique et du vivant...",
                        tip: "Retiens : 3 barri√®res = 3 m√©canismes diff√©rents"
                    },
                    {
                        type: "vf",
                        question: "Les cils vibratiles font partie de la barri√®re chimique.",
                        answer: false,
                        keyword: "Cils vibratiles",
                        explanation: "FAUX. Les cils vibratiles font partie de la barri√®re physique car ils √©vacuent m√©caniquement les particules.",
                        hint: "Les cils bougent, c'est m√©canique ou chimique ?"
                    },
                    {
                        type: "qcm",
                        question: "Combien y a-t-il de signes cardinaux de l'inflammation ?",
                        options: [
                            "2 signes",
                            "3 signes", 
                            "4 signes",
                            "5 signes"
                        ],
                        answer: 2,
                        keyword: "Signes inflammation",
                        explanation: "Il y a 4 signes cardinaux : rougeur, chaleur, gonflement et douleur.",
                        hint: "C'est un chiffre pair..."
                    },
                    {
                        type: "keyword",
                        keyword: "Diap√©d√®se",
                        question: "Que signifie la diap√©d√®se ?",
                        answer: "sortie des globules blancs des vaisseaux",
                        explanation: "La diap√©d√®se permet aux leucocytes de traverser la paroi vasculaire pour rejoindre le site d'infection.",
                        hint: "Les globules blancs doivent sortir de quelque part...",
                        tip: "Retiens : diap√©d√®se = passage √† travers la paroi"
                    },
                    {
                        type: "vf",
                        question: "La phagocytose est un m√©canisme sp√©cifique.",
                        answer: false,
                        keyword: "Phagocytose sp√©cificit√©",
                        explanation: "FAUX. La phagocytose est un m√©canisme non sp√©cifique qui 'avale' tout corps √©tranger sans distinction.",
                        hint: "Un phagocyte fait-il le tri entre les microbes ?"
                    },
                    {
                        type: "keyword",
                        keyword: "Lymphocytes B",
                        question: "Quel est le r√¥le principal des lymphocytes B ?",
                        answer: "production d'anticorps",
                        explanation: "Les lymphocytes B se diff√©rencient en plasmocytes qui produisent des anticorps sp√©cifiques.",
                        hint: "Ils fabriquent des mol√©cules de d√©fense...",
                        tip: "Retiens : B comme 'Body' (anticorps)"
                    },
                    {
                        type: "qcm",
                        question: "Quelle ligne de d√©fense fait intervenir la m√©moire immunitaire ?",
                        options: [
                            "Premi√®re ligne",
                            "Deuxi√®me ligne",
                            "Troisi√®me ligne", 
                            "Toutes les lignes"
                        ],
                        answer: 2,
                        keyword: "M√©moire immunitaire",
                        explanation: "Seule la troisi√®me ligne (immunit√© sp√©cifique) poss√®de une m√©moire immunitaire gr√¢ce aux lymphocytes m√©moire.",
                        hint: "C'est la plus sophistiqu√©e..."
                    },
                    {
                        type: "keyword",
                        keyword: "Immunit√© humorale",
                        question: "Qu'est-ce que l'immunit√© humorale ?",
                        answer: "immunit√© par les anticorps",
                        explanation: "L'immunit√© humorale fait intervenir les anticorps circulants produits par les lymphocytes B.",
                        hint: "Elle circule dans les liquides corporels...",
                        tip: "Retiens : humorale = humeurs = liquides = anticorps"
                    },
                    {
                        type: "vf",
                        question: "L'immunit√© cellulaire fait intervenir les lymphocytes T.",
                        answer: true,
                        keyword: "Immunit√© cellulaire",
                        explanation: "VRAI. L'immunit√© cellulaire fait intervenir les lymphocytes T (T4 auxiliaires, T8 cytotoxiques).",
                        hint: "T comme 'Tueur' de cellules..."
                    },
                    {
                        type: "qcm",
                        question: "Quelle est la caract√©ristique principale de la r√©ponse secondaire ?",
                        options: [
                            "Plus lente que la primaire",
                            "Moins efficace",
                            "Plus rapide et plus intense",
                            "Identique √† la primaire"
                        ],
                        answer: 2,
                        keyword: "R√©ponse secondaire",
                        explanation: "La r√©ponse secondaire est plus rapide et plus intense gr√¢ce √† la m√©moire immunitaire.",
                        hint: "Gr√¢ce √† la m√©moire, la deuxi√®me fois c'est..."
                    }
                ]
            },
            4: {
                title: "M√©canismes vaccination",
                icon: "üß¨",
                cards: [
                    {
                        type: "keyword",
                        keyword: "Antig√®ne",
                        question: "Qu'est-ce qu'un antig√®ne ?",
                        answer: "substance d√©clenchant une r√©ponse immunitaire",
                        explanation: "Un antig√®ne est toute substance √©trang√®re capable de d√©clencher une r√©ponse immunitaire sp√©cifique.",
                        hint: "C'est ce qui est reconnu comme 'non-soi'...",
                        tip: "Retiens : antig√®ne = g√©n√©rateur d'anticorps"
                    },
                    {
                        type: "vf",
                        question: "Un vaccin contient des microorganismes vivants et dangereux.",
                        answer: false,
                        keyword: "Composition vaccin",
                        explanation: "FAUX. Un vaccin contient des agents att√©nu√©s, inactiv√©s ou des fragments, jamais des agents dangereux.",
                        hint: "Un vaccin est-il cens√© rendre malade ?"
                    },
                    {
                        type: "qcm",
                        question: "Que contient principalement un vaccin ?",
                        options: [
                            "Des antibiotiques",
                            "Des antig√®nes att√©nu√©s ou inactiv√©s",
                            "Des globules blancs",
                            "Des anticorps tout pr√™ts"
                        ],
                        answer: 1,
                        keyword: "Contenu vaccin",
                        explanation: "Un vaccin contient des antig√®nes (virus/bact√©ries) att√©nu√©s ou inactiv√©s pour stimuler l'immunit√© sans danger.",
                        hint: "Il faut pr√©senter l'ennemi sans danger..."
                    },
                    {
                        type: "keyword",
                        keyword: "Lymphocytes m√©moire",
                        question: "Quel est le r√¥le des lymphocytes m√©moire ?",
                        answer: "garder l'information pour r√©agir rapidement",
                        explanation: "Les lymphocytes m√©moire conservent l'information sur l'antig√®ne pour d√©clencher une r√©ponse rapide lors d'un contact ult√©rieur.",
                        hint: "Ils sont comme un carnet d'adresses...",
                        tip: "Retiens : m√©moire = reconnaissance + r√©action rapide"
                    },
                    {
                        type: "vf",
                        question: "La vaccination cr√©e une immunit√© passive.",
                        answer: false,
                        keyword: "Type immunit√© vaccination",
                        explanation: "FAUX. La vaccination cr√©e une immunit√© active car l'organisme fabrique lui-m√™me ses anticorps.",
                        hint: "L'organisme travaille-t-il ou re√ßoit-il tout fait ?"
                    },
                    {
                        type: "keyword",
                        keyword: "S√©roconversion",
                        question: "Qu'est-ce que la s√©roconversion ?",
                        answer: "apparition d'anticorps dans le sang",
                        explanation: "La s√©roconversion est l'apparition d'anticorps sp√©cifiques d√©tectables dans le s√©rum apr√®s vaccination ou infection.",
                        hint: "Quelque chose appara√Æt dans le s√©rum...",
                        tip: "Retiens : s√©ro = s√©rum, conversion = changement"
                    },
                    {
                        type: "qcm",
                        question: "Combien de temps faut-il environ pour d√©velopper une immunit√© apr√®s vaccination ?",
                        options: [
                            "24 heures",
                            "2-3 semaines",
                            "2 mois",
                            "6 mois"
                        ],
                        answer: 1,
                        keyword: "D√©lai immunit√©",
                        explanation: "Il faut environ 2-3 semaines pour d√©velopper une immunit√© efficace apr√®s vaccination (temps de r√©ponse immunitaire).",
                        hint: "C'est plus qu'une semaine mais moins qu'un mois..."
                    },
                    {
                        type: "vf",
                        question: "Les rappels vaccinaux sont inutiles si on a √©t√© vaccin√© une fois.",
                        answer: false,
                        keyword: "Rappels vaccins",
                        explanation: "FAUX. Les rappels sont essentiels pour entretenir la m√©moire immunitaire et maintenir un niveau de protection efficace.",
                        hint: "La m√©moire peut-elle s'estomper avec le temps ?"
                    },
                    {
                        type: "keyword",
                        keyword: "Adjuvant",
                        question: "Quel est le r√¥le d'un adjuvant dans un vaccin ?",
                        answer: "renforcer la r√©ponse immunitaire",
                        explanation: "Les adjuvants stimulent et renforcent la r√©ponse immunitaire pour am√©liorer l'efficacit√© du vaccin.",
                        hint: "Il aide √† 'doper' la r√©action...",
                        tip: "Retiens : adjuvant = assistant du vaccin"
                    },
                    {
                        type: "qcm",
                        question: "Que se passe-t-il lors d'un contact avec l'agent pathog√®ne apr√®s vaccination ?",
                        options: [
                            "Rien, on est immunis√©",
                            "R√©ponse immunitaire lente comme la premi√®re fois",
                            "R√©ponse immunitaire rapide et efficace",
                            "On tombe malade normalement"
                        ],
                        answer: 2,
                        keyword: "Contact post-vaccination",
                        explanation: "Gr√¢ce √† la m√©moire immunitaire, la r√©ponse est imm√©diate et tr√®s efficace, emp√™chant la maladie.",
                        hint: "La m√©moire permet une r√©action..."
                    }
                ]
            },
            5: {
                title: "R√©vision BAC",
                icon: "üéì",
                cards: [
                    {
                        type: "qcm",
                        question: "Un technicien de laboratoire manipulant des agents biologiques du groupe 3 doit b√©n√©ficier :",
                        options: [
                            "D'une VIP dans les 3 mois",
                            "D'un EMA avant la prise de poste",
                            "D'un suivi simple tous les 5 ans",
                            "D'aucun suivi particulier"
                        ],
                        answer: 1,
                        keyword: "Cas pratique laboratoire",
                        explanation: "Les agents biologiques du groupe 3 n√©cessitent un EMA (examen m√©dical d'aptitude) avant la prise de poste et un suivi renforc√©.",
                        hint: "Groupe 3 = risque √©lev√©..."
                    },
                    {
                        type: "keyword",
                        keyword: "Triple protection",
                        question: "Citez les 3 niveaux de protection apport√©s par la vaccination collective",
                        answer: "individuelle collective communautaire",
                        explanation: "La vaccination prot√®ge l'individu vaccin√©, le collectif de travail et la communaut√© (immunit√© collective).",
                        hint: "De soi vers les autres, de plus en plus large...",
                        tip: "Retiens : 3 cercles concentriques de protection"
                    },
                    {
                        type: "vf",
                        question: "Une aide-soignante en EHPAD peut refuser le vaccin h√©patite B si elle invoque ses convictions personnelles.",
                        answer: false,
                        keyword: "Refus vaccination obligatoire",
                        explanation: "FAUX. Dans le secteur de la sant√©, certaines vaccinations sont obligatoires et conditionnent l'exercice professionnel.",
                        hint: "Obligatoire signifie..."
                    },
                    {
                        type: "qcm",
                        question: "Lors d'une blessure avec un objet souill√©, quelle ligne de d√©fense intervient en premier ?",
                        options: [
                            "La r√©action inflammatoire",
                            "La production d'anticorps",
                            "La barri√®re cutan√©o-muqueuse",
                            "Les lymphocytes T"
                        ],
                        answer: 0,
                        keyword: "Succession d√©fenses",
                        explanation: "La barri√®re cutan√©o-muqueuse √©tant rompue, c'est la r√©action inflammatoire (2√®me ligne) qui intervient imm√©diatement.",
                        hint: "La peau est cass√©e, que se passe-t-il apr√®s ?"
                    },
                    {
                        type: "keyword",
                        keyword: "Analyse de risque",
                        question: "Quels sont les 2 crit√®res pour d√©terminer le type de suivi m√©dical ?",
                        answer: "risques particuliers et vuln√©rabilit√©",
                        explanation: "Le type de suivi d√©pend des risques du poste (agents dangereux, conditions particuli√®res) et de la vuln√©rabilit√© du salari√© (√¢ge, handicap...).",
                        hint: "Il y a le poste ET la personne...",
                        tip: "Retiens : risque du job + fragilit√© de la personne"
                    },
                    {
                        type: "vf",
                        question: "Un rappel de vaccin d√©clenche une r√©ponse immunitaire primaire.",
                        answer: false,
                        keyword: "Rappel vaccinal",
                        explanation: "FAUX. Un rappel d√©clenche une r√©ponse secondaire, plus rapide et plus intense gr√¢ce √† la m√©moire immunitaire.",
                        hint: "C'est la deuxi√®me fois que le syst√®me voit cet antig√®ne..."
                    },
                    {
                        type: "qcm",
                        question: "Pourquoi les professionnels de petite enfance doivent-ils √™tre vaccin√©s contre la coqueluche ?",
                        options: [
                            "Car ils risquent d'attraper la maladie",
                            "Pour prot√©ger les jeunes enfants non encore vaccin√©s",
                            "Car c'est obligatoire par la loi",
                            "Pour √©viter les arr√™ts maladie"
                        ],
                        answer: 1,
                        keyword: "Protection enfants",
                        explanation: "Les tr√®s jeunes enfants ne sont pas encore vaccin√©s et sont vuln√©rables. La vaccination des adultes les prot√®ge.",
                        hint: "Qui prot√®ge-t-on vraiment ?"
                    },
                    {
                        type: "keyword",
                        keyword: "S√©ropositivit√©",
                        question: "Que signifie √™tre s√©ropositif pour l'h√©patite B apr√®s vaccination ?",
                        answer: "pr√©sence d'anticorps protecteurs",
                        explanation: "√ätre s√©ropositif apr√®s vaccination signifie avoir des anticorps protecteurs d√©tectables, donc √™tre immunis√©.",
                        hint: "C'est positif dans le bon sens...",
                        tip: "Retiens : s√©ropositif post-vaccinal = prot√©g√©"
                    },
                    {
                        type: "vf",
                        question: "L'immunit√© collective n√©cessite que 100% de la population soit vaccin√©e.",
                        answer: false,
                        keyword: "Seuil immunit√© collective",
                        explanation: "FAUX. L'immunit√© collective est atteinte avec 80-95% de couverture vaccinale selon les maladies.",
                        hint: "Faut-il vraiment vacciner absolument tout le monde ?"
                    },
                    {
                        type: "qcm",
                        question: "Dans quel cas un salari√© peut-il contester un avis d'inaptitude ?",
                        options: [
                            "Jamais, l'avis est d√©finitif",
                            "Aupr√®s de l'inspecteur du travail dans les 15 jours",
                            "Aupr√®s des prud'hommes dans les 2 mois",
                            "Aupr√®s du m√©decin traitant"
                        ],
                        answer: 1,
                        keyword: "Contestation inaptitude",
                        explanation: "Le salari√© peut contester un avis d'inaptitude aupr√®s de l'inspecteur du travail dans un d√©lai de 15 jours.",
                        hint: "Il y a un recours possible, mais avec un d√©lai court..."
                    }
                ]
            }
        };
        
        // Variables globales
        let currentLevel = 1;
        let currentCardIndex = 0;
        let levelCorrect = 0;
        let levelPoints = 0;
        let levelErrors = [];
        let totalPoints = parseInt(localStorage.getItem('totalPointsC7') || '0');
        let currentStreak = 0;
        let bestStreak = 0;
        let hintUsed = false;
        let levelProgress = JSON.parse(localStorage.getItem('levelProgressC7') || '[0,0,0,0,0,0]');
        
        function startLevel(level) {
            currentLevel = level;
            currentCardIndex = 0;
            levelCorrect = 0;
            levelPoints = 0;
            levelErrors = [];
            bestStreak = 0;
            
            document.getElementById('homeScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');
            
            document.getElementById('levelBadge').textContent = `Niveau ${level} - ${levels[level].title}`;
            
            showCard();
        }
        
        function showCard() {
            const card = levels[currentLevel].cards[currentCardIndex];
            hintUsed = false;
            
            document.getElementById('cardCounter').textContent = `${currentCardIndex + 1}/${levels[currentLevel].cards.length}`;
            document.getElementById('hintText').style.display = 'none';
            
            const cardTypeBadge = document.getElementById('cardTypeBadge');
            const questionSection = document.getElementById('cardContent');
            
            if (card.type === 'keyword') {
                cardTypeBadge.className = 'card-type-badge badge-keyword';
                cardTypeBadge.textContent = 'MOT-CL√â';
                questionSection.innerHTML = `
                    <div class="keyword-display">${card.keyword}</div>
                    <p class="question-text">${card.question}</p>
                    <input type="text" class="answer-input" id="keywordAnswer" placeholder="Tapez votre r√©ponse..." autocomplete="off">
                `;
                
                setTimeout(() => document.getElementById('keywordAnswer').focus(), 100);
                
                document.getElementById('keywordAnswer').addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') validateAnswer();
                });
            }
            else if (card.type === 'qcm') {
                cardTypeBadge.className = 'card-type-badge badge-qcm';
                cardTypeBadge.textContent = 'QCM';
                
                let optionsHTML = card.options.map((opt, i) => `
                    <button class="option-btn" data-index="${i}" onclick="selectOption(this)">
                        <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                        <span>${opt}</span>
                    </button>
                `).join('');
                
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="options-container">${optionsHTML}</div>
                `;
            }
            else if (card.type === 'vf') {
                cardTypeBadge.className = 'card-type-badge badge-vf';
                cardTypeBadge.textContent = 'VRAI/FAUX';
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="vf-container">
                        <button class="vf-btn vrai" onclick="selectVF(this, true)">‚úì VRAI</button>
                        <button class="vf-btn faux" onclick="selectVF(this, false)">‚úó FAUX</button>
                    </div>
                `;
            }
        }
        
        function selectOption(btn) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }
        
        function selectVF(btn, value) {
            document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            btn.dataset.value = value;
        }
        
        function showHint() {
            const card = levels[currentLevel].cards[currentCardIndex];
            if (card.hint) {
                document.getElementById('hintText').innerHTML = `üí° <strong>Indice :</strong> ${card.hint}`;
                document.getElementById('hintText').style.display = 'block';
                hintUsed = true;
            }
        }
        
        function validateAnswer() {
            const card = levels[currentLevel].cards[currentCardIndex];
            let isCorrect = false;
            let userAnswer = '';
            
            if (card.type === 'keyword') {
                userAnswer = document.getElementById('keywordAnswer').value.trim().toLowerCase();
                const normalize = str => str.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
                const normalizedUser = normalize(userAnswer);
                const normalizedAnswer = normalize(card.answer);
                
                isCorrect = normalizedUser.includes(normalizedAnswer) || 
                           normalizedAnswer.includes(normalizedUser) ||
                           normalizedUser === normalizedAnswer;
            }
            else if (card.type === 'qcm') {
                const selected = document.querySelector('.option-btn.selected');
                if (!selected) { alert('S√©lectionne une r√©ponse'); return; }
                userAnswer = parseInt(selected.dataset.index);
                isCorrect = userAnswer === card.answer;
            }
            else if (card.type === 'vf') {
                const selected = document.querySelector('.vf-btn.selected');
                if (!selected) { alert('S√©lectionne VRAI ou FAUX'); return; }
                userAnswer = selected.dataset.value === 'true';
                isCorrect = userAnswer === card.answer;
            }
            
            showFeedback(isCorrect, card);
        }
        
        function showFeedback(isCorrect, card) {
            const overlay = document.getElementById('feedbackOverlay');
            const feedbackCard = document.getElementById('feedbackCard');
            
            let points = 0;
            if (isCorrect) {
                points = hintUsed ? 5 : 10;
                levelCorrect++;
                currentStreak++;
                if (currentStreak > bestStreak) bestStreak = currentStreak;
                
                if (currentStreak === 3) showStreakPopup('üî• 3 de suite !');
                else if (currentStreak === 5) showStreakPopup('üî•üî• 5 de suite !');
                else if (currentStreak === 10) showStreakPopup('üî•üî•üî• INCROYABLE !');
            } else {
                currentStreak = 0;
                levelErrors.push(card.keyword || card.question.replace(/<[^>]*>/g, '').substring(0, 50) + '...');
            }
            
            levelPoints += points;
            totalPoints += points;
            localStorage.setItem('totalPointsC7', totalPoints.toString());
            updateScoreDisplay();
            
            feedbackCard.className = 'feedback-card ' + (isCorrect ? 'correct' : 'incorrect');
            document.getElementById('feedbackIcon').textContent = isCorrect ? '‚úÖ' : '‚ùå';
            document.getElementById('feedbackTitle').textContent = isCorrect ? 
                (currentStreak >= 3 ? 'Excellent ! üî•' : 'Bravo !') : 'Pas tout √† fait...';
            document.getElementById('feedbackPoints').textContent = isCorrect ? `+${points} points` : '0 point';
            document.getElementById('feedbackPoints').style.display = isCorrect ? 'block' : 'none';
            
            document.getElementById('feedbackExplanation').innerHTML = `
                <h4>üìö Explication</h4>
                <p>${card.explanation}</p>
                <div class="keyword-box">üîë <span>${card.keyword}</span></div>
                ${card.tip ? `<div class="tip-box"><h5>üí° Astuce BAC</h5><p>${card.tip}</p></div>` : ''}
            `;
            
            overlay.classList.add('visible');
        }
        
        function showStreakPopup(text) {
            const popup = document.getElementById('streakPopup');
            popup.textContent = text;
            popup.style.display = 'block';
            setTimeout(() => { popup.style.display = 'none'; }, 1500);
        }
        
        function nextCard() {
            document.getElementById('feedbackOverlay').classList.remove('visible');
            currentCardIndex++;
            
            if (currentCardIndex >= levels[currentLevel].cards.length) {
                showResults();
            } else {
                showCard();
            }
        }
        
        function showResults() {
            const total = levels[currentLevel].cards.length;
            const percent = Math.round((levelCorrect / total) * 100);
            
            levelProgress[currentLevel] = Math.max(levelProgress[currentLevel], percent);
            localStorage.setItem('levelProgressC7', JSON.stringify(levelProgress));
            
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');
            
            document.getElementById('resultsIcon').textContent = percent >= 80 ? 'üéâ' : percent >= 50 ? 'üëç' : 'üí™';
            document.getElementById('resultsTitle').textContent = percent >= 80 ? 'Niveau r√©ussi !' : percent >= 50 ? 'Pas mal !' : 'Continue !';
            document.getElementById('resultsScore').textContent = percent + '%';
            document.getElementById('correctCount').textContent = levelCorrect + '/' + total;
            document.getElementById('pointsEarned').textContent = '+' + levelPoints;
            document.getElementById('bestStreak').textContent = bestStreak;
            
            const errorsRecap = document.getElementById('errorsRecap');
            if (levelErrors.length > 0) {
                errorsRecap.style.display = 'block';
                document.getElementById('errorsList').innerHTML = levelErrors.map(e => `<li>${e}</li>`).join('');
            } else {
                errorsRecap.style.display = 'none';
            }
            
            if (percent >= 80) {
                createConfetti();
            }
            
            document.getElementById('nextLevelBtn').style.display = (currentLevel < 5 && percent >= 60) ? 'block' : 'none';
            
            updateHomeProgress();
        }
        
        function createConfetti() {
            const colors = ['#ff9a9e', '#fecfef', '#ffd1ff', '#84fab0', '#8fd3f4', '#FFD700'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }
        
        function goHome() {
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('homeScreen').classList.add('active');
            updateHomeProgress();
        }
        
        function nextLevel() {
            if (currentLevel < 5) {
                startLevel(currentLevel + 1);
                document.getElementById('resultsScreen').classList.remove('active');
            }
        }
        
        function updateScoreDisplay() {
            document.getElementById('totalPoints').textContent = totalPoints;
            document.getElementById('currentStreak').textContent = currentStreak;
        }
        
        function updateHomeProgress() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`level${i}Percent`).textContent = levelProgress[i] + '%';
                document.getElementById(`level${i}Bar`).style.width = levelProgress[i] + '%';
            }
        }
        
        // Initialisation
        updateScoreDisplay();
        updateHomeProgress();
    </script>
</body>
</html>