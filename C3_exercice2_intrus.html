<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module C3 ‚Äì Jeu de l'Intrus</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #1e293b;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #7c3aed 0%, #4c1d95 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container { max-width: 900px; margin: 0 auto; }
        
        .source-banner {
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .source-banner a { color: rgba(255,255,255,0.9); font-size: 11px; text-decoration: none; }
        
        .header {
            background: white;
            border-radius: 20px;
            padding: 20px 25px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .header h1 { font-size: 24px; color: var(--dark); margin-bottom: 5px; }
        .header p { font-size: 13px; color: #64748b; }
        
        .objectif-box {
            background: linear-gradient(135deg, #ede9fe, #ddd6fe);
            border-left: 4px solid #7c3aed;
            padding: 12px 18px;
            border-radius: 0 10px 10px 0;
            margin-top: 15px;
            text-align: left;
        }
        
        .objectif-box strong { color: #7c3aed; font-size: 11px; }
        .objectif-box p { font-size: 13px; margin-top: 5px; }
        
        .game-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat {
            background: white;
            padding: 15px 25px;
            border-radius: 15px;
            text-align: center;
            min-width: 100px;
        }
        
        .stat .value { font-size: 28px; font-weight: 800; color: var(--primary); }
        .stat .label { font-size: 11px; color: #64748b; }
        
        .progress-bar {
            background: rgba(255,255,255,0.2);
            height: 10px;
            border-radius: 10px;
            margin-bottom: 25px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .game-card {
            background: white;
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
        }
        
        .question-header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .question-header .round {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            color: white;
            padding: 5px 20px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .question-header h2 {
            font-size: 20px;
            color: var(--dark);
        }
        
        .question-header .hint {
            font-size: 13px;
            color: #64748b;
            margin-top: 8px;
        }
        
        .picto-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .picto-option {
            background: #f8fafc;
            border: 4px solid #e2e8f0;
            border-radius: 20px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .picto-option:hover:not(.disabled) {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .picto-option img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 10px;
        }
        
        .picto-option .name {
            font-size: 11px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .picto-option.correct {
            border-color: var(--success);
            background: #dcfce7;
        }
        
        .picto-option.wrong {
            border-color: var(--danger);
            background: #fee2e2;
        }
        
        .picto-option.highlight {
            border-color: #fbbf24;
            background: #fef3c7;
        }
        
        .picto-option.disabled {
            cursor: default;
            opacity: 0.7;
        }
        
        .feedback-box {
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            display: none;
            margin-bottom: 20px;
        }
        
        .feedback-box.show { display: block; animation: fadeIn 0.4s ease; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .feedback-box.success { background: #dcfce7; border: 2px solid var(--success); }
        .feedback-box.error { background: #fee2e2; border: 2px solid var(--danger); }
        
        .feedback-box h3 { font-size: 20px; margin-bottom: 8px; }
        .feedback-box.success h3 { color: #166534; }
        .feedback-box.error h3 { color: #991b1b; }
        
        .feedback-box p { font-size: 13px; color: #475569; }
        
        .btn-next {
            display: block;
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            color: white;
            font-family: inherit;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-next:hover { transform: translateY(-2px); }
        .btn-next:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        
        /* Intro & Results */
        .screen { display: none; }
        .screen.active { display: block; }
        
        .intro-card, .results-card {
            background: white;
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            max-width: 600px;
            margin: 30px auto;
        }
        
        .intro-card h2, .results-card h2 { font-size: 28px; margin-bottom: 15px; }
        .intro-card p { color: #64748b; margin-bottom: 20px; }
        
        .example-box {
            background: #f8fafc;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }
        
        .example-box h4 { font-size: 14px; color: var(--primary); margin-bottom: 15px; }
        
        .example-row {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .example-picto {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }
        
        .example-picto.blue { background: #dbeafe; }
        .example-picto.red { background: #fee2e2; border: 3px solid #ef4444; }
        
        .example-text { font-size: 13px; color: #475569; flex: 1; }
        
        .btn-start {
            padding: 18px 50px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, #7c3aed, #5b21b6);
            color: white;
            font-family: inherit;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }
        
        .btn-start:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(124, 58, 237, 0.4); }
        
        .results-card .trophy { font-size: 80px; margin-bottom: 20px; }
        
        .results-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 25px 0;
        }
        
        .results-stats .stat .val { font-size: 36px; font-weight: 800; color: #7c3aed; }
        .results-stats .stat .lbl { font-size: 12px; color: #64748b; }
        
        @media (max-width: 600px) {
            .picto-grid { grid-template-columns: repeat(2, 1fr); }
            .picto-option img { width: 60px; height: 60px; }
        }
    </style>
</head>
<body>
    
    <div class="container">
        
        <div class="source-banner">
            <a href="https://www.inrs.fr" target="_blank">üìö Source : INRS ‚Äì Institut National de Recherche et de S√©curit√© ‚Äì www.inrs.fr</a>
        </div>
        
        <!-- Intro -->
        <div class="screen active" id="intro-screen">
            <div class="intro-card">
                <h2>üîç Trouve l'Intrus !</h2>
                <p>Parmi 4 pictogrammes, un seul n'appartient pas √† la m√™me famille. Sauras-tu le rep√©rer ?</p>
                
                <div class="objectif-box">
                    <strong>üéØ OBJECTIF</strong>
                    <p>√ätre capable de <strong>distinguer</strong> les diff√©rentes cat√©gories de pictogrammes par leur forme et leur couleur.</p>
                </div>
                
                <div class="example-box">
                    <h4>üí° Exemple :</h4>
                    <div class="example-row">
                        <div class="example-picto blue">üîµ</div>
                        <div class="example-picto blue">üîµ</div>
                        <div class="example-picto blue">üîµ</div>
                        <div class="example-picto red">üî¥</div>
                        <div class="example-text">
                            Le pictogramme <strong>rouge (interdiction)</strong> est l'intrus parmi les <strong>bleus (obligation)</strong>.
                        </div>
                    </div>
                </div>
                
                <button class="btn-start" onclick="startGame()">C'est parti ! üöÄ</button>
            </div>
        </div>
        
        <!-- Game -->
        <div class="screen" id="game-screen">
            <div class="header">
                <h1>üîç Trouve l'Intrus</h1>
                <p>Module C3 ‚Äì Quel pictogramme n'appartient pas √† la m√™me famille ?</p>
            </div>
            
            <div class="game-stats">
                <div class="stat">
                    <div class="value" id="score">0</div>
                    <div class="label">Points</div>
                </div>
                <div class="stat">
                    <div class="value" id="round">1/10</div>
                    <div class="label">Manche</div>
                </div>
                <div class="stat">
                    <div class="value" id="streak">0</div>
                    <div class="label">S√©rie üî•</div>
                </div>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progress" style="width: 10%;"></div>
            </div>
            
            <div class="game-card">
                <div class="question-header">
                    <span class="round" id="category-hint">Cat√©gorie : Obligation</span>
                    <h2>Trouve l'intrus parmi ces pictogrammes !</h2>
                    <p class="hint">3 pictogrammes appartiennent √† la m√™me famille, 1 est diff√©rent.</p>
                </div>
                
                <div class="picto-grid" id="picto-grid"></div>
                
                <div class="feedback-box" id="feedback">
                    <h3 id="feedback-title"></h3>
                    <p id="feedback-text"></p>
                </div>
                
                <button class="btn-next" id="btn-next" onclick="nextRound()" disabled>
                    Question suivante ‚Üí
                </button>
            </div>
        </div>
        
        <!-- Results -->
        <div class="screen" id="results-screen">
            <div class="results-card">
                <div class="trophy" id="trophy">üèÜ</div>
                <h2 id="results-title">Bravo !</h2>
                <p id="results-msg">Tu as un ≈ìil de lynx !</p>
                
                <div class="results-stats">
                    <div class="stat">
                        <div class="val" id="final-score">0</div>
                        <div class="lbl">Points</div>
                    </div>
                    <div class="stat">
                        <div class="val" id="final-correct">0/10</div>
                        <div class="lbl">Trouv√©s</div>
                    </div>
                    <div class="stat">
                        <div class="val" id="final-streak">0</div>
                        <div class="lbl">Meilleure s√©rie</div>
                    </div>
                </div>
                
                <button class="btn-start" onclick="restartGame()">üîÑ Rejouer</button>
            </div>
        </div>
        
    </div>
    
    <script>
        const categories = {
            obligation: {
                name: "Obligation",
                color: "#0ea5e9",
                items: [
                    { name: "Port des gants", image: "pictogrammes/images/OBLIGATION-gants.jpg" },
                    { name: "Port du casque", image: "pictogrammes/images/OBLIGATION-casque.jpg" },
                    { name: "Chaussures de s√©curit√©", image: "pictogrammes/images/OBLIGATION-chaussures.jpg" },
                    { name: "Lunettes de protection", image: "pictogrammes/images/OBLIGATION-lunettes.jpg" },
                    { name: "Protection auditive", image: "pictogrammes/images/OBLIGATION-casque-antibruit.jpg" },
                    { name: "Protection respiratoire", image: "pictogrammes/images/OBLIGATION-protection-voies-espiratoires.jpg" }
                ]
            },
            interdiction: {
                name: "Interdiction",
                color: "#dc2626",
                items: [
                    { name: "Interdiction de fumer", image: "pictogrammes/images/INTERDIT-fumer.jpg" },
                    { name: "Flamme interdite", image: "pictogrammes/images/INTERDIT-flamme.jpg" },
                    { name: "Acc√®s interdit", image: "pictogrammes/images/INTERDIT-entrer.jpg" },
                    { name: "Interdit de toucher", image: "pictogrammes/images/INTERDIT-toucher.jpg" },
                    { name: "Interdit aux pi√©tons", image: "pictogrammes/images/INTERDIT-pietons.jpg" }
                ]
            },
            avertissement: {
                name: "Avertissement",
                color: "#eab308",
                items: [
                    { name: "Danger √©lectrique", image: "pictogrammes/images/DANGER-electricite.jpg" },
                    { name: "Danger de chute", image: "pictogrammes/images/DANGER-chute.jpg" },
                    { name: "Produit toxique", image: "pictogrammes/images/DANGER-produit-toxique.jpg" },
                    { name: "Produit inflammable", image: "pictogrammes/images/DANGER-produit-inflammable.jpg" },
                    { name: "Chariot √©l√©vateur", image: "pictogrammes/images/DANGER-chariot.jpg" }
                ]
            },
            incendie: {
                name: "Incendie",
                color: "#b91c1c",
                items: [
                    { name: "Extincteur", image: "pictogrammes/images/INCENDIE-extincteur.jpg" },
                    { name: "Alarme incendie", image: "pictogrammes/images/INCENDIE-alarme.jpg" },
                    { name: "Lance √† incendie", image: "pictogrammes/images/INCENDIE-lance.jpg" }
                ]
            },
            secours: {
                name: "Secours",
                color: "#16a34a",
                items: [
                    { name: "Sortie de secours", image: "pictogrammes/images/SECOURS-sortie-vers-droite.jpg" },
                    { name: "Point rassemblement", image: "pictogrammes/images/SECOURS-point-rassemblement.jpg" },
                    { name: "Premiers secours", image: "pictogrammes/images/SECOURS-croix.jpg" },
                    { name: "D√©fibrillateur", image: "pictogrammes/images/SECOURS-defibrillateur.jpg" }
                ]
            }
        };
        
        const totalRounds = 10;
        let currentRound = 0;
        let score = 0;
        let streak = 0;
        let maxStreak = 0;
        let correctCount = 0;
        let currentIntrus = null;
        let answered = false;
        
        function startGame() {
            document.getElementById('intro-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            
            currentRound = 0;
            score = 0;
            streak = 0;
            maxStreak = 0;
            correctCount = 0;
            
            nextRound();
        }
        
        function nextRound() {
            currentRound++;
            answered = false;
            
            if (currentRound > totalRounds) {
                showResults();
                return;
            }
            
            // Update display
            document.getElementById('score').textContent = score;
            document.getElementById('round').textContent = currentRound + '/' + totalRounds;
            document.getElementById('streak').textContent = streak;
            document.getElementById('progress').style.width = (currentRound / totalRounds * 100) + '%';
            document.getElementById('btn-next').disabled = true;
            document.getElementById('feedback').classList.remove('show', 'success', 'error');
            
            // Generate round
            const catKeys = Object.keys(categories);
            const mainCatKey = catKeys[Math.floor(Math.random() * catKeys.length)];
            let intrusCatKey;
            do {
                intrusCatKey = catKeys[Math.floor(Math.random() * catKeys.length)];
            } while (intrusCatKey === mainCatKey);
            
            const mainCat = categories[mainCatKey];
            const intrusCat = categories[intrusCatKey];
            
            // Select 3 from main category
            const mainItems = [...mainCat.items].sort(() => Math.random() - 0.5).slice(0, 3);
            
            // Select 1 intrus
            const intrusItem = intrusCat.items[Math.floor(Math.random() * intrusCat.items.length)];
            currentIntrus = { ...intrusItem, category: intrusCatKey, catName: intrusCat.name };
            
            // Combine and shuffle
            const allItems = [
                ...mainItems.map(item => ({ ...item, category: mainCatKey, isIntrus: false })),
                { ...intrusItem, category: intrusCatKey, isIntrus: true }
            ].sort(() => Math.random() - 0.5);
            
            // Update hint
            document.getElementById('category-hint').textContent = '3 pictogrammes sont de type : ' + mainCat.name;
            
            // Render grid
            const grid = document.getElementById('picto-grid');
            grid.innerHTML = '';
            
            allItems.forEach((item, index) => {
                const option = document.createElement('div');
                option.className = 'picto-option';
                option.dataset.isIntrus = item.isIntrus;
                option.dataset.index = index;
                option.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <div class="name">${item.name}</div>
                `;
                option.onclick = () => selectOption(option, item);
                grid.appendChild(option);
            });
        }
        
        function selectOption(element, item) {
            if (answered) return;
            answered = true;
            
            const options = document.querySelectorAll('.picto-option');
            options.forEach(opt => opt.classList.add('disabled'));
            
            const feedback = document.getElementById('feedback');
            
            if (item.isIntrus) {
                // Correct!
                element.classList.add('correct');
                score += 10 + streak * 2;
                streak++;
                maxStreak = Math.max(maxStreak, streak);
                correctCount++;
                
                feedback.classList.add('show', 'success');
                document.getElementById('feedback-title').textContent = 'Bravo ! üéâ';
                document.getElementById('feedback-text').textContent = 
                    `"${item.name}" est bien l'intrus ! C'est un pictogramme de ${currentIntrus.catName}.`;
            } else {
                // Wrong
                element.classList.add('wrong');
                streak = 0;
                
                // Highlight the real intrus
                options.forEach(opt => {
                    if (opt.dataset.isIntrus === 'true') {
                        opt.classList.add('highlight');
                    }
                });
                
                feedback.classList.add('show', 'error');
                document.getElementById('feedback-title').textContent = 'Pas tout √† fait...';
                document.getElementById('feedback-text').textContent = 
                    `L'intrus √©tait "${currentIntrus.name}" (${currentIntrus.catName}).`;
            }
            
            document.getElementById('score').textContent = score;
            document.getElementById('streak').textContent = streak;
            document.getElementById('btn-next').disabled = false;
            document.getElementById('btn-next').textContent = 
                currentRound >= totalRounds ? 'Voir les r√©sultats üèÜ' : 'Question suivante ‚Üí';
        }
        
        function showResults() {
            document.getElementById('game-screen').classList.remove('active');
            document.getElementById('results-screen').classList.add('active');
            
            document.getElementById('final-score').textContent = score;
            document.getElementById('final-correct').textContent = correctCount + '/' + totalRounds;
            document.getElementById('final-streak').textContent = maxStreak;
            
            const pct = (correctCount / totalRounds) * 100;
            
            if (pct === 100) {
                document.getElementById('trophy').textContent = 'üèÜ';
                document.getElementById('results-title').textContent = 'Parfait !';
                document.getElementById('results-msg').textContent = 'Tu as un ≈ìil de lynx !';
            } else if (pct >= 70) {
                document.getElementById('trophy').textContent = 'üåü';
                document.getElementById('results-title').textContent = 'Excellent !';
                document.getElementById('results-msg').textContent = 'Tu distingues bien les cat√©gories !';
            } else {
                document.getElementById('trophy').textContent = 'üí™';
                document.getElementById('results-title').textContent = 'Continue !';
                document.getElementById('results-msg').textContent = 'R√©vise les formes et couleurs des familles.';
            }
        }
        
        function restartGame() {
            document.getElementById('results-screen').classList.remove('active');
            document.getElementById('intro-screen').classList.add('active');
        }
    </script>
    
</body>
</html>
