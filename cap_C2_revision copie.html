<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission PSE - Garage Auto-R√©par</title>
    <style>
        :root { --primary: #2c3e50; --secondary: #e67e22; --bg: #f5f6fa; --success: #27ae60; --danger: #e74c3c; --mission: #34495e; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: var(--bg); color: #333; line-height: 1.6; padding: 10px; margin: 0; }
        .container { max-width: 800px; margin: 0 auto; }
        
        .header { background: #fff; padding: 20px; text-align: center; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; border-top: 5px solid var(--primary); }
        .header h1 { color: var(--primary); margin: 0 0 10px 0; font-size: 1.6em; text-transform: uppercase; }
        .header h2 { color: var(--secondary); margin: 0 0 15px 0; font-size: 1.2em; }
        
        .mission-box { background: #fff; padding: 20px; border-left: 6px solid var(--secondary); border-radius: 6px; margin-bottom: 25px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .mission-title { font-size: 1.3em; color: var(--mission); font-weight: bold; margin-bottom: 10px; display: flex; align-items: center; }
        .mission-title::before { content: 'üìã'; margin-right: 10px; }
        
        .q-card { background: #fff; padding: 18px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; border: 1px solid #eaeaea; }
        .comp { display: inline-block; background: var(--primary); color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.85em; font-weight: bold; margin-bottom: 12px; }
        .consigne { font-weight: normal; margin-bottom: 15px; font-size: 1.05em; }
        
        label { display: block; padding: 12px 15px; margin: 8px 0; background: #f8f9fa; border-radius: 6px; border: 1px solid #dcdde1; cursor: pointer; transition: background 0.2s; }
        label:hover { background: #f1f2f6; }
        input[type="radio"] { margin-right: 12px; transform: scale(1.2); }
        
        button { width: 100%; padding: 15px; background: var(--secondary); color: white; border: none; border-radius: 6px; font-size: 1.1em; font-weight: bold; margin-top: 10px; cursor: pointer; transition: background 0.3s; }
        button:hover { background: #d35400; }
        button:disabled { background: #bdc3c7; cursor: not-allowed; }
        
        .feedback { display: none; margin-top: 15px; padding: 15px; border-radius: 6px; border-left: 5px solid transparent; }
        .rep-rouge { color: var(--danger); font-weight: bold; display: none; margin-bottom: 5px; }
        .rep-verte { color: var(--success); font-weight: bold; display: none; margin-bottom: 10px; }
        .explication { font-size: 0.95em; border-top: 1px dashed #ccc; padding-top: 12px; margin-top: 5px; }
        
        /* Bilan final */
        #score-final { display: none; background: #fff; padding: 30px; border-radius: 8px; margin-top: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.15); border-top: 5px solid var(--primary); }
        .score-title { text-align: center; font-size: 1.8em; font-weight: bold; color: var(--primary); margin-bottom: 10px; }
        .score-number { text-align: center; font-size: 2.5em; color: var(--secondary); margin-bottom: 25px; font-weight: bold; }
        .bar-label { font-weight: bold; font-size: 0.95em; margin-top: 15px; display: flex; justify-content: space-between; color: #555; }
        .bar-container { width: 100%; background-color: #ecf0f1; border-radius: 10px; overflow: hidden; height: 20px; margin-top: 5px; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1); }
        .bar-fill { height: 100%; background-color: var(--success); width: 0%; transition: width 1s cubic-bezier(0.4, 0, 0.2, 1); }
        .strong-point { text-align: center; padding: 15px; background: #e8f8f5; color: #27ae60; font-weight: bold; border-radius: 6px; margin-top: 25px; font-size: 1.1em; }
        .restart-btn { background-color: var(--primary); margin-top: 30px; font-size: 1.2em; padding: 18px; }
        .restart-btn:hover { background-color: #1a252f; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>TH√âMATIQUE C</h1>
        <h2>MODULE C2 : Les enjeux de la sant√© et s√©curit√© au travail</h2>
        <p><strong>Objectif :</strong> √ätre capable de rep√©rer, pour une situation professionnelle, les enjeux et les obligations en sant√© et s√©curit√© au travail.</p>
        <p style="font-size: 0.85em; background:#f1f2f6; padding:8px; border-radius:5px; display:inline-block; margin-top:10px;">
            Niveau CAP - Entra√Ænement guid√©
        </p>
    </div>

    <div class="mission-box" style="background-color: #fffdf5; border-color: #f1c40f;">
        <div class="mission-title" style="color: #d35400;">DOSSIER √âL√àVE : Le Garage "Auto-R√©par"</div>
        <p>Le garage emploie plusieurs salari√©s. <strong>Enzo</strong>, 17 ans, vient d'arriver comme apprenti m√©canicien. Lors de son premier jour, le patron lui a remis un livret d'accueil. <strong>Karim</strong>, 45 ans, travaille ici depuis 20 ans. √Ä cause du bruit continu des moteurs, il souffre aujourd'hui d'une surdit√© s√©v√®re (reconnue par la S√©curit√© sociale).</p>
        <p>Mardi matin, Enzo nettoie des pi√®ces avec un solvant tr√®s toxique, alors que son patron lui avait formellement interdit d'y toucher. L'apr√®s-midi, en transportant un pneu, Enzo glisse sur une flaque d'huile non nettoy√©e et se fracture la jambe. Il est transport√© √† l'h√¥pital pour 45 jours d'arr√™t de travail.</p>
    </div>

    <div class="mission-title">Mission 1 : Analyser les √©v√©nements</div>

    <div class="q-card">
        <span class="comp">[C1]</span>
        <div class="consigne"><strong>Qualifier</strong> l'√©v√©nement subi par Enzo (fracture suite √† une glissade) en cochant la bonne case.</div>
        <label><input type="radio" name="q1" value="A"><span>Un Accident du Travail (AT) car il r√©sulte d'une action soudaine.</span></label>
        <label><input type="radio" name="q1" value="B"><span>Une Maladie Professionnelle (MP) car il r√©sulte d'une exposition chronique.</span></label>
        <button id="btn-q1" onclick="check('q1', 'A', 'C1')">Valider</button>
        <div id="fb-q1" class="feedback">
            <div class="rep-rouge"></div><div class="rep-verte"></div>
            <div class="explication"><strong>Explication :</strong> L'Accident du Travail (AT) est d√ª √† un √©v√©nement "soudain" entra√Ænant une "l√©sion" (ici, la glissade et la fracture).</div>
        </div>
    </div>

    <div class="q-card">
        <span class="comp">[C1]</span>
        <div class="consigne"><strong>Qualifier</strong> l'atteinte √† la sant√© de Karim (surdit√© apr√®s 20 ans de bruit).</div>
        <label><input type="radio" name="q2" value="A"><span>Un Accident du Travail (AT).</span></label>
        <label><input type="radio" name="q2" value="B"><span>Une Maladie Professionnelle (MP) car elle s'installe suite √† une exposition chronique.</span></label>
        <button id="btn-q2" onclick="check('q2', 'B', 'C1')">Valider</button>
        <div id="fb-q2" class="feedback">
            <div class="rep-rouge"></div><div class="rep-verte"></div>
            <div class="explication"><strong>Explication :</strong> La Maladie Professionnelle (MP) s'installe lentement dans le temps, suite √† la r√©p√©tition d'une t√¢che ou une exposition chronique √† un risque.</div>
        </div>
    </div>

    <div class="q-card">
        <span class="comp">[C1]</span>
        <div class="consigne"><strong>Relever</strong> l'enjeu socio-√©conomique majeur pour le garage Auto-R√©par suite √† l'absence d'Enzo.</div>
        <label><input type="radio" name="q3" value="A"><span>Le co√ªt de son remplacement et les journ√©es de travail perdues.</span></label>
        <label><input type="radio" name="q3" value="B"><span>La douleur physique subie par l'apprenti.</span></label>
        <button id="btn-q3" onclick="check('q3', 'A', 'C1')">Valider</button>
        <div id="fb-q3" class="feedback">
            <div class="rep-rouge"></div><div class="rep-verte"></div>
            <div class="explication"><strong>Explication :</strong> L'enjeu socio-√©conomique touche aux finances de l'entreprise ou du salari√© (perte de salaire, remplacement). La douleur est un enjeu purement "humain".</div>
        </div>
    </div>

    <div class="mission-title" style="margin-top:40px;">Mission 2 : Comprendre les r√®gles</div>

    <div class="q-card">
        <span class="comp">[C3]</span>
        <div class="consigne"><strong>Mettre en relation</strong> l'√¢ge d'Enzo avec l'interdiction de manipuler le solvant, en compl√©tant la phrase.</div>
        <label><input type="radio" name="q4" value="A"><span>Parce qu'Enzo est mineur (moins de 18 ans), l'employeur a l'obligation de lui interdire les travaux dangereux pour prot√©ger sa sant√©.</span></label>
        <label><input type="radio" name="q4" value="B"><span>Parce qu'Enzo est apprenti, il doit faire les t√¢ches les plus dangereuses pour apprendre le m√©tier plus vite.</span></label>
        <button id="btn-q4" onclick="check('q4', 'A', 'C3')">Valider</button>
        <div id="fb-q4" class="feedback">
            <div class="rep-rouge"></div><div class="rep-verte"></div>
            <div class="explication"><strong>Explication :</strong> Le Code du travail prot√®ge strictement les jeunes travailleurs : il est formellement interdit de les exposer √† des agents chimiques toxiques sans d√©rogation.</div>
        </div>
    </div>

    <div class="q-card">
        <span class="comp">[C1]</span>
        <div class="consigne"><strong>Identifier</strong> l'obligation l√©gale qu'Enzo n'a pas respect√©e ce matin-l√†.</div>
        <label><input type="radio" name="q5" value="A"><span>Il n'a pas r√©dig√© le Document Unique d'√âvaluation des Risques.</span></label>
        <label><input type="radio" name="q5" value="B"><span>Il n'a pas respect√© les consignes de s√©curit√© donn√©es par son employeur.</span></label>
        <button id="btn-q5" onclick="check('q5', 'B', 'C1')">Valider</button>
        <div id="fb-q5" class="feedback">
            <div class="rep-rouge"></div><div class="rep-verte"></div>
            <div class="explication"><strong>Explication :</strong> Il incombe √† chaque travailleur de prendre soin de sa s√©curit√© en respectant les instructions (interdictions, r√®glement int√©rieur) fix√©es par le patron.</div>
        </div>
    </div>

    <div class="q-card">
        <span class="comp">[C5]</span>
        <div class="consigne"><strong>Argumenter</strong> la d√©cision d'un autre m√©canicien qui choisirait d'utiliser son "droit de retrait" face √† la flaque d'huile g√©ante.</div>
        <label><input type="radio" name="q6" value="A"><span>Il a le droit car il n'a pas envie de salir ses chaussures de s√©curit√©.</span></label>
        <label><input type="radio" name="q6" value="B"><span>Il a le droit car la flaque repr√©sente un danger grave et imminent pour sa vie ou sa sant√©.</span></label>
        <button id="btn-q6" onclick="check('q6', 'B', 'C5')">Valider</button>
        <div id="fb-q6" class="feedback">
            <div class="rep-rouge"></div><div class="rep-verte"></div>
            <div class="explication"><strong>Explication :</strong> Le droit de retrait permet √† un salari√© de quitter son poste sans √™tre sanctionn√©, √† condition que la situation pr√©sente un danger "grave et imminent" et que son retrait ne mette pas les autres en danger.</div>
        </div>
    </div>

    <div class="mission-title" style="margin-top:40px;">Mission 3 : R√©agir face √† l'accident</div>

    <div class="q-card">
        <span class="comp">[C2]</span>
        <div class="consigne"><strong>Organiser</strong> la proc√©dure chronologique de d√©claration de l'accident d'Enzo.</div>
        <label><input type="radio" name="q7" value="A"><span>1. M√©decin / 2. Informer le patron (24h) / 3. Envoyer volets 1 et 2 √† la CPAM / 4. Patron d√©clare √† la CPAM (48h).</span></label>
        <label><input type="radio" name="q7" value="B"><span>1. Patron d√©clare √† la CPAM (48h) / 2. M√©decin / 3. Informer le patron.</span></label>
        <button id="btn-q7" onclick="check('q7', 'A', 'C2')">Valider</button>
        <div id="fb-q7" class="feedback">
            <div class="rep-rouge"></div><div class="rep-verte"></div>
            <div class="explication"><strong>Explication :</strong> C'est la d√©marche l√©gale stricte. La victime pr√©vient d'abord son employeur (24h max), et c'est l'employeur qui fait ensuite la d√©claration officielle √† l'Assurance maladie (48h max).</div>
        </div>
    </div>

    <div class="q-card">
        <span class="comp">[C1]</span>
        <div class="consigne"><strong>Indiquer</strong> la prestation qui permettra la prise en charge √† 100 % des frais d'h√¥pital d'Enzo.</div>
        <label><input type="radio" name="q8" value="A"><span>Les prestations en esp√®ces.</span></label>
        <label><input type="radio" name="q8" value="B"><span>Les prestations en nature.</span></label>
        <button id="btn-q8" onclick="check('q8', 'B', 'C1')">Valider</button>
        <div id="fb-q8" class="feedback">
            <div class="rep-rouge"></div><div class="rep-verte"></div>
            <div class="explication"><strong>Explication :</strong> Les prestations en NATURE couvrent les d√©penses m√©dicales (m√©decin, m√©dicaments) pour √©viter au salari√© de faire l'avance des frais.</div>
        </div>
    </div>

    <div class="q-card">
        <span class="comp">[C4]</span>
        <div class="consigne"><strong>Proposer</strong> la solution financi√®re exacte qui remplacera le salaire d'Enzo pendant ses 45 jours d'arr√™t.</div>
        <label><input type="radio" name="q9" value="A"><span>Le versement d'Indemnit√©s Journali√®res (IJ) par la CPAM.</span></label>
        <label><input type="radio" name="q9" value="B"><span>Le versement d'une rente d'incapacit√© permanente.</span></label>
        <button id="btn-q9" onclick="check('q9', 'A', 'C4')">Valider</button>
        <div id="fb-q9" class="feedback">
            <div class="rep-rouge"></div><div class="rep-verte"></div>
            <div class="explication"><strong>Explication :</strong> Pour compenser la perte de salaire temporaire, la S√©curit√© sociale verse des Indemnit√©s Journali√®res (qui font partie des prestations en esp√®ces).</div>
        </div>
    </div>

    <div id="score-final">
        <div class="score-title">üéØ Fin de la Mission !</div>
        <div class="score-number" id="score-affichage"></div>
        
        <div style="font-size: 1.1em; margin-bottom: 10px; color: var(--mission);"><strong>Ton profil de comp√©tences :</strong></div>
        <div id="barometre-competences"></div>
        
        <div id="strong-point" class="strong-point"></div>

        <button class="restart-btn" onclick="location.reload()">üîÑ Recommencer la mission</button>
    </div>

</div>

<script>
    let score = 0;
    let repondu = 0;
    const totalQuestions = 9;
    
    // Suivi du bar√®me par comp√©tence
    const stats = {
        'C1': { correct: 0, total: 5, label: "Traiter l'information" },
        'C2': { correct: 0, total: 1, label: "Appliquer une m√©thode d'analyse" },
        'C3': { correct: 0, total: 1, label: "Mettre en relation" },
        'C4': { correct: 0, total: 1, label: "Proposer une solution" },
        'C5': { correct: 0, total: 1, label: "Argumenter un choix" }
    };

    function check(qName, correctVal, competence) {
        const radios = document.getElementsByName(qName);
        let selectedVal = null;
        let selectedText = "";
        let correctText = "";

        for(let r of radios) {
            if(r.value === correctVal) correctText = r.nextElementSibling.innerText;
            if(r.checked) {
                selectedVal = r.value;
                selectedText = r.nextElementSibling.innerText;
            }
        }

        if(!selectedVal) {
            alert("Mission en attente : veuillez s√©lectionner une r√©ponse pour valider.");
            return;
        }

        // Verrouille la question
        for(let r of radios) r.disabled = true;
        document.getElementById('btn-' + qName).disabled = true;

        const fb = document.getElementById('fb-' + qName);
        fb.style.display = "block";
        
        const repRouge = fb.querySelector('.rep-rouge');
        const repVerte = fb.querySelector('.rep-verte');

        if(selectedVal === correctVal) {
            score++;
            stats[competence].correct++;
            repVerte.innerText = "‚úÖ BIEN JOU√â : " + selectedText;
            repVerte.style.display = "block";
            fb.style.borderLeftColor = "var(--success)";
            fb.style.backgroundColor = "#e8f8f5";
        } else {
            repRouge.innerText = "‚ùå ERREUR : " + selectedText;
            repRouge.style.display = "block";
            repVerte.innerText = "‚úÖ La r√©ponse attendue : " + correctText;
            repVerte.style.display = "block";
            fb.style.borderLeftColor = "var(--danger)";
            fb.style.backgroundColor = "#fdedec";
        }

        repondu++;
        if(repondu === totalQuestions) {
            afficherBilan();
        }
    }

    function afficherBilan() {
        const scoreBox = document.getElementById('score-final');
        document.getElementById('score-affichage').innerText = "Score : " + score + " / " + totalQuestions;
        
        let barometreHTML = "";
        let bestComp = "";
        let bestPercent = -1;

        for(let c in stats) {
            let pct = Math.round((stats[c].correct / stats[c].total) * 100);
            
            // On cherche la meilleure comp√©tence (priorit√© √† C1 qui a plus de questions, sauf si on a 100% ailleurs)
            if(pct > bestPercent || (pct === bestPercent && stats[c].total > stats[bestComp.substring(0,2)]?.total)) {
                bestPercent = pct;
                bestComp = c + " (" + stats[c].label + ")";
            }

            let color = pct >= 75 ? "var(--success)" : (pct >= 50 ? "#f39c12" : "var(--danger)");
            
            barometreHTML += `
                <div class="bar-label">
                    <span>${c} - ${stats[c].label}</span>
                    <span>${stats[c].correct}/${stats[c].total}</span>
                </div>
                <div class="bar-container">
                    <div class="bar-fill" style="width: ${pct}%; background-color: ${color};"></div>
                </div>
            `;
        }
        
        if(bestPercent === 0) {
            document.getElementById('strong-point').innerHTML = "La mission a √©t√© rude... Prends le temps de relire ton cours avant de recommencer !";
        } else {
            document.getElementById('strong-point').innerHTML = "üåü Comp√©tence la mieux ma√Ætris√©e :<br>" + bestComp;
        }

        document.getElementById('barometre-competences').innerHTML = barometreHTML;
        
        scoreBox.style.display = "block";
        
        // Fait d√©filer la page doucement vers le score final
        setTimeout(() => {
            scoreBox.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 300);
    }
</script>

</body>
</html>