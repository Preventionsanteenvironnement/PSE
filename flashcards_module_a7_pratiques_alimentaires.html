<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©vision A7 - Les Pratiques Alimentaires - Bac Pro Premi√®re</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2E86AB;
            --secondary-color: #A23B72;
            --success-color: #219653;
            --warning-color: #F2994A;
            --danger-color: #EB5757;
            --text-primary: #ffffff;
            --background-gradient: linear-gradient(135deg, #1a2e4a 0%, #16213e 50%, #0f3460 100%);
            --border-color: rgba(255,255,255,0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: var(--background-gradient);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* Header avec en-t√™te p√©dagogique PSE */
        .pse-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .pse-module-info h2 {
            font-size: 24px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .pse-objectif {
            background: rgba(255,255,255,0.15);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #FFF;
        }

        .pse-competences h3 {
            margin: 15px 0 10px 0;
            font-size: 18px;
        }

        .pse-competences-list {
            list-style: none;
            padding: 0;
        }

        .pse-competences-list li {
            background: rgba(255,255,255,0.1);
            margin: 8px 0;
            padding: 10px;
            border-radius: 8px;
            border-left: 4px solid;
            font-size: 14px;
        }

        .pse-competences-list li:nth-child(1) { border-left-color: #E74C3C; }
        .pse-competences-list li:nth-child(2) { border-left-color: #3498DB; }
        .pse-competences-list li:nth-child(3) { border-left-color: #2ECC71; }
        .pse-competences-list li:nth-child(4) { border-left-color: #F39C12; }

        .pse-niveau {
            background: var(--warning-color);
            padding: 10px 15px;
            border-radius: 25px;
            display: inline-block;
            font-weight: bold;
            margin-top: 10px;
            font-size: 14px;
        }

        /* Navigation header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .btn-back {
            background: rgba(255,255,255,0.1);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 2px solid var(--border-color);
            cursor: pointer;
        }
        
        .btn-back:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .score-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 50px;
        }
        
        .score-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .score-item .icon {
            font-size: 18px;
        }
        
        /* √âcrans */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* √âcran d'accueil */
        .welcome-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .welcome-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #4ade80, #22d3ee, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 30px;
        }
        
        /* Objectifs */
        .objectifs-card {
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.3), rgba(34, 211, 238, 0.3));
            border: 2px solid rgba(74, 222, 128, 0.5);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: left;
        }
        
        .objectifs-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .objectif-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
            line-height: 1.5;
        }
        
        .objectif-item:last-child {
            border-bottom: none;
        }
        
        .objectif-item .check {
            color: var(--success-color);
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .competences-row {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .comp-badge {
            background: rgba(255,255,255,0.15);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .comp-badge.c1 { background: rgba(231, 76, 60, 0.3); border: 1px solid #e74c3c; }
        .comp-badge.c2 { background: rgba(52, 152, 219, 0.3); border: 1px solid #3498db; }
        .comp-badge.c3 { background: rgba(46, 204, 113, 0.3); border: 1px solid #2ecc71; }
        .comp-badge.c4 { background: rgba(243, 156, 18, 0.3); border: 1px solid #f39c12; }
        .comp-badge.c5 { background: rgba(155, 89, 182, 0.3); border: 1px solid #9b59b6; }
        .comp-badge.c6 { background: rgba(26, 188, 156, 0.3); border: 1px solid #1abc9c; }
        
        /* Niveaux */
        .niveaux-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .niveau-card {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .niveau-card:hover:not(.locked) {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
            border-color: rgba(74, 222, 128, 0.5);
        }
        
        .niveau-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .niveau-card.completed {
            border-color: var(--success-color);
            background: rgba(33, 150, 83, 0.1);
        }
        
        .niveau-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }
        
        .niveau-info {
            flex-grow: 1;
        }
        
        .niveau-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .niveau-desc {
            font-size: 13px;
            color: rgba(255,255,255,0.6);
            margin-bottom: 8px;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color), #27AE60);
            transition: width 0.3s ease;
        }
        
        .niveau-stats {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 14px;
            color: rgba(255,255,255,0.7);
        }
        
        /* Boutons */
        .btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 10px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(46, 134, 171, 0.3);
        }
        
        .btn-start {
            font-size: 18px;
            padding: 18px 35px;
            margin-top: 20px;
        }

        /* √âcran de jeu */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .level-info {
            font-size: 18px;
            font-weight: 700;
        }
        
        .card-counter {
            background: rgba(255,255,255,0.1);
            padding: 10px 15px;
            border-radius: 25px;
            font-size: 14px;
        }
        
        .flashcard {
            background: rgba(255,255,255,0.03);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            text-align: center;
            backdrop-filter: blur(10px);
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .card-keyword {
            font-size: 28px;
            font-weight: 900;
            color: #4ade80;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(74, 222, 128, 0.3);
        }
        
        .question-text {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 20px;
            color: rgba(255,255,255,0.9);
        }
        
        /* R√©ponses */
        .answer-section {
            margin: 25px 0;
        }
        
        .keyword-input {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 16px;
            color: white;
            width: 100%;
            max-width: 400px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .keyword-input:focus {
            outline: none;
            border-color: #4ade80;
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.2);
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .option-btn {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 15px 20px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            text-align: left;
            min-height: 44px;
        }
        
        .option-btn:hover {
            background: rgba(255,255,255,0.1);
            border-color: #4ade80;
        }
        
        .option-btn.selected {
            background: rgba(74, 222, 128, 0.2);
            border-color: #4ade80;
        }
        
        .option-letter {
            width: 30px;
            height: 30px;
            background: #4ade80;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #1a2e4a;
            flex-shrink: 0;
        }
        
        .vf-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .vf-btn {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px 30px;
            color: white;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            min-height: 44px;
        }
        
        .vf-btn:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .vf-btn.selected {
            border-color: #4ade80;
            background: rgba(74, 222, 128, 0.2);
        }
        
        .vf-btn.vrai {
            border-color: var(--success-color);
        }
        
        .vf-btn.faux {
            border-color: var(--danger-color);
        }
        
        /* Actions */
        .actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        /* Indice */
        .hint-section {
            margin-top: 20px;
            padding: 15px;
            background: rgba(242, 153, 74, 0.1);
            border: 1px solid rgba(242, 153, 74, 0.3);
            border-radius: 10px;
            font-size: 14px;
            display: none;
        }
        
        /* Overlay de feedback avec fond OPAQUE */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(26, 46, 74, 0.95); /* FOND OPAQUE */
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .feedback-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .feedback-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f); /* FOND COMPL√àTEMENT OPAQUE */
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            transform: scale(0.8);
            transition: all 0.3s ease;
        }
        
        .feedback-overlay.visible .feedback-card {
            transform: scale(1);
        }
        
        .feedback-card.correct {
            border: 3px solid var(--success-color);
        }
        
        .feedback-card.incorrect {
            border: 3px solid var(--danger-color);
        }
        
        .feedback-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        
        .feedback-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .feedback-points {
            color: #4ade80;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .feedback-explanation {
            background: rgba(255,255,255,0.1); /* OPAQUE */
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
        }
        
        .feedback-explanation h4 {
            color: #4ade80;
            margin-bottom: 10px;
        }
        
        .keyword-box {
            background: rgba(74, 222, 128, 0.2);
            color: #4ade80;
            padding: 10px 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: 700;
        }
        
        .tip-box {
            background: rgba(242, 153, 74, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid var(--warning-color);
        }
        
        .tip-box h5 {
            color: var(--warning-color);
            margin-bottom: 8px;
        }
        
        /* √âcran de r√©sultats */
        .results-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .results-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }
        
        .results-title {
            font-size: 32px;
            font-weight: 900;
            margin-bottom: 10px;
        }
        
        .results-score {
            font-size: 48px;
            font-weight: 900;
            color: #4ade80;
            margin-bottom: 20px;
        }
        
        .results-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .stat-item {
            background: rgba(255,255,255,0.1);
            padding: 15px 20px;
            border-radius: 15px;
            min-width: 120px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #4ade80;
        }
        
        .stat-label {
            font-size: 12px;
            color: rgba(255,255,255,0.6);
            margin-top: 5px;
        }
        
        .errors-recap {
            background: rgba(235, 87, 87, 0.1);
            border: 1px solid rgba(235, 87, 87, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 25px 0;
            text-align: left;
        }
        
        .errors-recap h4 {
            color: var(--danger-color);
            margin-bottom: 15px;
        }
        
        .errors-recap ul {
            list-style: none;
            padding: 0;
        }
        
        .errors-recap li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
        }
        
        .errors-recap li:last-child {
            border-bottom: none;
        }
        
        /* Popup streak */
        .streak-popup {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 20px 30px;
            border-radius: 50px;
            font-size: 20px;
            font-weight: 700;
            z-index: 1001;
            display: none;
            animation: bounce 0.6s ease;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-20px); }
        }
        
        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            z-index: 999;
            animation: fall 3s linear infinite;
            pointer-events: none;
        }
        
        @keyframes fall {
            from {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* RGPD Footer */
        .rgpd-footer {
            text-align: center;
            padding: 15px;
            font-size: 12px;
            color: rgba(255,255,255,0.5);
            border-top: 1px solid rgba(255,255,255,0.1);
            margin-top: 30px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .welcome-title {
                font-size: 32px;
            }
            
            .flashcard {
                padding: 20px;
                min-height: 250px;
            }
            
            .card-keyword {
                font-size: 24px;
            }
            
            .question-text {
                font-size: 16px;
            }
            
            .vf-container {
                flex-direction: column;
                align-items: center;
            }
            
            .vf-btn {
                width: 100%;
                max-width: 200px;
            }
            
            .results-stats {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- En-t√™te p√©dagogique PSE obligatoire -->
        <div class="pse-header">
            <div class="pse-module-info">
                <h2>üçΩÔ∏è Module A.7 : Les pratiques alimentaires</h2>
                <div class="pse-objectif">
                    <strong>Objectif :</strong> Appr√©hender les enjeux de l'alimentation afin d'effectuer des choix raisonn√©s et de se maintenir en bonne sant√©.
                </div>
            </div>
            
            <div class="pse-competences">
                <h3>Comp√©tences travaill√©es dans ces flashcards :</h3>
                <ul class="pse-competences-list">
                    <li><strong>C1</strong> - Traiter une information</li>
                    <li><strong>C2</strong> - Appliquer une d√©marche d'analyse dans une situation donn√©e</li>
                    <li><strong>C3</strong> - Expliquer un ph√©nom√®ne physiologique en lien avec une mesure de pr√©vention</li>
                    <li><strong>C4</strong> - Proposer une solution pour r√©soudre un probl√®me</li>
                </ul>
            </div>
            
            <div class="pse-niveau">
                <strong>Niveau :</strong> Bac Pro Premi√®re
            </div>
        </div>

        <!-- Header navigation -->
        <div class="header">
            <button class="btn-back" onclick="goBack()">‚Üê Retour</button>
            <div class="score-bar">
                <div class="score-item">
                    <span class="icon">üíØ</span>
                    <span id="totalPoints">0</span> pts
                </div>
                <div class="score-item">
                    <span class="icon">üî•</span>
                    <span id="currentStreak">0</span>
                </div>
            </div>
        </div>

        <!-- √âcran d'accueil -->
        <div class="screen active" id="homeScreen">
            <div class="welcome-screen">
                <h1 class="welcome-title">üß† R√âVISIONS A7</h1>
                <p class="welcome-subtitle">Les Pratiques Alimentaires</p>
                
                <div class="objectifs-card">
                    <h3>üéØ Ce que tu vas r√©viser</h3>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <span>M√©canismes de la digestion et absorption intestinale</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <span>Pratiques alimentaires et impact environnemental</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <span>D√©cryptage d'√©tiquettes et choix √©clair√©s</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <span>Nutri-Score, additifs et allerg√®nes alimentaires</span>
                    </div>
                    <div class="competences-row">
                        <span class="comp-badge c1">C1 - Traiter info</span>
                        <span class="comp-badge c2">C2 - Analyser</span>
                        <span class="comp-badge c3">C3 - Expliquer</span>
                        <span class="comp-badge c4">C4 - Proposer</span>
                    </div>
                </div>

                <div class="niveaux-grid">
                    <div class="niveau-card" onclick="startLevel(1)">
                        <div class="niveau-icon">üß¨</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 1 - Digestion & Absorption</div>
                            <div class="niveau-desc">Organes digestifs et transformations alimentaires</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level1Bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="niveau-stats">
                            <span id="level1Percent">0%</span>
                        </div>
                    </div>

                    <div class="niveau-card" onclick="startLevel(2)">
                        <div class="niveau-icon">üå±</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 2 - Pratiques Alimentaires</div>
                            <div class="niveau-desc">V√©g√©tarisme, flexitarisme et enjeux sant√©</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level2Bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="niveau-stats">
                            <span id="level2Percent">0%</span>
                        </div>
                    </div>

                    <div class="niveau-card" onclick="startLevel(3)">
                        <div class="niveau-icon">üåç</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 3 - Impact Environnemental</div>
                            <div class="niveau-desc">Empreinte carbone et eau des aliments</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level3Bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="niveau-stats">
                            <span id="level3Percent">0%</span>
                        </div>
                    </div>

                    <div class="niveau-card" onclick="startLevel(4)">
                        <div class="niveau-icon">üè∑Ô∏è</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 4 - √âtiquetage Alimentaire</div>
                            <div class="niveau-desc">Nutri-Score, ingr√©dients et allerg√®nes</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level4Bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="niveau-stats">
                            <span id="level4Percent">0%</span>
                        </div>
                    </div>

                    <div class="niveau-card" onclick="startLevel(5)">
                        <div class="niveau-icon">üéØ</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 5 - Synth√®se Experte</div>
                            <div class="niveau-desc">Questions complexes et situations pro</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level5Bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="niveau-stats">
                            <span id="level5Percent">0%</span>
                        </div>
                    </div>
                </div>

                <button class="btn btn-start" onclick="startLevel(1)">
                    üöÄ Commencer les r√©visions
                </button>
            </div>
        </div>

        <!-- √âcran de jeu -->
        <div class="screen" id="gameScreen">
            <div class="game-header">
                <div class="level-info" id="levelInfo">Niveau 1 - Digestion & Absorption</div>
                <div class="card-counter" id="cardCounter">1 / 10</div>
            </div>

            <div class="flashcard">
                <div class="card-keyword" id="cardKeyword">ESTOMAC</div>
                <div id="questionSection">
                    <p class="question-text">Quel est le r√¥le principal de cet organe dans la digestion ?</p>
                </div>
                <div class="answer-section" id="answerSection">
                    <input type="text" class="keyword-input" id="keywordAnswer" placeholder="Tape ta r√©ponse...">
                </div>
                <div class="hint-section" id="hintSection">
                    <div id="hintText"></div>
                </div>
            </div>

            <div class="actions">
                <button class="btn btn-secondary" onclick="showHint()">üí° Indice</button>
                <button class="btn" onclick="validateAnswer()">‚úÖ Valider</button>
                <button class="btn btn-secondary" onclick="goHome()">üè† Accueil</button>
            </div>
        </div>

        <!-- √âcran de r√©sultats -->
        <div class="screen" id="resultsScreen">
            <div class="results-screen">
                <div class="results-icon" id="resultsIcon">üéâ</div>
                <h2 class="results-title" id="resultsTitle">Niveau r√©ussi !</h2>
                <div class="results-score" id="resultsScore">85%</div>

                <div class="results-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="correctCount">8/10</div>
                        <div class="stat-label">Bonnes r√©ponses</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="pointsEarned">+80</div>
                        <div class="stat-label">Points gagn√©s</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="bestStreak">5</div>
                        <div class="stat-label">Meilleure s√©rie</div>
                    </div>
                </div>

                <div class="errors-recap" id="errorsRecap" style="display: none;">
                    <h4>üìö √Ä revoir :</h4>
                    <ul id="errorsList"></ul>
                </div>

                <div class="actions">
                    <button class="btn btn-secondary" onclick="goHome()">üè† Accueil</button>
                    <button class="btn" id="nextLevelBtn" onclick="nextLevel()" style="display: none;">
                        ‚û°Ô∏è Niveau suivant
                    </button>
                </div>
            </div>
        </div>

        <!-- Overlay de feedback -->
        <div class="feedback-overlay" id="feedbackOverlay">
            <div class="feedback-card" id="feedbackCard">
                <div class="feedback-icon" id="feedbackIcon">‚úÖ</div>
                <h3 class="feedback-title" id="feedbackTitle">Bravo !</h3>
                <div class="feedback-points" id="feedbackPoints">+10 points</div>
                <div class="feedback-explanation" id="feedbackExplanation">
                    <h4>üìö Explication</h4>
                    <p>L'estomac brasse et malaxe les aliments avec le suc gastrique acide.</p>
                    <div class="keyword-box">üîë <span>BRASSAGE</span></div>
                </div>
                <button class="btn" onclick="nextCard()">‚û°Ô∏è Suivant</button>
            </div>
        </div>

        <!-- Popup streak -->
        <div class="streak-popup" id="streakPopup">üî• 3 de suite !</div>

        <!-- Footer RGPD -->
        <div class="rgpd-footer">
            üîí Conformit√© RGPD : Cet exercice respecte votre anonymat.
        </div>
    </div>

    <script>
        // DONN√âES DES FLASHCARDS PAR NIVEAU
        const levels = {
            1: {
                title: "Digestion & Absorption",
                cards: [
                    {
                        type: 'keyword',
                        keyword: 'ESTOMAC',
                        question: 'Quel est le r√¥le principal de cet organe dans la digestion ?',
                        answer: 'brassage',
                        hint: 'Cet organe malaxe les aliments avec un liquide acide',
                        explanation: 'L\'estomac brasse et malaxe les aliments avec le suc gastrique acide pour d√©composer les prot√©ines.',
                        tip: 'M√©morise : ESTOMAC = BRASSAGE + SUC GASTRIQUE ACIDE'
                    },
                    {
                        type: 'qcm',
                        keyword: 'VILLOSIT√âS INTESTINALES',
                        question: 'Quel est le r√¥le des villosit√©s intestinales ?',
                        options: [
                            'Augmenter la surface d\'absorption',
                            'Produire des enzymes digestives',
                            'Stocker les nutriments',
                            '√âliminer les d√©chets'
                        ],
                        answer: 0,
                        hint: 'Pense √† une √©ponge : plus il y a de surface, plus on absorbe',
                        explanation: 'Les villosit√©s intestinales augmentent consid√©rablement la surface d\'absorption de l\'intestin gr√™le.',
                        tip: 'Surface intestin gr√™le = 300 m¬≤ gr√¢ce aux villosit√©s !'
                    },
                    {
                        type: 'vf',
                        keyword: 'GLUCIDES',
                        question: 'Les glucides sont transform√©s en glucose lors de la digestion.',
                        answer: true,
                        hint: 'L\'amidon du pain devient du sucre simple',
                        explanation: 'Les glucides complexes (amidon) sont d√©compos√©s en glucose, sucre simple absorbable par l\'organisme.',
                        tip: 'Transformation : AMIDON ‚Üí GLUCOSE par l\'amylase'
                    },
                    {
                        type: 'keyword',
                        keyword: 'BILE',
                        question: 'Quelle substance √©mulsionne les lipides ?',
                        answer: 'bile',
                        hint: 'Liquide vert-jaune produit par le foie',
                        explanation: 'La bile, produite par le foie, √©mulsionne les lipides (les d√©coupe en fines gouttelettes) pour faciliter leur digestion.',
                        tip: 'BILE = √©mulsifiant naturel pour les graisses'
                    },
                    {
                        type: 'qcm',
                        keyword: 'PROT√âINES',
                        question: 'Les prot√©ines sont d√©compos√©es en :',
                        options: [
                            'Glucose',
                            'Acides amin√©s',
                            'Acides gras',
                            'Glyc√©rol'
                        ],
                        answer: 1,
                        hint: 'Les briques qui constituent les prot√©ines',
                        explanation: 'Les prot√©ines sont d√©coup√©es en acides amin√©s, leurs √©l√©ments de base, absorb√©s dans l\'intestin gr√™le.',
                        tip: 'PROT√âINES = collier de perles d\'acides amin√©s'
                    },
                    {
                        type: 'keyword',
                        keyword: 'P√âRISTALTISME',
                        question: 'Comment s\'appellent les contractions qui font progresser les aliments ?',
                        answer: 'p√©ristaltisme',
                        hint: 'Comme un serpent qui avale sa proie',
                        explanation: 'Le p√©ristaltisme d√©signe les contractions musculaires rythm√©es qui font progresser le bol alimentaire.',
                        tip: 'P√âRISTALTISME = vagues de contractions digestives'
                    },
                    {
                        type: 'vf',
                        keyword: 'LIPIDES',
                        question: 'Les lipides passent uniquement par la voie sanguine apr√®s absorption.',
                        answer: false,
                        hint: 'Ils ont leur propre autoroute corporelle',
                        explanation: 'Les lipides passent d\'abord par la voie lymphatique avant de rejoindre la circulation sanguine.',
                        tip: 'LIPIDES : voie lymphatique ‚Üí puis voie sanguine'
                    },
                    {
                        type: 'qcm',
                        keyword: 'PANCR√âAS',
                        question: 'Le pancr√©as produit :',
                        options: [
                            'De la bile',
                            'Du suc gastrique',
                            'Des enzymes digestives',
                            'De la salive'
                        ],
                        answer: 2,
                        hint: 'Des "ciseaux mol√©culaires" pour d√©couper les nutriments',
                        explanation: 'Le pancr√©as s√©cr√®te le suc pancr√©atique contenant de nombreuses enzymes qui ach√®vent la digestion.',
                        tip: 'PANCR√âAS = centrale d\'enzymes digestives'
                    }
                ]
            },
            2: {
                title: "Pratiques Alimentaires",
                cards: [
                    {
                        type: 'qcm',
                        keyword: 'V√âG√âTARIEN',
                        question: 'Un v√©g√©tarien consomme :',
                        options: [
                            'Uniquement des v√©g√©taux',
                            'V√©g√©taux + ≈ìufs + lait',
                            'V√©g√©taux + poisson',
                            'Tout sauf la viande rouge'
                        ],
                        answer: 1,
                        hint: 'Il √©vite la chair animale mais pas tous les produits animaux',
                        explanation: 'Le v√©g√©tarien exclut la chair animale (viande, poisson) mais consomme ≈ìufs et produits laitiers.',
                        tip: 'V√âG√âTARIEN = NON aux chairs, OUI aux produits animaux'
                    },
                    {
                        type: 'keyword',
                        keyword: 'FLEXITARIEN',
                        question: 'Comment appelle-t-on une personne qui r√©duit sa consommation de viande sans l\'√©liminer ?',
                        answer: 'flexitarien',
                        hint: 'Il fait preuve de flexibilit√© dans son r√©gime',
                        explanation: 'Le flexitarien r√©duit sa consommation de viande pour des raisons de sant√© ou d\'environnement, sans l\'√©liminer totalement.',
                        tip: '24% des Fran√ßais sont flexitariens (en augmentation)'
                    },
                    {
                        type: 'vf',
                        keyword: 'VITAMINE B12',
                        question: 'La vitamine B12 se trouve uniquement dans les produits animaux.',
                        answer: true,
                        hint: 'C\'est la principale pr√©occupation des v√©g√©taliens',
                        explanation: 'La vitamine B12 n\'est synth√©tis√©e que par des bact√©ries pr√©sentes dans les produits animaux. Carence possible chez les v√©g√©taliens.',
                        tip: 'B12 = vitamine critique pour v√©g√©taliens (suppl√©mentation)'
                    },
                    {
                        type: 'qcm',
                        keyword: 'PESC√âTARIEN',
                        question: 'Un pesc√©tarien consomme :',
                        options: [
                            'Poisson + viande blanche',
                            'Poisson mais pas de viande',
                            'Uniquement des fruits de mer',
                            'Viande une fois par semaine'
                        ],
                        answer: 1,
                        hint: '"Pesce" signifie poisson en italien',
                        explanation: 'Le pesc√©tarien √©vite toutes les viandes mais continue de consommer poissons et fruits de mer.',
                        tip: '1,1% des Fran√ßais sont pesc√©tariens'
                    },
                    {
                        type: 'keyword',
                        keyword: 'V√âGAN',
                        question: 'Comment appelle-t-on le mode de vie excluant tout produit d\'origine animale ?',
                        answer: 'v√©gan',
                        hint: 'Plus radical que v√©g√©tarien, √ßa concerne aussi les v√™tements',
                        explanation: 'Le v√©ganisme exclut tous produits animaux : nourriture, v√™tements, cosm√©tiques... Mode de vie complet.',
                        tip: 'V√âGAN = v√©g√©talien + mode de vie (cuir, laine, etc.)'
                    },
                    {
                        type: 'vf',
                        keyword: 'CARENCES',
                        question: 'Un r√©gime v√©g√©tarien bien planifi√© peut couvrir tous les besoins nutritionnels.',
                        answer: true,
                        hint: 'Le mot-cl√© est "bien planifi√©"',
                        explanation: 'Avec des associations alimentaires judicieuses, un r√©gime v√©g√©tarien peut √™tre parfaitement √©quilibr√©.',
                        tip: 'L√©gumineuses + c√©r√©ales = prot√©ines compl√®tes'
                    },
                    {
                        type: 'qcm',
                        keyword: 'ALLERGIES',
                        question: 'Les allergies alimentaires sont :',
                        options: [
                            'Uniquement psychologiques',
                            'Des r√©actions du syst√®me immunitaire',
                            'Li√©es √† l\'√¢ge seulement',
                            'Toujours b√©nignes'
                        ],
                        answer: 1,
                        hint: 'Le corps consid√®re l\'aliment comme un ennemi',
                        explanation: 'L\'allergie alimentaire est une r√©action excessive du syst√®me immunitaire face √† un allerg√®ne alimentaire.',
                        tip: 'ALLERGIE = syst√®me immunitaire hyperactif'
                    },
                    {
                        type: 'keyword',
                        keyword: 'INTOL√âRANCE',
                        question: 'Difficult√© √† dig√©rer le lactose, sans r√©action immunitaire :',
                        answer: 'intol√©rance',
                        hint: 'Le corps manque d\'une enzyme pour dig√©rer',
                        explanation: 'L\'intol√©rance alimentaire (ex: lactose) est due √† un d√©ficit enzymatique, sans r√©action du syst√®me immunitaire.',
                        tip: 'INTOL√âRANCE ‚â† ALLERGIE (pas d\'immunit√© impliqu√©e)'
                    }
                ]
            },
            3: {
                title: "Impact Environnemental",
                cards: [
                    {
                        type: 'qcm',
                        keyword: 'EMPREINTE CARBONE',
                        question: 'Quel aliment a la plus forte empreinte carbone ?',
                        options: [
                            'Soja (5 kg CO‚ÇÇ/kg)',
                            'Porc (12 kg CO‚ÇÇ/kg)',
                            'B≈ìuf (46 kg CO‚ÇÇ/kg)',
                            'Poisson (8 kg CO‚ÇÇ/kg)'
                        ],
                        answer: 2,
                        hint: 'L\'√©levage qui produit le plus de m√©thane',
                        explanation: 'Le b≈ìuf a l\'empreinte carbone la plus √©lev√©e (46 kg CO‚ÇÇ/kg) √† cause des √©missions de m√©thane des ruminants.',
                        tip: 'B≈íUF = champion des √©missions CO‚ÇÇ (x9 vs soja)'
                    },
                    {
                        type: 'keyword',
                        keyword: 'M√âTHANE',
                        question: 'Quel gaz √† effet de serre produisent les ruminants ?',
                        answer: 'm√©thane',
                        hint: 'Gas intestinal des vaches et moutons',
                        explanation: 'Les ruminants (vaches, moutons) produisent du m√©thane par fermentation dans leur syst√®me digestif.',
                        tip: 'M√âTHANE = 25x plus puissant que le CO‚ÇÇ pour l\'effet de serre'
                    },
                    {
                        type: 'vf',
                        keyword: 'EAU VIRTUELLE',
                        question: 'Il faut 15 500L d\'eau pour produire 1kg de b≈ìuf.',
                        answer: true,
                        hint: 'Eau pour nourrir l\'animal pendant toute sa vie',
                        explanation: 'L\'eau virtuelle inclut l\'eau de boisson, l\'irrigation des cultures pour l\'alimentation animale, etc.',
                        tip: 'EAU VIRTUELLE b≈ìuf = 15500L vs soja = 2750L'
                    },
                    {
                        type: 'qcm',
                        keyword: 'TRANSPORT',
                        question: 'Pour r√©duire l\'impact environnemental, privil√©gier :',
                        options: [
                            'Produits exotiques bio',
                            'Circuits courts locaux',
                            'Aliments surgel√©s',
                            'Emballages plastiques'
                        ],
                        answer: 1,
                        hint: 'Moins de kilom√®tres = moins de pollution',
                        explanation: 'Les circuits courts r√©duisent les √©missions li√©es au transport et soutiennent l\'√©conomie locale.',
                        tip: 'CIRCUITS COURTS = moins de transport = moins de CO‚ÇÇ'
                    },
                    {
                        type: 'keyword',
                        keyword: 'SAISONNALIT√â',
                        question: 'Consommer les fruits et l√©gumes de leur p√©riode de production naturelle :',
                        answer: 'saisonnalit√©',
                        hint: 'Fraises en √©t√©, pas en hiver sous serre',
                        explanation: 'Respecter la saisonnalit√© √©vite les serres chauff√©es et les importations lointaines.',
                        tip: 'SAISONNALIT√â = √©conomie d\'√©nergie + meilleur go√ªt'
                    },
                    {
                        type: 'vf',
                        keyword: 'AGRICULTURE BIO',
                        question: 'L\'agriculture bio utilise toujours moins d\'eau que l\'agriculture conventionnelle.',
                        answer: false,
                        hint: 'Bio = sans pesticides, mais rendements parfois plus faibles',
                        explanation: 'L\'agriculture bio peut parfois n√©cessiter plus d\'eau en raison de rendements plus faibles par hectare.',
                        tip: 'BIO ‚â† automatiquement moins d\'impact environnemental'
                    },
                    {
                        type: 'qcm',
                        keyword: 'GASPILLAGE',
                        question: 'En France, combien jette-t-on de nourriture par personne/an ?',
                        options: [
                            '10 kg par personne',
                            '30 kg par personne',
                            '50 kg par personne',
                            '80 kg par personne'
                        ],
                        answer: 1,
                        hint: '√âquivaut √† 1 repas par semaine jet√©',
                        explanation: '30 kg de nourriture gaspill√©e par personne/an en France, soit 20% de nos achats alimentaires.',
                        tip: 'ANTI-GASPI = geste simple et efficace pour l\'environnement'
                    },
                    {
                        type: 'keyword',
                        keyword: 'PROT√âINES V√âG√âTALES',
                        question: 'Alternatives aux prot√©ines animales moins polluantes :',
                        answer: 'prot√©ines v√©g√©tales',
                        hint: 'L√©gumineuses, c√©r√©ales, noix...',
                        explanation: 'Les prot√©ines v√©g√©tales (l√©gumineuses, graines, noix) ont un impact environnemental tr√®s inf√©rieur aux prot√©ines animales.',
                        tip: 'V√âG√âTAL = 10x moins d\'impact vs ANIMAL'
                    }
                ]
            },
            4: {
                title: "√âtiquetage Alimentaire",
                cards: [
                    {
                        type: 'qcm',
                        keyword: 'NUTRI-SCORE',
                        question: 'Le Nutri-Score classe les aliments de :',
                        options: [
                            'A (moins bon) √† E (meilleur)',
                            'A (meilleur) √† E (moins bon)',
                            '1 (meilleur) √† 5 (moins bon)',
                            '‚òÖ √† ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ'
                        ],
                        answer: 1,
                        hint: 'Comme √† l\'√©cole : A = tr√®s bien, E = √† √©viter',
                        explanation: 'Le Nutri-Score va de A (vert, qualit√© nutritionnelle favorable) √† E (rouge, moins favorable).',
                        tip: 'NUTRI-SCORE : A=excellent ‚Üí E=√©viter'
                    },
                    {
                        type: 'keyword',
                        keyword: 'ADDITIFS',
                        question: 'Comment reconna√Æt-on un additif alimentaire sur une √©tiquette ?',
                        answer: 'e',
                        hint: 'Une lettre suivie de chiffres',
                        explanation: 'Les additifs sont identifi√©s par un code commen√ßant par E suivi de chiffres (ex: E300, E150d).',
                        tip: 'E100=colorants, E200=conservateurs, E300=antioxydants'
                    },
                    {
                        type: 'vf',
                        keyword: 'ALLERG√àNES',
                        question: 'Les 14 allerg√®nes majeurs doivent √™tre signal√©s en gras sur les √©tiquettes.',
                        answer: true,
                        hint: 'Obligation l√©gale pour prot√©ger les allergiques',
                        explanation: 'Les 14 allerg√®nes majeurs (gluten, lait, ≈ìufs, etc.) doivent √™tre mis en √©vidence sur l\'√©tiquetage.',
                        tip: 'ALLERG√àNES en GRAS = obligation l√©gale UE'
                    },
                    {
                        type: 'qcm',
                        keyword: 'ULTRA-TRANSFORM√â',
                        question: 'Un aliment ultra-transform√© contient g√©n√©ralement :',
                        options: [
                            'Moins de 3 ingr√©dients',
                            'Plus de 5 ingr√©dients + additifs',
                            'Uniquement des ingr√©dients naturels',
                            'Aucun conservateur'
                        ],
                        answer: 1,
                        hint: 'Plus c\'est long √† lire, plus c\'est transform√©',
                        explanation: 'Les aliments ultra-transform√©s ont >5 ingr√©dients dont des additifs et substances peu utilis√©es en cuisine.',
                        tip: 'ULTRA-TRANSFORM√â = >5 ingr√©dients + additifs industriels'
                    },
                    {
                        type: 'keyword',
                        keyword: 'DLC',
                        question: 'Date limite de consommation (√† ne pas d√©passer) :',
                        answer: 'dlc',
                        hint: '√Ä consommer JUSQU\'AU...',
                        explanation: 'La DLC (Date Limite de Consommation) indique la limite de s√©curit√© sanitaire - ne pas d√©passer.',
                        tip: 'DLC = s√©curit√© alimentaire / DLUO = qualit√© optimale'
                    },
                    {
                        type: 'vf',
                        keyword: 'INDICE SIGA',
                        question: 'L\'indice SIGA mesure le degr√© de transformation des aliments de 1 √† 7.',
                        answer: true,
                        hint: '1 = brut, 7 = ultra-transform√©',
                        explanation: 'L\'indice SIGA classe les aliments selon leur degr√© de transformation : 1 (brut) √† 7 (ultra-transform√©).',
                        tip: 'SIGA 1-3 = OK, SIGA 6-7 = limiter'
                    },
                    {
                        type: 'qcm',
                        keyword: 'YUKA',
                        question: 'L\'application Yuka √©value les produits selon :',
                        options: [
                            'Uniquement le prix',
                            'Qualit√© nutritionnelle + additifs',
                            'Uniquement l\'origine',
                            'Avis des consommateurs'
                        ],
                        answer: 1,
                        hint: 'Scan du code-barre pour note globale',
                        explanation: 'Yuka analyse la qualit√© nutritionnelle (60%), les additifs (30%) et la dimension biologique (10%).',
                        tip: 'YUKA = 60% nutrition + 30% additifs + 10% bio'
                    },
                    {
                        type: 'keyword',
                        keyword: '√âTIQUETAGE',
                        question: 'Information obligatoire sur tous les produits alimentaires :',
                        answer: '√©tiquetage',
                        hint: 'Liste des ingr√©dients, valeurs nutritionnelles...',
                        explanation: 'L\'√©tiquetage alimentaire est obligatoire : ingr√©dients, allerg√®nes, valeur √©nerg√©tique, provenance.',
                        tip: '√âTIQUETAGE = droit √† l\'information du consommateur'
                    }
                ]
            },
            5: {
                title: "Synth√®se Experte",
                cards: [
                    {
                        type: 'qcm',
                        keyword: 'PNNS 4',
                        question: 'Le Programme National Nutrition Sant√© recommande pour la viande rouge :',
                        options: [
                            'Consommation libre',
                            'Maximum 500g par semaine',
                            '1kg par semaine minimum',
                            '√âviter compl√®tement'
                        ],
                        answer: 1,
                        hint: 'Recommandation officielle fran√ßaise r√©cente',
                        explanation: 'Le PNNS 4 recommande de limiter la viande rouge √† 500g/semaine et la charcuterie √† 150g/semaine.',
                        tip: 'PNNS 4 : viande rouge <500g/sem + charcuterie <150g/sem'
                    },
                    {
                        type: 'keyword',
                        keyword: 'MICROBIOTE',
                        question: 'Ensemble des micro-organismes pr√©sents dans l\'intestin :',
                        answer: 'microbiote',
                        hint: 'Notre "deuxi√®me cerveau" digestif',
                        explanation: 'Le microbiote intestinal contient 100 000 milliards de bact√©ries qui participent √† la digestion et l\'immunit√©.',
                        tip: 'MICROBIOTE = √©cosyst√®me intestinal essentiel'
                    },
                    {
                        type: 'vf',
                        keyword: 'INDEX GLYC√âMIQUE',
                        question: 'Plus l\'index glyc√©mique est √©lev√©, plus la glyc√©mie augmente rapidement.',
                        answer: true,
                        hint: 'Important pour les diab√©tiques',
                        explanation: 'L\'index glyc√©mique mesure la rapidit√© d\'√©l√©vation de la glyc√©mie apr√®s consommation d\'un glucide.',
                        tip: 'IG √©lev√© = pic glyc√©mique = fringales rapides'
                    },
                    {
                        type: 'qcm',
                        keyword: 'PR√âVENTION',
                        question: 'Pour pr√©venir les maladies cardiovasculaires par l\'alimentation :',
                        options: [
                            'Augmenter les graisses satur√©es',
                            'Privil√©gier om√©ga-3 + fibres',
                            '√âliminer tous les lipides',
                            'Consommer plus de sel'
                        ],
                        answer: 1,
                        hint: 'R√©gime m√©diterran√©en = r√©f√©rence',
                        explanation: 'Les om√©ga-3 (poissons gras) et fibres (l√©gumes, fruits) prot√®gent le syst√®me cardiovasculaire.',
                        tip: 'CARDIOPROTECTION = om√©ga-3 + fibres + antioxydants'
                    },
                    {
                        type: 'keyword',
                        keyword: 'PHYTONUTRIMENTS',
                        question: 'Compos√©s bioactifs des v√©g√©taux aux propri√©t√©s antioxydantes :',
                        answer: 'phytonutriments',
                        hint: 'Donnent les couleurs vives aux fruits et l√©gumes',
                        explanation: 'Les phytonutriments (polyph√©nols, flavono√Ødes) prot√®gent contre le stress oxydatif et l\'inflammation.',
                        tip: '5 COULEURS/JOUR = diversit√© de phytonutriments'
                    },
                    {
                        type: 'vf',
                        keyword: 'ALIMENTATION INTUITIVE',
                        question: 'L\'alimentation intuitive consiste √† √©couter ses signaux de faim et sati√©t√©.',
                        answer: true,
                        hint: 'Oppos√© aux r√©gimes restrictifs',
                        explanation: 'L\'alimentation intuitive privil√©gie l\'√©coute des signaux corporels naturels plut√¥t que les contraintes externes.',
                        tip: 'INTUITIF = faim/sati√©t√© vs restrictions mentales'
                    },
                    {
                        type: 'qcm',
                        keyword: 'TRANSITION ALIMENTAIRE',
                        question: 'Pour accompagner une transition vers plus de v√©g√©tal :',
                        options: [
                            'Changement radical imm√©diat',
                            'Progression graduelle',
                            'Attendre la motivation parfaite',
                            'Copier un mod√®le unique'
                        ],
                        answer: 1,
                        hint: 'Changement durable = changement progressif',
                        explanation: 'Une transition alimentaire r√©ussie se fait graduellement, en respectant ses pr√©f√©rences et contraintes.',
                        tip: 'TRANSITION = petits pas r√©guliers > grand saut'
                    },
                    {
                        type: 'keyword',
                        keyword: '√âQUILIBRE',
                        question: 'Principe fondamental d\'une alimentation saine :',
                        answer: '√©quilibre',
                        hint: 'Ni exc√®s ni restriction extr√™me',
                        explanation: 'L\'√©quilibre alimentaire combine vari√©t√©, mod√©ration et plaisir pour une sant√© optimale √† long terme.',
                        tip: '√âQUILIBRE = vari√©t√© + mod√©ration + plaisir'
                    }
                ]
            }
        };

        // VARIABLES GLOBALES
        let currentLevel = 1;
        let currentCardIndex = 0;
        let levelProgress = {1: 0, 2: 0, 3: 0, 4: 0, 5: 0};
        let totalPoints = 0;
        let currentStreak = 0;
        let bestStreak = 0;

        // Variables par niveau
        let levelCorrect = 0;
        let levelPoints = 0;
        let levelErrors = [];
        let hintUsed = false;

        // FONCTIONS DE NAVIGATION
        function goBack() {
            // Simule le retour navigation (remplace par votre logique)
            if (confirm('Retourner au menu principal ?')) {
                window.history.back();
            }
        }

        function startLevel(levelNum) {
            currentLevel = levelNum;
            currentCardIndex = 0;
            levelCorrect = 0;
            levelPoints = 0;
            levelErrors = [];
            hintUsed = false;

            document.getElementById('homeScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');

            document.getElementById('levelInfo').textContent = `Niveau ${levelNum} - ${levels[levelNum].title}`;
            
            showCard();
        }

        function showCard() {
            const card = levels[currentLevel].cards[currentCardIndex];
            
            // Mise √† jour du compteur
            document.getElementById('cardCounter').textContent = 
                `${currentCardIndex + 1} / ${levels[currentLevel].cards.length}`;
            
            // R√©initialiser l'indice
            hintUsed = false;
            document.getElementById('hintSection').style.display = 'none';
            document.getElementById('hintText').innerHTML = '';
            
            // Afficher le mot-cl√©
            document.getElementById('cardKeyword').textContent = card.keyword;
            
            // Section question
            const questionSection = document.getElementById('questionSection');
            const answerSection = document.getElementById('answerSection');
            
            if (card.type === 'keyword') {
                questionSection.innerHTML = `<p class="question-text">${card.question}</p>`;
                answerSection.innerHTML = `
                    <input type="text" class="keyword-input" id="keywordAnswer" placeholder="Tape ta r√©ponse..." autofocus>
                `;
                
                // Validation sur Entr√©e
                document.getElementById('keywordAnswer').addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        validateAnswer();
                    }
                });
            }
            else if (card.type === 'qcm') {
                questionSection.innerHTML = `<p class="question-text">${card.question}</p>`;
                let optionsHTML = card.options.map((opt, i) => `
                    <button class="option-btn" data-index="${i}" onclick="selectOption(this)">
                        <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                        <span>${opt}</span>
                    </button>
                `).join('');
                
                answerSection.innerHTML = `<div class="options-container">${optionsHTML}</div>`;
            }
            else if (card.type === 'vf') {
                questionSection.innerHTML = `<p class="question-text">${card.question}</p>`;
                answerSection.innerHTML = `
                    <div class="vf-container">
                        <button class="vf-btn vrai" onclick="selectVF(this, true)">‚úì VRAI</button>
                        <button class="vf-btn faux" onclick="selectVF(this, false)">‚úó FAUX</button>
                    </div>
                `;
            }
        }

        function selectOption(btn) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }

        function selectVF(btn, value) {
            document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            btn.dataset.value = value;
        }

        function showHint() {
            const card = levels[currentLevel].cards[currentCardIndex];
            if (card.hint) {
                document.getElementById('hintText').innerHTML = `üí° <strong>Indice :</strong> ${card.hint}`;
                document.getElementById('hintSection').style.display = 'block';
                hintUsed = true;
            }
        }

        function validateAnswer() {
            const card = levels[currentLevel].cards[currentCardIndex];
            let isCorrect = false;
            let userAnswer = '';

            if (card.type === 'keyword') {
                userAnswer = document.getElementById('keywordAnswer').value.trim().toLowerCase();
                // Normaliser (accents, etc.)
                const normalize = str => str.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
                isCorrect = normalize(userAnswer) === normalize(card.answer) || 
                            userAnswer.includes(normalize(card.answer)) ||
                            normalize(card.answer).includes(userAnswer);
            }
            else if (card.type === 'qcm') {
                const selected = document.querySelector('.option-btn.selected');
                if (!selected) { alert('S√©lectionne une r√©ponse'); return; }
                userAnswer = parseInt(selected.dataset.index);
                isCorrect = userAnswer === card.answer;
            }
            else if (card.type === 'vf') {
                const selected = document.querySelector('.vf-btn.selected');
                if (!selected) { alert('S√©lectionne VRAI ou FAUX'); return; }
                userAnswer = selected.dataset.value === 'true';
                isCorrect = userAnswer === card.answer;
            }

            showFeedback(isCorrect, card);
        }

        function showFeedback(isCorrect, card) {
            const overlay = document.getElementById('feedbackOverlay');
            const feedbackCard = document.getElementById('feedbackCard');

            let points = 0;
            if (isCorrect) {
                points = hintUsed ? 5 : 10;
                levelCorrect++;
                currentStreak++;
                if (currentStreak > bestStreak) bestStreak = currentStreak;

                // Streak bonus
                if (currentStreak === 3) showStreakPopup('üî• 3 de suite !');
                else if (currentStreak === 5) showStreakPopup('üî•üî• 5 de suite !');
                else if (currentStreak === 10) showStreakPopup('üî•üî•üî• INCROYABLE !');
            } else {
                currentStreak = 0;
                levelErrors.push(card.keyword || card.question.replace(/<[^>]*>/g, '').substring(0, 50) + '...');
            }

            levelPoints += points;
            totalPoints += points;
            updateScoreDisplay();

            feedbackCard.className = 'feedback-card ' + (isCorrect ? 'correct' : 'incorrect');
            document.getElementById('feedbackIcon').textContent = isCorrect ? '‚úÖ' : '‚ùå';
            document.getElementById('feedbackTitle').textContent = isCorrect ? 
                (currentStreak >= 3 ? 'Excellent ! üî•' : 'Bravo !') : 'Pas tout √† fait...';
            document.getElementById('feedbackPoints').textContent = isCorrect ? `+${points} points` : '0 point';
            document.getElementById('feedbackPoints').style.display = isCorrect ? 'block' : 'none';

            document.getElementById('feedbackExplanation').innerHTML = `
                <h4>üìö Explication</h4>
                <p>${card.explanation}</p>
                <div class="keyword-box">üîë <span>${card.keyword}</span></div>
                ${card.tip ? `<div class="tip-box"><h5>üí° Astuce BAC</h5><p>${card.tip}</p></div>` : ''}
            `;

            overlay.classList.add('visible');
        }

        function showStreakPopup(text) {
            const popup = document.getElementById('streakPopup');
            popup.textContent = text;
            popup.style.display = 'block';
            setTimeout(() => { popup.style.display = 'none'; }, 1500);
        }

        function nextCard() {
            document.getElementById('feedbackOverlay').classList.remove('visible');
            currentCardIndex++;

            if (currentCardIndex >= levels[currentLevel].cards.length) {
                showResults();
            } else {
                showCard();
            }
        }

        function showResults() {
            const total = levels[currentLevel].cards.length;
            const percent = Math.round((levelCorrect / total) * 100);

            levelProgress[currentLevel] = Math.max(levelProgress[currentLevel], percent);

            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');

            document.getElementById('resultsIcon').textContent = percent >= 80 ? 'üéâ' : percent >= 50 ? 'üëç' : 'üí™';
            document.getElementById('resultsTitle').textContent = percent >= 80 ? 'Niveau r√©ussi !' : percent >= 50 ? 'Pas mal !' : 'Continue !';
            document.getElementById('resultsScore').textContent = percent + '%';
            document.getElementById('correctCount').textContent = levelCorrect + '/' + total;
            document.getElementById('pointsEarned').textContent = '+' + levelPoints;
            document.getElementById('bestStreak').textContent = bestStreak;

            // Erreurs
            const errorsRecap = document.getElementById('errorsRecap');
            if (levelErrors.length > 0) {
                errorsRecap.style.display = 'block';
                document.getElementById('errorsList').innerHTML = levelErrors.map(e => `<li>${e}</li>`).join('');
            } else {
                errorsRecap.style.display = 'none';
            }

            // Confettis si r√©ussi
            if (percent >= 80) {
                createConfetti();
            }

            // Bouton niveau suivant
            document.getElementById('nextLevelBtn').style.display = (currentLevel < 5 && percent >= 60) ? 'flex' : 'none';

            updateHomeProgress();
        }

        function createConfetti() {
            const colors = ['#4ade80', '#22d3ee', '#a855f7', '#84fab0', '#8fd3f4', '#FFD700'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }

        function goHome() {
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('homeScreen').classList.add('active');
            updateHomeProgress();
        }

        function nextLevel() {
            if (currentLevel < 5) {
                startLevel(currentLevel + 1);
                document.getElementById('resultsScreen').classList.remove('active');
            }
        }

        function updateScoreDisplay() {
            document.getElementById('totalPoints').textContent = totalPoints;
            document.getElementById('currentStreak').textContent = currentStreak;
        }

        function updateHomeProgress() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`level${i}Percent`).textContent = levelProgress[i] + '%';
                document.getElementById(`level${i}Bar`).style.width = levelProgress[i] + '%';
            }
        }

        // INITIALISATION
        updateScoreDisplay();
        updateHomeProgress();
    </script>
</body>
</html>