<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©vision B.1 - L'Alimentation √âcoresponsable - Seconde Bac Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #2d5a27 0%, #4a7c59 50%, #8bc34a 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .btn-back {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.3);
            cursor: pointer;
        }
        
        .btn-back:hover {
            background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
            transform: translateY(-2px);
        }
        
        .score-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            padding: 10px 20px;
            border-radius: 50px;
        }
        
        .score-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .score-item .icon {
            font-size: 18px;
        }
        
        /* √âcrans */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* √âcran d'accueil */
        .welcome-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .welcome-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #81C784, #4CAF50, #2E7D32);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: rgba(255,255,255,0.8);
            margin-bottom: 30px;
        }
        
        /* EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE */
        .objectifs-card {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.3), rgba(129, 199, 132, 0.3));
            border: 2px solid rgba(76, 175, 80, 0.5);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: left;
        }
        
        .objectifs-card h3 {
            font-size: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #E8F5E8;
        }
        
        .module-header {
            background: linear-gradient(135deg, rgba(46, 125, 50, 0.4), rgba(76, 175, 80, 0.4));
            border: 2px solid #4CAF50;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .module-title {
            font-size: 18px;
            color: #C8E6C9;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .module-objectif {
            font-size: 14px;
            color: rgba(255,255,255,0.9);
            margin-bottom: 15px;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            padding: 10px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        
        .objectif-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
            line-height: 1.5;
        }
        
        .objectif-item:last-child {
            border-bottom: none;
        }
        
        .objectif-item .check {
            color: #81C784;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .competences-row {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .comp-badge {
            background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.1));
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .comp-badge.c1 { background: rgba(16, 185, 129, 0.3); border: 1px solid #10b981; }
        .comp-badge.c2 { background: rgba(102, 126, 234, 0.3); border: 1px solid #667eea; }
        .comp-badge.c3 { background: rgba(245, 158, 11, 0.3); border: 1px solid #f59e0b; }
        .comp-badge.c4 { background: rgba(239, 68, 68, 0.3); border: 1px solid #ef4444; }
        .comp-badge.c5 { background: rgba(168, 85, 247, 0.3); border: 1px solid #a855f7; }
        .comp-badge.c6 { background: rgba(34, 197, 94, 0.3); border: 1px solid #22c55e; }
        
        .niveau-cible {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.3), rgba(255, 235, 59, 0.3));
            padding: 12px;
            border-radius: 10px;
            margin-top: 15px;
            font-weight: 700;
            text-align: center;
            color: #FFF9C4;
            border: 1px solid #FFC107;
        }
        
        /* Niveaux */
        .niveaux-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .niveau-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .niveau-card:hover:not(.locked) {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            transform: translateX(5px);
            border-color: rgba(129, 199, 132, 0.5);
        }
        
        .niveau-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .niveau-card.completed {
            border-color: #4CAF50;
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05));
        }
        
        .niveau-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 900;
            color: white;
            flex-shrink: 0;
        }
        
        .niveau-1 .niveau-icon { background: linear-gradient(135deg, #4CAF50, #81C784); }
        .niveau-2 .niveau-icon { background: linear-gradient(135deg, #2196F3, #64B5F6); }
        .niveau-3 .niveau-icon { background: linear-gradient(135deg, #FF9800, #FFB74D); }
        .niveau-4 .niveau-icon { background: linear-gradient(135deg, #F44336, #EF5350); }
        .niveau-5 .niveau-icon { background: linear-gradient(135deg, #9C27B0, #BA68C8); }
        
        .niveau-info {
            flex: 1;
        }
        
        .niveau-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .niveau-desc {
            font-size: 13px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 8px;
        }
        
        .niveau-progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-bar {
            flex: 1;
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4CAF50, #81C784);
            border-radius: 3px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .progress-text {
            font-size: 12px;
            font-weight: 600;
        }
        
        /* Bouton Start */
        .btn-start {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            color: white;
            border: none;
            padding: 15px 50px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.3);
        }
        
        .btn-start:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(76, 175, 80, 0.4);
        }
        
        /* √âcran de jeu */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .level-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .level-badge {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
        }
        
        .card-counter {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }
        
        /* Flashcard */
        .flashcard {
            background: linear-gradient(135deg, #ffffff, #f8fffe);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            margin-bottom: 20px;
            overflow: hidden;
            min-height: 400px;
            position: relative;
        }
        
        .card-header {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            padding: 20px;
            text-align: center;
        }
        
        .card-type {
            color: rgba(255,255,255,0.8);
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }
        
        .card-title {
            color: white;
            font-size: 18px;
            font-weight: 700;
        }
        
        .card-content {
            padding: 30px;
            color: #2E7D32;
        }
        
        .keyword-display {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .keyword-term {
            font-size: 28px;
            font-weight: 900;
            color: #2E7D32;
            margin-bottom: 10px;
        }
        
        .keyword-category {
            background: linear-gradient(135deg, #E8F5E8, #C8E6C9);
            color: #2E7D32;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }
        
        /* Question Section */
        .question-section {
            margin-bottom: 30px;
        }
        
        .question-text {
            font-size: 16px;
            font-weight: 600;
            color: #2E7D32;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .input-answer {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #C8E6C9;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 600;
            color: #2E7D32;
            background: #F1F8E9;
            transition: all 0.3s ease;
            outline: none;
        }
        
        .input-answer:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.2);
        }
        
        /* Options QCM */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .option-btn {
            background: linear-gradient(135deg, #F1F8E9, #E8F5E8);
            border: 2px solid #C8E6C9;
            border-radius: 12px;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 14px;
            font-weight: 600;
            color: #2E7D32;
            min-height: 60px;
        }
        
        .option-btn:hover {
            background: linear-gradient(135deg, #E8F5E8, #C8E6C9);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.2);
        }
        
        .option-btn.selected {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            color: white;
            border-color: #2E7D32;
            transform: scale(1.02);
        }
        
        .option-letter {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #4CAF50;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            flex-shrink: 0;
        }
        
        .option-btn.selected .option-letter {
            background: white;
            color: #4CAF50;
        }
        
        /* Vrai/Faux */
        .vf-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .vf-btn {
            flex: 1;
            padding: 20px;
            border: 2px solid;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .vf-btn.vrai {
            color: #4CAF50;
            border-color: #4CAF50;
        }
        
        .vf-btn.faux {
            color: #f44336;
            border-color: #f44336;
        }
        
        .vf-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .vf-btn.selected.vrai {
            background: #4CAF50;
            color: white;
        }
        
        .vf-btn.selected.faux {
            background: #f44336;
            color: white;
        }
        
        /* Actions */
        .card-actions {
            padding: 0 30px 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .btn-hint {
            background: linear-gradient(135deg, #FF9800, #FFB74D);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .btn-hint:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 152, 0, 0.3);
        }
        
        .btn-validate {
            flex: 1;
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.3);
        }
        
        .btn-validate:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(76, 175, 80, 0.4);
        }
        
        .btn-validate:disabled {
            background: #bbb;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Indice */
        .hint-text {
            background: linear-gradient(135deg, #FFF8E1, #FFECB3);
            border: 2px solid #FFC107;
            border-radius: 12px;
            padding: 15px;
            margin-top: 15px;
            font-size: 14px;
            color: #E65100;
            display: none;
        }
        
        /* FEEDBACK AVEC FONDS OPAQUES OBLIGATOIRES */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0,0,0,0.8), rgba(46,125,50,0.9));
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .feedback-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .feedback-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fffe 100%);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border-left: 6px solid;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        .feedback-card.correct {
            border-color: #4CAF50;
        }
        
        .feedback-card.incorrect {
            border-color: #f44336;
        }
        
        .feedback-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .feedback-icon {
            font-size: 40px;
        }
        
        .feedback-title {
            font-size: 20px;
            font-weight: 700;
            color: #2E7D32;
        }
        
        .feedback-points {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 14px;
            margin-left: auto;
        }
        
        .feedback-explanation {
            color: #2E7D32;
            margin-bottom: 20px;
        }
        
        .feedback-explanation h4 {
            margin-bottom: 10px;
            color: #1B5E20;
        }
        
        .feedback-explanation p {
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .keyword-box {
            background: linear-gradient(135deg, #E8F5E8, #C8E6C9);
            padding: 15px;
            border-radius: 12px;
            margin: 15px 0;
            text-align: center;
            border: 2px solid #4CAF50;
        }
        
        .keyword-box span {
            font-size: 18px;
            font-weight: 700;
            color: #2E7D32;
        }
        
        .tip-box {
            background: linear-gradient(135deg, #FFF8E1, #FFECB3);
            border: 2px solid #FFC107;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .tip-box h5 {
            color: #E65100;
            margin-bottom: 8px;
        }
        
        .tip-box p {
            color: #BF360C;
            font-weight: 600;
            font-size: 14px;
        }
        
        .btn-next {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            float: right;
            margin-top: 20px;
        }
        
        .btn-next:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.3);
        }
        
        /* Streak popup */
        .streak-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #FF9800, #FFB74D);
            color: white;
            padding: 20px 40px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 700;
            z-index: 1001;
            display: none;
            box-shadow: 0 20px 60px rgba(255, 152, 0, 0.4);
        }
        
        /* √âcran de r√©sultats */
        .results-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .results-header {
            margin-bottom: 30px;
        }
        
        .results-icon {
            font-size: 80px;
            margin-bottom: 20px;
            display: block;
        }
        
        .results-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .results-score {
            font-size: 48px;
            font-weight: 900;
            background: linear-gradient(135deg, #4CAF50, #81C784);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 15px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #81C784;
        }
        
        .stat-label {
            font-size: 12px;
            color: rgba(255,255,255,0.7);
            font-weight: 600;
        }
        
        .errors-recap {
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.1), rgba(244, 67, 54, 0.05));
            border: 2px solid rgba(244, 67, 54, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: left;
        }
        
        .errors-title {
            color: #FFCDD2;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .errors-list {
            color: rgba(255,255,255,0.8);
            font-size: 14px;
        }
        
        .errors-list li {
            margin: 5px 0;
        }
        
        .results-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn-home, .btn-next-level, .btn-retry {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-home {
            background: linear-gradient(135deg, #607D8B, #78909C);
        }
        
        .btn-retry {
            background: linear-gradient(135deg, #FF9800, #FFB74D);
        }
        
        /* Confettis */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            z-index: 999;
            animation: confetti-fall 3s linear forwards;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* RESPONSIVE MOBILE */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .score-bar {
                gap: 10px;
                padding: 8px 15px;
            }
            
            .score-item {
                font-size: 12px;
            }
            
            .welcome-title {
                font-size: 32px;
            }
            
            .flashcard {
                min-height: 350px;
            }
            
            .card-content {
                padding: 20px;
            }
            
            .keyword-term {
                font-size: 24px;
            }
            
            .question-text {
                font-size: 15px;
            }
            
            .option-btn {
                padding: 12px 15px;
                font-size: 13px;
                min-height: 50px;
            }
            
            .vf-btn {
                padding: 15px;
                font-size: 14px;
                min-height: 60px;
            }
            
            .card-actions {
                padding: 0 20px 20px;
                gap: 10px;
            }
            
            .btn-validate {
                padding: 12px 20px;
                font-size: 14px;
            }
            
            .feedback-card {
                padding: 25px;
                margin: 10px;
            }
            
            .results-score {
                font-size: 36px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .results-actions {
                flex-direction: column;
                align-items: center;
            }
        }
        
        /* RGPD Footer */
        .rgpd-notice {
            background: linear-gradient(135deg, #37474f 0%, #263238 100%);
            color: white;
            text-align: center;
            padding: 15px;
            margin-top: 30px;
            border-radius: 10px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header global -->
        <div class="header">
            <button class="btn-back" onclick="goHome()">üè† Accueil</button>
            <div class="score-bar">
                <div class="score-item">
                    <span class="icon">üèÜ</span>
                    <span id="totalPoints">0</span>
                </div>
                <div class="score-item">
                    <span class="icon">üî•</span>
                    <span id="currentStreak">0</span>
                </div>
            </div>
        </div>

        <!-- √âcran d'accueil -->
        <div class="screen active" id="homeScreen">
            <div class="welcome-screen">
                <h1 class="welcome-title">FLASHCARDS B.1</h1>
                <p class="welcome-subtitle">L'Alimentation √âcoresponsable</p>

                <!-- EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE -->
                <div class="module-header">
                    <div class="module-title">Module B.1 : L'alimentation √©coresponsable</div>
                    <div class="module-objectif">
                        <strong>Objectif :</strong> D√©velopper une attitude √©coresponsable dans sa consommation alimentaire
                    </div>
                    <div class="competences-row">
                        <span class="comp-badge c1">C1 - Traiter information</span>
                        <span class="comp-badge c2">C2 - Analyser situation</span>
                        <span class="comp-badge c3">C3 - Expliquer ph√©nom√®ne</span>
                        <span class="comp-badge c4">C4 - Proposer solution</span>
                        <span class="comp-badge c5">C5 - Argumenter</span>
                        <span class="comp-badge c6">C6 - Communiquer</span>
                    </div>
                    <div class="niveau-cible">
                        <strong>Niveau :</strong> Seconde Bac Pro
                    </div>
                </div>

                <div class="objectifs-card">
                    <h3>üéØ Objectifs de r√©vision</h3>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <span>Ma√Ætriser les crit√®res du consommateur √©coresponsable</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <span>Distinguer agriculture biologique, raisonn√©e et labels</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <span>Comprendre les causes et cons√©quences du gaspillage alimentaire</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <span>Conna√Ætre les mesures de pr√©vention individuelles et collectives</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úÖ</span>
                        <span>Ma√Ætriser la l√©gislation fran√ßaise anti-gaspillage (AGEC, EGALIM...)</span>
                    </div>
                </div>

                <div class="niveaux-grid">
                    <div class="niveau-card niveau-1" onclick="startLevel(1)">
                        <div class="niveau-icon">üå±</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 1 - Bases √©coresponsables</div>
                            <div class="niveau-desc">D√©veloppement durable, circuits courts, crit√®res de base</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level1Bar"></div>
                                </div>
                                <span class="progress-text" id="level1Percent">0%</span>
                            </div>
                        </div>
                    </div>

                    <div class="niveau-card niveau-2" onclick="startLevel(2)">
                        <div class="niveau-icon">üè∑Ô∏è</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 2 - Agriculture & Labels</div>
                            <div class="niveau-desc">Bio vs raisonn√©e, labels AB, commerce √©quitable</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level2Bar"></div>
                                </div>
                                <span class="progress-text" id="level2Percent">0%</span>
                            </div>
                        </div>
                    </div>

                    <div class="niveau-card niveau-3" onclick="startLevel(3)">
                        <div class="niveau-icon">üóëÔ∏è</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 3 - Gaspillage alimentaire</div>
                            <div class="niveau-desc">D√©finitions, causes, chiffres France</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level3Bar"></div>
                                </div>
                                <span class="progress-text" id="level3Percent">0%</span>
                            </div>
                        </div>
                    </div>

                    <div class="niveau-card niveau-4" onclick="startLevel(4)">
                        <div class="niveau-icon">üåç</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 4 - Impacts & Solutions</div>
                            <div class="niveau-desc">Cons√©quences environnementales, mesures individuelles</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level4Bar"></div>
                                </div>
                                <span class="progress-text" id="level4Percent">0%</span>
                            </div>
                        </div>
                    </div>

                    <div class="niveau-card niveau-5" onclick="startLevel(5)">
                        <div class="niveau-icon">‚öñÔ∏è</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 5 - L√©gislation Expert</div>
                            <div class="niveau-desc">Lois AGEC/EGALIM, mesures collectives, applications</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level5Bar"></div>
                                </div>
                                <span class="progress-text" id="level5Percent">0%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn-start" onclick="startLevel(1)">üöÄ COMMENCER</button>
            </div>
        </div>

        <!-- √âcran de jeu -->
        <div class="screen" id="gameScreen">
            <div class="game-header">
                <div class="level-info">
                    <div class="level-badge" id="levelBadge">Niveau 1</div>
                    <div class="card-counter" id="cardCounter">1/6</div>
                </div>
            </div>

            <div class="flashcard">
                <div class="card-header">
                    <div class="card-type" id="cardType">MOT-CL√â</div>
                    <div class="card-title" id="cardTitle">D√©finition √† trouver</div>
                </div>
                
                <div class="card-content">
                    <div class="keyword-display" id="keywordDisplay" style="display: none;">
                        <div class="keyword-term" id="keywordTerm"></div>
                        <div class="keyword-category" id="keywordCategory"></div>
                    </div>

                    <div class="question-section" id="questionSection">
                        <!-- Contenu dynamique selon le type -->
                    </div>

                    <div class="hint-text" id="hintText"></div>
                </div>

                <div class="card-actions">
                    <button class="btn-hint" onclick="showHint()">üí° Indice</button>
                    <button class="btn-validate" onclick="validateAnswer()">Valider</button>
                </div>
            </div>
        </div>

        <!-- √âcran de r√©sultats -->
        <div class="screen" id="resultsScreen">
            <div class="results-screen">
                <div class="results-header">
                    <div class="results-icon" id="resultsIcon">üéâ</div>
                    <div class="results-title" id="resultsTitle">Niveau termin√© !</div>
                    <div class="results-score" id="resultsScore">85%</div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="correctCount">5/6</div>
                        <div class="stat-label">Bonnes r√©ponses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="pointsEarned">+50</div>
                        <div class="stat-label">Points gagn√©s</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="bestStreak">3</div>
                        <div class="stat-label">Meilleure s√©rie</div>
                    </div>
                </div>

                <div class="errors-recap" id="errorsRecap" style="display: none;">
                    <div class="errors-title">üìù Points √† revoir :</div>
                    <ul class="errors-list" id="errorsList"></ul>
                </div>

                <div class="results-actions">
                    <button class="btn-home" onclick="goHome()">üè† Accueil</button>
                    <button class="btn-retry" onclick="startLevel(currentLevel)">üîÑ Refaire</button>
                    <button class="btn-next-level" id="nextLevelBtn" onclick="nextLevel()" style="display: none;">
                        ‚û°Ô∏è Niveau suivant
                    </button>
                </div>
            </div>
        </div>

        <!-- Overlay feedback avec fond opaque -->
        <div class="feedback-overlay" id="feedbackOverlay">
            <div class="feedback-card" id="feedbackCard">
                <div class="feedback-header">
                    <span class="feedback-icon" id="feedbackIcon">‚úÖ</span>
                    <div>
                        <div class="feedback-title" id="feedbackTitle">Bravo !</div>
                        <div class="feedback-points" id="feedbackPoints">+10 points</div>
                    </div>
                </div>
                <div class="feedback-explanation" id="feedbackExplanation">
                    <!-- Contenu dynamique -->
                </div>
                <button class="btn-next" onclick="nextCard()">Continuer</button>
            </div>
        </div>

        <!-- Popup streak -->
        <div class="streak-popup" id="streakPopup">üî• 3 de suite !</div>

        <!-- FOOTER RGPD -->
        <div class="rgpd-notice">
            üîí Conformit√© RGPD : Cet exercice respecte votre anonymat. Aucune donn√©e collect√©e.
        </div>
    </div>

    <script>
        // Variables globales
        let currentLevel = 1;
        let currentCardIndex = 0;
        let levelProgress = [0, 0, 0, 0, 0, 0]; // Index 0 inutilis√©
        let totalPoints = 0;
        let currentStreak = 0;
        let bestStreak = 0;
        let levelPoints = 0;
        let levelCorrect = 0;
        let levelErrors = [];
        let hintUsed = false;

        // DONN√âES DES NIVEAUX AVEC CONTENU MODULE B.1
        const levels = {
            1: {
                title: "Bases √©coresponsables",
                icon: "üå±",
                cards: [
                    {
                        type: "keyword",
                        keyword: "D√©veloppement Durable",
                        category: "Concept fondamental",
                        question: "D√©veloppement qui r√©pond aux besoins du pr√©sent sans compromettre la capacit√© des g√©n√©rations futures √† r√©pondre aux leurs",
                        answer: "d√©veloppement durable",
                        hint: "3 piliers : √©conomique, social, environnemental",
                        explanation: "Le d√©veloppement durable vise l'harmonie entre croissance √©conomique, justice sociale et pr√©servation de l'environnement.",
                        tip: "üí° <strong>Astuce BAC :</strong> Retenez les '3 E' : √âconomique, √âquitable, √âcologique !"
                    },
                    {
                        type: "qcm",
                        question: "Quels sont les 3 piliers du d√©veloppement durable ?",
                        options: [
                            "√âconomique, social, environnemental",
                            "Production, transport, consommation", 
                            "Local, bio, √©quitable",
                            "Pr√©vention, r√©duction, recyclage"
                        ],
                        answer: 0,
                        keyword: "3 piliers du DD",
                        hint: "Pensez aux aspects √©conomie, soci√©t√© et plan√®te",
                        explanation: "Les 3 piliers sont : <strong>√âconomique</strong> (viabilit√©), <strong>Social</strong> (√©quit√©), <strong>Environnemental</strong> (vivabilit√©).",
                        tip: "üí° <strong>Astuce BAC :</strong> Sch√©ma classique avec les 3 cercles qui se recoupent !"
                    },
                    {
                        type: "keyword",
                        keyword: "Circuit Court",
                        category: "Mode de distribution",
                        question: "Circuit commercial avec au maximum un seul interm√©diaire entre le producteur et le consommateur",
                        answer: "circuit court",
                        hint: "Maximum 1 interm√©diaire, souvent < 150 km",
                        explanation: "Le circuit court r√©duit les interm√©diaires, favorise l'√©conomie locale et diminue l'empreinte carbone du transport.",
                        tip: "üí° <strong>Astuce BAC :</strong> Circuit court = au MAXIMUM 1 interm√©diaire (peut √™tre 0 aussi) !"
                    },
                    {
                        type: "vf",
                        question: "Un circuit court peut avoir z√©ro interm√©diaire entre producteur et consommateur",
                        answer: true,
                        keyword: "Circuit court - z√©ro interm√©diaire",
                        hint: "Pensez √† la vente directe √† la ferme",
                        explanation: "VRAI ! Circuit court = <strong>au maximum</strong> 1 interm√©diaire. La vente directe (ferme, march√©) = 0 interm√©diaire.",
                        tip: "üí° <strong>Astuce BAC :</strong> 'Au maximum' signifie 0 ou 1 interm√©diaire !"
                    },
                    {
                        type: "keyword", 
                        keyword: "Consommateur √âcoresponsable",
                        category: "Comportement",
                        question: "Personne qui consomme en tenant compte de l'impact environnemental, social et √©conomique de ses achats",
                        answer: "consommateur √©coresponsable",
                        hint: "Prend en compte les 3 piliers du DD dans ses achats",
                        explanation: "Il privil√©gie les produits locaux, de saison, bio, √©quitables et limite le gaspillage selon les 3 piliers du DD.",
                        tip: "üí° <strong>Astuce BAC :</strong> √âcoresponsable = d√©veloppement durable appliqu√© √† la consommation !"
                    },
                    {
                        type: "qcm",
                        question: "Quelle distance maximale d√©finit g√©n√©ralement un circuit de proximit√© pour les fruits et l√©gumes ?",
                        options: [
                            "30 km",
                            "80 km", 
                            "150 km",
                            "500 km"
                        ],
                        answer: 0,
                        keyword: "Circuit de proximit√©",
                        hint: "Distance variable selon le type de production",
                        explanation: "Environ <strong>30 km pour les fruits et l√©gumes</strong> simples, jusqu'√† 80 km pour les produits transform√©s.",
                        tip: "üí° <strong>Astuce BAC :</strong> Plus c'est frais et simple, plus c'est proche !"
                    }
                ]
            },
            2: {
                title: "Agriculture & Labels",
                icon: "üè∑Ô∏è",
                cards: [
                    {
                        type: "keyword",
                        keyword: "Agriculture Biologique",
                        category: "Mode de production",
                        question: "Mode de production agricole qui exclut l'usage d'OGM et limite le recours aux intrants chimiques de synth√®se",
                        answer: "agriculture biologique",
                        hint: "Interdiction totale des pesticides chimiques",
                        explanation: "L'agriculture bio interdit pesticides chimiques, engrais de synth√®se, OGM et privil√©gie les ressources naturelles.",
                        tip: "üí° <strong>Astuce BAC :</strong> BIO = 0% pesticides chimiques (contrairement au 'raisonn√©e') !"
                    },
                    {
                        type: "vf",
                        question: "L'agriculture raisonn√©e interdit compl√®tement l'usage de pesticides chimiques",
                        answer: false,
                        keyword: "Agriculture raisonn√©e",
                        hint: "Diff√©rence cl√© avec l'agriculture biologique",
                        explanation: "FAUX ! L'agriculture raisonn√©e <strong>autorise</strong> les pesticides chimiques mais en dernier recours et de fa√ßon limit√©e.",
                        tip: "üí° <strong>Astuce BAC :</strong> RAISONN√âE = pesticides en dernier recours / BIO = jamais de pesticides chimiques !"
                    },
                    {
                        type: "keyword",
                        keyword: "Label AB",
                        category: "Certification", 
                        question: "Label fran√ßais cr√©√© par le minist√®re de l'Agriculture qui certifie qu'un produit est issu de l'agriculture biologique",
                        answer: "label ab",
                        hint: "Agriculture Biologique - label fran√ßais vert et blanc",
                        explanation: "Le label AB garantit le respect du cahier des charges de l'agriculture biologique fran√ßaise.",
                        tip: "üí° <strong>Astuce BAC :</strong> AB = Agriculture Biologique (explicit√© le sigle) !"
                    },
                    {
                        type: "qcm",
                        question: "Que signifie le sigle AMAP ?",
                        options: [
                            "Association pour le Maintien d'une Agriculture Paysanne",
                            "Agence Moderne d'Alimentation Publique",
                            "Alliance Mondiale Anti-Pesticides", 
                            "Association des March√©s Alimentaires de Proximit√©"
                        ],
                        answer: 0,
                        keyword: "AMAP",
                        hint: "Lien direct producteur-consommateur, agriculture locale",
                        explanation: "<strong>AMAP = Association pour le Maintien d'une Agriculture Paysanne</strong>. Syst√®me de paniers de produits locaux et de saison.",
                        tip: "üí° <strong>Astuce BAC :</strong> AMAP = soutien financier direct aux producteurs locaux via des paniers !"
                    },
                    {
                        type: "keyword",
                        keyword: "Commerce √âquitable", 
                        category: "Syst√®me √©conomique",
                        question: "Syst√®me qui permet aux producteurs de vivre de leur travail en respectant des crit√®res sociaux, environnementaux et √©conomiques",
                        answer: "commerce √©quitable",
                        hint: "Prix juste pay√© aux producteurs, conditions de travail d√©centes",
                        explanation: "Le commerce √©quitable garantit un prix juste aux producteurs, le respect des droits humains et la protection environnementale.",
                        tip: "üí° <strong>Astuce BAC :</strong> Commerce √©quitable = les 3 crit√®res : social + environnemental + √©conomique !"
                    },
                    {
                        type: "vf", 
                        question: "Le label bio europ√©en 'Eurofeuille' a la m√™me valeur que le label AB fran√ßais",
                        answer: true,
                        keyword: "Label europ√©en bio",
                        hint: "Harmonisation europ√©enne des standards bio",
                        explanation: "VRAI ! L'Eurofeuille et le label AB respectent le m√™me cahier des charges europ√©en de l'agriculture biologique.",
                        tip: "üí° <strong>Astuce BAC :</strong> AB fran√ßais = Eurofeuille europ√©en (m√™me cahier des charges) !"
                    }
                ]
            },
            3: {
                title: "Gaspillage alimentaire", 
                icon: "üóëÔ∏è",
                cards: [
                    {
                        type: "keyword",
                        keyword: "Gaspillage Alimentaire",
                        category: "D√©finition officielle",
                        question: "Toute nourriture destin√©e √† la consommation humaine qui, √† un endroit de la cha√Æne de production, est perdue, jet√©e, d√©grad√©e",
                        answer: "gaspillage alimentaire",
                        hint: "De la production √† la consommation, toute la cha√Æne",
                        explanation: "Le gaspillage alimentaire concerne toute la cha√Æne : production, transformation, distribution, consommation.",
                        tip: "üí° <strong>Astuce BAC :</strong> Gaspillage = TOUTE la cha√Æne alimentaire (pas que le consommateur) !"
                    },
                    {
                        type: "qcm",
                        question: "Combien de tonnes de nourriture sont gaspill√©es chaque ann√©e en France ?",
                        options: [
                            "5 millions de tonnes",
                            "10 millions de tonnes",
                            "15 millions de tonnes",
                            "20 millions de tonnes"
                        ],
                        answer: 1,
                        keyword: "Chiffres France 2021",
                        hint: "Chiffre rond, correspond √† 16 milliards d'euros",
                        explanation: "<strong>10 millions de tonnes</strong> de nourriture gaspill√©e par an en France = 16 milliards d'euros perdus.",
                        tip: "üí° <strong>Astuce BAC :</strong> Retenez 10M tonnes = 16 Mds ‚Ç¨ = 30 kg/personne/an !"
                    },
                    {
                        type: "keyword",
                        keyword: "Surconsommation",
                        category: "Comportement",
                        question: "Consommation excessive qui exc√®de les besoins r√©els et qui conduit le plus souvent au gaspillage",
                        answer: "surconsommation", 
                        hint: "Consommer plus que n√©cessaire",
                        explanation: "La surconsommation pousse √† acheter plus que nos besoins r√©els, g√©n√©rant automatiquement du gaspillage.",
                        tip: "üí° <strong>Astuce BAC :</strong> Surconsommation = cause principale du gaspillage c√¥t√© consommateur !"
                    },
                    {
                        type: "vf",
                        question: "Chaque Fran√ßais jette en moyenne 30 kg de nourriture par an, dont 7 kg d'aliments encore emball√©s",
                        answer: true,
                        keyword: "Gaspillage par personne",
                        hint: "Donn√©es officielles fran√ßaises 2021",
                        explanation: "VRAI ! <strong>30 kg/personne/an</strong> dont 7 kg d'aliments non ouverts. Soit l'√©quivalent d'un repas par semaine jet√© !",
                        tip: "üí° <strong>Astuce BAC :</strong> 30 kg/an = 1 repas/semaine gaspill√© par personne !"
                    },
                    {
                        type: "qcm",
                        question: "√Ä quelle √©tape de la cha√Æne alimentaire le gaspillage est-il le plus important ?",
                        options: [
                            "Production agricole (32%)",
                            "Transformation industrielle (21%)", 
                            "Distribution en magasins (14%)",
                            "Consommation finale (33%)"
                        ],
                        answer: 3,
                        keyword: "R√©partition gaspillage",
                        hint: "Consommateurs = principal poste de gaspillage",
                        explanation: "La <strong>consommation finale (33%)</strong> est le 1er poste, suivi de la production agricole (32%).",
                        tip: "üí° <strong>Astuce BAC :</strong> Consommation (33%) + Production (32%) = 2/3 du gaspillage total !"
                    },
                    {
                        type: "keyword",
                        keyword: "Cha√Æne de Production Alimentaire",
                        category: "Processus",
                        question: "Ensemble des √©tapes depuis la production agricole jusqu'√† la consommation finale, en passant par la transformation et la distribution",
                        answer: "cha√Æne de production alimentaire",
                        hint: "Production ‚Üí Transformation ‚Üí Distribution ‚Üí Consommation",
                        explanation: "4 √©tapes principales : <strong>Production (32%)</strong> ‚Üí <strong>Transformation (21%)</strong> ‚Üí <strong>Distribution (14%)</strong> ‚Üí <strong>Consommation (33%)</strong>.",
                        tip: "üí° <strong>Astuce BAC :</strong> Chaque √©tape a ses causes sp√©cifiques de gaspillage !"
                    }
                ]
            },
            4: {
                title: "Impacts & Solutions",
                icon: "üåç", 
                cards: [
                    {
                        type: "vf",
                        question: "Si le gaspillage alimentaire √©tait un pays, il serait le 3√®me plus grand √©metteur de gaz √† effet de serre",
                        answer: true,
                        keyword: "Impact climatique",
                        hint: "Apr√®s la Chine et les √âtats-Unis",
                        explanation: "VRAI ! Le gaspillage alimentaire mondial g√©n√®re 3,3 gigatonnes de CO‚ÇÇ, soit le 3√®me rang mondial apr√®s Chine et USA.",
                        tip: "üí° <strong>Astuce BAC :</strong> Gaspillage = 3√®me pollueur mondial (m√©moriser ce classement) !"
                    },
                    {
                        type: "keyword",
                        keyword: "DLC", 
                        category: "Date limite",
                        question: "Date Limite de Consommation - Indicateur sanitaire, consommation interdite apr√®s cette date sous peine de risque pour la sant√©",
                        answer: "dlc",
                        hint: "Date Limite de Consommation = s√©curit√© sanitaire",
                        explanation: "<strong>DLC = Date Limite de Consommation</strong>. Imp√©ratif sanitaire : vente, don et consommation interdits apr√®s cette date.",
                        tip: "üí° <strong>Astuce BAC :</strong> DLC = '√Ä consommer JUSQU'AU' = DANGER apr√®s ! (explicit√© le sigle)"
                    },
                    {
                        type: "qcm",
                        question: "Que signifie DDM ?",
                        options: [
                            "Date de Derni√®re Manipulation",
                            "Date de Durabilit√© Minimale",
                            "Date de Distribution Maximum", 
                            "Date de Destruction Maximale"
                        ],
                        answer: 1,
                        keyword: "DDM",
                        hint: "Indicateur de qualit√©, pas de s√©curit√©",
                        explanation: "<strong>DDM = Date de Durabilit√© Minimale</strong>. Indicateur qualit√© : '√Ä consommer de pr√©f√©rence avant le...'",
                        tip: "üí° <strong>Astuce BAC :</strong> DDM = qualit√© / DLC = s√©curit√© sanitaire !"
                    },
                    {
                        type: "keyword",
                        keyword: "Doggy Bag",
                        category: "Mesure anti-gaspillage",
                        question: "Contenant fourni par un restaurant pour permettre au client d'emporter les restes de son repas",
                        answer: "doggy bag",
                        hint: "Obligation l√©gale depuis la loi EGALIM 2018",
                        explanation: "Le doggy bag est une obligation l√©gale depuis la loi EGALIM pour les restaurants servant plus de 3000 repas/jour.",
                        tip: "üí° <strong>Astuce BAC :</strong> Doggy bag = obligation l√©gale (pas juste une possibilit√©) !"
                    },
                    {
                        type: "vf",
                        question: "28% des terres agricoles mondiales servent √† produire des aliments qui finissent √† la poubelle",
                        answer: true,
                        keyword: "Gaspillage terres agricoles",
                        hint: "Plus d'1/4 des terres cultiv√©es pour rien",
                        explanation: "VRAI ! <strong>28% des terres agricoles</strong> mondiales = 1,4 milliard d'hectares produisent pour le gaspillage.",
                        tip: "üí° <strong>Astuce BAC :</strong> Pr√®s de 30% des terres agricoles = gaspillage pur !"
                    },
                    {
                        type: "qcm",
                        question: "Quelle quantit√© d'eau est gaspill√©e annuellement dans le monde √† cause du gaspillage alimentaire ?",
                        options: [
                            "100 km¬≥ (1 fois le lac L√©man)", 
                            "250 km¬≥ (3 fois le lac L√©man)",
                            "500 km¬≥ (6 fois le lac L√©man)",
                            "1000 km¬≥ (12 fois le lac L√©man)"
                        ],
                        answer: 1,
                        keyword: "Gaspillage eau",
                        hint: "R√©f√©rence : 3 fois le volume du lac L√©man",
                        explanation: "<strong>250 km¬≥ d'eau</strong> gaspill√©e annuellement = 3 fois le volume du lac L√©man !",
                        tip: "üí° <strong>Astuce BAC :</strong> R√©f√©rence lac L√©man pour visualiser les volumes !"
                    }
                ]
            },
            5: {
                title: "L√©gislation Expert",
                icon: "‚öñÔ∏è",
                cards: [
                    {
                        type: "keyword",
                        keyword: "Loi AGEC",
                        category: "L√©gislation 2020",
                        question: "Loi Anti-Gaspillage pour une √âconomie Circulaire - Objectif : r√©duire de 50% le gaspillage alimentaire d'ici 2025",
                        answer: "loi agec",
                        hint: "Anti-Gaspillage pour une √âconomie Circulaire, objectif 2025",
                        explanation: "<strong>AGEC = Anti-Gaspillage pour une √âconomie Circulaire</strong>. Objectif : -50% gaspillage d'ici 2025 vs 2015.",
                        tip: "üí° <strong>Astuce BAC :</strong> AGEC 2020 = -50% en 2025 (explicit√© le sigle) !"
                    },
                    {
                        type: "qcm",
                        question: "Que signifie EGALIM ?",
                        options: [
                            "√âconomie G√©n√©rale de l'Alimentation",
                            "√âtats G√©n√©raux de l'Alimentation", 
                            "√âvolution et Garantie de l'Alimentation",
                            "√âgalit√© et Gestion de l'Alimentation"
                        ],
                        answer: 1,
                        keyword: "Loi EGALIM",
                        hint: "Issue des √âtats G√©n√©raux lanc√©s en 2017",
                        explanation: "<strong>EGALIM = √âtats G√©n√©raux de l'ALIMentation</strong>. Loi de 2018 sur la restauration collective et l'agriculture.",
                        tip: "üí° <strong>Astuce BAC :</strong> EGALIM = √âtats G√©n√©raux (concertation nationale 2017) !"
                    },
                    {
                        type: "vf",
                        question: "La loi Garot de 2016 oblige les supermarch√©s de plus de 400m¬≤ √† √©tablir des conventions de don avec des associations",
                        answer: true,
                        keyword: "Loi Garot 2016",
                        hint: "Premi√®re loi anti-gaspillage fran√ßaise majeure",
                        explanation: "VRAI ! La loi Garot (2016) impose aux supermarch√©s >400m¬≤ des conventions de don et interdit de rendre impropres les invendus.",
                        tip: "üí° <strong>Astuce BAC :</strong> Garot 2016 = obligation de don + interdiction destruction !"
                    },
                    {
                        type: "keyword",
                        keyword: "Label Anti-gaspillage",
                        category: "Certification r√©cente",
                        question: "Label national fran√ßais cr√©√© en 2023 avec 3 niveaux (1 √† 3 √©toiles) pour r√©compenser les acteurs engag√©s contre le gaspillage",
                        answer: "label anti-gaspillage",
                        hint: "3 niveaux : Engagement, Ma√Ætrise, Exemplaire",
                        explanation: "Label national 2023 avec 3 niveaux : 1 √©toile (engagement), 2 √©toiles (ma√Ætrise), 3 √©toiles (exemplaire).",
                        tip: "üí° <strong>Astuce BAC :</strong> Label r√©cent 2023 = 3 niveaux croissants d'engagement !"
                    },
                    {
                        type: "qcm",
                        question: "Quel est l'objectif de r√©duction du gaspillage alimentaire fix√© par l'objectif de d√©veloppement durable de l'ONU ?",
                        options: [
                            "25% d'ici 2030",
                            "30% d'ici 2025", 
                            "50% d'ici 2030",
                            "75% d'ici 2035"
                        ],
                        answer: 2,
                        keyword: "ODD - Objectif mondial",
                        hint: "Objectif de D√©veloppement Durable n¬∞12 de l'ONU",
                        explanation: "L'<strong>ODD 12 (Objectif de D√©veloppement Durable)</strong> vise -50% de gaspillage alimentaire mondial d'ici 2030.",
                        tip: "üí° <strong>Astuce BAC :</strong> ODD = Objectifs de D√©veloppement Durable (explicit√© sigle ONU) !"
                    },
                    {
                        type: "vf",
                        question: "Les applications anti-gaspillage comme 'Too Good To Go' permettent d'acheter des invendus √† prix r√©duits",
                        answer: true,
                        keyword: "Applications anti-gaspillage",
                        hint: "Solutions num√©riques contre le gaspillage",
                        explanation: "VRAI ! Ces apps connectent commer√ßants et consommateurs pour √©couler les invendus du jour √† prix r√©duit (-50 √† -70%).",
                        tip: "üí° <strong>Astuce BAC :</strong> Apps anti-gaspi = solution num√©rique concr√®te et efficace !"
                    }
                ]
            }
        };

        // Fonctions principales
        function startLevel(level) {
            if (level < 1 || level > 5) return;
            
            currentLevel = level;
            currentCardIndex = 0;
            levelPoints = 0;
            levelCorrect = 0; 
            levelErrors = [];
            hintUsed = false;

            document.getElementById('homeScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');

            document.getElementById('levelBadge').textContent = `Niveau ${level} - ${levels[level].title}`;
            
            showCard();
        }

        function showCard() {
            const card = levels[currentLevel].cards[currentCardIndex];
            const total = levels[currentLevel].cards.length;
            
            document.getElementById('cardCounter').textContent = `${currentCardIndex + 1}/${total}`;
            document.getElementById('cardType').textContent = card.type.toUpperCase();
            document.getElementById('hintText').style.display = 'none';
            hintUsed = false;

            const keywordDisplay = document.getElementById('keywordDisplay');
            const questionSection = document.getElementById('questionSection');

            if (card.type === 'keyword') {
                keywordDisplay.style.display = 'block';
                document.getElementById('keywordTerm').textContent = card.keyword;
                document.getElementById('keywordCategory').textContent = card.category;
                document.getElementById('cardTitle').textContent = 'Que d√©finit ce terme ?';
                
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <input type="text" class="input-answer" id="keywordAnswer" placeholder="Tapez votre r√©ponse...">
                `;
            }
            else if (card.type === 'qcm') {
                keywordDisplay.style.display = 'none';
                document.getElementById('cardTitle').textContent = 'Question √† choix multiple';
                
                let optionsHTML = card.options.map((opt, i) => `
                    <button class="option-btn" data-index="${i}" onclick="selectOption(this)">
                        <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                        <span>${opt}</span>
                    </button>
                `).join('');
                
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="options-container">${optionsHTML}</div>
                `;
            }
            else if (card.type === 'vf') {
                keywordDisplay.style.display = 'none';
                document.getElementById('cardTitle').textContent = 'Vrai ou Faux ?';
                
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="vf-container">
                        <button class="vf-btn vrai" onclick="selectVF(this, true)">‚úì VRAI</button>
                        <button class="vf-btn faux" onclick="selectVF(this, false)">‚úó FAUX</button>
                    </div>
                `;
            }
        }

        function selectOption(btn) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }

        function selectVF(btn, value) {
            document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            btn.dataset.value = value;
        }

        function showHint() {
            const card = levels[currentLevel].cards[currentCardIndex];
            if (card.hint) {
                document.getElementById('hintText').innerHTML = `üí° <strong>Indice :</strong> ${card.hint}`;
                document.getElementById('hintText').style.display = 'block';
                hintUsed = true;
            }
        }

        function validateAnswer() {
            const card = levels[currentLevel].cards[currentCardIndex];
            let isCorrect = false;
            let userAnswer = '';
            
            if (card.type === 'keyword') {
                userAnswer = document.getElementById('keywordAnswer').value.trim().toLowerCase();
                const normalize = str => str.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
                isCorrect = normalize(userAnswer) === normalize(card.answer) || 
                            userAnswer.includes(normalize(card.answer)) ||
                            normalize(card.answer).includes(userAnswer);
            }
            else if (card.type === 'qcm') {
                const selected = document.querySelector('.option-btn.selected');
                if (!selected) { alert('S√©lectionnez une r√©ponse'); return; }
                userAnswer = parseInt(selected.dataset.index);
                isCorrect = userAnswer === card.answer;
            }
            else if (card.type === 'vf') {
                const selected = document.querySelector('.vf-btn.selected');
                if (!selected) { alert('S√©lectionnez VRAI ou FAUX'); return; }
                userAnswer = selected.dataset.value === 'true';
                isCorrect = userAnswer === card.answer;
            }
            
            showFeedback(isCorrect, card);
        }

        function showFeedback(isCorrect, card) {
            const overlay = document.getElementById('feedbackOverlay');
            const feedbackCard = document.getElementById('feedbackCard');
            
            let points = 0;
            if (isCorrect) {
                points = hintUsed ? 5 : 10;
                levelCorrect++;
                currentStreak++;
                if (currentStreak > bestStreak) bestStreak = currentStreak;
                
                // Streak bonus
                if (currentStreak === 3) showStreakPopup('üî• 3 de suite !');
                else if (currentStreak === 5) showStreakPopup('üî•üî• 5 de suite !');
                else if (currentStreak === 10) showStreakPopup('üî•üî•üî• INCROYABLE !');
            } else {
                currentStreak = 0;
                levelErrors.push(card.keyword || card.question.replace(/<[^>]*>/g, '').substring(0, 50) + '...');
            }
            
            levelPoints += points;
            totalPoints += points;
            updateScoreDisplay();
            
            feedbackCard.className = 'feedback-card ' + (isCorrect ? 'correct' : 'incorrect');
            document.getElementById('feedbackIcon').textContent = isCorrect ? '‚úÖ' : '‚ùå';
            document.getElementById('feedbackTitle').textContent = isCorrect ? 
                (currentStreak >= 3 ? 'Excellent ! üî•' : 'Bravo !') : 'Pas tout √† fait...';
            document.getElementById('feedbackPoints').textContent = isCorrect ? `+${points} points` : '0 point';
            document.getElementById('feedbackPoints').style.display = isCorrect ? 'block' : 'none';
            
            document.getElementById('feedbackExplanation').innerHTML = `
                <h4>üìö Explication</h4>
                <p>${card.explanation}</p>
                <div class="keyword-box">üîë <span>${card.keyword}</span></div>
                ${card.tip ? `<div class="tip-box"><h5>üí° Astuce BAC</h5><p>${card.tip}</p></div>` : ''}
            `;
            
            overlay.classList.add('visible');
        }

        function showStreakPopup(text) {
            const popup = document.getElementById('streakPopup');
            popup.textContent = text;
            popup.style.display = 'block';
            setTimeout(() => { popup.style.display = 'none'; }, 1500);
        }

        function nextCard() {
            document.getElementById('feedbackOverlay').classList.remove('visible');
            currentCardIndex++;
            
            if (currentCardIndex >= levels[currentLevel].cards.length) {
                showResults();
            } else {
                showCard();
            }
        }

        function showResults() {
            const total = levels[currentLevel].cards.length;
            const percent = Math.round((levelCorrect / total) * 100);
            
            levelProgress[currentLevel] = Math.max(levelProgress[currentLevel], percent);
            
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');
            
            document.getElementById('resultsIcon').textContent = percent >= 80 ? 'üéâ' : percent >= 50 ? 'üëç' : 'üí™';
            document.getElementById('resultsTitle').textContent = percent >= 80 ? 'Niveau r√©ussi !' : percent >= 50 ? 'Pas mal !' : 'Continue !';
            document.getElementById('resultsScore').textContent = percent + '%';
            document.getElementById('correctCount').textContent = levelCorrect + '/' + total;
            document.getElementById('pointsEarned').textContent = '+' + levelPoints;
            document.getElementById('bestStreak').textContent = bestStreak;
            
            // Erreurs
            const errorsRecap = document.getElementById('errorsRecap');
            if (levelErrors.length > 0) {
                errorsRecap.style.display = 'block';
                document.getElementById('errorsList').innerHTML = levelErrors.map(e => `<li>${e}</li>`).join('');
            } else {
                errorsRecap.style.display = 'none';
            }
            
            // Confettis si r√©ussi
            if (percent >= 80) {
                createConfetti();
            }
            
            // Bouton niveau suivant
            document.getElementById('nextLevelBtn').style.display = (currentLevel < 5 && percent >= 60) ? 'flex' : 'none';
            
            updateHomeProgress();
        }

        function createConfetti() {
            const colors = ['#4CAF50', '#81C784', '#66BB6A', '#A5D6A7', '#C8E6C9', '#E8F5E8'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }

        function goHome() {
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('homeScreen').classList.add('active');
            updateHomeProgress();
        }

        function nextLevel() {
            if (currentLevel < 5) {
                startLevel(currentLevel + 1);
                document.getElementById('resultsScreen').classList.remove('active');
            }
        }

        function updateScoreDisplay() {
            document.getElementById('totalPoints').textContent = totalPoints;
            document.getElementById('currentStreak').textContent = currentStreak;
        }

        function updateHomeProgress() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`level${i}Percent`).textContent = levelProgress[i] + '%';
                document.getElementById(`level${i}Bar`).style.width = levelProgress[i] + '%';
            }
        }

        // Init
        updateScoreDisplay();
        updateHomeProgress();
    </script>
</body>
</html>