<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module B.4 - Laboratoire Empreinte Eau - Premi√®re Bac Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=OpenDyslexie&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-pse: #2E86AB;
            --secondary-pse: #A23B72;
            --success-pse: #219653;
            --warning-pse: #F2994A;
            --danger-pse: #EB5757;
            --dark-pse: #2F3542;
            --light-pse: #F1F2F6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', 'OpenDyslexie', Arial, sans-serif;
            font-size: 16px;
            line-height: 1.6;
            background: linear-gradient(135deg, #00cec9 0%, #55a3ff 100%);
            min-height: 100vh;
            padding: 15px;
        }

        .exercice-container {
            width: 100%;
            max-width: 100vw;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }

        /* EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE */
        .cadre-pedagogique {
            background: linear-gradient(135deg, var(--primary-pse) 0%, var(--secondary-pse) 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }

        .module-info h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .objectif {
            background: rgba(255,255,255,0.15);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 1.1rem;
        }

        .competences-travaillees {
            margin-top: 20px;
        }

        .competences-list {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .competences-list li {
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            border-left: 4px solid #fff;
        }

        .niveau-cible {
            margin-top: 15px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* EXERCICE PRINCIPAL */
        .exercice-principal {
            padding: 30px 25px;
        }

        .scenario-intro {
            background: linear-gradient(135deg, #fd79a8, #fdcb6e);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .scenario-intro h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .laboratoire-container {
            display: grid;
            gap: 25px;
            margin: 30px 0;
        }

        .section-labo {
            background: var(--light-pse);
            border-radius: 15px;
            padding: 25px;
            position: relative;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .section-icon {
            font-size: 2.5rem;
            padding: 10px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .section-title {
            color: var(--primary-pse);
            font-size: 1.3rem;
            font-weight: 600;
        }

        /* PRODUITS √Ä ANALYSER */
        .produits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .produit-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .produit-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .produit-card.selected {
            border-color: var(--warning-pse);
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            transform: scale(1.05);
        }

        .produit-card.analyzed {
            border-color: var(--success-pse);
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
        }

        .produit-emoji {
            font-size: 2.5rem;
            margin-bottom: 8px;
            display: block;
        }

        .produit-nom {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--dark-pse);
            margin-bottom: 5px;
        }

        .produit-card.selected .produit-nom,
        .produit-card.analyzed .produit-nom {
            color: var(--dark-pse);
        }

        .produit-quantite {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 8px;
        }

        .empreinte-badge {
            background: var(--primary-pse);
            color: white;
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
            display: none;
        }

        .produit-card.analyzed .empreinte-badge {
            display: inline-block;
        }

        /* CALCULATEUR VIRTUEL */
        .calculateur-zone {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid var(--primary-pse);
        }

        .calculateur-display {
            background: linear-gradient(135deg, #2d3436, #636e72);
            color: #00ff88;
            font-family: 'Courier New', monospace;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 1.1rem;
            min-height: 120px;
        }

        .calcul-steps {
            margin: 15px 0;
        }

        .step {
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.5s ease;
            margin: 8px 0;
        }

        .step.visible {
            opacity: 1;
            transform: translateX(0);
        }

        .step.highlight {
            color: #ffeaa7;
            font-weight: bold;
        }

        /* COMPARATEUR */
        .comparateur-zone {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .comparaison-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            position: relative;
            border: 2px solid #e0e0e0;
        }

        .comparaison-card.champion {
            border-color: var(--danger-pse);
            background: linear-gradient(135deg, #fab1a0, #e84393);
            color: white;
        }

        .comparaison-card.eco {
            border-color: var(--success-pse);
            background: linear-gradient(135deg, #a8e6cf, #88d8c0);
            color: white;
        }

        .classement-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--warning-pse);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* INSTRUCTIONS */
        .instructions-interaction {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }

        .instructions-interaction h5 {
            margin-bottom: 10px;
            font-size: 1rem;
        }

        /* BOUTONS */
        .btn-principal {
            background: linear-gradient(135deg, var(--success-pse), #00b894);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin: 20px 0;
        }

        .btn-principal:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .btn-principal:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--warning-pse), #e17055);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
        }

        /* GRAPHIQUES */
        .graphique-zone {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }

        .barre-graphique {
            display: flex;
            align-items: end;
            justify-content: space-around;
            height: 200px;
            margin: 20px 0;
            padding: 0 20px;
        }

        .barre {
            background: linear-gradient(180deg, var(--primary-pse), var(--secondary-pse));
            width: 40px;
            min-height: 20px;
            border-radius: 5px 5px 0 0;
            position: relative;
            transition: all 0.8s ease;
            transform-origin: bottom;
        }

        .barre-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--dark-pse);
            white-space: nowrap;
        }

        .barre-valeur {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            font-weight: bold;
            color: var(--primary-pse);
            white-space: nowrap;
        }

        /* FEEDBACK */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .feedback-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .feedback-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            color: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            position: relative;
        }

        .feedback-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .feedback-icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .feedback-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .correction-explicite {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .correction-explicite h4 {
            color: #ff7675;
            margin-bottom: 15px;
        }

        .bonne-reponse {
            background: rgba(0, 184, 148, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #00b894;
        }

        .explication {
            background: rgba(255, 193, 7, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #fdcb6e;
        }

        .astuce-bac {
            background: rgba(116, 185, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #74b9ff;
        }

        .astuce-bac strong {
            color: #74b9ff;
        }

        .btn-fermer {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .btn-fermer:hover {
            background: rgba(255,255,255,0.1);
        }

        /* RGPD FOOTER */
        .rgpd-notice {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            font-size: 0.9rem;
            color: #6c757d;
            border-top: 1px solid #dee2e6;
        }

        /* RESPONSIVE */
        @media (min-width: 768px) {
            body {
                font-size: 17px;
                padding: 20px;
            }
            
            .exercice-container {
                max-width: 1000px;
            }
            
            .cadre-pedagogique {
                padding: 35px;
            }
            
            .exercice-principal {
                padding: 40px 35px;
            }
            
            .produits-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .laboratoire-container {
                grid-template-columns: 1fr;
            }
        }

        @media (min-width: 1024px) {
            body {
                font-size: 18px;
                padding: 30px;
            }
            
            .exercice-container {
                max-width: 1200px;
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .highlight {
            animation: pulse 1s ease-in-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }
    </style>
</head>
<body>
    <div class="exercice-container">
        <!-- EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE -->
        <div class="cadre-pedagogique">
            <div class="module-info">
                <h2>Module B.4 : L'eau et le d√©veloppement durable</h2>
                <div class="objectif">
                    <strong>Objectif :</strong> Adopter un comportement √©coresponsable afin de pr√©server les ressources en eau
                </div>
            </div>
            
            <div class="competences-travaillees">
                <h3>Comp√©tences travaill√©es dans cet exercice :</h3>
                <ul class="competences-list">
                    <li><strong>C1</strong> - Traiter une information</li>
                    <li><strong>C3</strong> - Expliquer un ph√©nom√®ne environnemental en lien avec une mesure de pr√©vention</li>
                    <li><strong>C4</strong> - Proposer une solution pour r√©soudre un probl√®me</li>
                </ul>
            </div>
            
            <div class="niveau-cible">
                <strong>Niveau :</strong> Bac Pro Premi√®re
            </div>
        </div>

        <!-- EXERCICE PRINCIPAL -->
        <main class="exercice-principal">
            <div class="scenario-intro">
                <h3>üß™ LABORATOIRE VIRTUEL : Empreinte Eau des Produits</h3>
                <p>En tant qu'√©co-conseiller, vous devez analyser l'empreinte eau de diff√©rents produits de consommation pour sensibiliser les citoyens. Utilisez le calculateur virtuel pour d√©couvrir la consommation d'eau cach√©e de nos achats quotidiens !</p>
            </div>

            <div class="laboratoire-container">
                <!-- SECTION 1 : S√âLECTION DES PRODUITS -->
                <div class="section-labo">
                    <div class="section-header">
                        <div class="section-icon">üõí</div>
                        <div>
                            <div class="section-title">√âtape 1 : S√©lection des produits √† analyser</div>
                            <p style="color: #666; font-size: 0.9rem;">Choisissez les produits dont vous voulez d√©couvrir l'empreinte eau</p>
                        </div>
                    </div>

                    <div class="instructions-interaction">
                        <h5>üß™ MODE D'EMPLOI LABORATOIRE :</h5>
                        <p><strong>1.</strong> Cliquez sur un produit pour le s√©lectionner (il s'illumine) 
                        <strong>2.</strong> Cliquez sur "ANALYSER" pour lancer le calcul 
                        <strong>3.</strong> Observez le processus de calcul automatique !</p>
                    </div>

                    <div class="produits-grid" id="produitsGrid">
                        <div class="produit-card" data-produit="hamburger" data-eau="2400">
                            <span class="produit-emoji">üçî</span>
                            <div class="produit-nom">Hamburger</div>
                            <div class="produit-quantite">1 unit√© (250g)</div>
                            <div class="empreinte-badge">2 400 L</div>
                        </div>
                        <div class="produit-card" data-produit="jeans" data-eau="8000">
                            <span class="produit-emoji">üëñ</span>
                            <div class="produit-nom">Jean</div>
                            <div class="produit-quantite">1 pantalon</div>
                            <div class="empreinte-badge">8 000 L</div>
                        </div>
                        <div class="produit-card" data-produit="smartphone" data-eau="12760">
                            <span class="produit-emoji">üì±</span>
                            <div class="produit-nom">Smartphone</div>
                            <div class="produit-quantite">1 appareil</div>
                            <div class="empreinte-badge">12 760 L</div>
                        </div>
                        <div class="produit-card" data-produit="tomate" data-eau="214">
                            <span class="produit-emoji">üçÖ</span>
                            <div class="produit-nom">Tomates</div>
                            <div class="produit-quantite">1 kg</div>
                            <div class="empreinte-badge">214 L</div>
                        </div>
                        <div class="produit-card" data-produit="boeuf" data-eau="15000">
                            <span class="produit-emoji">ü•©</span>
                            <div class="produit-nom">Viande de b≈ìuf</div>
                            <div class="produit-quantite">1 kg</div>
                            <div class="empreinte-badge">15 000 L</div>
                        </div>
                        <div class="produit-card" data-produit="riz" data-eau="3000">
                            <span class="produit-emoji">üåæ</span>
                            <div class="produit-nom">Riz</div>
                            <div class="produit-quantite">1 kg</div>
                            <div class="empreinte-badge">3 000 L</div>
                        </div>
                        <div class="produit-card" data-produit="lait" data-eau="1000">
                            <span class="produit-emoji">ü•õ</span>
                            <div class="produit-nom">Lait</div>
                            <div class="produit-quantite">1 litre</div>
                            <div class="empreinte-badge">1 000 L</div>
                        </div>
                        <div class="produit-card" data-produit="tshirt" data-eau="2700">
                            <span class="produit-emoji">üëï</span>
                            <div class="produit-nom">T-shirt coton</div>
                            <div class="produit-quantite">1 pi√®ce</div>
                            <div class="empreinte-badge">2 700 L</div>
                        </div>
                    </div>

                    <button class="btn-principal" id="btnAnalyser" disabled>
                        üß™ ANALYSER L'EMPREINTE EAU
                    </button>
                </div>

                <!-- SECTION 2 : CALCULATEUR VIRTUEL -->
                <div class="calculateur-zone" id="calculateurZone" style="display: none;">
                    <div class="section-header">
                        <div class="section-icon">‚öóÔ∏è</div>
                        <div>
                            <div class="section-title">Calculateur d'empreinte eau virtuel</div>
                            <p style="color: #666; font-size: 0.9rem;">Analyse en cours...</p>
                        </div>
                    </div>

                    <div class="calculateur-display" id="calculDisplay">
                        <div class="calcul-steps" id="calculSteps">
                            <div class="step">üî¨ ANALYSE LABORATOIRE D√âMARR√âE...</div>
                            <div class="step">üíß Calcul de l'eau d'irrigation...</div>
                            <div class="step">üè≠ Calcul de l'eau industrielle...</div>
                            <div class="step">üöõ Calcul de l'eau de transport...</div>
                            <div class="step">üì¶ Calcul de l'eau d'emballage...</div>
                            <div class="step highlight">‚úÖ ANALYSE TERMIN√âE !</div>
                        </div>
                    </div>
                </div>

                <!-- SECTION 3 : COMPARATEUR -->
                <div class="section-labo" id="comparateurSection" style="display: none;">
                    <div class="section-header">
                        <div class="section-icon">üìä</div>
                        <div>
                            <div class="section-title">Comparateur d'impact environnemental</div>
                            <p style="color: #666; font-size: 0.9rem;">Classement par empreinte eau</p>
                        </div>
                    </div>

                    <div class="comparateur-zone" id="comparateurZone">
                        <!-- Les cartes de comparaison seront g√©n√©r√©es dynamiquement -->
                    </div>

                    <div class="graphique-zone">
                        <h4>üìà Visualisation comparative</h4>
                        <p style="color: #666; margin-bottom: 20px;">Empreinte eau en litres par unit√©</p>
                        <div class="barre-graphique" id="barreGraphique">
                            <!-- Les barres seront g√©n√©r√©es dynamiquement -->
                        </div>
                    </div>

                    <button class="btn-principal" id="btnProposerSolutions">
                        üí° PROPOSER DES SOLUTIONS √âCO-RESPONSABLES
                    </button>
                </div>
            </div>
        </main>

        <!-- RGPD FOOTER -->
        <div class="rgpd-notice">
            üîí Conformit√© RGPD : Cet exercice respecte votre anonymat.
        </div>
    </div>

    <!-- FEEDBACK OVERLAY -->
    <div class="feedback-overlay" id="feedbackOverlay">
        <div class="feedback-card">
            <button class="btn-fermer" id="btnFermer">√ó</button>
            <div class="feedback-header">
                <div class="feedback-icon" id="feedbackIcon">üß™</div>
                <div class="feedback-title" id="feedbackTitle">Analyse termin√©e !</div>
            </div>
            <div id="feedbackContent"></div>
        </div>
    </div>

    <script>
        class LaboratoireEmpreinteEau {
            constructor() {
                this.produitsSelectionnes = [];
                this.produitsAnalyses = [];
                this.donneesEau = {
                    'hamburger': { litres: 2400, categories: ['irrigation: 800L', '√©levage: 1200L', 'transformation: 400L'] },
                    'jeans': { litres: 8000, categories: ['culture coton: 5500L', 'teinture: 1800L', 'confection: 700L'] },
                    'smartphone': { litres: 12760, categories: ['extraction m√©taux: 8000L', 'fabrication: 3500L', 'emballage: 1260L'] },
                    'tomate': { litres: 214, categories: ['irrigation: 180L', 'transformation: 24L', 'transport: 10L'] },
                    'boeuf': { litres: 15000, categories: ['abreuvement: 3000L', 'fourrage: 10000L', 'abattage: 2000L'] },
                    'riz': { litres: 3000, categories: ['rizi√®re: 2500L', 'transformation: 400L', 'emballage: 100L'] },
                    'lait': { litres: 1000, categories: ['abreuvement: 400L', 'fourrage: 500L', 'traitement: 100L'] },
                    'tshirt': { litres: 2700, categories: ['culture coton: 2000L', 'teinture: 500L', 'confection: 200L'] }
                };
                this.init();
            }

            init() {
                this.attachEventListeners();
            }

            attachEventListeners() {
                // S√©lection des produits
                document.querySelectorAll('.produit-card').forEach(card => {
                    card.addEventListener('click', (e) => this.selectionnerProduit(e.target.closest('.produit-card')));
                });

                // Bouton analyser
                document.getElementById('btnAnalyser').addEventListener('click', () => this.demarrerAnalyse());
                
                // Bouton solutions
                document.getElementById('btnProposerSolutions').addEventListener('click', () => this.proposerSolutions());
                
                // Fermer feedback
                document.getElementById('btnFermer').addEventListener('click', () => this.fermerFeedback());
                document.getElementById('feedbackOverlay').addEventListener('click', (e) => {
                    if (e.target.id === 'feedbackOverlay') this.fermerFeedback();
                });
            }

            selectionnerProduit(card) {
                const produit = card.dataset.produit;
                
                if (card.classList.contains('analyzed')) {
                    return; // D√©j√† analys√©
                }

                if (card.classList.contains('selected')) {
                    // D√©s√©lectionner
                    card.classList.remove('selected');
                    this.produitsSelectionnes = this.produitsSelectionnes.filter(p => p !== produit);
                } else {
                    // S√©lectionner (maximum 3)
                    if (this.produitsSelectionnes.length < 3) {
                        card.classList.add('selected');
                        this.produitsSelectionnes.push(produit);
                    }
                }

                document.getElementById('btnAnalyser').disabled = this.produitsSelectionnes.length === 0;
            }

            demarrerAnalyse() {
                if (this.produitsSelectionnes.length === 0) return;

                // Afficher le calculateur
                document.getElementById('calculateurZone').style.display = 'block';
                
                // Marquer les produits comme analys√©s
                this.produitsSelectionnes.forEach(produit => {
                    const card = document.querySelector(`[data-produit="${produit}"]`);
                    card.classList.remove('selected');
                    card.classList.add('analyzed');
                });

                this.produitsAnalyses = [...this.produitsSelectionnes];
                this.produitsSelectionnes = [];
                document.getElementById('btnAnalyser').disabled = true;

                // Animation du calculateur
                this.animerCalculateur();
            }

            animerCalculateur() {
                const steps = document.querySelectorAll('.step');
                let currentStep = 0;

                const showNextStep = () => {
                    if (currentStep < steps.length) {
                        steps[currentStep].classList.add('visible');
                        currentStep++;
                        setTimeout(showNextStep, 800);
                    } else {
                        setTimeout(() => this.afficherComparaison(), 1000);
                    }
                };

                showNextStep();
            }

            afficherComparaison() {
                document.getElementById('comparateurSection').style.display = 'block';

                // Trier les produits par empreinte eau
                const produitsTri√©s = this.produitsAnalyses
                    .map(p => ({
                        nom: p,
                        eau: this.donneesEau[p].litres,
                        emoji: document.querySelector(`[data-produit="${p}"] .produit-emoji`).textContent,
                        nomDisplay: document.querySelector(`[data-produit="${p}"] .produit-nom`).textContent
                    }))
                    .sort((a, b) => b.eau - a.eau);

                // G√©n√©rer les cartes de comparaison
                this.genererComparateur(produitsTri√©s);
                
                // G√©n√©rer le graphique
                this.genererGraphique(produitsTri√©s);
            }

            genererComparateur(produits) {
                const zone = document.getElementById('comparateurZone');
                zone.innerHTML = '';

                produits.forEach((produit, index) => {
                    const card = document.createElement('div');
                    card.className = 'comparaison-card';
                    
                    if (index === 0) card.classList.add('champion');
                    if (index === produits.length - 1) card.classList.add('eco');

                    card.innerHTML = `
                        <div class="classement-badge">${index + 1}</div>
                        <div style="font-size: 2rem; margin-bottom: 10px;">${produit.emoji}</div>
                        <div style="font-weight: 600; margin-bottom: 5px;">${produit.nomDisplay}</div>
                        <div style="font-size: 1.3rem; font-weight: bold;">
                            ${produit.eau.toLocaleString()} L
                        </div>
                        <div style="font-size: 0.8rem; margin-top: 5px;">
                            ${index === 0 ? 'üèÜ Plus gourmand' : 
                              index === produits.length - 1 ? 'üå± Plus √©cologique' : 
                              `${Math.round((produit.eau / produits[0].eau) * 100)}% du champion`}
                        </div>
                    `;
                    zone.appendChild(card);
                });
            }

            genererGraphique(produits) {
                const graphique = document.getElementById('barreGraphique');
                graphique.innerHTML = '';

                const maxEau = Math.max(...produits.map(p => p.eau));

                produits.forEach(produit => {
                    const hauteur = (produit.eau / maxEau) * 180;
                    
                    const barre = document.createElement('div');
                    barre.className = 'barre';
                    barre.style.height = hauteur + 'px';
                    
                    barre.innerHTML = `
                        <div class="barre-valeur">${produit.eau.toLocaleString()}L</div>
                        <div class="barre-label">${produit.emoji}<br>${produit.nomDisplay}</div>
                    `;
                    
                    graphique.appendChild(barre);
                });

                // Animation des barres
                setTimeout(() => {
                    document.querySelectorAll('.barre').forEach((barre, index) => {
                        setTimeout(() => {
                            barre.style.transform = 'scaleY(1)';
                        }, index * 200);
                    });
                }, 100);
            }

            proposerSolutions() {
                let feedback = '<div class="correction-explicite">';
                feedback += '<h4>üí° SOLUTIONS √âCO-RESPONSABLES</h4>';
                
                feedback += '<div class="bonne-reponse">';
                feedback += '<strong>‚úÖ ACTIONS CONCR√àTES POUR R√âDUIRE VOTRE EMPREINTE EAU :</strong><br>';
                
                // Solutions sp√©cifiques selon les produits analys√©s
                const solutions = [];
                
                if (this.produitsAnalyses.includes('boeuf')) {
                    solutions.push('ü•© R√©duire sa consommation de viande rouge (15 000L ‚Üí 3 000L pour du porc)');
                }
                if (this.produitsAnalyses.includes('smartphone')) {
                    solutions.push('üì± Conserver son smartphone plus longtemps (7 ans au lieu de 2 ans)');
                }
                if (this.produitsAnalyses.includes('jeans') || this.produitsAnalyses.includes('tshirt')) {
                    solutions.push('üëï Privil√©gier les v√™tements d\'occasion ou en fibres recycl√©es');
                }
                if (this.produitsAnalyses.includes('riz')) {
                    solutions.push('üåæ Choisir des c√©r√©ales moins gourmandes (bl√©, avoine)');
                }
                
                solutions.push('üè™ Privil√©gier les produits locaux et de saison');
                solutions.push('‚ôªÔ∏è Acheter des produits avec emballage recycl√©');
                solutions.push('üîÑ R√©parer plut√¥t que remplacer quand c\'est possible');
                
                feedback += solutions.join('<br>');
                feedback += '</div>';
                
                feedback += '<div class="explication">';
                feedback += '<strong>üí° COMPRENDRE L\'EMPREINTE EAU :</strong><br>';
                feedback += 'L\'empreinte eau comptabilise toute l\'eau n√©cessaire √† la production d\'un bien : ';
                feedback += 'irrigation des cultures, alimentation des animaux, proc√©d√©s industriels, transport, emballage. ';
                feedback += 'Cette "eau virtuelle" repr√©sente 96% de notre consommation quotidienne (4000L/jour contre 150L au robinet).';
                feedback += '</div>';
                
                // Calcul de l'impact
                const eauTotale = this.produitsAnalyses.reduce((sum, p) => sum + this.donneesEau[p].litres, 0);
                const equivalentBaignoires = Math.round(eauTotale / 150);
                
                feedback += '<div class="astuce-bac">';
                feedback += '<strong>üéØ ASTUCE BAC :</strong> ';
                feedback += `Les ${this.produitsAnalyses.length} produits analys√©s repr√©sentent ${eauTotale.toLocaleString()}L d'eau, soit ${equivalentBaignoires} baignoires ! `;
                feedback += 'Retenez que l\'alimentation repr√©sente 70% de notre empreinte eau. ';
                feedback += 'La hi√©rarchie : viande de b≈ìuf > produits transform√©s > c√©r√©ales > l√©gumes. ';
                feedback += 'Pour l\'industrie : textile > √©lectronique > m√©tallurgie.';
                feedback += '</div>';
                
                feedback += '</div>';
                
                this.showFeedback('success', feedback);
            }

            showFeedback(type, content) {
                const overlay = document.getElementById('feedbackOverlay');
                const icon = document.getElementById('feedbackIcon');
                const title = document.getElementById('feedbackTitle');
                const feedbackContent = document.getElementById('feedbackContent');
                
                if (type === 'success') {
                    icon.textContent = 'üåç';
                    title.textContent = 'Laboratoire termin√© - Solutions identifi√©es !';
                } else {
                    icon.textContent = 'üß™';
                    title.textContent = 'Analyse en cours...';
                }
                
                feedbackContent.innerHTML = content;
                overlay.classList.add('show');
            }

            fermerFeedback() {
                document.getElementById('feedbackOverlay').classList.remove('show');
            }
        }

        // Initialisation au chargement de la page
        window.addEventListener('DOMContentLoaded', () => {
            new LaboratoireEmpreinteEau();
        });
    </script>
</body>
</html>