<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©vision A.2 - Les rythmes biologiques - Le sommeil - Bac Pro Seconde</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* En-t√™te p√©dagogique obligatoire */
        .cadre-pedagogique {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
        }

        .module-info h2 {
            font-size: 1.5em;
            margin-bottom: 10px;
            color: #4fc3f7;
        }

        .objectif {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #F2994A;
        }

        .niveau-cible {
            font-size: 1.1em;
            color: #4fc3f7;
            margin-top: 10px;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .btn-back {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.2);
            cursor: pointer;
        }
        
        .btn-back:hover {
            background: linear-gradient(135deg, #3a3a4e, #2e2e3f);
            transform: translateY(-2px);
        }
        
        .score-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            padding: 10px 20px;
            border-radius: 50px;
        }
        
        .score-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .score-item .icon {
            font-size: 18px;
        }
        
        /* √âcrans */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* √âcran d'accueil */
        .welcome-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .welcome-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #4fc3f7, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 30px;
        }
        
        /* Objectifs */
        .objectifs-card {
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.3), rgba(102, 126, 234, 0.3));
            border: 2px solid rgba(79, 195, 247, 0.5);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: left;
        }
        
        .objectifs-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .objectif-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
            line-height: 1.5;
        }
        
        .objectif-item:last-child {
            border-bottom: none;
        }
        
        .objectif-item .check {
            color: #4CAF50;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .competences-row {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .comp-badge {
            background: rgba(255,255,255,0.15);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .comp-badge.c1 { background: rgba(231, 76, 60, 0.3); border: 1px solid #e74c3c; }
        .comp-badge.c2 { background: rgba(52, 152, 219, 0.3); border: 1px solid #3498db; }
        .comp-badge.c3 { background: rgba(46, 204, 113, 0.3); border: 1px solid #2ecc71; }
        .comp-badge.c4 { background: rgba(243, 156, 18, 0.3); border: 1px solid #f39c12; }
        .comp-badge.c5 { background: rgba(155, 89, 182, 0.3); border: 1px solid #9b59b6; }
        .comp-badge.c6 { background: rgba(26, 188, 156, 0.3); border: 1px solid #1abc9c; }
        
        /* Niveaux */
        .niveaux-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .niveau-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .niveau-card:hover:not(.locked) {
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.1), rgba(102, 126, 234, 0.1));
            transform: translateX(5px);
            border-color: rgba(79, 195, 247, 0.5);
        }
        
        .niveau-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .niveau-card.completed {
            border-color: #4CAF50;
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05));
        }
        
        .niveau-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }
        
        .niveau1 .niveau-icon { background: linear-gradient(135deg, #4CAF50, #45a049); }
        .niveau2 .niveau-icon { background: linear-gradient(135deg, #2196F3, #1976D2); }
        .niveau3 .niveau-icon { background: linear-gradient(135deg, #FF9800, #F57C00); }
        .niveau4 .niveau-icon { background: linear-gradient(135deg, #F44336, #D32F2F); }
        .niveau5 .niveau-icon { background: linear-gradient(135deg, #9C27B0, #7B1FA2); }
        
        .niveau-content {
            flex: 1;
        }
        
        .niveau-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .niveau-desc {
            font-size: 13px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 8px;
        }
        
        .niveau-progress {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 8px;
        }
        
        .progress-bar {
            flex: 1;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }
        
        .progress-text {
            font-size: 12px;
            font-weight: 600;
        }
        
        .btn-start {
            background: linear-gradient(135deg, #4fc3f7, #667eea);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        
        .btn-start:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(79, 195, 247, 0.4);
        }
        
        /* √âcran de jeu */
        .game-screen {
            text-align: center;
            position: relative;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .progress-info {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .streak-indicator {
            background: linear-gradient(135deg, #FF6B35, #F7931E);
            padding: 8px 15px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 700;
        }
        
        .card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 2px solid rgba(79, 195, 247, 0.3);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .card-type {
            background: linear-gradient(135deg, #4fc3f7, #667eea);
            padding: 8px 16px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .difficulty {
            display: flex;
            gap: 3px;
        }
        
        .star {
            color: #FFD700;
            font-size: 16px;
        }
        
        .star.empty {
            color: rgba(255,255,255,0.2);
        }
        
        .keyword-display {
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.2), rgba(102, 126, 234, 0.2));
            border: 2px solid rgba(79, 195, 247, 0.5);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: 700;
            text-align: center;
        }
        
        .question-section {
            margin: 25px 0;
        }
        
        .question-text {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            line-height: 1.4;
        }
        
        .answer-input {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            background: rgba(255,255,255,0.05);
            color: white;
            font-size: 16px;
            margin-bottom: 15px;
            transition: border-color 0.3s ease;
        }
        
        .answer-input:focus {
            outline: none;
            border-color: #4fc3f7;
        }
        
        .answer-input::placeholder {
            color: rgba(255,255,255,0.5);
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .option-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .option-btn:hover {
            background: rgba(79, 195, 247, 0.1);
            border-color: rgba(79, 195, 247, 0.5);
        }
        
        .option-btn.selected {
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.2), rgba(102, 126, 234, 0.2));
            border-color: #4fc3f7;
            transform: scale(1.02);
        }
        
        .option-letter {
            width: 30px;
            height: 30px;
            background: #4fc3f7;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            flex-shrink: 0;
        }
        
        .vf-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .vf-btn {
            flex: 1;
            min-width: 120px;
            padding: 20px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .vf-btn.vrai {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }
        
        .vf-btn.faux {
            background: linear-gradient(135deg, #F44336, #D32F2F);
            color: white;
        }
        
        .vf-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        
        .vf-btn.selected {
            transform: scale(1.1);
            box-shadow: 0 15px 30px rgba(0,0,0,0.4);
        }
        
        .hint-section {
            margin: 20px 0;
        }
        
        .btn-hint {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-hint:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 152, 0, 0.3);
        }
        
        .hint-text {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(245, 124, 0, 0.1));
            border: 1px solid rgba(255, 152, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .btn-validate {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
        }
        
        .btn-validate:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.4);
        }
        
        /* Overlay de feedback */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .feedback-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .feedback-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            border-radius: 20px;
            padding: 30px;
            margin: 20px;
            max-width: 500px;
            width: 100%;
            text-align: center;
            box-shadow: 0 25px 75px rgba(0,0,0,0.5);
            transform: translateY(30px);
            transition: all 0.3s ease;
        }
        
        .feedback-overlay.visible .feedback-card {
            transform: translateY(0);
        }
        
        .feedback-card.correct {
            border: 3px solid #4CAF50;
        }
        
        .feedback-card.incorrect {
            border: 3px solid #F44336;
        }
        
        .feedback-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }
        
        .feedback-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .feedback-points {
            font-size: 18px;
            font-weight: 600;
            color: #4CAF50;
            margin-bottom: 20px;
        }
        
        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }
        
        .feedback-explanation h4 {
            color: #4fc3f7;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .keyword-box {
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.2), rgba(102, 126, 234, 0.2));
            border: 1px solid rgba(79, 195, 247, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }
        
        .tip-box {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(245, 124, 0, 0.1));
            border: 1px solid rgba(255, 152, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .tip-box h5 {
            color: #FF9800;
            margin-bottom: 8px;
        }
        
        .btn-continue {
            background: linear-gradient(135deg, #4fc3f7, #667eea);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }
        
        .btn-continue:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(79, 195, 247, 0.4);
        }
        
        /* √âcran de r√©sultats */
        .results-screen {
            text-align: center;
            padding: 20px 0;
        }
        
        .results-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }
        
        .results-title {
            font-size: 32px;
            font-weight: 900;
            margin-bottom: 15px;
        }
        
        .results-score {
            font-size: 48px;
            font-weight: 900;
            background: linear-gradient(135deg, #4fc3f7, #667eea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 25px;
        }
        
        .results-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
        }
        
        .stat-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 14px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
        }
        
        .errors-recap {
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.1), rgba(211, 47, 47, 0.1));
            border: 1px solid rgba(244, 67, 54, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }
        
        .errors-recap h4 {
            color: #F44336;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .errors-list {
            list-style: none;
        }
        
        .errors-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
        }
        
        .errors-list li:last-child {
            border-bottom: none;
        }
        
        .results-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
        }
        
        .btn-retry {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-retry:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 152, 0, 0.4);
        }
        
        .btn-next-level {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-next-level:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.4);
        }
        
        .btn-home {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            color: white;
            border: 2px solid rgba(255,255,255,0.2);
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-home:hover {
            background: linear-gradient(135deg, #3a3a4e, #2e2e3f);
            transform: translateY(-2px);
        }
        
        /* Popup streak */
        .streak-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #FF6B35, #F7931E);
            color: white;
            padding: 20px 40px;
            border-radius: 50px;
            font-size: 24px;
            font-weight: 900;
            z-index: 1001;
            display: none;
            animation: pulse 1s ease;
        }
        
        /* Confettis */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #FFD700;
            animation: confetti-fall 3s linear forwards;
            z-index: 999;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .cadre-pedagogique {
                padding: 15px;
            }
            
            .module-info h2 {
                font-size: 1.3em;
            }
            
            .welcome-title {
                font-size: 32px;
            }
            
            .card {
                padding: 20px;
            }
            
            .results-stats {
                grid-template-columns: 1fr;
            }
            
            .results-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .btn-start,
            .btn-validate,
            .btn-continue,
            .btn-retry,
            .btn-next-level,
            .btn-home {
                width: 100%;
                max-width: 300px;
            }
            
            .vf-container {
                flex-direction: column;
            }
            
            .vf-btn {
                min-width: auto;
            }
        }
        
        @media (max-width: 480px) {
            .header {
                flex-direction: column;
            }
            
            .score-bar {
                flex-direction: column;
                gap: 10px;
            }
            
            .game-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .progress-info {
                justify-content: center;
            }
        }

        /* Sigles explicit√©s */
        .sigle-tooltip {
            position: relative;
            border-bottom: 1px dotted rgba(255,255,255,0.5);
            cursor: help;
        }

        .sigle-tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .sigle-tooltip:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-5px);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE -->
        <div class="cadre-pedagogique">
            <div class="module-info">
                <h2>Module A.2 : Les rythmes biologiques - Le sommeil</h2>
                <div class="objectif">
                    <strong>Objectif :</strong> Pr√©server les rythmes biologiques, dont le sommeil, pour √™tre en bonne sant√© tout en respectant les rythmes sociaux.
                </div>
            </div>
            <div class="niveau-cible">
                <strong>Niveau :</strong> Bac Pro Seconde
            </div>
        </div>

        <!-- Header -->
        <div class="header">
            <button class="btn-back" onclick="goHome()">üè† Accueil</button>
            <div class="score-bar">
                <div class="score-item">
                    <span class="icon">üèÜ</span>
                    <span id="totalPoints">0</span>
                </div>
                <div class="score-item">
                    <span class="icon">üî•</span>
                    <span id="currentStreak">0</span>
                </div>
            </div>
        </div>

        <!-- √âcran d'accueil -->
        <div class="screen active" id="homeScreen">
            <div class="welcome-screen">
                <h1 class="welcome-title">üåô Flashcards A.2</h1>
                <p class="welcome-subtitle">Ma√Ætrise tes rythmes biologiques et le sommeil</p>
                
                <div class="objectifs-card">
                    <h3>üéØ Objectifs d'apprentissage</h3>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <div>Identifier les diff√©rents types de rythmes biologiques (circadiens, ultradiens, infradiens)</div>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <div>Comprendre le fonctionnement de l'horloge biologique et ses synchroniseurs</div>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <div>Analyser les phases du sommeil et leurs r√¥les physiologiques</div>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <div>Conna√Ætre la r√©glementation du travail de nuit et le <span class="sigle-tooltip" data-tooltip="Compte Professionnel de Pr√©vention">C2P</span></div>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <div>Appliquer les r√®gles d'hygi√®ne du sommeil pour pr√©server sa sant√©</div>
                    </div>
                    
                    <div class="competences-row">
                        <span class="comp-badge c1">C1 - Traiter une information</span>
                        <span class="comp-badge c2">C2 - Appliquer une d√©marche d'analyse</span>
                        <span class="comp-badge c3">C3 - Expliquer un ph√©nom√®ne physiologique</span>
                        <span class="comp-badge c4">C4 - Proposer une solution</span>
                    </div>
                </div>
                
                <div class="niveaux-grid">
                    <div class="niveau-card niveau1" onclick="startLevel(1)">
                        <div class="niveau-icon">üå±</div>
                        <div class="niveau-content">
                            <div class="niveau-title">Niveau 1 : D√©couverte</div>
                            <div class="niveau-desc">Les bases des rythmes biologiques</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level1Bar" style="width: 0%"></div>
                                </div>
                                <div class="progress-text" id="level1Percent">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card niveau2" onclick="startLevel(2)">
                        <div class="niveau-icon">üß¨</div>
                        <div class="niveau-content">
                            <div class="niveau-title">Niveau 2 : M√©canismes</div>
                            <div class="niveau-desc">Horloge biologique et synchroniseurs</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level2Bar" style="width: 0%"></div>
                                </div>
                                <div class="progress-text" id="level2Percent">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card niveau3" onclick="startLevel(3)">
                        <div class="niveau-icon">üò¥</div>
                        <div class="niveau-content">
                            <div class="niveau-title">Niveau 3 : Sommeil</div>
                            <div class="niveau-desc">Cycles, phases et fonctions du sommeil</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level3Bar" style="width: 0%"></div>
                                </div>
                                <div class="progress-text" id="level3Percent">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card niveau4" onclick="startLevel(4)">
                        <div class="niveau-icon">‚öñÔ∏è</div>
                        <div class="niveau-content">
                            <div class="niveau-title">Niveau 4 : R√©glementation</div>
                            <div class="niveau-desc">Travail de nuit et protection des salari√©s</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level4Bar" style="width: 0%"></div>
                                </div>
                                <div class="progress-text" id="level4Percent">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="niveau-card niveau5" onclick="startLevel(5)">
                        <div class="niveau-icon">üéØ</div>
                        <div class="niveau-content">
                            <div class="niveau-title">Niveau 5 : Ma√Ætrise</div>
                            <div class="niveau-desc">Hygi√®ne du sommeil et pr√©vention</div>
                            <div class="niveau-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="level5Bar" style="width: 0%"></div>
                                </div>
                                <div class="progress-text" id="level5Percent">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="btn-start" onclick="startLevel(1)">üöÄ Commencer l'aventure</button>
            </div>
        </div>

        <!-- √âcran de jeu -->
        <div class="screen" id="gameScreen">
            <div class="game-screen">
                <div class="game-header">
                    <div class="progress-info">
                        <span>Niveau <span id="currentLevelDisplay">1</span></span>
                        <span>‚Ä¢</span>
                        <span id="cardProgress">1/10</span>
                    </div>
                    <div class="streak-indicator">
                        üî• S√©rie : <span id="streakDisplay">0</span>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-type" id="cardType">D√©finition</div>
                        <div class="difficulty" id="difficulty">
                            <span class="star">‚òÖ</span>
                            <span class="star empty">‚òÖ</span>
                            <span class="star empty">‚òÖ</span>
                        </div>
                    </div>
                    
                    <div class="keyword-display" id="keywordDisplay">
                        Rythme circadien
                    </div>
                    
                    <div class="question-section" id="questionSection">
                        <!-- Contenu dynamique -->
                    </div>
                    
                    <div class="hint-section">
                        <button class="btn-hint" onclick="showHint()">üí° Indice</button>
                        <div class="hint-text" id="hintText" style="display: none;"></div>
                    </div>
                    
                    <button class="btn-validate" onclick="validateAnswer()">‚úì Valider</button>
                </div>
            </div>
        </div>

        <!-- √âcran de r√©sultats -->
        <div class="screen" id="resultsScreen">
            <div class="results-screen">
                <div class="results-icon" id="resultsIcon">üéâ</div>
                <h2 class="results-title" id="resultsTitle">Niveau r√©ussi !</h2>
                <div class="results-score" id="resultsScore">85%</div>
                
                <div class="results-stats">
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-label">R√©ponses correctes</div>
                        <div class="stat-value" id="correctCount">8/10</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-label">Points gagn√©s</div>
                        <div class="stat-value" id="pointsEarned">+75</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üî•</div>
                        <div class="stat-label">Meilleure s√©rie</div>
                        <div class="stat-value" id="bestStreak">5</div>
                    </div>
                </div>
                
                <div class="errors-recap" id="errorsRecap" style="display: none;">
                    <h4>‚ö†Ô∏è Points √† revoir</h4>
                    <ul class="errors-list" id="errorsList"></ul>
                </div>
                
                <div class="results-actions">
                    <button class="btn-home" onclick="goHome()">üè† Accueil</button>
                    <button class="btn-retry" onclick="retryLevel()">üîÑ Recommencer</button>
                    <button class="btn-next-level" id="nextLevelBtn" onclick="nextLevel()" style="display: none;">‚û°Ô∏è Niveau suivant</button>
                </div>
            </div>
        </div>

        <!-- Overlay de feedback -->
        <div class="feedback-overlay" id="feedbackOverlay">
            <div class="feedback-card" id="feedbackCard">
                <div class="feedback-icon" id="feedbackIcon">‚úÖ</div>
                <h3 class="feedback-title" id="feedbackTitle">Bravo !</h3>
                <div class="feedback-points" id="feedbackPoints">+10 points</div>
                
                <div class="feedback-explanation" id="feedbackExplanation">
                    <!-- Contenu dynamique -->
                </div>
                
                <button class="btn-continue" onclick="nextCard()">Continuer ‚û°Ô∏è</button>
            </div>
        </div>

        <!-- Popup streak -->
        <div class="streak-popup" id="streakPopup"></div>
    </div>

    <script>
        // Variables globales
        let currentLevel = 1;
        let currentCardIndex = 0;
        let totalPoints = parseInt(localStorage.getItem('totalPoints') || '0');
        let currentStreak = 0;
        let bestStreak = 0;
        let hintUsed = false;
        let levelProgress = JSON.parse(localStorage.getItem('levelProgress') || '[0,0,0,0,0,0]');
        let levelCorrect = 0;
        let levelPoints = 0;
        let levelErrors = [];

        // Donn√©es des cartes par niveau
        const levels = [
            {}, // Index 0 non utilis√©
            {
                name: "D√©couverte",
                cards: [
                    {
                        type: 'keyword',
                        keyword: 'Rythme circadien',
                        question: 'D√©finis ce terme fondamental des rythmes biologiques :',
                        answer: 'rythme biologique de 24 heures',
                        explanation: 'Les rythmes circadiens (du latin "circa" = environ, "dies" = jour) sont des rythmes biologiques d\'environ 24 heures. L\'exemple le plus connu est l\'alternance veille-sommeil.',
                        hint: 'Du latin "circa" (environ) et "dies" (jour)',
                        tip: 'Retenir : Circadien = CIRca DIes = environ 1 jour = 24h',
                        difficulty: 1
                    },
                    {
                        type: 'qcm',
                        keyword: 'Types de rythmes',
                        question: 'Combien existe-t-il de types de rythmes biologiques principaux ?',
                        options: ['2 types', '3 types', '4 types', '5 types'],
                        answer: 1,
                        explanation: 'Il existe 3 types principaux de rythmes biologiques : les rythmes ultradiens (< 24h), circadiens (‚âà 24h) et infradiens (> 24h).',
                        hint: 'Pense aux pr√©fixes : ultra-, circa-, infra-',
                        tip: 'M√©moriser : Ultra < 24h < Circa ‚âà 24h < Infra > 24h',
                        difficulty: 1
                    },
                    {
                        type: 'vf',
                        keyword: 'Rythme cardiaque',
                        question: 'Le rythme cardiaque est un rythme ultradien (moins de 24h)',
                        answer: true,
                        explanation: 'Vrai ! Le rythme cardiaque au repos est d\'environ 60-100 battements par minute, soit bien moins de 24h. C\'est donc un rythme ultradien.',
                        hint: 'Combien de temps dure un battement cardiaque ?',
                        tip: 'Tous les rythmes physiologiques rapides sont ultradiens',
                        difficulty: 1
                    },
                    {
                        type: 'keyword',
                        keyword: 'Cycle menstruel',
                        question: '√Ä quel type de rythme appartient le cycle menstruel ?',
                        answer: 'rythme infradien',
                        explanation: 'Le cycle menstruel dure environ 28 jours, soit plus de 24h. C\'est donc un rythme infradien (dur√©e sup√©rieure √† 24h).',
                        hint: 'Il dure environ 4 semaines...',
                        tip: 'Infra = au-dessus de 24h (cycle menstruel, saisons...)',
                        difficulty: 1
                    },
                    {
                        type: 'qcm',
                        keyword: 'Fr√©quence',
                        question: 'La fr√©quence d\'un rythme biologique correspond √† :',
                        options: ['La dur√©e d\'un cycle', 'Le nombre de cycles sur un temps T', 'L\'amplitude du rythme', 'La r√©gularit√© du rythme'],
                        answer: 1,
                        explanation: 'La fr√©quence correspond au nombre de fois qu\'un ph√©nom√®ne se reproduit sur un temps donn√©. Par exemple : 16 cycles respiratoires par minute.',
                        hint: 'Fr√©quence = nombre de fois par...',
                        tip: 'Ne pas confondre avec la p√©riode (dur√©e d\'un cycle)',
                        difficulty: 1
                    },
                    {
                        type: 'vf',
                        keyword: 'Alternance veille-sommeil',
                        question: 'L\'alternance veille-sommeil est un rythme infradien',
                        answer: false,
                        explanation: 'Faux ! L\'alternance veille-sommeil se d√©roule sur 24h environ (on dort et on est √©veill√© chaque jour). C\'est donc un rythme circadien.',
                        hint: 'Combien de fois dors-tu par jour ?',
                        tip: 'Veille-sommeil = 1 cycle par jour = circadien',
                        difficulty: 1
                    },
                    {
                        type: 'keyword',
                        keyword: 'Horloge biologique',
                        question: 'O√π se situe l\'horloge biologique principale dans le corps humain ?',
                        answer: 'cerveau',
                        explanation: 'L\'horloge biologique principale (noyaux suprachiasmatiques) se situe dans le cerveau, plus pr√©cis√©ment dans l\'hypothalamus.',
                        hint: 'C\'est l\'organe de contr√¥le du corps...',
                        tip: 'Hypothalamus = centre de contr√¥le des rythmes',
                        difficulty: 1
                    },
                    {
                        type: 'qcm',
                        keyword: 'Synchroniseurs',
                        question: 'Quel est le synchroniseur principal de l\'horloge biologique ?',
                        options: ['Les repas', 'La lumi√®re', 'L\'exercice physique', 'Le travail'],
                        answer: 1,
                        explanation: 'La lumi√®re est le synchroniseur principal. Elle informe l\'horloge biologique de l\'alternance jour-nuit et r√©gule la production de m√©latonine.',
                        hint: 'Qu\'est-ce qui diff√©rencie le jour de la nuit ?',
                        tip: 'Lumi√®re = synchroniseur n¬∞1, les autres = synchroniseurs secondaires',
                        difficulty: 1
                    },
                    {
                        type: 'vf',
                        keyword: 'M√©latonine',
                        question: 'La m√©latonine est produite principalement le jour',
                        answer: false,
                        explanation: 'Faux ! La m√©latonine est l\'hormone du sommeil, produite principalement la nuit quand il fait sombre. Sa production est inhib√©e par la lumi√®re.',
                        hint: 'M√©latonine = hormone du sommeil...',
                        tip: 'M√©latonine = hormone de l\'obscurit√© (nuit)',
                        difficulty: 1
                    },
                    {
                        type: 'keyword',
                        keyword: 'D√©synchronisation',
                        question: 'Que se passe-t-il quand les synchroniseurs sont perturb√©s ?',
                        answer: 'd√©synchronisation',
                        explanation: 'Quand les synchroniseurs (lumi√®re, rythmes sociaux) sont modifi√©s, l\'horloge biologique se d√©r√®gle et les rythmes biologiques se d√©synchronisent, causant des troubles.',
                        hint: 'Le contraire de synchronisation...',
                        tip: 'D√©synchronisation ‚Üí troubles jusqu\'√† adaptation progressive',
                        difficulty: 2
                    }
                ]
            },
            {
                name: "M√©canismes",
                cards: [
                    {
                        type: 'qcm',
                        keyword: 'Production de m√©latonine',
                        question: '√Ä quel moment la production de m√©latonine est-elle maximale ?',
                        options: ['12h (midi)', '18h (coucher du soleil)', '2-4h du matin', '6h (lever du soleil)'],
                        answer: 2,
                        explanation: 'La production de m√©latonine atteint son pic entre 2h et 4h du matin, au moment de l\'obscurit√© maximale. Elle d√©marre vers 21h et s\'arr√™te vers 6h.',
                        hint: 'Au c≈ìur de la nuit...',
                        tip: 'Pic de m√©latonine = milieu de la nuit = sommeil profond',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Lumi√®re bleue',
                        question: 'Pourquoi la lumi√®re bleue des √©crans perturbe-t-elle le sommeil ?',
                        answer: 'inhibe la m√©latonine',
                        explanation: 'La lumi√®re bleue des √©crans est per√ßue par le cerveau comme de la lumi√®re du jour. Elle inhibe donc la production de m√©latonine, retardant l\'endormissement.',
                        hint: 'Le cerveau confond cette lumi√®re avec...',
                        tip: 'Lumi√®re bleue = fausse lumi√®re du jour = pas de m√©latonine',
                        difficulty: 2
                    },
                    {
                        type: 'vf',
                        keyword: 'Cellules photor√©ceptrices',
                        question: 'Les cellules photor√©ceptrices de la r√©tine d√©tectent seulement les images',
                        answer: false,
                        explanation: 'Faux ! Les cellules photor√©ceptrices sp√©cialis√©es de la r√©tine d√©tectent aussi l\'alternance jour-nuit et envoient cette information √† l\'horloge biologique.',
                        hint: 'Elles ont une double fonction...',
                        tip: 'R√©tine : vision + d√©tection jour/nuit pour horloge biologique',
                        difficulty: 2
                    },
                    {
                        type: 'qcm',
                        keyword: 'Synchroniseurs secondaires',
                        question: 'Quels sont les synchroniseurs secondaires de l\'horloge biologique ?',
                        options: ['Uniquement les repas', 'Lumi√®re et temp√©rature', 'Repas, travail, loisirs, sport', 'Seulement les hormones'],
                        answer: 2,
                        explanation: 'Les synchroniseurs secondaires incluent les rythmes sociaux : horaires de repas, de travail, activit√©s sportives, loisirs. Ils renforcent l\'action de la lumi√®re.',
                        hint: 'Les activit√©s qui structurent nos journ√©es...',
                        tip: 'Synchroniseurs secondaires = tous nos rythmes sociaux',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'D√©calage horaire',
                        question: 'Quel ph√©nom√®ne se produit lors d\'un voyage avec d√©calage horaire ?',
                        answer: 'd√©synchronisation temporaire',
                        explanation: 'Le d√©calage horaire provoque une d√©synchronisation temporaire entre l\'horloge biologique interne (encore cal√©e sur l\'ancien fuseau) et les nouveaux synchroniseurs externes.',
                        hint: 'L\'horloge interne n\'est plus en phase avec...',
                        tip: 'Adaptation = 1 jour par heure de d√©calage environ',
                        difficulty: 2
                    },
                    {
                        type: 'vf',
                        keyword: 'Adaptation d√©calage',
                        question: 'L\'adaptation au d√©calage horaire est imm√©diate',
                        answer: false,
                        explanation: 'Faux ! L\'adaptation prend du temps : environ 1 jour par heure de d√©calage. Pour un d√©calage de 6h, il faut environ 6 jours pour s\'adapter compl√®tement.',
                        hint: 'Combien de temps pour s\'habituer √† un nouveau rythme ?',
                        tip: 'Patience n√©cessaire : 1 jour = 1h de d√©calage',
                        difficulty: 2
                    },
                    {
                        type: 'qcm',
                        keyword: 'Temp√©rature corporelle',
                        question: 'Comment √©volue la temp√©rature corporelle sur 24h ?',
                        options: ['Elle reste constante', 'Elle augmente la nuit', 'Elle diminue la nuit', 'Elle varie au hasard'],
                        answer: 2,
                        explanation: 'La temp√©rature corporelle suit un rythme circadien : elle diminue la nuit (minimum vers 4h) et augmente le jour (maximum vers 18h). Cette baisse favorise l\'endormissement.',
                        hint: 'Que se passe-t-il quand tu as sommeil ?',
                        tip: 'Temp√©rature ‚Üì la nuit = signal naturel de sommeil',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Glande pin√©ale',
                        question: 'Quelle glande produit la m√©latonine ?',
                        answer: 'glande pin√©ale',
                        explanation: 'La glande pin√©ale (ou √©piphyse) est une petite glande situ√©e dans le cerveau qui produit la m√©latonine en r√©ponse aux signaux de l\'horloge biologique.',
                        hint: 'Une petite glande dans le cerveau...',
                        tip: 'Pin√©ale = usine √† m√©latonine du cerveau',
                        difficulty: 2
                    },
                    {
                        type: 'vf',
                        keyword: 'Hormones de croissance',
                        question: 'Les hormones de croissance sont s√©cr√©t√©es principalement pendant le sommeil',
                        answer: true,
                        explanation: 'Vrai ! Les hormones de croissance sont massivement s√©cr√©t√©es pendant le sommeil lent profond, particuli√®rement en d√©but de nuit. C\'est pourquoi le sommeil est crucial pour la croissance.',
                        hint: 'Quand grandit-on le plus ?',
                        tip: 'Sommeil profond = croissance maximale',
                        difficulty: 2
                    },
                    {
                        type: 'qcm',
                        keyword: 'Chronotype',
                        question: 'Qu\'est-ce qu\'un chronotype ?',
                        options: ['Un trouble du sommeil', 'Un m√©dicament pour dormir', 'Le profil temporel individuel', 'Un appareil de mesure'],
                        answer: 2,
                        explanation: 'Le chronotype correspond au profil temporel individuel : certaines personnes sont "du matin" (l√®ve-t√¥t), d\'autres "du soir" (couche-tard). C\'est en partie g√©n√©tique.',
                        hint: 'Es-tu plut√¥t du matin ou du soir ?',
                        tip: 'Chronotype = horloge biologique personnelle',
                        difficulty: 3
                    }
                ]
            },
            {
                name: "Sommeil",
                cards: [
                    {
                        type: 'keyword',
                        keyword: 'Cycle de sommeil',
                        question: 'Quelle est la dur√©e moyenne d\'un cycle de sommeil ?',
                        answer: '90 minutes',
                        explanation: 'Un cycle de sommeil dure environ 90 minutes (entre 80 et 120 minutes selon les individus). Une nuit compl√®te comprend 4 √† 5 cycles cons√©cutifs.',
                        hint: 'Une heure et demie environ...',
                        tip: 'Se r√©veiller en fin de cycle = r√©veil plus facile',
                        difficulty: 2
                    },
                    {
                        type: 'qcm',
                        keyword: 'Phases du sommeil',
                        question: 'Combien de phases principales compose un cycle de sommeil ?',
                        options: ['2 phases', '3 phases', '4 phases', '5 phases'],
                        answer: 1,
                        explanation: 'Un cycle comprend 3 phases principales : sommeil lent l√©ger, sommeil lent profond, et sommeil paradoxal (appel√© aussi <span class="sigle-tooltip" data-tooltip="Rapid Eye Movement">REM</span>).',
                        hint: 'L√©ger, profond, et...',
                        tip: 'M√©moriser : L√©ger ‚Üí Profond ‚Üí Paradoxal',
                        difficulty: 2
                    },
                    {
                        type: 'vf',
                        keyword: 'Sommeil paradoxal',
                        question: 'Le sommeil paradoxal sert uniquement √† r√™ver',
                        answer: false,
                        explanation: 'Faux ! Le sommeil paradoxal a plusieurs r√¥les cruciaux : consolidation de la m√©moire, √©vacuation du stress, r√©cup√©ration mentale, et r√©gulation √©motionnelle.',
                        hint: 'Il a des fonctions vitales pour le cerveau...',
                        tip: 'Paradoxal = r√©cup√©ration mentale + m√©moire + √©motions',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Sommeil lent profond',
                        question: 'Quel est le r√¥le principal du sommeil lent profond ?',
                        answer: 'r√©cup√©ration physique',
                        explanation: 'Le sommeil lent profond assure la r√©cup√©ration physique : r√©paration des tissus, croissance, renforcement du syst√®me immunitaire, et √©limination des toxines.',
                        hint: 'Pour le corps et les muscles...',
                        tip: 'Lent profond = r√©paration du corps, paradoxal = r√©paration de l\'esprit',
                        difficulty: 2
                    },
                    {
                        type: 'qcm',
                        keyword: 'Activit√© c√©r√©brale',
                        question: 'Pendant quel type de sommeil l\'activit√© c√©r√©brale est-elle la plus intense ?',
                        options: ['Sommeil lent l√©ger', 'Sommeil lent profond', 'Sommeil paradoxal', 'Toutes les phases √©gales'],
                        answer: 2,
                        explanation: 'Pendant le sommeil paradoxal, l\'activit√© c√©r√©brale est aussi intense qu\'√† l\'√©veil. C\'est pourquoi on l\'appelle "paradoxal" : le cerveau semble √©veill√© mais le corps dort.',
                        hint: 'Le cerveau travaille comme s\'il √©tait √©veill√©...',
                        tip: 'Paradoxal = cerveau actif + corps paralys√© = paradoxe !',
                        difficulty: 2
                    },
                    {
                        type: 'vf',
                        keyword: 'Mouvements oculaires',
                        question: 'Les mouvements oculaires rapides caract√©risent le sommeil lent profond',
                        answer: false,
                        explanation: 'Faux ! Les mouvements oculaires rapides (<span class="sigle-tooltip" data-tooltip="Rapid Eye Movement">REM</span>) caract√©risent le sommeil paradoxal. D\'o√π son nom anglais "REM sleep".',
                        hint: 'REM = Rapid Eye Movement...',
                        tip: 'REM = mouvements oculaires = sommeil paradoxal',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Hypnogramme',
                        question: 'Comment appelle-t-on le graphique qui repr√©sente les phases de sommeil ?',
                        answer: 'hypnogramme',
                        explanation: 'L\'hypnogramme est un graphique qui visualise les diff√©rentes phases de sommeil au cours d\'une nuit, permettant d\'analyser la qualit√© du sommeil.',
                        hint: 'Hypno = sommeil, gramme = graphique...',
                        tip: 'Hypnogramme = "graphique du sommeil"',
                        difficulty: 3
                    },
                    {
                        type: 'qcm',
                        keyword: 'R√©partition du sommeil',
                        question: '√Ä quel moment de la nuit le sommeil paradoxal est-il le plus abondant ?',
                        options: ['D√©but de nuit', 'Milieu de nuit', 'Fin de nuit', 'R√©parti uniform√©ment'],
                        answer: 2,
                        explanation: 'Le sommeil paradoxal est plus abondant en fin de nuit, tandis que le sommeil lent profond domine en d√©but de nuit. C\'est pourquoi couper sa nuit affecte la r√©cup√©ration mentale.',
                        hint: 'Les r√™ves les plus intenses sont au r√©veil...',
                        tip: 'D√©but = r√©cup√©ration physique, fin = r√©cup√©ration mentale',
                        difficulty: 3
                    },
                    {
                        type: 'vf',
                        keyword: 'Paralysie musculaire',
                        question: 'Pendant le sommeil paradoxal, les muscles squelettiques sont compl√®tement rel√¢ch√©s',
                        answer: true,
                        explanation: 'Vrai ! Pendant le sommeil paradoxal, il y a une paralysie compl√®te des muscles squelettiques (sauf le diaphragme). Cela √©vite de "jouer" nos r√™ves.',
                        hint: 'Protection contre nos r√™ves d\'action...',
                        tip: 'Paralysie = protection naturelle contre les r√™ves agit√©s',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Consolidation m√©moire',
                        question: 'Pendant quelle phase le cerveau consolide-t-il principalement la m√©moire ?',
                        answer: 'sommeil paradoxal',
                        explanation: 'Le sommeil paradoxal joue un r√¥le crucial dans la consolidation de la m√©moire : les informations de la journ√©e sont tri√©es, organis√©es et transf√©r√©es en m√©moire √† long terme.',
                        hint: 'Quand le cerveau "range" les souvenirs de la journ√©e...',
                        tip: 'Paradoxal = archivage des souvenirs importants',
                        difficulty: 2
                    }
                ]
            },
            {
                name: "R√©glementation",
                cards: [
                    {
                        type: 'qcm',
                        keyword: 'D√©finition travail de nuit',
                        question: 'Selon le Code du Travail, le travail de nuit se situe entre :',
                        options: ['20h et 5h', '21h et 6h', '22h et 7h', '23h et 8h'],
                        answer: 1,
                        explanation: 'Le Code du Travail d√©finit le travail de nuit comme tout travail effectu√© entre 21h et 6h du matin.',
                        hint: 'De 21h √† 6h du matin...',
                        tip: '21h-6h = d√©finition l√©gale fran√ßaise du travail de nuit',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Dur√©e maximale quotidienne',
                        question: 'Quelle est la dur√©e maximale quotidienne autoris√©e pour le travail de nuit ?',
                        answer: '8 heures',
                        explanation: 'La dur√©e maximale du travail de nuit est de 8 heures cons√©cutives par p√©riode de 24h, pour prot√©ger la sant√© des travailleurs.',
                        hint: 'Une journ√©e de travail normale...',
                        tip: 'M√™me dur√©e que le jour, mais plus strictement contr√¥l√©e',
                        difficulty: 2
                    },
                    {
                        type: 'vf',
                        keyword: 'Dur√©e hebdomadaire',
                        question: 'La dur√©e hebdomadaire maximale du travail de nuit est de 35 heures',
                        answer: false,
                        explanation: 'Faux ! La dur√©e hebdomadaire maximale est de 40 heures calcul√©e sur une p√©riode de 12 semaines cons√©cutives.',
                        hint: '40 heures sur 12 semaines...',
                        tip: '40h/semaine en moyenne sur 12 semaines = flexibilit√© encadr√©e',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Repos obligatoire',
                        question: 'Combien d\'heures de repos cons√©cutives sont obligatoires apr√®s le travail de nuit ?',
                        answer: '11 heures',
                        explanation: 'Le travailleur de nuit doit b√©n√©ficier d\'au moins 11 heures de repos cons√©cutives apr√®s sa p√©riode de travail.',
                        hint: 'Plus que les 8h travaill√©es...',
                        tip: '11h de repos = r√©cup√©ration obligatoire apr√®s d√©synchronisation',
                        difficulty: 2
                    },
                    {
                        type: 'qcm',
                        keyword: '<span class="sigle-tooltip" data-tooltip="Compte Professionnel de Pr√©vention">C2P</span>',
                        question: 'Que signifie le sigle <span class="sigle-tooltip" data-tooltip="Compte Professionnel de Pr√©vention">C2P</span> ?',
                        options: ['Certificat de Comp√©tence Professionnelle', 'Compte Professionnel de Pr√©vention', 'Centre de Protection des Professionnels', 'Contr√¥le de la P√©nibilit√© au Poste'],
                        answer: 1,
                        explanation: 'Le <span class="sigle-tooltip" data-tooltip="Compte Professionnel de Pr√©vention">C2P</span> signifie "Compte Professionnel de Pr√©vention". Il permet aux salari√©s expos√©s √† la p√©nibilit√© d\'acqu√©rir des points pour leur retraite, formation ou temps partiel.',
                        hint: 'Li√© √† la pr√©vention de la p√©nibilit√©...',
                        tip: 'C2P = compensation de la p√©nibilit√© professionnelle',
                        difficulty: 1
                    },
                    {
                        type: 'vf',
                        keyword: 'Travail de nuit p√©nible',
                        question: 'Le travail de nuit est consid√©r√© comme un facteur de p√©nibilit√©',
                        answer: true,
                        explanation: 'Vrai ! Le travail de nuit figure parmi les 6 crit√®res de p√©nibilit√© maintenus, donnant droit au <span class="sigle-tooltip" data-tooltip="Compte Professionnel de Pr√©vention">C2P</span>.',
                        hint: 'Il ouvre des droits particuliers...',
                        tip: 'Travail de nuit = p√©nibilit√© reconnue = droits C2P',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Surveillance m√©dicale',
                        question: 'Quel type de surveillance m√©dicale est obligatoire pour les travailleurs de nuit ?',
                        answer: 'surveillance renforc√©e',
                        explanation: 'Les travailleurs de nuit b√©n√©ficient d\'une surveillance m√©dicale renforc√©e avec des examens plus fr√©quents et approfondis.',
                        hint: 'Plus stricte que pour le travail de jour...',
                        tip: 'Surveillance renforc√©e = pr√©vention des risques sant√©',
                        difficulty: 2
                    },
                    {
                        type: 'qcm',
                        keyword: 'Utilisation <span class="sigle-tooltip" data-tooltip="Compte Professionnel de Pr√©vention">C2P</span>',
                        question: 'Les points <span class="sigle-tooltip" data-tooltip="Compte Professionnel de Pr√©vention">C2P</span> peuvent servir √† :',
                        options: ['Uniquement la retraite anticip√©e', 'Formation et temps partiel seulement', 'Retraite, formation et temps partiel', 'Augmentation de salaire'],
                        answer: 2,
                        explanation: 'Les points <span class="sigle-tooltip" data-tooltip="Compte Professionnel de Pr√©vention">C2P</span> peuvent √™tre utilis√©s pour : partir plus t√¥t √† la retraite, financer une formation, ou passer √† temps partiel sans perte de salaire.',
                        hint: '3 utilisations possibles...',
                        tip: '3 choix C2P = retraite OU formation OU temps partiel',
                        difficulty: 2
                    },
                    {
                        type: 'vf',
                        keyword: 'Priorit√© poste de jour',
                        question: 'Le travailleur de nuit est prioritaire pour obtenir un poste de jour',
                        answer: true,
                        explanation: 'Vrai ! Le salari√© de nuit b√©n√©ficie d\'un droit de priorit√© pour acc√©der √† un emploi de jour correspondant √† sa qualification.',
                        hint: 'Protection pour retrouver un rythme normal...',
                        tip: 'Priorit√© = possibilit√© de sortir du travail de nuit',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Compensation financi√®re',
                        question: 'Comment appelle-t-on la compensation accord√©e pour le travail de nuit ?',
                        answer: 'contrepartie',
                        explanation: 'Les travailleurs de nuit ont droit √† une contrepartie sous forme de repos compensateur ou de majoration salariale, selon les accords d\'entreprise.',
                        hint: 'Une compensation pour la p√©nibilit√©...',
                        tip: 'Contrepartie = reconnaissance de la contrainte nocturne',
                        difficulty: 2
                    }
                ]
            },
            {
                name: "Ma√Ætrise",
                cards: [
                    {
                        type: 'qcm',
                        keyword: 'Temp√©rature chambre',
                        question: 'Quelle est la temp√©rature id√©ale d\'une chambre pour bien dormir ?',
                        options: ['15¬∞C', '17¬∞C', '20¬∞C', '22¬∞C'],
                        answer: 1,
                        explanation: 'La temp√©rature id√©ale d\'une chambre √† coucher est de 17¬∞C. Cette temp√©rature fra√Æche favorise la baisse naturelle de la temp√©rature corporelle n√©cessaire √† l\'endormissement.',
                        hint: 'Plus frais que la temp√©rature d\'une pi√®ce de vie...',
                        tip: '17¬∞C = temp√©rature optimale pour d√©clencher le sommeil',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Arr√™t des √©crans',
                        question: 'Combien de temps avant le coucher faut-il arr√™ter les √©crans ?',
                        answer: '1 heure',
                        explanation: 'Il est recommand√© d\'arr√™ter les √©crans 1 heure avant le coucher pour permettre √† la production de m√©latonine de reprendre normalement.',
                        hint: 'Le temps que la m√©latonine se remette en marche...',
                        tip: '1h sans √©cran = temps de r√©cup√©ration de la m√©latonine',
                        difficulty: 2
                    },
                    {
                        type: 'vf',
                        keyword: 'Caf√© et sommeil',
                        question: 'Il faut √©viter le caf√© apr√®s 15h pour pr√©server le sommeil',
                        answer: true,
                        explanation: 'Vrai ! La caf√©ine met environ 6 heures √† √™tre √©limin√©e de l\'organisme. Un caf√© pris apr√®s 15h peut donc perturber l\'endormissement vers 21-22h.',
                        hint: '6 heures pour √©liminer la caf√©ine...',
                        tip: 'Caf√© apr√®s 15h = risque d\'insomnie le soir',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Signaux de sommeil',
                        question: 'Comment s\'appellent les signes naturels qui indiquent qu\'il faut aller dormir ?',
                        answer: 'signaux de sommeil',
                        explanation: 'Les signaux de sommeil sont des signes naturels (b√¢illements, yeux qui piquent, paupi√®res lourdes) qui indiquent le d√©but d\'un cycle de sommeil.',
                        hint: 'B√¢illements, yeux qui se ferment...',
                        tip: 'Respecter ces signaux = endormissement plus facile',
                        difficulty: 2
                    },
                    {
                        type: 'qcm',
                        keyword: 'Effet de l\'alcool',
                        question: 'Quel effet l\'alcool a-t-il sur le sommeil ?',
                        options: ['Il am√©liore la qualit√©', 'Il facilite l\'endormissement mais d√©grade la qualit√©', 'Il n\'a aucun effet', 'Il emp√™che totalement de dormir'],
                        answer: 1,
                        explanation: 'L\'alcool peut faciliter l\'endormissement initial mais d√©grade la qualit√© du sommeil : r√©veils fr√©quents, sommeil agit√©, et r√©duction du sommeil profond.',
                        hint: 'Facilite au d√©but mais d√©grade ensuite...',
                        tip: 'Alcool = faux ami du sommeil (pi√®ge classique)',
                        difficulty: 2
                    },
                    {
                        type: 'vf',
                        keyword: 'Sport le soir',
                        question: 'Faire du sport intense le soir favorise l\'endormissement',
                        answer: false,
                        explanation: 'Faux ! Le sport intense le soir augmente la temp√©rature corporelle et le taux d\'adr√©naline, retardant l\'endormissement. Il vaut mieux s\'arr√™ter 3-4h avant le coucher.',
                        hint: 'Adr√©naline + temp√©rature √©lev√©e = √©veil...',
                        tip: 'Sport = oui dans la journ√©e, non le soir',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Horaires r√©guliers',
                        question: 'Pourquoi est-il important de se coucher √† heures r√©guli√®res ?',
                        answer: 'synchroniser horloge biologique',
                        explanation: 'Des horaires r√©guliers aident l\'horloge biologique √† maintenir ses rythmes naturels et facilitent l\'endormissement √† l\'heure habituelle.',
                        hint: 'Pour que l\'horloge interne soit bien r√©gl√©e...',
                        tip: 'R√©gularit√© = meilleur ami de l\'horloge biologique',
                        difficulty: 2
                    },
                    {
                        type: 'qcm',
                        keyword: 'Dur√©e sommeil adolescent',
                        question: 'Combien d\'heures de sommeil sont recommand√©es pour un adolescent ?',
                        options: ['6-7 heures', '7-8 heures', '8-9 heures', '9-10 heures'],
                        answer: 2,
                        explanation: 'Les adolescents ont besoin de 8 √† 9 heures de sommeil par nuit pour assurer leur croissance, leur apprentissage et leur √©quilibre mental.',
                        hint: 'Plus qu\'un adulte, en p√©riode de croissance...',
                        tip: 'Adolescence = besoin de sommeil maximal (croissance + √©tudes)',
                        difficulty: 2
                    },
                    {
                        type: 'vf',
                        keyword: 'Sieste courte',
                        question: 'Une sieste de 20-30 minutes peut √™tre b√©n√©fique sans perturber le sommeil nocturne',
                        answer: true,
                        explanation: 'Vrai ! Une sieste courte (20-30 min) en d√©but d\'apr√®s-midi peut restaurer la vigilance sans perturber le sommeil nocturne.',
                        hint: 'Courte et pas trop tard dans la journ√©e...',
                        tip: 'Sieste power = 20 min max, avant 15h',
                        difficulty: 2
                    },
                    {
                        type: 'keyword',
                        keyword: 'Dette de sommeil',
                        question: 'Comment appelle-t-on l\'accumulation de manque de sommeil ?',
                        answer: 'dette de sommeil',
                        explanation: 'La dette de sommeil correspond au manque cumul√© d\'heures de sommeil. Elle ne se rattrape pas compl√®tement et affecte les performances cognitives et physiques.',
                        hint: 'Comme une dette financi√®re mais avec le sommeil...',
                        tip: 'Dette de sommeil = difficile √† rembourser compl√®tement',
                        difficulty: 3
                    }
                ]
            }
        ];

        function startLevel(level) {
            if (level > 1 && levelProgress[level-1] < 60) {
                alert('Termine d\'abord le niveau pr√©c√©dent avec au moins 60% !');
                return;
            }
            
            currentLevel = level;
            currentCardIndex = 0;
            levelCorrect = 0;
            levelPoints = 0;
            levelErrors = [];
            hintUsed = false;
            
            document.getElementById('homeScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');
            
            document.getElementById('currentLevelDisplay').textContent = level;
            
            showCard();
        }
        
        function showCard() {
            const card = levels[currentLevel].cards[currentCardIndex];
            const total = levels[currentLevel].cards.length;
            
            document.getElementById('cardProgress').textContent = `${currentCardIndex + 1}/${total}`;
            document.getElementById('keywordDisplay').innerHTML = card.keyword;
            document.getElementById('cardType').textContent = 
                card.type === 'keyword' ? 'D√©finition' :
                card.type === 'qcm' ? 'QCM' : 'Vrai/Faux';
            
            // Difficult√©
            const difficulty = document.getElementById('difficulty');
            const stars = difficulty.querySelectorAll('.star');
            stars.forEach((star, i) => {
                star.className = i < card.difficulty ? 'star' : 'star empty';
            });
            
            // Reset hint
            document.getElementById('hintText').style.display = 'none';
            hintUsed = false;
            
            const questionSection = document.getElementById('questionSection');
            
            if (card.type === 'keyword') {
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <input type="text" class="answer-input" id="keywordAnswer" placeholder="Ta r√©ponse ici...">
                `;
            }
            else if (card.type === 'qcm') {
                let optionsHTML = card.options.map((opt, i) => `
                    <button class="option-btn" data-index="${i}" onclick="selectOption(this)">
                        <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                        <span>${opt}</span>
                    </button>
                `).join('');
                
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="options-container">${optionsHTML}</div>
                `;
            }
            else if (card.type === 'vf') {
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="vf-container">
                        <button class="vf-btn vrai" onclick="selectVF(this, true)">‚úì VRAI</button>
                        <button class="vf-btn faux" onclick="selectVF(this, false)">‚úó FAUX</button>
                    </div>
                `;
            }
        }
        
        function selectOption(btn) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }
        
        function selectVF(btn, value) {
            document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            btn.dataset.value = value;
        }
        
        function showHint() {
            const card = levels[currentLevel].cards[currentCardIndex];
            if (card.hint) {
                document.getElementById('hintText').innerHTML = `üí° <strong>Indice :</strong> ${card.hint}`;
                document.getElementById('hintText').style.display = 'block';
                hintUsed = true;
            }
        }
        
        function validateAnswer() {
            const card = levels[currentLevel].cards[currentCardIndex];
            let isCorrect = false;
            let userAnswer = '';
            
            if (card.type === 'keyword') {
                userAnswer = document.getElementById('keywordAnswer').value.trim().toLowerCase();
                // Normaliser (accents, etc.)
                const normalize = str => str.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
                isCorrect = normalize(userAnswer) === normalize(card.answer) || 
                            userAnswer.includes(normalize(card.answer)) ||
                            normalize(card.answer).includes(userAnswer);
            }
            else if (card.type === 'qcm') {
                const selected = document.querySelector('.option-btn.selected');
                if (!selected) { alert('S√©lectionne une r√©ponse'); return; }
                userAnswer = parseInt(selected.dataset.index);
                isCorrect = userAnswer === card.answer;
            }
            else if (card.type === 'vf') {
                const selected = document.querySelector('.vf-btn.selected');
                if (!selected) { alert('S√©lectionne VRAI ou FAUX'); return; }
                userAnswer = selected.dataset.value === 'true';
                isCorrect = userAnswer === card.answer;
            }
            
            showFeedback(isCorrect, card);
        }
        
        function showFeedback(isCorrect, card) {
            const overlay = document.getElementById('feedbackOverlay');
            const feedbackCard = document.getElementById('feedbackCard');
            
            let points = 0;
            if (isCorrect) {
                points = hintUsed ? 5 : 10;
                levelCorrect++;
                currentStreak++;
                if (currentStreak > bestStreak) bestStreak = currentStreak;
                
                // Streak bonus
                if (currentStreak === 3) showStreakPopup('üî• 3 de suite !');
                else if (currentStreak === 5) showStreakPopup('üî•üî• 5 de suite !');
                else if (currentStreak === 10) showStreakPopup('üî•üî•üî• INCROYABLE !');
            } else {
                currentStreak = 0;
                levelErrors.push(card.keyword || card.question.replace(/<[^>]*>/g, '').substring(0, 50) + '...');
            }
            
            levelPoints += points;
            totalPoints += points;
            localStorage.setItem('totalPoints', totalPoints.toString());
            updateScoreDisplay();
            
            feedbackCard.className = 'feedback-card ' + (isCorrect ? 'correct' : 'incorrect');
            document.getElementById('feedbackIcon').textContent = isCorrect ? '‚úÖ' : '‚ùå';
            document.getElementById('feedbackTitle').textContent = isCorrect ? 
                (currentStreak >= 3 ? 'Excellent ! üî•' : 'Bravo !') : 'Pas tout √† fait...';
            document.getElementById('feedbackPoints').textContent = isCorrect ? `+${points} points` : '0 point';
            document.getElementById('feedbackPoints').style.display = isCorrect ? 'block' : 'none';
            
            document.getElementById('feedbackExplanation').innerHTML = `
                <h4>üìö Explication</h4>
                <p>${card.explanation}</p>
                <div class="keyword-box">üîë <span>${card.keyword}</span></div>
                ${card.tip ? `<div class="tip-box"><h5>üí° Astuce BAC</h5><p>${card.tip}</p></div>` : ''}
            `;
            
            overlay.classList.add('visible');
        }
        
        function showStreakPopup(text) {
            const popup = document.getElementById('streakPopup');
            popup.textContent = text;
            popup.style.display = 'block';
            setTimeout(() => { popup.style.display = 'none'; }, 1500);
        }
        
        function nextCard() {
            document.getElementById('feedbackOverlay').classList.remove('visible');
            currentCardIndex++;
            
            if (currentCardIndex >= levels[currentLevel].cards.length) {
                showResults();
            } else {
                showCard();
            }
        }
        
        function showResults() {
            const total = levels[currentLevel].cards.length;
            const percent = Math.round((levelCorrect / total) * 100);
            
            levelProgress[currentLevel] = Math.max(levelProgress[currentLevel], percent);
            localStorage.setItem('levelProgress', JSON.stringify(levelProgress));
            
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');
            
            document.getElementById('resultsIcon').textContent = percent >= 80 ? 'üéâ' : percent >= 50 ? 'üëç' : 'üí™';
            document.getElementById('resultsTitle').textContent = percent >= 80 ? 'Niveau r√©ussi !' : percent >= 50 ? 'Pas mal !' : 'Continue !';
            document.getElementById('resultsScore').textContent = percent + '%';
            document.getElementById('correctCount').textContent = levelCorrect + '/' + total;
            document.getElementById('pointsEarned').textContent = '+' + levelPoints;
            document.getElementById('bestStreak').textContent = bestStreak;
            
            // Erreurs
            const errorsRecap = document.getElementById('errorsRecap');
            if (levelErrors.length > 0) {
                errorsRecap.style.display = 'block';
                document.getElementById('errorsList').innerHTML = levelErrors.map(e => `<li>${e}</li>`).join('');
            } else {
                errorsRecap.style.display = 'none';
            }
            
            // Confettis si r√©ussi
            if (percent >= 80) {
                createConfetti();
            }
            
            // Bouton niveau suivant
            document.getElementById('nextLevelBtn').style.display = (currentLevel < 5 && percent >= 60) ? 'flex' : 'none';
            
            updateHomeProgress();
        }
        
        function createConfetti() {
            const colors = ['#4fc3f7', '#667eea', '#764ba2', '#4CAF50', '#FF9800', '#FFD700'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }
        
        function goHome() {
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('homeScreen').classList.add('active');
            updateHomeProgress();
        }
        
        function retryLevel() {
            startLevel(currentLevel);
        }
        
        function nextLevel() {
            if (currentLevel < 5) {
                startLevel(currentLevel + 1);
                document.getElementById('resultsScreen').classList.remove('active');
            }
        }
        
        function updateScoreDisplay() {
            document.getElementById('totalPoints').textContent = totalPoints;
            document.getElementById('currentStreak').textContent = currentStreak;
            document.getElementById('streakDisplay').textContent = currentStreak;
        }
        
        function updateHomeProgress() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`level${i}Percent`).textContent = levelProgress[i] + '%';
                document.getElementById(`level${i}Bar`).style.width = levelProgress[i] + '%';
            }
        }
        
        // Init
        updateScoreDisplay();
        updateHomeProgress();
    </script>
</body>
</html>