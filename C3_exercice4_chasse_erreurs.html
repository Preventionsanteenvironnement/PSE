<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module C3 â€“ Chasse aux Erreurs</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #dc2626;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #1e293b;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container { max-width: 1000px; margin: 0 auto; }
        
        .source-banner {
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .source-banner a { color: rgba(255,255,255,0.9); font-size: 11px; text-decoration: none; }
        
        .screen { display: none; }
        .screen.active { display: block; }
        
        /* Intro */
        .intro-card {
            background: white;
            border-radius: 25px;
            padding: 40px;
            max-width: 650px;
            margin: 30px auto;
            text-align: center;
        }
        
        .intro-card h2 { font-size: 28px; margin-bottom: 15px; }
        .intro-card > p { color: #64748b; margin-bottom: 20px; }
        
        .objectif-box {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-left: 4px solid var(--primary);
            padding: 15px 20px;
            border-radius: 0 12px 12px 0;
            text-align: left;
            margin-bottom: 25px;
        }
        
        .objectif-box strong { color: var(--primary); font-size: 11px; }
        .objectif-box p { font-size: 13px; margin-top: 5px; }
        
        .how-to-play {
            background: #f8fafc;
            border-radius: 15px;
            padding: 20px;
            text-align: left;
            margin-bottom: 25px;
        }
        
        .how-to-play h4 { font-size: 14px; color: var(--primary); margin-bottom: 12px; }
        .how-to-play li { font-size: 13px; color: #475569; margin-bottom: 8px; margin-left: 20px; }
        
        .btn-start {
            padding: 18px 50px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, var(--primary), #991b1b);
            color: white;
            font-family: inherit;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-start:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(220, 38, 38, 0.4); }
        
        /* Game */
        .game-header {
            background: white;
            border-radius: 20px;
            padding: 15px 25px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .game-header h2 { font-size: 18px; color: var(--dark); }
        
        .header-stats { display: flex; gap: 15px; }
        
        .header-stat {
            padding: 8px 18px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 14px;
        }
        
        .header-stat.score { background: #fef3c7; color: #92400e; }
        .header-stat.errors { background: #fee2e2; color: #991b1b; }
        .header-stat.round { background: #dbeafe; color: #1e40af; }
        
        .game-content {
            background: white;
            border-radius: 20px;
            padding: 25px;
        }
        
        .situation-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .situation-header .icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }
        
        .situation-header .text h3 { font-size: 18px; color: var(--dark); }
        .situation-header .text p { font-size: 13px; color: #64748b; }
        
        .instruction {
            background: #fef3c7;
            padding: 12px 18px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .instruction p {
            font-size: 14px;
            font-weight: 600;
            color: #92400e;
        }
        
        .picto-display {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .picto-card {
            background: #f8fafc;
            border: 4px solid #e2e8f0;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .picto-card:hover:not(.disabled) {
            border-color: var(--primary);
            transform: translateY(-3px);
        }
        
        .picto-card img {
            width: 70px;
            height: 70px;
            object-fit: contain;
            margin-bottom: 8px;
        }
        
        .picto-card .name { font-size: 11px; font-weight: 600; color: var(--dark); }
        
        .picto-card.selected { border-color: var(--primary); background: #fee2e2; }
        .picto-card.correct-error { border-color: var(--success); background: #dcfce7; }
        .picto-card.missed-error { border-color: #f59e0b; background: #fef3c7; }
        .picto-card.wrong-selection { border-color: var(--danger); background: #fee2e2; }
        .picto-card.disabled { cursor: default; }
        
        .picto-card .badge {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: white;
        }
        
        .picto-card .badge.error { background: var(--danger); }
        .picto-card .badge.ok { background: var(--success); }
        
        .btn-validate {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, var(--primary), #991b1b);
            color: white;
            font-family: inherit;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-validate:hover { transform: translateY(-2px); }
        
        .feedback-panel {
            margin-top: 20px;
            padding: 20px;
            border-radius: 15px;
            display: none;
        }
        
        .feedback-panel.show { display: block; animation: fadeIn 0.4s ease; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .feedback-panel.success { background: #dcfce7; border: 2px solid var(--success); }
        .feedback-panel.partial { background: #fef3c7; border: 2px solid #f59e0b; }
        .feedback-panel.error { background: #fee2e2; border: 2px solid var(--danger); }
        
        .feedback-panel h4 { font-size: 18px; margin-bottom: 10px; }
        .feedback-panel.success h4 { color: #166534; }
        .feedback-panel.partial h4 { color: #92400e; }
        .feedback-panel.error h4 { color: #991b1b; }
        
        .feedback-panel p { font-size: 13px; color: #475569; margin-bottom: 15px; }
        
        .btn-next {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            background: var(--primary);
            color: white;
            font-family: inherit;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
        }
        
        /* Results */
        .results-card {
            background: white;
            border-radius: 25px;
            padding: 40px;
            max-width: 600px;
            margin: 30px auto;
            text-align: center;
        }
        
        .results-card .trophy { font-size: 80px; margin-bottom: 20px; }
        .results-card h2 { font-size: 26px; margin-bottom: 10px; }
        .results-card > p { color: #64748b; margin-bottom: 25px; }
        
        .results-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 25px;
        }
        
        .results-stats .stat { text-align: center; }
        .results-stats .stat .val { font-size: 36px; font-weight: 800; color: var(--primary); }
        .results-stats .stat .lbl { font-size: 12px; color: #64748b; }
        
        @media (max-width: 700px) {
            .picto-display { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    
    <div class="container">
        
        <div class="source-banner">
            <a href="https://www.inrs.fr" target="_blank">ğŸ“š Source : INRS â€“ Institut National de Recherche et de SÃ©curitÃ© â€“ www.inrs.fr</a>
        </div>
        
        <!-- Intro -->
        <div class="screen active" id="intro-screen">
            <div class="intro-card">
                <h2>ğŸ” Chasse aux Erreurs</h2>
                <p>RepÃ¨re les pictogrammes mal placÃ©s dans chaque situation !</p>
                
                <div class="objectif-box">
                    <strong>ğŸ¯ OBJECTIF</strong>
                    <p>ÃŠtre capable d'<strong>analyser</strong> une situation de travail et d'<strong>identifier</strong> les pictogrammes de sÃ©curitÃ© inappropriÃ©s ou manquants.</p>
                </div>
                
                <div class="how-to-play">
                    <h4>ğŸ“‹ Comment jouer ?</h4>
                    <ul>
                        <li>Une situation de travail t'est prÃ©sentÃ©e avec des pictogrammes</li>
                        <li>Certains pictogrammes ne devraient PAS Ãªtre lÃ  (erreurs)</li>
                        <li>Clique sur les pictogrammes que tu penses Ãªtre des erreurs</li>
                        <li>Valide ta sÃ©lection pour voir le rÃ©sultat</li>
                    </ul>
                </div>
                
                <button class="btn-start" onclick="startGame()">Commencer la chasse ! ğŸ¯</button>
            </div>
        </div>
        
        <!-- Game -->
        <div class="screen" id="game-screen">
            <div class="game-header">
                <h2>ğŸ” Chasse aux Erreurs</h2>
                <div class="header-stats">
                    <div class="header-stat score">â­ <span id="score">0</span> pts</div>
                    <div class="header-stat errors">ğŸ¯ <span id="found">0</span> trouvÃ©es</div>
                    <div class="header-stat round">ğŸ“ <span id="round">1</span>/5</div>
                </div>
            </div>
            
            <div class="game-content">
                <div class="situation-header">
                    <div class="icon" id="situation-icon">ğŸ­</div>
                    <div class="text">
                        <h3 id="situation-title">Titre de la situation</h3>
                        <p id="situation-desc">Description de la situation</p>
                    </div>
                </div>
                
                <div class="instruction">
                    <p>ğŸ”´ Clique sur les pictogrammes qui ne devraient PAS Ãªtre affichÃ©s ici (<span id="error-count">2</span> erreurs Ã  trouver)</p>
                </div>
                
                <div class="picto-display" id="picto-display"></div>
                
                <button class="btn-validate" id="btn-validate" onclick="validateSelection()">
                    âœ… Valider ma sÃ©lection
                </button>
                
                <div class="feedback-panel" id="feedback">
                    <h4 id="feedback-title"></h4>
                    <p id="feedback-text"></p>
                    <button class="btn-next" onclick="nextRound()">Situation suivante â†’</button>
                </div>
            </div>
        </div>
        
        <!-- Results -->
        <div class="screen" id="results-screen">
            <div class="results-card">
                <div class="trophy" id="trophy">ğŸ†</div>
                <h2 id="results-title">Bravo !</h2>
                <p id="results-msg">Tu as l'Å“il d'un expert sÃ©curitÃ© !</p>
                
                <div class="results-stats">
                    <div class="stat">
                        <div class="val" id="final-score">0</div>
                        <div class="lbl">Points</div>
                    </div>
                    <div class="stat">
                        <div class="val" id="final-found">0</div>
                        <div class="lbl">Erreurs trouvÃ©es</div>
                    </div>
                </div>
                
                <button class="btn-start" onclick="restartGame()">ğŸ”„ Rejouer</button>
            </div>
        </div>
        
    </div>
    
    <script>
        const allPictograms = {
            "gants": { name: "Port des gants", image: "pictogrammes/images/OBLIGATION-gants.jpg" },
            "casque": { name: "Port du casque", image: "pictogrammes/images/OBLIGATION-casque.jpg" },
            "chaussures": { name: "Chaussures sÃ©curitÃ©", image: "pictogrammes/images/OBLIGATION-chaussures.jpg" },
            "lunettes": { name: "Lunettes protection", image: "pictogrammes/images/OBLIGATION-lunettes.jpg" },
            "antibruit": { name: "Protection auditive", image: "pictogrammes/images/OBLIGATION-casque-antibruit.jpg" },
            "masque": { name: "Protection respiratoire", image: "pictogrammes/images/OBLIGATION-protection-voies-espiratoires.jpg" },
            "fumer": { name: "Interdiction fumer", image: "pictogrammes/images/INTERDIT-fumer.jpg" },
            "flamme": { name: "Flamme interdite", image: "pictogrammes/images/INTERDIT-flamme.jpg" },
            "entrer": { name: "AccÃ¨s interdit", image: "pictogrammes/images/INTERDIT-entrer.jpg" },
            "toucher": { name: "Interdit toucher", image: "pictogrammes/images/INTERDIT-toucher.jpg" },
            "electricite": { name: "Danger Ã©lectrique", image: "pictogrammes/images/DANGER-electricite.jpg" },
            "chute": { name: "Danger chute", image: "pictogrammes/images/DANGER-chute.jpg" },
            "toxique": { name: "Produit toxique", image: "pictogrammes/images/DANGER-produit-toxique.jpg" },
            "inflammable": { name: "Produit inflammable", image: "pictogrammes/images/DANGER-produit-inflammable.jpg" },
            "chariot": { name: "Chariot Ã©lÃ©vateur", image: "pictogrammes/images/DANGER-chariot.jpg" },
            "extincteur": { name: "Extincteur", image: "pictogrammes/images/INCENDIE-extincteur.jpg" },
            "alarme": { name: "Alarme incendie", image: "pictogrammes/images/INCENDIE-alarme.jpg" },
            "sortie": { name: "Sortie secours", image: "pictogrammes/images/SECOURS-sortie-vers-droite.jpg" },
            "rassemblement": { name: "Point rassemblement", image: "pictogrammes/images/SECOURS-point-rassemblement.jpg" },
            "secours": { name: "Premiers secours", image: "pictogrammes/images/SECOURS-croix.jpg" }
        };
        
        const situations = [
            {
                icon: "ğŸ¢",
                title: "Bureau administratif",
                desc: "Un espace de bureaux classique avec ordinateurs et imprimantes.",
                correct: ["fumer", "sortie", "extincteur", "secours"],
                errors: ["casque", "chariot"],
                explanation: "Dans un bureau, pas besoin de casque ni d'avertissement chariot !"
            },
            {
                icon: "ğŸ”¬",
                title: "Laboratoire de chimie",
                desc: "Un laboratoire manipulant des produits chimiques.",
                correct: ["lunettes", "gants", "toxique", "sortie", "extincteur"],
                errors: ["chariot", "antibruit"],
                explanation: "Le laboratoire ne nÃ©cessite pas de protection auditive ni d'avertissement chariot."
            },
            {
                icon: "ğŸ—ï¸",
                title: "Chantier de construction",
                desc: "Un chantier avec travaux en hauteur et engins.",
                correct: ["casque", "chaussures", "chute", "entrer", "sortie"],
                errors: ["toxique", "masque"],
                explanation: "Sur ce chantier, pas de produits toxiques nÃ©cessitant ces protections."
            },
            {
                icon: "ğŸ“¦",
                title: "EntrepÃ´t logistique",
                desc: "Un entrepÃ´t avec rayonnages et circulation de chariots.",
                correct: ["chaussures", "chariot", "sortie", "extincteur"],
                errors: ["lunettes", "toxique"],
                explanation: "L'entrepÃ´t standard ne nÃ©cessite pas de lunettes ni de signalisation toxique."
            },
            {
                icon: "ğŸ‘¨â€ğŸ³",
                title: "Cuisine de restaurant",
                desc: "Une cuisine professionnelle avec fours et Ã©quipements.",
                correct: ["fumer", "flamme", "sortie", "extincteur", "secours"],
                errors: ["casque", "electricite"],
                explanation: "En cuisine, pas de risque de chute d'objets nÃ©cessitant un casque, et le danger Ã©lectrique n'est pas spÃ©cifique."
            }
        ];
        
        let currentRound = 0;
        let score = 0;
        let totalFound = 0;
        let selected = [];
        let validated = false;
        
        function startGame() {
            document.getElementById('intro-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            
            currentRound = 0;
            score = 0;
            totalFound = 0;
            
            loadRound();
        }
        
        function loadRound() {
            if (currentRound >= situations.length) {
                showResults();
                return;
            }
            
            const sit = situations[currentRound];
            selected = [];
            validated = false;
            
            document.getElementById('score').textContent = score;
            document.getElementById('found').textContent = totalFound;
            document.getElementById('round').textContent = (currentRound + 1) + '/' + situations.length;
            
            document.getElementById('situation-icon').textContent = sit.icon;
            document.getElementById('situation-title').textContent = sit.title;
            document.getElementById('situation-desc').textContent = sit.desc;
            document.getElementById('error-count').textContent = sit.errors.length;
            
            document.getElementById('feedback').classList.remove('show', 'success', 'partial', 'error');
            document.getElementById('btn-validate').style.display = 'block';
            
            // Combine and shuffle pictograms
            const allKeys = [...sit.correct, ...sit.errors].sort(() => Math.random() - 0.5);
            
            const display = document.getElementById('picto-display');
            display.innerHTML = '';
            
            allKeys.forEach(key => {
                const picto = allPictograms[key];
                const isError = sit.errors.includes(key);
                
                const card = document.createElement('div');
                card.className = 'picto-card';
                card.dataset.key = key;
                card.dataset.isError = isError;
                card.innerHTML = `
                    <img src="${picto.image}" alt="${picto.name}">
                    <div class="name">${picto.name}</div>
                `;
                
                card.onclick = () => toggleSelection(card, key);
                display.appendChild(card);
            });
        }
        
        function toggleSelection(card, key) {
            if (validated) return;
            
            if (selected.includes(key)) {
                selected = selected.filter(k => k !== key);
                card.classList.remove('selected');
            } else {
                selected.push(key);
                card.classList.add('selected');
            }
        }
        
        function validateSelection() {
            validated = true;
            const sit = situations[currentRound];
            
            let correctSelections = 0;
            let wrongSelections = 0;
            let missedErrors = 0;
            
            document.querySelectorAll('.picto-card').forEach(card => {
                card.classList.add('disabled');
                const key = card.dataset.key;
                const isError = card.dataset.isError === 'true';
                const isSelected = selected.includes(key);
                
                if (isError && isSelected) {
                    // Correctly identified error
                    card.classList.add('correct-error');
                    card.innerHTML += '<div class="badge ok">âœ“</div>';
                    correctSelections++;
                } else if (isError && !isSelected) {
                    // Missed error
                    card.classList.add('missed-error');
                    card.innerHTML += '<div class="badge error">!</div>';
                    missedErrors++;
                } else if (!isError && isSelected) {
                    // Wrong selection (not an error but selected)
                    card.classList.add('wrong-selection');
                    card.innerHTML += '<div class="badge error">âœ—</div>';
                    wrongSelections++;
                }
            });
            
            totalFound += correctSelections;
            const roundScore = correctSelections * 15 - wrongSelections * 5;
            score += Math.max(0, roundScore);
            
            document.getElementById('score').textContent = score;
            document.getElementById('found').textContent = totalFound;
            
            const feedback = document.getElementById('feedback');
            document.getElementById('btn-validate').style.display = 'none';
            
            if (correctSelections === sit.errors.length && wrongSelections === 0) {
                feedback.classList.add('show', 'success');
                document.getElementById('feedback-title').textContent = 'Parfait ! ğŸ‰';
                document.getElementById('feedback-text').textContent = 'Tu as trouvÃ© toutes les erreurs ! ' + sit.explanation;
            } else if (correctSelections > 0) {
                feedback.classList.add('show', 'partial');
                document.getElementById('feedback-title').textContent = 'Pas mal ! ğŸ‘';
                document.getElementById('feedback-text').textContent = 
                    `${correctSelections}/${sit.errors.length} erreurs trouvÃ©es. ${sit.explanation}`;
            } else {
                feedback.classList.add('show', 'error');
                document.getElementById('feedback-title').textContent = 'RatÃ© ! ğŸ˜…';
                document.getElementById('feedback-text').textContent = sit.explanation;
            }
            
            if (currentRound >= situations.length - 1) {
                document.querySelector('#feedback .btn-next').textContent = 'Voir les rÃ©sultats ğŸ†';
            }
        }
        
        function nextRound() {
            currentRound++;
            loadRound();
        }
        
        function showResults() {
            document.getElementById('game-screen').classList.remove('active');
            document.getElementById('results-screen').classList.add('active');
            
            const totalErrors = situations.reduce((sum, s) => sum + s.errors.length, 0);
            
            document.getElementById('final-score').textContent = score;
            document.getElementById('final-found').textContent = totalFound + '/' + totalErrors;
            
            const pct = (totalFound / totalErrors) * 100;
            
            if (pct >= 80) {
                document.getElementById('trophy').textContent = 'ğŸ†';
                document.getElementById('results-title').textContent = 'Expert sÃ©curitÃ© !';
                document.getElementById('results-msg').textContent = 'Tu as l\'Å“il pour repÃ©rer les anomalies !';
            } else if (pct >= 50) {
                document.getElementById('trophy').textContent = 'ğŸ‘';
                document.getElementById('results-title').textContent = 'Bien jouÃ© !';
                document.getElementById('results-msg').textContent = 'Continue Ã  t\'entraÃ®ner pour tout repÃ©rer.';
            } else {
                document.getElementById('trophy').textContent = 'ğŸ’ª';
                document.getElementById('results-title').textContent = 'Continue !';
                document.getElementById('results-msg').textContent = 'RÃ©vise les pictogrammes et leur utilisation.';
            }
        }
        
        function restartGame() {
            document.getElementById('results-screen').classList.remove('active');
            document.getElementById('intro-screen').classList.add('active');
        }
    </script>
    
</body>
</html>
