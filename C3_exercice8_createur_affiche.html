<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module C3 â€“ CrÃ©ateur d'Affiche SÃ©curitÃ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #7c3aed;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #1e293b;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%);
            min-height: 100vh;
            padding: 15px;
        }
        
        .container { max-width: 500px; margin: 0 auto; }
        
        .source-banner {
            background: rgba(255,255,255,0.15);
            padding: 6px 12px;
            border-radius: 8px;
            margin-bottom: 12px;
            text-align: center;
        }
        
        .source-banner a { color: rgba(255,255,255,0.9); font-size: 10px; text-decoration: none; }
        
        .screen { display: none; }
        .screen.active { display: block; }
        
        /* Intro */
        .intro-card {
            background: white;
            border-radius: 20px;
            padding: 30px 25px;
            text-align: center;
        }
        
        .intro-card h2 { font-size: 24px; margin-bottom: 12px; color: var(--dark); }
        .intro-card > p { color: #64748b; margin-bottom: 20px; font-size: 14px; }
        
        .objectif-box {
            background: linear-gradient(135deg, #ede9fe, #ddd6fe);
            border-left: 4px solid var(--primary);
            padding: 12px 15px;
            border-radius: 0 10px 10px 0;
            text-align: left;
            margin-bottom: 20px;
        }
        
        .objectif-box strong { color: var(--primary); font-size: 10px; }
        .objectif-box p { font-size: 12px; margin-top: 5px; }
        
        .mission-selector {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .mission-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f8fafc;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .mission-option:hover { border-color: var(--primary); }
        .mission-option.selected { border-color: var(--primary); background: #ede9fe; }
        
        .mission-option .icon { font-size: 35px; }
        .mission-option .text .name { font-size: 15px; font-weight: 700; color: var(--dark); }
        .mission-option .text .desc { font-size: 11px; color: #64748b; }
        
        .btn-start {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, var(--primary), #5b21b6);
            color: white;
            font-family: inherit;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
        }
        
        .btn-start:disabled { opacity: 0.5; cursor: not-allowed; }
        
        /* Game */
        .game-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .game-header h3 { font-size: 14px; color: var(--dark); }
        
        .stats { display: flex; gap: 10px; }
        
        .stat {
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .stat.selected-count { background: #dcfce7; color: #166534; }
        .stat.required { background: #fee2e2; color: #991b1b; }
        
        .mission-context {
            background: linear-gradient(135deg, #f5f3ff, #ede9fe);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .mission-context .icon { font-size: 35px; margin-bottom: 8px; }
        .mission-context .title { font-size: 14px; font-weight: 700; color: var(--dark); }
        .mission-context .desc { font-size: 11px; color: #64748b; margin-top: 5px; }
        
        .instruction {
            text-align: center;
            font-size: 13px;
            font-weight: 600;
            color: #475569;
            margin-bottom: 15px;
            padding: 10px;
            background: #fef3c7;
            border-radius: 10px;
        }
        
        /* Grille de sÃ©lection */
        .picto-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .picto-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 8px;
            background: #f8fafc;
            border: 3px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .picto-item:hover { border-color: var(--primary); }
        .picto-item:active { transform: scale(0.97); }
        
        .picto-item.selected {
            border-color: var(--success);
            background: #dcfce7;
        }
        
        .picto-item img {
            width: 45px;
            height: 45px;
            object-fit: contain;
            margin-bottom: 6px;
        }
        
        .picto-item .name {
            font-size: 9px;
            font-weight: 600;
            color: var(--dark);
            text-align: center;
            line-height: 1.2;
        }
        
        .picto-item .check {
            display: none;
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background: var(--success);
            border-radius: 50%;
            color: white;
            font-size: 12px;
            align-items: center;
            justify-content: center;
        }
        
        .picto-item.selected { position: relative; }
        .picto-item.selected .check { display: flex; }
        
        .btn-validate {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
            font-family: inherit;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
        }
        
        .btn-validate:disabled { opacity: 0.5; cursor: not-allowed; }
        
        /* Results */
        .results-card {
            background: white;
            border-radius: 20px;
            padding: 30px 25px;
            text-align: center;
        }
        
        .results-card .trophy { font-size: 70px; margin-bottom: 15px; }
        .results-card h2 { font-size: 24px; margin-bottom: 8px; color: var(--dark); }
        .results-card > p { color: #64748b; margin-bottom: 20px; font-size: 14px; }
        
        .score-box {
            background: linear-gradient(135deg, #ede9fe, #ddd6fe);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        
        .score-box .score { font-size: 48px; font-weight: 800; color: var(--primary); }
        .score-box .label { font-size: 12px; color: #64748b; }
        
        .results-detail {
            text-align: left;
            margin-bottom: 20px;
        }
        
        .results-detail h4 {
            font-size: 13px;
            color: var(--dark);
            margin-bottom: 10px;
        }
        
        .result-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            border-radius: 8px;
            margin-bottom: 6px;
            font-size: 11px;
        }
        
        .result-item img { width: 30px; height: 30px; object-fit: contain; }
        .result-item .name { flex: 1; }
        .result-item .status { font-weight: 700; }
        
        .result-item.correct { background: #dcfce7; }
        .result-item.correct .status { color: #166534; }
        
        .result-item.wrong { background: #fee2e2; }
        .result-item.wrong .status { color: #991b1b; }
        
        .result-item.missing { background: #fef3c7; }
        .result-item.missing .status { color: #92400e; }
        
        .btn-restart {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, var(--primary), #5b21b6);
            color: white;
            font-family: inherit;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
        }
    </style>
</head>
<body>
    
    <div class="container">
        
        <div class="source-banner">
            <a href="https://www.inrs.fr" target="_blank">ğŸ“š Source : INRS â€“ www.inrs.fr</a>
        </div>
        
        <!-- Intro -->
        <div class="screen active" id="intro-screen">
            <div class="intro-card">
                <h2>ğŸ¨ CrÃ©ateur d'Affiche</h2>
                <p>SÃ©lectionne les pictogrammes adaptÃ©s au lieu de travail !</p>
                
                <div class="objectif-box">
                    <strong>ğŸ¯ OBJECTIF</strong>
                    <p>ÃŠtre capable de <strong>sÃ©lectionner</strong> les pictogrammes de sÃ©curitÃ© adaptÃ©s Ã  un contexte professionnel.</p>
                </div>
                
                <p style="font-weight: 600; margin-bottom: 12px; font-size: 13px;">Choisis ta mission :</p>
                
                <div class="mission-selector">
                    <div class="mission-option" onclick="selectMission('cuisine')" data-mission="cuisine">
                        <div class="icon">ğŸ‘¨â€ğŸ³</div>
                        <div class="text">
                            <div class="name">Cuisine collective</div>
                            <div class="desc">Restaurant / Cantine scolaire</div>
                        </div>
                    </div>
                    <div class="mission-option" onclick="selectMission('chantier')" data-mission="chantier">
                        <div class="icon">ğŸ—ï¸</div>
                        <div class="text">
                            <div class="name">Chantier BTP</div>
                            <div class="desc">Construction / Travaux</div>
                        </div>
                    </div>
                    <div class="mission-option" onclick="selectMission('entrepot')" data-mission="entrepot">
                        <div class="icon">ğŸ“¦</div>
                        <div class="text">
                            <div class="name">EntrepÃ´t logistique</div>
                            <div class="desc">Stockage / PrÃ©paration</div>
                        </div>
                    </div>
                </div>
                
                <button class="btn-start" id="btn-start" onclick="startGame()" disabled>CrÃ©er l'affiche ! ğŸ¨</button>
            </div>
        </div>
        
        <!-- Game -->
        <div class="screen" id="game-screen">
            <div class="game-card">
                <div class="game-header">
                    <h3>ğŸ¨ Ton affiche</h3>
                    <div class="stats">
                        <div class="stat selected-count">âœ… <span id="selected-count">0</span></div>
                        <div class="stat required">ğŸ¯ <span id="required-count">6</span> requis</div>
                    </div>
                </div>
                
                <div class="mission-context">
                    <div class="icon" id="mission-icon">ğŸ‘¨â€ğŸ³</div>
                    <div class="title" id="mission-title">Cuisine collective</div>
                    <div class="desc" id="mission-desc">SÃ©lectionne les 6 pictogrammes indispensables pour ce lieu.</div>
                </div>
                
                <div class="instruction">
                    ğŸ‘† Clique pour sÃ©lectionner / dÃ©sÃ©lectionner
                </div>
                
                <div class="picto-grid" id="picto-grid">
                    <!-- GÃ©nÃ©rÃ© dynamiquement -->
                </div>
                
                <button class="btn-validate" id="btn-validate" onclick="validateSelection()" disabled>
                    âœ… Valider ma sÃ©lection
                </button>
            </div>
        </div>
        
        <!-- Results -->
        <div class="screen" id="results-screen">
            <div class="results-card">
                <div class="trophy" id="trophy">ğŸ†</div>
                <h2 id="results-title">Affiche crÃ©Ã©e !</h2>
                <p id="results-msg">Voyons le rÃ©sultat...</p>
                
                <div class="score-box">
                    <div class="score" id="final-score">0</div>
                    <div class="label">points sur 60</div>
                </div>
                
                <div class="results-detail" id="results-detail">
                    <!-- GÃ©nÃ©rÃ© dynamiquement -->
                </div>
                
                <button class="btn-restart" onclick="restartGame()">ğŸ”„ Nouvelle mission</button>
            </div>
        </div>
        
    </div>
    
    <script>
        const allPictos = [
            { id: "gants", name: "Port des gants", image: "pictogrammes/images/OBLIGATION-gants.jpg" },
            { id: "casque", name: "Port du casque", image: "pictogrammes/images/OBLIGATION-casque.jpg" },
            { id: "chaussures", name: "Chaussures sÃ©curitÃ©", image: "pictogrammes/images/OBLIGATION-chaussures.jpg" },
            { id: "lunettes", name: "Lunettes protection", image: "pictogrammes/images/OBLIGATION-lunettes.jpg" },
            { id: "antibruit", name: "Protection auditive", image: "pictogrammes/images/OBLIGATION-casque-antibruit.jpg" },
            { id: "fumer", name: "Interdiction fumer", image: "pictogrammes/images/INTERDIT-fumer.jpg" },
            { id: "flamme", name: "Flamme interdite", image: "pictogrammes/images/INTERDIT-flamme.jpg" },
            { id: "entrer", name: "AccÃ¨s interdit", image: "pictogrammes/images/INTERDIT-entrer.jpg" },
            { id: "pietons", name: "Interdit piÃ©tons", image: "pictogrammes/images/INTERDIT-pietons.jpg" },
            { id: "chute", name: "Danger chute", image: "pictogrammes/images/DANGER-chute.jpg" },
            { id: "chariot", name: "Chariot Ã©lÃ©vateur", image: "pictogrammes/images/DANGER-chariot.jpg" },
            { id: "extincteur", name: "Extincteur", image: "pictogrammes/images/INCENDIE-extincteur.jpg" },
            { id: "sortie", name: "Sortie secours", image: "pictogrammes/images/SECOURS-sortie-vers-droite.jpg" },
            { id: "rassemblement", name: "Point rassemblement", image: "pictogrammes/images/SECOURS-point-rassemblement.jpg" },
            { id: "secours", name: "Premiers secours", image: "pictogrammes/images/SECOURS-croix.jpg" }
        ];
        
        const missions = {
            cuisine: {
                name: "Cuisine collective",
                icon: "ğŸ‘¨â€ğŸ³",
                desc: "SÃ©lectionne les 6 pictogrammes indispensables pour ce lieu.",
                required: ["gants", "fumer", "flamme", "extincteur", "sortie", "secours"]
            },
            chantier: {
                name: "Chantier BTP",
                icon: "ğŸ—ï¸",
                desc: "SÃ©lectionne les 6 pictogrammes indispensables pour ce lieu.",
                required: ["casque", "chaussures", "chute", "entrer", "extincteur", "sortie"]
            },
            entrepot: {
                name: "EntrepÃ´t logistique",
                icon: "ğŸ“¦",
                desc: "SÃ©lectionne les 6 pictogrammes indispensables pour ce lieu.",
                required: ["chaussures", "chariot", "pietons", "extincteur", "sortie", "rassemblement"]
            }
        };
        
        let selectedMission = null;
        let selectedPictos = [];
        
        function selectMission(mission) {
            selectedMission = mission;
            document.querySelectorAll('.mission-option').forEach(opt => {
                opt.classList.toggle('selected', opt.dataset.mission === mission);
            });
            document.getElementById('btn-start').disabled = false;
        }
        
        function startGame() {
            document.getElementById('intro-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            
            selectedPictos = [];
            
            const mission = missions[selectedMission];
            document.getElementById('mission-icon').textContent = mission.icon;
            document.getElementById('mission-title').textContent = mission.name;
            document.getElementById('mission-desc').textContent = mission.desc;
            document.getElementById('required-count').textContent = mission.required.length;
            
            renderPictoGrid();
            updateCount();
        }
        
        function renderPictoGrid() {
            const grid = document.getElementById('picto-grid');
            const shuffled = [...allPictos].sort(() => Math.random() - 0.5);
            
            grid.innerHTML = shuffled.map(picto => `
                <div class="picto-item ${selectedPictos.includes(picto.id) ? 'selected' : ''}" 
                     data-id="${picto.id}" onclick="togglePicto('${picto.id}')">
                    <span class="check">âœ“</span>
                    <img src="${picto.image}" alt="${picto.name}">
                    <div class="name">${picto.name}</div>
                </div>
            `).join('');
        }
        
        function togglePicto(id) {
            if (selectedPictos.includes(id)) {
                selectedPictos = selectedPictos.filter(p => p !== id);
            } else {
                selectedPictos.push(id);
            }
            
            document.querySelectorAll('.picto-item').forEach(item => {
                item.classList.toggle('selected', selectedPictos.includes(item.dataset.id));
            });
            
            updateCount();
        }
        
        function updateCount() {
            document.getElementById('selected-count').textContent = selectedPictos.length;
            
            const mission = missions[selectedMission];
            document.getElementById('btn-validate').disabled = selectedPictos.length !== mission.required.length;
        }
        
        function validateSelection() {
            const mission = missions[selectedMission];
            let score = 0;
            let results = [];
            
            // Check selected pictos
            selectedPictos.forEach(id => {
                if (mission.required.includes(id)) {
                    score += 10;
                    results.push({ id, status: 'correct' });
                } else {
                    results.push({ id, status: 'wrong' });
                }
            });
            
            // Check missing
            mission.required.forEach(id => {
                if (!selectedPictos.includes(id)) {
                    results.push({ id, status: 'missing' });
                }
            });
            
            showResults(score, results);
        }
        
        function showResults(score, results) {
            document.getElementById('game-screen').classList.remove('active');
            document.getElementById('results-screen').classList.add('active');
            
            document.getElementById('final-score').textContent = score;
            
            const pct = (score / 60) * 100;
            
            if (pct === 100) {
                document.getElementById('trophy').textContent = 'ğŸ†';
                document.getElementById('results-title').textContent = 'Parfait !';
                document.getElementById('results-msg').textContent = 'Affiche complÃ¨te et correcte !';
            } else if (pct >= 50) {
                document.getElementById('trophy').textContent = 'ğŸ‘';
                document.getElementById('results-title').textContent = 'Bien !';
                document.getElementById('results-msg').textContent = 'Quelques ajustements Ã  faire.';
            } else {
                document.getElementById('trophy').textContent = 'ğŸ’ª';
                document.getElementById('results-title').textContent = 'Continue !';
                document.getElementById('results-msg').textContent = 'RÃ©vise les pictogrammes adaptÃ©s.';
            }
            
            // Render detail
            const detail = document.getElementById('results-detail');
            detail.innerHTML = '<h4>DÃ©tail :</h4>' + results.map(r => {
                const picto = allPictos.find(p => p.id === r.id);
                let statusText = '';
                if (r.status === 'correct') statusText = 'âœ… Correct';
                else if (r.status === 'wrong') statusText = 'âŒ Inutile';
                else statusText = 'âš ï¸ Manquant';
                
                return `
                    <div class="result-item ${r.status}">
                        <img src="${picto.image}" alt="${picto.name}">
                        <span class="name">${picto.name}</span>
                        <span class="status">${statusText}</span>
                    </div>
                `;
            }).join('');
        }
        
        function restartGame() {
            document.getElementById('results-screen').classList.remove('active');
            document.getElementById('intro-screen').classList.add('active');
            selectedMission = null;
            selectedPictos = [];
            document.querySelectorAll('.mission-option').forEach(opt => opt.classList.remove('selected'));
            document.getElementById('btn-start').disabled = true;
        }
    </script>
    
</body>
</html>
