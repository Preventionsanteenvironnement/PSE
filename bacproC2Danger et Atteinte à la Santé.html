<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danger et Atteinte √† la Sant√© - Fiche P√©dagogique PSE</title>
    <style>
        :root {
            --primary-color: #0056b3;
            --secondary-color: #f0f8ff;
            --danger-color: #dc3545;
            --health-color: #28a745;
            --info-color: #ffc107;
            --text-color: #333;
            --border-radius: 8px;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            padding: 15px;
            background-color: #f4f7f6;
            color: var(--text-color);
        }

        .container {
            max-width: 900px;
            margin: auto;
            background-color: #fff;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        h1, h2, h3 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 5px;
            margin-top: 20px;
        }

        h1 {
            text-align: center;
            font-size: 1.8em;
            background-color: var(--secondary-color);
            padding: 10px;
            border-radius: var(--border-radius);
            border-bottom: none;
        }

        .definition-box {
            padding: 15px;
            margin: 15px 0;
            border-radius: var(--border-radius);
            font-size: 1.1em;
            border-left: 5px solid;
        }

        .danger-def {
            border-color: var(--danger-color);
            background-color: #fde0e3;
        }

        .health-def {
            border-color: var(--health-color);
            background-color: #e6f7e8;
        }

        .exercice {
            margin: 25px 0;
            padding: 15px;
            border: 1px dashed #ccc;
            border-radius: var(--border-radius);
            background-color: var(--secondary-color);
        }

        .exercice h3 {
            margin-top: 0;
            border-bottom: 1px solid #ccc;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .points {
            font-size: 0.8em;
            color: #666;
            font-weight: normal;
        }

        /* La correction d√©taill√©e (explications) reste masqu√©e */
        .correction {
            margin-top: 10px;
            padding: 10px;
            background-color: var(--info-color);
            border: 1px solid #e0ad00;
            border-radius: 4px;
            display: none; 
        }

        .correction strong {
            color: var(--primary-color);
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            transition: background-color 0.3s;
            font-weight: bold;
            display: inline-block;
        }

        button:hover {
            background-color: #004494;
        }

        .score-zone {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            border: 3px solid var(--health-color);
            border-radius: var(--border-radius);
            background-color: #e6f7e8;
        }

        #final-score {
            font-size: 2.5em;
            font-weight: bold;
            color: var(--danger-color);
            margin: 15px 0;
        }

        .drop-zone {
            border: 2px dashed #0056b3;
            padding: 10px;
            min-height: 50px;
            margin-top: 10px;
            border-radius: 5px;
            text-align: center;
            background-color: white;
            min-width: 45%;
        }

        .draggable-item {
            display: inline-block;
            background-color: #f7f7f7;
            padding: 5px 10px;
            margin: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: move;
        }

        .danger-item { background-color: var(--danger-color); color: white; }
        .health-item { background-color: var(--health-color); color: white; }

        .feedback { 
            margin-top: 10px; 
            font-weight: bold; 
            padding: 8px;
            border-radius: 4px;
            display: none; /* Reste cach√© jusqu'au calcul final */
        } 
        .feedback.correct { background-color: #d4edda; color: var(--health-color); }
        .feedback.partial { background-color: #fff3cd; color: var(--info-color); }
        .feedback.incorrect { background-color: #f8d7da; color: var(--danger-color); }


        input[type="text"], textarea, select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 90%;
            box-sizing: border-box;
        }
        
        .reset-button {
            background-color: #6c757d;
            margin-top: 20px;
        }
        .reset-button:hover {
            background-color: #5a6268;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>üéØ Danger et atteinte √† la Sant√© ü§ï</h1>
    <p>Objectif : Diff√©rencier la **CAUSE (Danger)** de la **CONS√âQUENCE (Atteinte √† la Sant√©)**.</p>

    <h2>1. Rappels des D√©finitions PSE</h2>
    <div class="definition-box danger-def">
        <h3>üö® DANGER : La CAUSE</h3>
        <p>C'est tout ce qui peut **provoquer** une blessure ou une maladie (ex: couteau, sol glissant, bruit).</p>
    </div>
    <div class="definition-box health-def">
        <h3>ü©∫ ATTEINTE √Ä LA SANT√â : La CONS√âQUENCE</h3>
        <p>C'est le dommage qui arrive **sur le corps** (blessure ou maladie) (ex: coupure, br√ªlure, mal de dos, intoxication).</p>
    </div>

    <hr>

    <h2>2. Les 6 Exercices (Total : 15 Points)</h2>
    
    <div id="exercices-container">
        <div class="exercice" id="exo1">
            <h3>Exercice 1 : Classification Glisser-D√©poser <span class="points">(5 points)</span></h3>
            <p>Glisse chaque √©l√©ment dans la bonne cat√©gorie. (1 point par bonne r√©ponse)</p>
            <div style="display: flex; justify-content: center; flex-wrap: wrap; margin-bottom: 15px;" id="drag-source-1">
                <div class="draggable-item" draggable="true" data-type="danger" id="item1-1">Cartons en hauteur</div>
                <div class="draggable-item" draggable="true" data-type="health" id="item1-2">Fracture</div>
                <div class="draggable-item" draggable="true" data-type="danger" id="item1-3">Posture courb√©e</div>
                <div class="draggable-item" draggable="true" data-type="health" id="item1-4">Mal de dos</div>
                <div class="draggable-item" draggable="true" data-type="danger" id="item1-5">Produit corrosif</div>
            </div>

            <div style="display: flex; justify-content: space-around;">
                <div style="width: 45%;">
                    <h4>DANGER (La CAUSE)</h4>
                    <div class="drop-zone" id="drop-danger-1" data-target="danger"></div>
                </div>
                <div style="width: 45%;">
                    <h4>ATTEINTE √Ä LA SANT√â (La CONS√âQUENCE)</h4>
                    <div class="drop-zone" id="drop-health-1" data-target="health"></div>
                </div>
            </div>
            <div class="feedback" id="feedback-exo1"></div>
            <div class="correction" id="correction-exo1">
                <strong>Correction d√©taill√©e :</strong> Les Dangers sont la cause potentielle (Cartons en hauteur, Posture courb√©e, Produit corrosif). Les Atteintes sont les cons√©quences sur le corps (Fracture, Mal de dos).
            </div>
        </div>

        <div class="exercice" id="exo2">
            <h3>Exercice 2 : QCM - Le Danger <span class="points">(2 points)</span></h3>
            <p>Dans un chantier, un marteau est laiss√© au bord d'un √©chafaudage. Quel est le **Danger** ?</p>
            <input type="radio" name="qcm2" value="A" id="qcm2a"> A. La bosse sur la t√™te.<br>
            <input type="radio" name="qcm2" value="B" id="qcm2b"> B. Le marteau en √©quilibre.<br>
            <input type="radio" name="qcm2" value="C" id="qcm2c"> C. La fatigue de l'ouvrier.<br>
            <div class="feedback" id="feedback-exo2"></div>
            <div class="correction" id="correction-exo2">
                <strong>Correction d√©taill√©e : R√©ponse B.</strong> Le marteau en √©quilibre est la CAUSE (Danger de chute d'objet). La bosse est la CONS√âQUENCE (Atteinte √† la Sant√©).
            </div>
        </div>

        <div class="exercice" id="exo3">
            <h3>Exercice 3 : Vrai ou Faux <span class="points">(1 point)</span></h3>
            <p>Le fait de devoir faire le m√©nage trop rapidement (pression) est une **Atteinte √† la Sant√©**.</p>
            <input type="radio" name="vf3" value="V" id="vf3v"> Vrai<br>
            <input type="radio" name="vf3" value="F" id="vf3f"> Faux<br>
            <div class="feedback" id="feedback-exo3"></div>
            <div class="correction" id="correction-exo3">
                <strong>Correction d√©taill√©e : R√©ponse Faux.</strong> La pression/rapidit√© est un **Danger** (Danger li√© √† l'organisation du travail, la CAUSE). L'atteinte serait le stress ou l'√©puisement (la CONS√âQUENCE).
            </div>
        </div>

        <div class="exercice" id="exo4">
            <h3>Exercice 4 : Compl√©ter l'Association <span class="points">(2 points)</span></h3>
            <p>Associe le Danger (Cause) √† l'Atteinte (Cons√©quence) :</p>
            <ol>
                <li>Un √©quipement qui fait beaucoup de bruit (Danger) peut provoquer une <select id="select4-1"><option value="">Choisir...</option><option value="surdit√©">surdit√©</option><option value="chute">chute</option><option value="maladie">maladie</option></select> (Atteinte).</li>
                <li>Un sol avec une flaque d'huile (Danger) peut provoquer une <select id="select4-2"><option value="">Choisir...</option><option value="coupure">coupure</option><option value="entorse">entorse</option><option value="br√ªlure">br√ªlure</option></select> (Atteinte) apr√®s une glissade.</li>
            </ol>
            <div class="feedback" id="feedback-exo4"></div>
            <div class="correction" id="correction-exo4">
                <strong>Correction d√©taill√©e :</strong> 1. Surdit√© (cons√©quence du bruit). 2. Entorse (cons√©quence de la glissade).
            </div>
        </div>

        <div class="exercice" id="exo5">
            <h3>Exercice 5 : Identifier les deux notions <span class="points">(3 points)</span></h3>
            <p>Un cuisinier se coupe le doigt en pr√©parant des l√©gumes.</p>
            <p>Le **Danger** (la cause) est le <input type="text" id="text5-1" placeholder="Danger"> et l'**Atteinte** (la cons√©quence) est la <input type="text" id="text5-2" placeholder="Atteinte">.</p>
            <div class="feedback" id="feedback-exo5"></div>
            <div class="correction" id="correction-exo5">
                <strong>Correction d√©taill√©e :</strong> Danger : Couteau / Lame (la CAUSE). Atteinte : Coupure / L√©sion (la CONS√âQUENCE sur le corps).
            </div>
        </div>

        <div class="exercice" id="exo6">
            <h3>Exercice 6 : √âcrire l'Atteinte (Phrase simple) <span class="points">(2 points)</span></h3>
            <p><strong>Sc√©nario :</strong> Un agent de logistique utilise un transpalette dont les roues sont bloqu√©es, il doit forcer pour le d√©placer.</p>
            <p>√âcris le nom de l'**Atteinte √† la Sant√©** (cons√©quence) la plus probable √† long terme sur son corps :</p>
            <textarea id="text6-1" rows="2" style="width: 100%;" placeholder="L'atteinte √† la sant√© est..."></textarea>
            <div class="feedback" id="feedback-exo6"></div>
            <div class="correction" id="correction-exo6">
                <strong>Correction d√©taill√©e :</strong> L'atteinte √† la sant√© est un **mal de dos** ou une **lombalgie** (caus√©e par l'effort excessif et la posture forc√©e).
            </div>
        </div>
    </div>

    <hr>

    <div class="score-zone">
        <h2>üìä Ton Bilan Final</h2>
        <p>Clique ci-dessous pour v√©rifier tes r√©ponses, obtenir ton score final sur 15 et afficher les corrections d√©taill√©es.</p>
        <button onclick="calculateScoreAndDisplayResults()">Calculer mon Score et Afficher la Correction</button>
        <p id="final-score">-- / 15 Points</p>

        <div id="score-explanation" style="display:none; text-align: left; margin-top: 20px;">
            <h3>Explication de ton Score</h3>
            <p>Ce score mesure ta capacit√© √† distinguer la **CAUSE** (Danger) de la **CONS√âQUENCE** (Atteinte √† la Sant√©) :</p>
            <ul>
                <li>**12 √† 15 points (Bien Ma√Ætris√©)** : F√©licitations ! Tu fais parfaitement la distinction.</li>
                <li>**8 √† 11 points (√Ä Am√©liorer)** : Tu as les bases, mais tu inverses parfois les notions. Revois les d√©finitions et les corrections.</li>
                <li>**Moins de 8 points (Bases √† Consolider)** : Il est important de bien relire les d√©finitions. La cause (Danger) vient toujours avant la cons√©quence (Atteinte).</li>
        </div>
        <button class="reset-button" onclick="resetAll()">R√©initialiser tous les exercices</button>
    </div>

</div>

<script>
    const maxScore = 15;

    // --- Fonctions de v√©rification individuelles ---

    function checkExo1(pointsTotal = 5) {
        const dropDanger = document.getElementById('drop-danger-1');
        const dropHealth = document.getElementById('drop-health-1');
        let correctCount = 0;
        let totalItems = 0;

        // Compter les Dangers corrects
        Array.from(dropDanger.children).forEach(item => {
            totalItems++;
            if (item.getAttribute('data-type') === 'danger') {
                correctCount++;
                item.classList.add('health-item'); // Vert si correct
            } else {
                item.classList.add('danger-item'); // Rouge si incorrect
            }
        });

        // Compter les Atteintes correctes
        Array.from(dropHealth.children).forEach(item => {
            totalItems++;
            if (item.getAttribute('data-type') === 'health') {
                correctCount++;
                item.classList.add('health-item'); // Vert si correct
            } else {
                item.classList.add('danger-item'); // Rouge si incorrect
            }
        });

        // Calcul du score (1 point par bonne r√©ponse)
        const score = correctCount;
        const feedback = document.getElementById('feedback-exo1');

        if (totalItems !== 5) {
            feedback.innerHTML = `‚ö†Ô∏è Exercice incomplet (plac√© ${totalItems}/5 √©l√©ments). 0 point.`;
            feedback.className = 'feedback incorrect';
            return 0;
        }

        if (score === pointsTotal) {
            feedback.innerHTML = `‚úÖ **CORRECT** ! Tu as obtenu ${score}/${pointsTotal} points.`;
            feedback.className = 'feedback correct';
        } else if (score > 0) {
            feedback.innerHTML = `üü° **PARTIEL** : ${score}/${pointsTotal} points. R√©vois les √©l√©ments en rouge.`;
            feedback.className = 'feedback partial';
        } else {
            feedback.innerHTML = `‚ùå **FAUX** : Tu as obtenu 0/${pointsTotal} points.`;
            feedback.className = 'feedback incorrect';
        }
        return score;
    }

    function checkExo2(pointsTotal = 2) {
        const selected = document.querySelector(`input[name="qcm2"]:checked`);
        const feedback = document.getElementById('feedback-exo2');
        let score = 0;

        if (selected && selected.value === 'B') {
            score = pointsTotal;
            feedback.innerHTML = `‚úÖ **CORRECT** ! Tu as obtenu ${score}/${pointsTotal} points.`;
            feedback.className = 'feedback correct';
        } else {
            feedback.innerHTML = `‚ùå **FAUX** : Tu as obtenu 0/${pointsTotal} points. La bonne r√©ponse √©tait B.`;
            feedback.className = 'feedback incorrect';
        }
        return score;
    }

    function checkExo3(pointsTotal = 1) {
        const selected = document.querySelector(`input[name="vf3"]:checked`);
        const feedback = document.getElementById('feedback-exo3');
        let score = 0;

        if (selected && selected.value === 'F') {
            score = pointsTotal;
            feedback.innerHTML = `‚úÖ **CORRECT** ! Tu as obtenu ${score}/${pointsTotal} point.`;
            feedback.className = 'feedback correct';
        } else {
            feedback.innerHTML = `‚ùå **FAUX** : Tu as obtenu 0/${pointsTotal} point. La bonne r√©ponse √©tait Faux.`;
            feedback.className = 'feedback incorrect';
        }
        return score;
    }

    function checkExo4(pointsTotal = 2) {
        const select1 = document.getElementById('select4-1').value;
        const select2 = document.getElementById('select4-2').value;
        const feedback = document.getElementById('feedback-exo4');
        let correctCount = 0;

        if (select1 === 'surdit√©') correctCount++;
        if (select2 === 'entorse') correctCount++;
        
        const score = correctCount;

        if (score === pointsTotal) {
            feedback.innerHTML = `‚úÖ **CORRECT** ! Tu as obtenu ${score}/${pointsTotal} points.`;
            feedback.className = 'feedback correct';
        } else if (score > 0) {
            feedback.innerHTML = `üü° **PARTIEL** : ${score}/${pointsTotal} points. Revois l'association manquante.`;
            feedback.className = 'feedback partial';
        } else {
            feedback.innerHTML = `‚ùå **FAUX** : Tu as obtenu 0/${pointsTotal} points.`;
            feedback.className = 'feedback incorrect';
        }
        return score;
    }

    function checkExo5(pointsTotal = 3) {
        const text1 = document.getElementById('text5-1').value.trim().toLowerCase();
        const text2 = document.getElementById('text5-2').value.trim().toLowerCase();
        const feedback = document.getElementById('feedback-exo5');
        let score = 0;

        const correct1 = ['couteau', 'lame'];
        const correct2 = ['coupure', 'coup√©', 'l√©sion'];

        const isCorrect1 = correct1.some(val => text1.includes(val.toLowerCase()));
        const isCorrect2 = correct2.some(val => text2.includes(val.toLowerCase()));

        if (isCorrect1) score++;
        if (isCorrect2) score += 2; // Plus de points pour l'atteinte car c'est l'objectif principal

        if (score === pointsTotal) {
            feedback.innerHTML = `‚úÖ **CORRECT** ! Tu as obtenu ${score}/${pointsTotal} points.`;
            feedback.className = 'feedback correct';
        } else if (score > 0) {
            feedback.innerHTML = `üü° **PARTIEL** : ${score}/${pointsTotal} points. V√©rifie si tu n'as pas invers√© le Danger (Cause) et l'Atteinte (Cons√©quence).`;
            feedback.className = 'feedback partial';
        } else {
            feedback.innerHTML = `‚ùå **FAUX** : Tu as obtenu 0/${pointsTotal} points.`;
            feedback.className = 'feedback incorrect';
        }
        return score;
    }

    function checkExo6(pointsTotal = 2) {
        const text = document.getElementById('text6-1').value.trim().toLowerCase();
        const feedback = document.getElementById('feedback-exo6');
        let score = 0;
        
        const correctValues = ['mal de dos', 'lombalgie', 'tendinite'];

        if (correctValues.some(val => text.includes(val.toLowerCase()))) {
            score = pointsTotal;
            feedback.innerHTML = `‚úÖ **CORRECT** ! Tu as obtenu ${score}/${pointsTotal} points.`;
            feedback.className = 'feedback correct';
        } else {
            feedback.innerHTML = `‚ùå **FAUX** : Tu as obtenu 0/${pointsTotal} points. L'atteinte √©tait li√©e aux efforts physiques.`;
            feedback.className = 'feedback incorrect';
        }
        return score;
    }


    // --- Fonction principale : Calcul et Affichage ---

    function calculateScoreAndDisplayResults() {
        // 1. R√©initialiser le score et les couleurs du D&D (avant de recalculer)
        let totalScore = 0;
        document.querySelectorAll('.draggable-item').forEach(item => {
            item.classList.remove('danger-item', 'health-item');
        });

        // 2. Lancer les v√©rifications, accumuler le score et afficher le feedback individuel
        totalScore += checkExo1(5);
        totalScore += checkExo2(2);
        totalScore += checkExo3(1);
        totalScore += checkExo4(2);
        totalScore += checkExo5(3);
        totalScore += checkExo6(2);


        // 3. Afficher le score final
        document.getElementById('final-score').textContent = `${totalScore} / ${maxScore} Points`;
        
        // 4. Afficher tous les feedbacks et les corrections d√©taill√©es
        document.querySelectorAll('.feedback').forEach(f => f.style.display = 'block');
        document.querySelectorAll('.correction').forEach(c => c.style.display = 'block');
        document.getElementById('score-explanation').style.display = 'block';
        
        alert(`Ton score final est de ${totalScore} / 15 ! Les r√©sultats d√©taill√©s sont maintenant affich√©s pour chaque exercice.`);
    }

    // --- Logique Glisser-D√©poser (Initialisation) ---

    let draggedItem = null;

    document.querySelectorAll('.draggable-item').forEach(item => {
        item.addEventListener('dragstart', (e) => {
            draggedItem = e.target;
            e.dataTransfer.setData('text/plain', e.target.id); 
            setTimeout(() => e.target.style.opacity = '0.5', 0);
        });

        item.addEventListener('dragend', (e) => {
            e.target.style.opacity = '1';
            draggedItem = null;
        });
    });

    document.querySelectorAll('.drop-zone').forEach(zone => {
        zone.addEventListener('dragover', (e) => {
            e.preventDefault(); 
            zone.style.backgroundColor = '#e0f7fa';
        });

        zone.addEventListener('dragleave', (e) => {
            zone.style.backgroundColor = 'white';
        });

        zone.addEventListener('drop', (e) => {
            e.preventDefault();
            zone.style.backgroundColor = 'white';
            if (draggedItem) {
                if (draggedItem.parentNode.classList.contains('drop-zone')) {
                    draggedItem.parentNode.removeChild(draggedItem);
                }
                zone.appendChild(draggedItem);
                draggedItem.classList.remove('danger-item', 'health-item'); 
            }
        });
    });

    // --- Fonctions de R√©initialisation ---
    
    function resetAll() {
        // R√©initialiser les entr√©es textuelles et selects
        document.getElementById('text5-1').value = "";
        document.getElementById('text5-2').value = "";
        document.getElementById('text6-1').value = "";
        document.getElementById('select4-1').selectedIndex = 0;
        document.getElementById('select4-2').selectedIndex = 0;
        
        // R√©initialiser les QCM
        document.querySelectorAll('input[type="radio"]').forEach(radio => radio.checked = false);
        
        // R√©initialiser le Glisser-D√©poser
        const source = document.getElementById('drag-source-1');
        
        Array.from(document.querySelectorAll('.draggable-item')).forEach(item => {
            item.classList.remove('danger-item', 'health-item');
            source.appendChild(item); // Remettre √† la source
        });

        // R√©initialiser l'affichage
        document.getElementById('final-score').textContent = `-- / ${maxScore} Points`;
        document.querySelectorAll('.feedback').forEach(f => {
            f.style.display = "none";
            f.innerHTML = "";
            f.className = 'feedback';
        });
        document.querySelectorAll('.correction').forEach(c => c.style.display = "none");
        document.getElementById('score-explanation').style.display = 'none';

        alert("Tous les exercices ont √©t√© r√©initialis√©s. Tu peux recommencer !");
    }

</script>

</body>
</html>