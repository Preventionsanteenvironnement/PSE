<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module C.5 - Flashcards Analyse Risques - Premi√®re Bac Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }

        /* EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE */
        .cadre-pedagogique {
            background: linear-gradient(135deg, #2E86AB, #A23B72);
            color: white;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .module-info h2 {
            font-size: 1.6em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .objectif {
            background: rgba(255,255,255,0.1);
            padding: 12px;
            border-radius: 8px;
            margin: 12px 0;
            font-size: 0.9em;
        }

        .competences-travaillees {
            margin: 15px 0;
        }

        .competences-list {
            list-style: none;
            margin: 8px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
        }

        .competences-list li {
            background: rgba(255,255,255,0.1);
            padding: 6px 12px;
            border-radius: 15px;
            border-left: 3px solid #fff;
            font-size: 0.8em;
        }

        .niveau-cible {
            font-weight: 600;
            background: rgba(255,255,255,0.2);
            padding: 8px;
            border-radius: 6px;
            font-size: 0.9em;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .btn-back {
            background: rgba(255,255,255,0.1);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.2);
            cursor: pointer;
        }
        
        .btn-back:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .score-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 50px;
        }
        
        .score-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .score-item .icon {
            font-size: 18px;
        }
        
        /* √âcrans */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* √âcran d'accueil */
        .welcome-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .welcome-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ff9a9e, #fecfef, #fecfef);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 30px;
        }
        
        /* Objectifs */
        .objectifs-card {
            background: linear-gradient(135deg, rgba(255, 154, 158, 0.3), rgba(254, 207, 239, 0.3));
            border: 2px solid rgba(255, 154, 158, 0.5);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: left;
        }
        
        .objectifs-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .objectif-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
            line-height: 1.5;
        }
        
        .objectif-item:last-child {
            border-bottom: none;
        }
        
        .objectif-item .check {
            color: #4CAF50;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .competences-row {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .comp-badge {
            background: rgba(255,255,255,0.15);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .comp-badge.c1 { background: rgba(16, 185, 129, 0.3); border: 1px solid #10b981; }
        .comp-badge.c2 { background: rgba(102, 126, 234, 0.3); border: 1px solid #667eea; }
        .comp-badge.c3 { background: rgba(245, 158, 11, 0.3); border: 1px solid #f59e0b; }
        .comp-badge.c4 { background: rgba(239, 68, 68, 0.3); border: 1px solid #ef4444; }
        .comp-badge.c5 { background: rgba(168, 85, 247, 0.3); border: 1px solid #a855f7; }

        /* Sigles explicit√©s */
        .sigles-explicatifs {
            background: rgba(33, 150, 243, 0.2);
            border: 2px solid rgba(33, 150, 243, 0.5);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: left;
        }

        .sigles-explicatifs h3 {
            font-size: 16px;
            margin-bottom: 12px;
            color: #64B5F6;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sigle-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 13px;
            line-height: 1.4;
        }

        .sigle-item:last-child {
            border-bottom: none;
        }

        .sigle-item .icon {
            color: #64B5F6;
            font-size: 16px;
            flex-shrink: 0;
        }

        .sigle-item strong {
            color: #81C784;
        }
        
        /* Niveaux */
        .niveaux-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .niveau-card {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .niveau-card:hover:not(.locked) {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
            border-color: rgba(255, 154, 158, 0.5);
        }
        
        .niveau-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .niveau-card.completed {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }
        
        .niveau-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }
        
        .niveau-info {
            flex-grow: 1;
        }
        
        .niveau-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .niveau-desc {
            font-size: 13px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 8px;
        }
        
        .niveau-progress {
            background: rgba(255,255,255,0.1);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 5px;
        }
        
        .niveau-progress-bar {
            background: linear-gradient(90deg, #4CAF50, #81C784);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .niveau-percent {
            font-size: 12px;
            color: rgba(255,255,255,0.8);
            font-weight: 600;
        }
        
        /* Bouton Start */
        .btn-start {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-start:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 154, 158, 0.4);
        }
        
        /* Screen de jeu */
        .game-screen {
            padding: 20px 0;
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background: rgba(255,255,255,0.05);
            padding: 15px 20px;
            border-radius: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .progress-info {
            font-size: 14px;
            color: rgba(255,255,255,0.8);
        }
        
        .progress-bar {
            background: rgba(255,255,255,0.1);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            flex-grow: 1;
            margin: 0 20px;
            min-width: 100px;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #ff9a9e, #fecfef);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .card-container {
            background: rgba(255,255,255,0.08);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            border: 2px solid rgba(255,255,255,0.1);
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .card-type {
            background: rgba(255, 154, 158, 0.3);
            color: #ff9a9e;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .card-keyword {
            font-size: 24px;
            font-weight: 900;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .card-definition {
            font-size: 16px;
            line-height: 1.6;
            color: rgba(255,255,255,0.8);
            margin-bottom: 25px;
        }
        
        /* Types de questions */
        .question-section {
            margin: 25px 0;
        }
        
        .question-text {
            font-size: 16px;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .answer-input {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 12px 20px;
            color: white;
            font-size: 16px;
            width: 100%;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .answer-input:focus {
            outline: none;
            border-color: #ff9a9e;
            background: rgba(255,255,255,0.15);
        }
        
        .answer-input::placeholder {
            color: rgba(255,255,255,0.5);
        }
        
        /* Options QCM */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }
        
        .option-btn {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 12px 15px;
            color: white;
            font-size: 14px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .option-btn:hover {
            background: rgba(255,255,255,0.1);
            border-color: #ff9a9e;
        }
        
        .option-btn.selected {
            background: rgba(255, 154, 158, 0.2);
            border-color: #ff9a9e;
        }
        
        .option-letter {
            background: #ff9a9e;
            color: #333;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            flex-shrink: 0;
        }
        
        /* Vrai/Faux */
        .vf-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .vf-btn {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 15px 25px;
            color: white;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 120px;
        }
        
        .vf-btn:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .vf-btn.selected {
            background: rgba(255, 154, 158, 0.2);
            border-color: #ff9a9e;
        }
        
        .vf-btn.vrai {
            color: #4CAF50;
        }
        
        .vf-btn.faux {
            color: #f44336;
        }
        
        /* Boutons action */
        .actions-bar {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn-action {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 10px 20px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-action:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .btn-validate {
            background: linear-gradient(135deg, #4CAF50, #81C784);
            border-color: #4CAF50;
        }
        
        .btn-validate:hover {
            background: linear-gradient(135deg, #45a049, #7cb677);
        }
        
        .hint-text {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid rgba(255, 193, 7, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-size: 14px;
            color: #FFC107;
        }
        
        /* Feedback Overlay - FONDS OPAQUES OBLIGATOIRE */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8); /* MINIMUM 80% opacit√© */
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 20px;
        }
        
        .feedback-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .feedback-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f); /* OPAQUE = LISIBLE */
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 2px solid rgba(255,255,255,0.1);
        }
        
        .feedback-card.correct {
            border-color: #4CAF50;
        }
        
        .feedback-card.incorrect {
            border-color: #f44336;
        }
        
        .feedback-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        
        .feedback-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .feedback-points {
            font-size: 14px;
            color: #4CAF50;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .feedback-explanation {
            background: rgba(255, 255, 255, 0.9); /* 90% opacit√© minimum */
            color: #333;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: left;
        }
        
        .feedback-explanation h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .feedback-explanation p {
            line-height: 1.5;
            margin-bottom: 10px;
        }
        
        .keyword-box {
            background: rgba(46, 134, 171, 0.2);
            border: 1px solid #2E86AB;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 600;
            color: #2E86AB;
        }
        
        .tip-box {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid #FFC107;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .tip-box h5 {
            color: #F57F17;
            margin-bottom: 5px;
        }
        
        .btn-next {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-next:hover {
            transform: translateY(-2px);
        }
        
        /* √âcran de r√©sultats */
        .results-screen {
            text-align: center;
            padding: 30px 0;
        }
        
        .results-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        .results-title {
            font-size: 32px;
            font-weight: 900;
            margin-bottom: 15px;
        }
        
        .results-score {
            font-size: 48px;
            font-weight: 900;
            color: #4CAF50;
            margin-bottom: 20px;
        }
        
        .results-stats {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 20px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #ff9a9e;
        }
        
        .stat-label {
            font-size: 12px;
            color: rgba(255,255,255,0.7);
        }
        
        .errors-recap {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid rgba(244, 67, 54, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: left;
        }
        
        .errors-recap h4 {
            color: #f44336;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .errors-recap ul {
            list-style: none;
            padding-left: 0;
        }
        
        .errors-recap li {
            padding: 5px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 13px;
        }
        
        .errors-recap li:last-child {
            border-bottom: none;
        }
        
        /* Popup Streak */
        .streak-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #333;
            padding: 20px 30px;
            border-radius: 20px;
            font-size: 20px;
            font-weight: 700;
            z-index: 1001;
            display: none;
            box-shadow: 0 10px 30px rgba(255, 154, 158, 0.4);
        }
        
        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            pointer-events: none;
            animation: confetti-fall 3s linear forwards;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }
        
        /* RGPD Footer */
        .rgpd-notice {
            background: rgba(255,255,255,0.05);
            color: rgba(255,255,255,0.7);
            text-align: center;
            padding: 15px;
            font-size: 0.9em;
            margin-top: 30px;
            border-radius: 10px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 32px;
            }
            
            .welcome-subtitle {
                font-size: 16px;
            }
            
            .container {
                padding: 15px;
            }
            
            .objectifs-card {
                padding: 20px;
            }
            
            .card-container {
                padding: 20px;
                min-height: 350px;
            }
            
            .vf-container {
                flex-direction: column;
                align-items: center;
            }
            
            .vf-btn {
                max-width: none;
                width: 200px;
            }
            
            .progress-header {
                flex-direction: column;
                text-align: center;
            }
            
            .progress-bar {
                margin: 10px 0;
                width: 100%;
            }
            
            .feedback-card {
                margin: 10px;
                padding: 20px;
            }
            
            .actions-bar {
                flex-direction: column;
                align-items: center;
            }
            
            .btn-action {
                width: 200px;
            }

            .cadre-pedagogique {
                padding: 15px;
            }

            .cadre-pedagogique h2 {
                font-size: 1.4em;
            }
        }
        
        @media (max-width: 480px) {
            .results-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .niveau-card {
                flex-direction: column;
                text-align: center;
            }
            
            .niveau-icon {
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE -->
    <div class="cadre-pedagogique">
        <div class="module-info">
            <h2>Module C.5 : L'analyse des risques professionnels</h2>
            <div class="objectif">
                <strong>Objectif :</strong> S'approprier des outils m√©thodologiques d'analyse des risques en vue d'analyser et d'√©valuer un risque et de proposer des mesures hi√©rarchis√©es de pr√©vention
            </div>
        </div>
        
        <div class="competences-travaillees">
            <h3>Comp√©tences travaill√©es dans cet exercice :</h3>
            <ul class="competences-list">
                <li><strong>C1</strong> - Traiter une information</li>
                <li><strong>C2</strong> - Appliquer une d√©marche d'analyse</li>
                <li><strong>C3</strong> - Expliquer un ph√©nom√®ne</li>
                <li><strong>C4</strong> - Proposer une solution</li>
                <li><strong>C5</strong> - Argumenter un choix</li>
            </ul>
        </div>
        
        <div class="niveau-cible">
            <strong>Niveau :</strong> Bac Pro Premi√®re
        </div>
    </div>

    <div class="container">
        <div class="header">
            <button class="btn-back" onclick="goHome()">‚Üê Retour</button>
            <div class="score-bar">
                <div class="score-item">
                    <span class="icon">üíé</span>
                    <span id="totalPoints">0</span>
                </div>
                <div class="score-item">
                    <span class="icon">üî•</span>
                    <span id="currentStreak">0</span>
                </div>
            </div>
        </div>
        
        <!-- √âcran d'accueil -->
        <div id="homeScreen" class="screen active">
            <div class="welcome-screen">
                <h1 class="welcome-title">R√©vision Active</h1>
                <p class="welcome-subtitle">Ma√Ætrise l'analyse des risques professionnels</p>
                
                <div class="objectifs-card">
                    <h3>üéØ Objectifs de r√©vision</h3>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Ma√Ætriser les m√©thodes d'analyse des risques (ITAMaMi, arbre des causes)</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Comprendre les grilles d'√©valuation et matrices de criticit√©</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Hi√©rarchiser les mesures de pr√©vention selon les 9 principes g√©n√©raux</span>
                    </div>
                    <div class="objectif-item">
                        <span class="check">‚úì</span>
                        <span>Argumenter des choix de pr√©vention dans un contexte professionnel</span>
                    </div>
                    
                    <div class="competences-row">
                        <span class="comp-badge c1">C1</span>
                        <span class="comp-badge c2">C2</span>
                        <span class="comp-badge c3">C3</span>
                        <span class="comp-badge c4">C4</span>
                        <span class="comp-badge c5">C5</span>
                    </div>
                </div>

                <div class="sigles-explicatifs">
                    <h3>üìö Sigles PSE - Explications</h3>
                    <div class="sigle-item">
                        <span class="icon">üîç</span>
                        <span><strong>ITAMaMi</strong> = <strong>I</strong>ndividu + <strong>TA</strong>che + <strong>A</strong>ctivit√© + <strong>MA</strong>t√©riel + <strong>MI</strong>lieu<br><em>M√©thode d'analyse syst√©mique des situations de travail</em></span>
                    </div>
                    <div class="sigle-item">
                        <span class="icon">üìã</span>
                        <span><strong>DUERP</strong> = <strong>D</strong>ocument <strong>U</strong>nique d'<strong>√â</strong>valuation des <strong>R</strong>isques <strong>P</strong>rofessionnels<br><em>Document obligatoire recensant tous les risques de l'entreprise</em></span>
                    </div>
                    <div class="sigle-item">
                        <span class="icon">üèõÔ∏è</span>
                        <span><strong>INRS</strong> = <strong>I</strong>nstitut <strong>N</strong>ational de <strong>R</strong>echerche et de <strong>S</strong>√©curit√©<br><em>Organisme de r√©f√©rence pour la pr√©vention des risques professionnels</em></span>
                    </div>
                    <div class="sigle-item">
                        <span class="icon">üõ°Ô∏è</span>
                        <span><strong>EPI</strong> = <strong>√â</strong>quipement de <strong>P</strong>rotection <strong>I</strong>ndividuelle<br><em>Dispositif destin√© √† prot√©ger une personne contre les risques</em></span>
                    </div>
                    <div class="sigle-item">
                        <span class="icon">üë•</span>
                        <span><strong>EPC</strong> = <strong>√â</strong>quipement de <strong>P</strong>rotection <strong>C</strong>ollective<br><em>Dispositif prot√©geant plusieurs personnes simultan√©ment</em></span>
                    </div>
                    <div class="sigle-item">
                        <span class="icon">üè¢</span>
                        <span><strong>HSE</strong> = <strong>H</strong>ygi√®ne, <strong>S</strong>√©curit√©, <strong>E</strong>nvironnement<br><em>Domaine professionnel de la pr√©vention des risques en entreprise</em></span>
                    </div>
                </div>
                
                <div class="niveaux-grid">
                    <div class="niveau-card" onclick="startLevel(1)">
                        <div class="niveau-icon">üìä</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 1 - Vocabulaire fondamental</div>
                            <div class="niveau-desc">Termes et d√©finitions de base</div>
                            <div class="niveau-progress">
                                <div class="niveau-progress-bar" id="level1Bar"></div>
                            </div>
                            <div class="niveau-percent" id="level1Percent">0%</div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(2)">
                        <div class="niveau-icon">üîç</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 2 - M√©thodes d'analyse</div>
                            <div class="niveau-desc">ITAMaMi, arbre des causes, processus</div>
                            <div class="niveau-progress">
                                <div class="niveau-progress-bar" id="level2Bar"></div>
                            </div>
                            <div class="niveau-percent" id="level2Percent">0%</div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(3)">
                        <div class="niveau-icon">‚öñÔ∏è</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 3 - √âvaluation des risques</div>
                            <div class="niveau-desc">Gravit√©, probabilit√©, matriceINRS</div>
                            <div class="niveau-progress">
                                <div class="niveau-progress-bar" id="level3Bar"></div>
                            </div>
                            <div class="niveau-percent" id="level3Percent">0%</div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(4)">
                        <div class="niveau-icon">üõ°Ô∏è</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 4 - Mesures de pr√©vention</div>
                            <div class="niveau-desc">Hi√©rarchie, EPI/EPC, efficacit√©</div>
                            <div class="niveau-progress">
                                <div class="niveau-progress-bar" id="level4Bar"></div>
                            </div>
                            <div class="niveau-percent" id="level4Percent">0%</div>
                        </div>
                    </div>
                    
                    <div class="niveau-card" onclick="startLevel(5)">
                        <div class="niveau-icon">üèÜ</div>
                        <div class="niveau-info">
                            <div class="niveau-title">Niveau 5 - Synth√®se experte</div>
                            <div class="niveau-desc">Cas complexes, argumentation</div>
                            <div class="niveau-progress">
                                <div class="niveau-progress-bar" id="level5Bar"></div>
                            </div>
                            <div class="niveau-percent" id="level5Percent">0%</div>
                        </div>
                    </div>
                </div>
                
                <button class="btn-start" onclick="startLevel(1)">üöÄ Commencer</button>
            </div>
        </div>
        
        <!-- √âcran de jeu -->
        <div id="gameScreen" class="screen">
            <div class="game-screen">
                <div class="progress-header">
                    <div class="progress-info">
                        <span>Niveau <span id="currentLevelNum">1</span></span> ‚Ä¢ 
                        <span>Question <span id="currentCardNum">1</span>/<span id="totalCardsNum">10</span></span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar"></div>
                    </div>
                    <div class="progress-info">
                        <span id="levelTitle">Vocabulaire fondamental</span>
                    </div>
                </div>
                
                <div class="card-container">
                    <div class="card-type" id="cardType">D√âFINITION</div>
                    <div class="card-keyword" id="cardKeyword"></div>
                    <div class="card-definition" id="cardDefinition"></div>
                    
                    <div class="question-section" id="questionSection">
                        <!-- Contenu dynamique selon le type de question -->
                    </div>
                    
                    <div class="hint-text" id="hintText" style="display: none;"></div>
                </div>
                
                <div class="actions-bar">
                    <button class="btn-action" onclick="showHint()">üí° Indice</button>
                    <button class="btn-action btn-validate" onclick="validateAnswer()">‚úÖ Valider</button>
                </div>
            </div>
        </div>
        
        <!-- √âcran de r√©sultats -->
        <div id="resultsScreen" class="screen">
            <div class="results-screen">
                <div class="results-icon" id="resultsIcon">üéâ</div>
                <h2 class="results-title" id="resultsTitle">Niveau r√©ussi !</h2>
                <div class="results-score" id="resultsScore">85%</div>
                
                <div class="results-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="correctCount">8/10</div>
                        <div class="stat-label">Bonnes r√©ponses</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="pointsEarned">+75</div>
                        <div class="stat-label">Points gagn√©s</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="bestStreak">5</div>
                        <div class="stat-label">Meilleure s√©rie</div>
                    </div>
                </div>
                
                <div class="errors-recap" id="errorsRecap" style="display: none;">
                    <h4>üìù √Ä retravailler</h4>
                    <ul id="errorsList"></ul>
                </div>
                
                <div class="actions-bar">
                    <button class="btn-action" onclick="goHome()">üè† Accueil</button>
                    <button class="btn-action btn-validate" id="nextLevelBtn" onclick="nextLevel()" style="display: none;">‚û°Ô∏è Niveau suivant</button>
                </div>
            </div>
        </div>
        
        <!-- Feedback Overlay -->
        <div class="feedback-overlay" id="feedbackOverlay">
            <div class="feedback-card" id="feedbackCard">
                <div class="feedback-icon" id="feedbackIcon">‚úÖ</div>
                <h3 class="feedback-title" id="feedbackTitle">Bravo !</h3>
                <div class="feedback-points" id="feedbackPoints">+10 points</div>
                <div class="feedback-explanation" id="feedbackExplanation">
                    <!-- Contenu dynamique -->
                </div>
                <button class="btn-next" onclick="nextCard()">Suivant ‚Üí</button>
            </div>
        </div>
        
        <!-- Popup Streak -->
        <div class="streak-popup" id="streakPopup">üî• 3 de suite !</div>

        <!-- FOOTER RGPD -->
        <div class="rgpd-notice">
            üîí Conformit√© RGPD : Cet exercice respecte votre anonymat.
        </div>
    </div>
    
    <script>
        // Variables globales
        let currentLevel = 1;
        let currentCardIndex = 0;
        let levelProgress = [0, 0, 0, 0, 0, 0]; // Index 0 inutilis√©
        let totalPoints = 0;
        let currentStreak = 0;
        let bestStreak = 0;
        let hintUsed = false;
        let levelCorrect = 0;
        let levelPoints = 0;
        let levelErrors = [];
        
        // Donn√©es des niveaux
        const levels = {
            1: {
                title: "Vocabulaire fondamental",
                icon: "üìä",
                cards: [
                    {
                        keyword: "Danger",
                        definition: "Propri√©t√© intrins√®que d'une situation, d'un √©quipement, d'un produit capable de causer un dommage",
                        type: "keyword",
                        question: "Comment appelle-t-on la propri√©t√© intrins√®que capable de causer un dommage ?",
                        answer: "danger",
                        hint: "C'est la cause potentielle du dommage, pas le risque lui-m√™me",
                        explanation: "Le danger est la cause premi√®re capable de provoquer une l√©sion ou atteinte √† la sant√©. Il faut le distinguer du risque qui est la probabilit√© que ce danger cause effectivement un dommage.",
                        tip: "√Ä l'examen, distinguez toujours danger (potentiel de nuisance) et risque (probabilit√© √ó gravit√©)."
                    },
                    {
                        keyword: "Risque professionnel",
                        definition: "Probabilit√© qu'un danger se r√©alise et cause un dommage dans le cadre du travail",
                        type: "qcm",
                        question: "Le risque professionnel se d√©finit comme :",
                        options: [
                            "La pr√©sence d'un danger sur le lieu de travail",
                            "La probabilit√© qu'un danger cause un dommage au travail",
                            "L'√©quipement de protection n√©cessaire",
                            "La formation √† la s√©curit√© obligatoire"
                        ],
                        answer: 1,
                        explanation: "Le risque professionnel = Danger √ó Exposition √ó Probabilit√© d'occurrence. C'est l'√©valuation de la chance qu'un danger se mat√©rialise en accident.",
                        tip: "Risque = f(Gravit√© √ó Probabilit√©). Cette formule est fondamentale pour l'√©valuation."
                    },
                    {
                        keyword: "Pr√©vention",
                        definition: "Ensemble des dispositions prises pour √©viter qu'un risque se r√©alise",
                        type: "vf",
                        question: "La pr√©vention consiste uniquement √† porter des √©quipements de protection individuelle.",
                        answer: false,
                        explanation: "La pr√©vention englobe 9 principes g√©n√©raux : √©viter les risques, √©valuer, combattre √† la source, adapter le travail √† l'homme, etc. Les EPI ne sont que le dernier recours.",
                        tip: "M√©morisez les 9 principes g√©n√©raux de pr√©vention du Code du travail (L4121-2)."
                    },
                    {
                        keyword: "DUERP",
                        definition: "Document Unique d'√âvaluation des Risques Professionnels - obligatoire dans toute entreprise",
                        type: "keyword", 
                        question: "Quel document obligatoire recense tous les risques d'une entreprise ? (sigle)",
                        answer: "duerp",
                        hint: "5 lettres, commence par D",
                        explanation: "Le DUERP (Document Unique d'√âvaluation des Risques Professionnels) est obligatoire d√®s le 1er salari√©. Il doit √™tre mis √† jour annuellement et lors de modifications importantes.",
                        tip: "DUERP = outil central de la d√©marche de pr√©vention. Connaissez ses obligations l√©gales."
                    },
                    {
                        keyword: "Accident du travail",
                        definition: "√âv√©nement soudain survenant par le fait ou √† l'occasion du travail et causant une l√©sion",
                        type: "qcm",
                        question: "Pour √™tre qualifi√© d'accident du travail, un √©v√©nement doit √™tre :",
                        options: [
                            "Soudain et caus√© par le travail uniquement",
                            "Soudain, survenant au travail et causant une l√©sion",
                            "Pr√©vu et d√©clar√© √† l'avance",
                            "Caus√© par une n√©gligence du salari√©"
                        ],
                        answer: 1,
                        explanation: "3 crit√®res cumulatifs : soudainet√© (√©v√©nement pr√©cis dans le temps), fait du travail (lien avec l'activit√© professionnelle), l√©sion (dommage corporel ou psychique).",
                        tip: "M√©morisez les 3 crit√®res de l'accident du travail : soudainet√© + fait du travail + l√©sion."
                    },
                    {
                        keyword: "Maladie professionnelle",
                        definition: "Affection caus√©e de mani√®re directe par l'exposition habituelle √† un risque professionnel",
                        type: "vf",
                        question: "Une maladie professionnelle appara√Æt toujours de mani√®re soudaine.",
                        answer: false,
                        explanation: "Contrairement √† l'accident du travail, la maladie professionnelle r√©sulte d'une exposition progressive et prolong√©e. Elle appara√Æt lentement (notion d'impr√©gnation).",
                        tip: "Accident = soudain / Maladie professionnelle = progressive. Opposition fondamentale."
                    },
                    {
                        keyword: "Facteurs de risques",
                        definition: "√âl√©ments de l'environnement ou de l'activit√© de travail susceptibles de causer un dommage",
                        type: "keyword",
                        question: "Comment appelle-t-on les √©l√©ments du travail susceptibles de causer un dommage ?",
                        answer: "facteurs de risques",
                        hint: "Deux mots, le second est au pluriel",
                        explanation: "Les facteurs de risques peuvent √™tre physiques (bruit, vibrations), chimiques (produits toxiques), biologiques (virus, bact√©ries), psychosociaux (stress) ou li√©s √† l'organisation.",
                        tip: "Classez les facteurs de risques : physiques, chimiques, biologiques, psychosociaux, organisationnels."
                    },
                    {
                        keyword: "S√©curit√© au travail",
                        definition: "√âtat dans lequel le risque de dommage corporel ou mat√©riel est limit√© √† un niveau acceptable",
                        type: "qcm",
                        question: "La s√©curit√© au travail vise √† :",
                        options: [
                            "√âliminer totalement tous les risques",
                            "Limiter les risques √† un niveau acceptable",
                            "Assurer uniquement contre les accidents",
                            "Former les salari√©s aux premiers secours"
                        ],
                        answer: 1,
                        explanation: "Le risque z√©ro n'existe pas. La s√©curit√© consiste √† ma√Ætriser les risques pour qu'ils restent dans des limites acceptables selon des crit√®res techniques, humains et √©conomiques.",
                        tip: "Risque z√©ro = impossible. Objectif = risque r√©siduel acceptable (principe ALARA)."
                    }
                ]
            },
            2: {
                title: "M√©thodes d'analyse",
                icon: "üîç",
                cards: [
                    {
                        keyword: "ITAMaMi",
                        definition: "M√©thode d'analyse : Individu + T√¢che + Activit√© + Mat√©riel + Milieu",
                        type: "keyword",
                        question: "Quelle m√©thode analyse 5 composantes d'une situation de travail ? (sigle)",
                        answer: "itamami",
                        hint: "7 lettres, m√©thode syst√©mique",
                        explanation: "ITAMaMi d√©compose une situation de travail en 5 √©l√©ments interd√©pendants pour une analyse exhaustive des risques et dysfonctionnements.",
                        tip: "ITAMaMi = vision globale et syst√©mique indispensable pour l'analyse PSE."
                    },
                    {
                        keyword: "Arbre des causes",
                        definition: "M√©thode de recherche des causes multiples ayant contribu√© √† un dysfonctionnement",
                        type: "qcm",
                        question: "L'arbre des causes permet de :",
                        options: [
                            "Pr√©voir les accidents futurs",
                            "Identifier les causes multiples d'un √©v√©nement",
                            "Calculer la probabilit√© d'accident",
                            "√âtablir les responsabilit√©s juridiques"
                        ],
                        answer: 1,
                        explanation: "L'arbre des causes remonte de l'√©v√©nement vers ses causes en posant syst√©matiquement 'Pourquoi ?'. Il r√©v√®le les causes multiples et leur encha√Ænement.",
                        tip: "Arbre des causes = outil d'analyse a posteriori. Questionner : 'Qu'est-ce qui a permis √ßa ?'"
                    },
                    {
                        keyword: "Processus d'apparition du dommage",
                        definition: "Encha√Ænement logique : Op√©rateur ‚Üí Danger ‚Üí Situation dangereuse ‚Üí √âv√©nement ‚Üí Dommage",
                        type: "vf",
                        question: "Dans le processus d'apparition du dommage, le danger pr√©c√®de toujours la situation dangereuse.",
                        answer: true,
                        explanation: "S√©quence obligatoire : il faut d'abord un danger (cause potentielle), puis que l'op√©rateur y soit expos√© (situation dangereuse) pour qu'un √©v√©nement puisse d√©clencher le dommage.",
                        tip: "M√©morisez la s√©quence : Op√©rateur + Danger = Situation dangereuse ‚Üí √âv√©nement ‚Üí Dommage."
                    },
                    {
                        keyword: "Observation du travail",
                        definition: "Analyse syst√©matique des gestes, postures et conditions r√©elles de r√©alisation du travail",
                        type: "keyword",
                        question: "Comment appelle-t-on l'analyse syst√©matique des gestes et postures au travail ?",
                        answer: "observation du travail",
                        hint: "Deux mots, m√©thode d'analyse directe",
                        explanation: "L'observation du travail r√©v√®le les √©carts entre le travail prescrit et r√©el. Elle identifie les adaptations, contraintes et risques effectifs.",
                        tip: "Distinguez travail prescrit (ce qui est demand√©) et travail r√©el (ce qui est fait)."
                    },
                    {
                        keyword: "Facteurs humains",
                        definition: "√âl√©ments li√©s √† l'individu influen√ßant sa performance et sa s√©curit√© au travail",
                        type: "qcm",
                        question: "Les facteurs humains comprennent :",
                        options: [
                            "Uniquement la formation et l'exp√©rience",
                            "L'√¢ge, l'√©tat de sant√©, la formation, la motivation",
                            "Seulement les aspects physiques",
                            "Exclusivement les comp√©tences techniques"
                        ],
                        answer: 1,
                        explanation: "Les facteurs humains englobent les aspects physiques (√¢ge, sant√©), cognitifs (formation, exp√©rience), et psychologiques (motivation, stress) influen√ßant la performance.",
                        tip: "Facteurs humains = approche globale : physique + cognitif + psychologique."
                    },
                    {
                        keyword: "Analyse syst√©mique",
                        definition: "Approche consid√©rant les interactions entre tous les √©l√©ments d'un syst√®me",
                        type: "vf",
                        question: "L'analyse syst√©mique √©tudie chaque √©l√©ment s√©par√©ment sans consid√©rer leurs interactions.",
                        answer: false,
                        explanation: "L'approche syst√©mique s'int√©resse aux interactions et interd√©pendances. Un dysfonctionnement r√©sulte souvent de la combinaison de plusieurs facteurs.",
                        tip: "Pensez 'syst√®me' : les √©l√©ments interagissent, l'ensemble ‚â† somme des parties."
                    },
                    {
                        keyword: "Retour d'exp√©rience",
                        definition: "Capitalisation des enseignements tir√©s d'√©v√©nements pass√©s pour am√©liorer la pr√©vention",
                        type: "keyword",
                        question: "Comment appelle-t-on la capitalisation des enseignements d'√©v√©nements pass√©s ?",
                        answer: "retour d'exp√©rience",
                        hint: "Trois mots, m√©thode d'apprentissage",
                        explanation: "Le retour d'exp√©rience (REX) transforme les accidents et incidents en apprentissage collectif pour √©viter leur reproduction.",
                        tip: "REX = transformer l'√©chec en progr√®s. Analyser, comprendre, corriger, partager."
                    },
                    {
                        keyword: "Indicateurs de s√©curit√©",
                        definition: "Donn√©es quantitatives mesurant la performance de la pr√©vention dans l'entreprise",
                        type: "qcm",
                        question: "Les indicateurs de s√©curit√© servent √† :",
                        options: [
                            "Sanctionner les salari√©s n√©gligents",
                            "Mesurer et piloter la performance s√©curit√©",
                            "Calculer les primes d'assurance",
                            "√âtablir les plannings de formation"
                        ],
                        answer: 1,
                        explanation: "Les indicateurs (taux de fr√©quence, gravit√©, nombre de presqu'accidents) permettent de mesurer l'efficacit√© de la pr√©vention et d'identifier les axes d'am√©lioration.",
                        tip: "Indicateurs = tableau de bord s√©curit√©. Mesurez pour piloter et am√©liorer."
                    }
                ]
            },
            3: {
                title: "√âvaluation des risques",
                icon: "‚öñÔ∏è",
                cards: [
                    {
                        keyword: "Gravit√©",
                        definition: "Mesure des cons√©quences potentielles d'un risque sur la sant√© ou l'int√©grit√© physique",
                        type: "keyword",
                        question: "Comment appelle-t-on la mesure des cons√©quences potentielles d'un risque ?",
                        answer: "gravit√©",
                        hint: "Intensit√© des cons√©quences possibles",
                        explanation: "La gravit√© s'√©value g√©n√©ralement sur une √©chelle de 1 (n√©gligeable) √† 4 (catastrophique). Elle consid√®re les cons√©quences humaines, mat√©rielles et environnementales.",
                        tip: "√âchelle gravit√© INRS : 1-N√©gligeable, 2-Mod√©r√©e, 3-Grave, 4-Catastrophique."
                    },
                    {
                        keyword: "Probabilit√© d'occurrence",
                        definition: "Estimation de la chance qu'un √©v√©nement dangereux se produise",
                        type: "qcm",
                        question: "La probabilit√© d'occurrence d√©pend principalement de :",
                        options: [
                            "La gravit√© des cons√©quences uniquement",
                            "La fr√©quence d'exposition et la probabilit√© d'√©v√©nement",
                            "Le nombre d'employ√©s dans l'entreprise",
                            "Le co√ªt des mesures de pr√©vention"
                        ],
                        answer: 1,
                        explanation: "Probabilit√© = Fr√©quence d'exposition √ó Probabilit√© d'√©v√©nement d√©clencheur. Plus l'exposition est fr√©quente et l'√©v√©nement probable, plus le risque est √©lev√©.",
                        tip: "Probabilit√© = f(Exposition + √âv√©nement d√©clencheur). √âvaluez les deux composantes."
                    },
                    {
                        keyword: "Matrice de criticit√©",
                        definition: "Outil croisant gravit√© et probabilit√© pour hi√©rarchiser les risques",
                        type: "vf",
                        question: "La matrice de criticit√© permet de prioriser les actions de pr√©vention selon l'urgence.",
                        answer: true,
                        explanation: "La matrice INRS croise gravit√© (axe Y) et probabilit√© (axe X) pour obtenir un niveau de risque (vert-jaune-orange-rouge) qui d√©termine la priorit√© d'action.",
                        tip: "Matrice = outil de priorisation. Rouge = urgent, Vert = surveillance acceptable."
                    },
                    {
                        keyword: "Criticit√©",
                        definition: "Niveau de risque r√©sultant du croisement gravit√© √ó probabilit√©",
                        type: "keyword",
                        question: "Comment appelle-t-on le niveau de risque obtenu par gravit√© √ó probabilit√© ?",
                        answer: "criticit√©",
                        hint: "R√©sultat du croisement des deux crit√®res",
                        explanation: "La criticit√© hi√©rarchise les risques : Criticit√© = f(Gravit√© √ó Probabilit√©). Plus la criticit√© est √©lev√©e, plus l'action de pr√©vention est urgente.",
                        tip: "Criticit√© = niveau de priorit√© d'action. Formule fondamentale de l'√©valuation."
                    },
                    {
                        keyword: "Grille d'√©valuation INRS",
                        definition: "R√©f√©rentiel standardis√© pour √©valuer et comparer les risques professionnels",
                        type: "qcm",
                        question: "La grille INRS propose combien de niveaux pour chaque crit√®re ?",
                        options: [
                            "3 niveaux (faible, moyen, √©lev√©)",
                            "4 niveaux (de 1 √† 4)",
                            "5 niveaux (de A √† E)", 
                            "2 niveaux (acceptable/inacceptable)"
                        ],
                        answer: 1,
                        explanation: "L'INRS utilise une √©chelle √† 4 niveaux pour la gravit√© (1 √† 4) et la probabilit√© (1 √† 4), permettant 16 combinaisons de criticit√©.",
                        tip: "INRS = standard fran√ßais. 4√ó4 = 16 combinaisons possibles de criticit√©."
                    },
                    {
                        keyword: "Risque r√©siduel",
                        definition: "Niveau de risque subsistant apr√®s mise en place des mesures de pr√©vention",
                        type: "vf",
                        question: "Le risque r√©siduel doit toujours √™tre √©gal √† z√©ro pour √™tre acceptable.",
                        answer: false,
                        explanation: "Le risque z√©ro n'existe pas. Le risque r√©siduel doit √™tre maintenu 'As Low As Reasonably Achievable' (ALARA) : le plus bas possible dans des limites raisonnables.",
                        tip: "ALARA = principe du risque r√©siduel. Z√©ro impossible, viser le minimum raisonnable."
                    },
                    {
                        keyword: "Seuil d'acceptabilit√©",
                        definition: "Niveau de risque consid√©r√© comme tol√©rable par l'organisation",
                        type: "keyword",
                        question: "Comment appelle-t-on le niveau de risque consid√©r√© comme tol√©rable ?",
                        answer: "seuil d'acceptabilit√©",
                        hint: "Deux mots, limite de tol√©rance",
                        explanation: "Le seuil d'acceptabilit√© varie selon le secteur, la culture s√©curit√© de l'entreprise et la r√©glementation. Il d√©finit la fronti√®re entre action obligatoire et surveillance.",
                        tip: "Seuil d'acceptabilit√© = curseur culturel et r√©glementaire propre √† chaque organisation."
                    },
                    {
                        keyword: "√âvaluation qualitative",
                        definition: "M√©thode d'estimation des risques bas√©e sur l'expertise plut√¥t que sur des donn√©es chiffr√©es",
                        type: "qcm",
                        question: "L'√©valuation qualitative utilise principalement :",
                        options: [
                            "Des calculs math√©matiques pr√©cis",
                            "L'expertise et le jugement professionnel",
                            "Uniquement des donn√©es statistiques",
                            "Des instruments de mesure sophistiqu√©s"
                        ],
                        answer: 1,
                        explanation: "L'√©valuation qualitative s'appuie sur l'exp√©rience, l'observation et l'expertise pour estimer les risques quand les donn√©es quantitatives manquent.",
                        tip: "Qualitatif = expertise humaine. Quantitatif = donn√©es mesurables. Compl√©mentaires."
                    }
                ]
            },
            4: {
                title: "Mesures de pr√©vention",
                icon: "üõ°Ô∏è",
                cards: [
                    {
                        keyword: "Hi√©rarchie des mesures",
                        definition: "Ordre de priorit√© des 9 principes g√©n√©raux de pr√©vention du Code du travail",
                        type: "keyword",
                        question: "Comment appelle-t-on l'ordre de priorit√© des mesures de pr√©vention ?",
                        answer: "hi√©rarchie des mesures",
                        hint: "Classification par ordre d'efficacit√©",
                        explanation: "La hi√©rarchie privil√©gie : 1) √âviter les risques, 2) √âvaluer, 3) Combattre √† la source, 4) Adapter le travail √† l'homme... Les EPI arrivent en dernier recours.",
                        tip: "M√©morisez les 9 principes L4121-2. Prioriser = √©liminer > collectif > individuel."
                    },
                    {
                        keyword: "Protection collective",
                        definition: "Mesures prot√©geant simultan√©ment plusieurs personnes contre un m√™me risque",
                        type: "qcm",
                        question: "Un exemple de protection collective est :",
                        options: [
                            "Le casque de chantier individuel",
                            "La ventilation d'un local de travail",
                            "Les lunettes de protection",
                            "La formation individuelle"
                        ],
                        answer: 1,
                        explanation: "La protection collective (ventilation, garde-corps, √©clairage) prot√®ge tous les op√©rateurs pr√©sents. Plus efficace que la protection individuelle car passive.",
                        tip: "Collectif > Individuel. Efficacit√© sup√©rieure car protection automatique et permanente."
                    },
                    {
                        keyword: "EPI",
                        definition: "√âquipement de Protection Individuelle port√© par une personne pour sa s√©curit√©",
                        type: "vf",
                        question: "Les EPI doivent √™tre utilis√©s en priorit√© avant les mesures collectives.",
                        answer: false,
                        explanation: "Les EPI sont le dernier recours dans la hi√©rarchie. Ils n√©cessitent une adh√©sion constante de l'utilisateur et peuvent cr√©er une g√™ne ou d√©faillir.",
                        tip: "EPI = dernier rempart. Efficacit√© d√©pendante du comportement humain donc moins fiable."
                    },
                    {
                        keyword: "Suppression du risque",
                        definition: "√âlimination compl√®te de la source de danger pour √©viter toute exposition",
                        type: "keyword",
                        question: "Quelle mesure consiste √† √©liminer compl√®tement la source de danger ?",
                        answer: "suppression du risque",
                        hint: "√âlimination totale du danger",
                        explanation: "La suppression agit √† la source : substituer un produit dangereux, automatiser une t√¢che dangereuse, modifier un proc√©d√©. C'est la mesure la plus efficace.",
                        tip: "Suppression = niveau 1 de la hi√©rarchie. Pas de danger = pas de risque."
                    },
                    {
                        keyword: "Substitution",
                        definition: "Remplacement d'un √©l√©ment dangereux par un moins dangereux",
                        type: "qcm",
                        question: "La substitution consiste √† :",
                        options: [
                            "Former davantage les salari√©s",
                            "Remplacer par un √©l√©ment moins dangereux",
                            "Augmenter la surveillance m√©dicale",
                            "Multiplier les √©quipements de protection"
                        ],
                        answer: 1,
                        explanation: "Exemples : remplacer un solvant canc√©rog√®ne par un produit moins toxique, utiliser une peinture √† l'eau plut√¥t qu'au solvant. R√©duction du danger √† la source.",
                        tip: "Substitution = m√™me fonction, moins de danger. Approche technique privil√©gi√©e."
                    },
                    {
                        keyword: "Formation s√©curit√©",
                        definition: "Transmission des connaissances et comp√©tences n√©cessaires √† la pr√©vention des risques",
                        type: "vf",
                        question: "La formation s√©curit√© peut remplacer les mesures techniques de pr√©vention.",
                        answer: false,
                        explanation: "La formation compl√®te les mesures techniques mais ne les remplace pas. Elle d√©veloppe les comportements s√ªrs mais reste d√©pendante du facteur humain.",
                        tip: "Formation = compl√©ment indispensable mais insuffisant seule. Technique + Humain."
                    },
                    {
                        keyword: "Maintenance pr√©ventive",
                        definition: "Actions planifi√©es pour maintenir les √©quipements en √©tat de s√©curit√©",
                        type: "keyword",
                        question: "Comment appelle-t-on les actions planifi√©es pour maintenir la s√©curit√© des √©quipements ?",
                        answer: "maintenance pr√©ventive",
                        hint: "Entretien programm√© des √©quipements",
                        explanation: "La maintenance pr√©ventive √©vite les pannes et dysfonctionnements source d'accidents. Contr√¥les, r√©visions, remplacements selon planning.",
                        tip: "Pr√©ventif > Curatif. Anticiper les d√©faillances plut√¥t que les subir."
                    },
                    {
                        keyword: "Consignation",
                        definition: "Proc√©dure de mise en s√©curit√© d'un √©quipement avant intervention",
                        type: "qcm",
                        question: "La consignation vise √† :",
                        options: [
                            "Acc√©l√©rer les interventions de maintenance",
                            "Mettre en s√©curit√© avant intervention sur √©quipement",
                            "Former les nouveaux salari√©s",
                            "Contr√¥ler les acc√®s aux locaux"
                        ],
                        answer: 1,
                        explanation: "La consignation supprime les √©nergies dangereuses (√©lectrique, pneumatique, m√©canique) et emp√™che la remise en marche intempestive par verrouillage/√©tiquetage.",
                        tip: "Consignation = LOTO (Lock-Out/Tag-Out). Couper, verrouiller, √©tiqueter."
                    }
                ]
            },
            5: {
                title: "Synth√®se experte",
                icon: "üèÜ", 
                cards: [
                    {
                        keyword: "Analyse multicrit√®re",
                        definition: "√âvaluation consid√©rant simultan√©ment plusieurs dimensions d'un probl√®me complexe",
                        type: "keyword",
                        question: "Comment appelle-t-on l'√©valuation consid√©rant plusieurs dimensions simultan√©ment ?",
                        answer: "analyse multicrit√®re",
                        hint: "Prise en compte de plusieurs aspects",
                        explanation: "L'analyse multicrit√®re int√®gre aspects techniques, √©conomiques, humains, organisationnels pour une d√©cision √©clair√©e. √âvite la vision unidimensionnelle.",
                        tip: "Multicrit√®re = vision 360¬∞. Technique + √âconomie + Humain + Organisation."
                    },
                    {
                        keyword: "D√©marche participative",
                        definition: "Approche associant les acteurs concern√©s √† l'analyse et aux d√©cisions de pr√©vention",
                        type: "qcm",
                        question: "La d√©marche participative am√©liore l'efficacit√© de la pr√©vention car :",
                        options: [
                            "Elle r√©duit les co√ªts de formation",
                            "Elle mobilise l'expertise terrain et favorise l'adh√©sion",
                            "Elle acc√©l√®re la prise de d√©cision",
                            "Elle √©vite les contr√¥les de l'inspection du travail"
                        ],
                        answer: 1,
                        explanation: "La participation des salari√©s apporte leur connaissance du travail r√©el, am√©liore l'acceptabilit√© des mesures et d√©veloppe une culture s√©curit√© partag√©e.",
                        tip: "Participation = expertise terrain + adh√©sion. Impliquer pour mieux r√©ussir."
                    },
                    {
                        keyword: "Retour sur investissement s√©curit√©",
                        definition: "Rapport entre les b√©n√©fices obtenus et les co√ªts engag√©s en pr√©vention",
                        type: "vf",
                        question: "Le retour sur investissement s√©curit√© ne peut jamais √™tre calcul√© pr√©cis√©ment.",
                        answer: false,
                        explanation: "Le ROI s√©curit√© se calcule : (Co√ªts √©vit√©s - Co√ªts investis) / Co√ªts investis. Les co√ªts √©vit√©s incluent accidents, arr√™ts, remplacements, image, productivit√©.",
                        tip: "ROI s√©curit√© = argument √©conomique puissant. Pr√©vention = investissement rentable."
                    },
                    {
                        keyword: "Culture s√©curit√©",
                        definition: "Ensemble des valeurs, attitudes et comportements partag√©s vis-√†-vis de la s√©curit√©",
                        type: "keyword",
                        question: "Comment appelle-t-on l'ensemble des valeurs partag√©es vis-√†-vis de la s√©curit√© ?",
                        answer: "culture s√©curit√©",
                        hint: "Valeurs et comportements collectifs",
                        explanation: "La culture s√©curit√© se construit par l'exemplarit√©, la communication, la reconnaissance, la formation continue. Elle transforme la contrainte en valeur partag√©e.",
                        tip: "Culture = changement durable. Long √† construire, efficace sur la dur√©e."
                    },
                    {
                        keyword: "Am√©lioration continue",
                        definition: "D√©marche d'optimisation progressive et permanente de la pr√©vention",
                        type: "qcm",
                        question: "L'am√©lioration continue en s√©curit√© s'appuie sur :",
                        options: [
                            "Des r√©volutions technologiques majeures",
                            "Le cycle PDCA : Planifier-D√©ployer-Contr√¥ler-Am√©liorer",
                            "La suppression imm√©diate de tous les risques",
                            "L'augmentation du budget s√©curit√© chaque ann√©e"
                        ],
                        answer: 1,
                        explanation: "Le PDCA (Plan-Do-Check-Act) ou roue de Deming structure l'am√©lioration continue : planifier les actions, les d√©ployer, mesurer les r√©sultats, ajuster.",
                        tip: "PDCA = m√©thode universelle d'am√©lioration. Cycle vertueux d'optimisation."
                    },
                    {
                        keyword: "Veille r√©glementaire",
                        definition: "Surveillance continue de l'√©volution des textes l√©gaux en sant√©-s√©curit√©",
                        type: "vf",
                        question: "La veille r√©glementaire est uniquement n√©cessaire lors de changements majeurs dans l'entreprise.",
                        answer: false,
                        explanation: "La r√©glementation √©volue constamment. La veille doit √™tre permanente pour identifier les nouvelles obligations, √©viter les sanctions et am√©liorer la pr√©vention.",
                        tip: "Veille = obligation permanente. Droit du travail en √©volution constante."
                    },
                    {
                        keyword: "Indicateurs avanc√©s",
                        definition: "Mesures pr√©dictives de la performance s√©curit√© permettant l'action pr√©ventive",
                        type: "keyword",
                        question: "Comment appelle-t-on les mesures pr√©dictives de la performance s√©curit√© ?",
                        answer: "indicateurs avanc√©s",
                        hint: "Mesures pr√©dictives, anticipatives",
                        explanation: "Contrairement aux indicateurs retard√©s (accidents survenus), les indicateurs avanc√©s mesurent l'activit√© de pr√©vention : formations, audits, actions correctives.",
                        tip: "Avanc√© = pr√©dictif / Retard√© = constat. Piloter l'activit√©, pas seulement les r√©sultats."
                    },
                    {
                        keyword: "Responsabilit√© soci√©tale",
                        definition: "Engagement volontaire de l'entreprise au-del√† de ses obligations l√©gales",
                        type: "qcm",
                        question: "La responsabilit√© soci√©tale en s√©curit√© se traduit par :",
                        options: [
                            "Le respect strict du minimum l√©gal",
                            "Un engagement d√©passant les obligations r√©glementaires",
                            "La d√©l√©gation de la s√©curit√© √† des sous-traitants",
                            "La souscription d'assurances compl√©mentaires"
                        ],
                        answer: 1,
                        explanation: "La RSE int√®gre la s√©curit√© dans la strat√©gie globale : exemplarit√©, innovation, transparence, engagement stakeholders. D√©passer le minimum l√©gal.",
                        tip: "RSE s√©curit√© = diff√©renciation positive. Excellence vs conformit√© minimale."
                    }
                ]
            }
        };
        
        function startLevel(level) {
            currentLevel = level;
            currentCardIndex = 0;
            levelCorrect = 0;
            levelPoints = 0;
            levelErrors = [];
            hintUsed = false;
            
            document.getElementById('homeScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');
            
            document.getElementById('currentLevelNum').textContent = level;
            document.getElementById('levelTitle').textContent = levels[level].title;
            document.getElementById('totalCardsNum').textContent = levels[level].cards.length;
            
            showCard();
        }
        
        function showCard() {
            const card = levels[currentLevel].cards[currentCardIndex];
            hintUsed = false;
            
            document.getElementById('currentCardNum').textContent = currentCardIndex + 1;
            document.getElementById('progressBar').style.width = ((currentCardIndex / levels[currentLevel].cards.length) * 100) + '%';
            
            document.getElementById('cardKeyword').textContent = card.keyword;
            document.getElementById('cardDefinition').textContent = card.definition;
            document.getElementById('hintText').style.display = 'none';
            
            let cardTypeText = '';
            if (card.type === 'keyword') cardTypeText = 'SAISIE LIBRE';
            else if (card.type === 'qcm') cardTypeText = 'QCM';
            else if (card.type === 'vf') cardTypeText = 'VRAI/FAUX';
            
            document.getElementById('cardType').textContent = cardTypeText;
            
            const questionSection = document.getElementById('questionSection');
            
            if (card.type === 'keyword') {
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <input type="text" class="answer-input" id="keywordAnswer" placeholder="Tapez votre r√©ponse...">
                `;
            }
            else if (card.type === 'qcm') {
                let optionsHTML = card.options.map((opt, i) => `
                    <button class="option-btn" data-index="${i}" onclick="selectOption(this)">
                        <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                        <span>${opt}</span>
                    </button>
                `).join('');
                
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="options-container">${optionsHTML}</div>
                `;
            }
            else if (card.type === 'vf') {
                questionSection.innerHTML = `
                    <p class="question-text">${card.question}</p>
                    <div class="vf-container">
                        <button class="vf-btn vrai" onclick="selectVF(this, true)">‚úì VRAI</button>
                        <button class="vf-btn faux" onclick="selectVF(this, false)">‚úó FAUX</button>
                    </div>
                `;
            }
        }
        
        function selectOption(btn) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }
        
        function selectVF(btn, value) {
            document.querySelectorAll('.vf-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            btn.dataset.value = value;
        }
        
        function showHint() {
            const card = levels[currentLevel].cards[currentCardIndex];
            if (card.hint) {
                document.getElementById('hintText').innerHTML = `üí° <strong>Indice :</strong> ${card.hint}`;
                document.getElementById('hintText').style.display = 'block';
                hintUsed = true;
            }
        }
        
        function validateAnswer() {
            const card = levels[currentLevel].cards[currentCardIndex];
            let isCorrect = false;
            let userAnswer = '';
            
            if (card.type === 'keyword') {
                userAnswer = document.getElementById('keywordAnswer').value.trim().toLowerCase();
                // Normaliser (accents, etc.)
                const normalize = str => str.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
                isCorrect = normalize(userAnswer) === normalize(card.answer) || 
                            userAnswer.includes(normalize(card.answer)) ||
                            normalize(card.answer).includes(userAnswer);
            }
            else if (card.type === 'qcm') {
                const selected = document.querySelector('.option-btn.selected');
                if (!selected) { alert('S√©lectionne une r√©ponse'); return; }
                userAnswer = parseInt(selected.dataset.index);
                isCorrect = userAnswer === card.answer;
            }
            else if (card.type === 'vf') {
                const selected = document.querySelector('.vf-btn.selected');
                if (!selected) { alert('S√©lectionne VRAI ou FAUX'); return; }
                userAnswer = selected.dataset.value === 'true';
                isCorrect = userAnswer === card.answer;
            }
            
            showFeedback(isCorrect, card);
        }
        
        function showFeedback(isCorrect, card) {
            const overlay = document.getElementById('feedbackOverlay');
            const feedbackCard = document.getElementById('feedbackCard');
            
            let points = 0;
            if (isCorrect) {
                points = hintUsed ? 5 : 10;
                levelCorrect++;
                currentStreak++;
                if (currentStreak > bestStreak) bestStreak = currentStreak;
                
                // Streak bonus
                if (currentStreak === 3) showStreakPopup('üî• 3 de suite !');
                else if (currentStreak === 5) showStreakPopup('üî•üî• 5 de suite !');
                else if (currentStreak === 10) showStreakPopup('üî•üî•üî• INCROYABLE !');
            } else {
                currentStreak = 0;
                levelErrors.push(card.keyword || card.question.replace(/<[^>]*>/g, '').substring(0, 50) + '...');
            }
            
            levelPoints += points;
            totalPoints += points;
            updateScoreDisplay();
            
            feedbackCard.className = 'feedback-card ' + (isCorrect ? 'correct' : 'incorrect');
            document.getElementById('feedbackIcon').textContent = isCorrect ? '‚úÖ' : '‚ùå';
            document.getElementById('feedbackTitle').textContent = isCorrect ? 
                (currentStreak >= 3 ? 'Excellent ! üî•' : 'Bravo !') : 'Pas tout √† fait...';
            document.getElementById('feedbackPoints').textContent = isCorrect ? `+${points} points` : '0 point';
            document.getElementById('feedbackPoints').style.display = isCorrect ? 'block' : 'none';
            
            document.getElementById('feedbackExplanation').innerHTML = `
                <h4>üìö Explication</h4>
                <p>${card.explanation}</p>
                <div class="keyword-box">üîë <span>${card.keyword}</span></div>
                ${card.tip ? `<div class="tip-box"><h5>üí° Astuce BAC</h5><p>${card.tip}</p></div>` : ''}
            `;
            
            overlay.classList.add('visible');
        }
        
        function showStreakPopup(text) {
            const popup = document.getElementById('streakPopup');
            popup.textContent = text;
            popup.style.display = 'block';
            setTimeout(() => { popup.style.display = 'none'; }, 1500);
        }
        
        function nextCard() {
            document.getElementById('feedbackOverlay').classList.remove('visible');
            currentCardIndex++;
            
            if (currentCardIndex >= levels[currentLevel].cards.length) {
                showResults();
            } else {
                showCard();
            }
        }
        
        function showResults() {
            const total = levels[currentLevel].cards.length;
            const percent = Math.round((levelCorrect / total) * 100);
            
            levelProgress[currentLevel] = Math.max(levelProgress[currentLevel], percent);
            
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');
            
            document.getElementById('resultsIcon').textContent = percent >= 80 ? 'üéâ' : percent >= 50 ? 'üëç' : 'üí™';
            document.getElementById('resultsTitle').textContent = percent >= 80 ? 'Niveau r√©ussi !' : percent >= 50 ? 'Pas mal !' : 'Continue !';
            document.getElementById('resultsScore').textContent = percent + '%';
            document.getElementById('correctCount').textContent = levelCorrect + '/' + total;
            document.getElementById('pointsEarned').textContent = '+' + levelPoints;
            document.getElementById('bestStreak').textContent = bestStreak;
            
            // Erreurs
            const errorsRecap = document.getElementById('errorsRecap');
            if (levelErrors.length > 0) {
                errorsRecap.style.display = 'block';
                document.getElementById('errorsList').innerHTML = levelErrors.map(e => `<li>${e}</li>`).join('');
            } else {
                errorsRecap.style.display = 'none';
            }
            
            // Confettis si r√©ussi
            if (percent >= 80) {
                createConfetti();
            }
            
            // Bouton niveau suivant
            document.getElementById('nextLevelBtn').style.display = (currentLevel < 5 && percent >= 60) ? 'flex' : 'none';
            
            updateHomeProgress();
        }
        
        function createConfetti() {
            const colors = ['#ff9a9e', '#fecfef', '#ffd1ff', '#84fab0', '#8fd3f4', '#FFD700'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }
        
        function goHome() {
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('homeScreen').classList.add('active');
            updateHomeProgress();
        }
        
        function nextLevel() {
            if (currentLevel < 5) {
                startLevel(currentLevel + 1);
                document.getElementById('resultsScreen').classList.remove('active');
            }
        }
        
        function updateScoreDisplay() {
            document.getElementById('totalPoints').textContent = totalPoints;
            document.getElementById('currentStreak').textContent = currentStreak;
        }
        
        function updateHomeProgress() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`level${i}Percent`).textContent = levelProgress[i] + '%';
                document.getElementById(`level${i}Bar`).style.width = levelProgress[i] + '%';
            }
        }
        
        // Init
        updateScoreDisplay();
        updateHomeProgress();
    </script>
</body>
</html>