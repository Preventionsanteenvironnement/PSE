<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module B.3 - Diagnostic Expert Risques Auditifs - Premi√®re Bac Pro</title>
    <style>
        :root {
            --primary-pse: #2E86AB;
            --secondary-pse: #A23B72;
            --success-pse: #219653;
            --warning-pse: #F2994A;
            --danger-pse: #EB5757;
            --dark-pse: #2F3542;
            --light-pse: #F1F2F6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', 'OpenDyslexie', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--dark-pse);
            line-height: 1.6;
        }

        .exercice-container {
            width: 100%;
            max-width: 100vw;
            padding: 15px;
            font-size: 16px;
        }

        @media (min-width: 768px) {
            .exercice-container {
                padding: 20px;
                font-size: 17px;
            }
        }

        @media (min-width: 1024px) {
            .exercice-container {
                max-width: 900px;
                margin: 0 auto;
                padding: 30px;
                font-size: 18px;
            }
        }

        .cadre-pedagogique {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border-left: 6px solid var(--primary-pse);
        }

        .module-info h2 {
            color: var(--primary-pse);
            font-size: 1.5em;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .objectif {
            background: var(--light-pse);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .competences-travaillees h3 {
            color: var(--secondary-pse);
            margin: 20px 0 15px 0;
            font-size: 1.2em;
        }

        .competences-list {
            list-style: none;
            padding: 0;
        }

        .competences-list li {
            background: linear-gradient(90deg, #e3f2fd, #f3e5f5);
            margin: 8px 0;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid var(--primary-pse);
        }

        .niveau-cible {
            background: var(--warning-pse);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            font-weight: 600;
            margin-top: 15px;
        }

        .exercice-principal {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
        }

        .scenario-intro {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .scenario-intro::before {
            content: 'üîä';
            font-size: 3em;
            position: absolute;
            top: 10px;
            right: 20px;
            opacity: 0.3;
        }

        .activite-section {
            margin: 30px 0;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid var(--primary-pse);
        }

        .activite-title {
            color: var(--primary-pse);
            font-size: 1.3em;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .situation-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid var(--secondary-pse);
        }

        .niveaux-sonores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .niveau-item {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .niveau-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .niveau-item.selected {
            border: 3px solid var(--warning-pse);
            background: #FFA726;
            color: white;
            transform: scale(1.05);
        }

        .niveau-item.correct {
            border: 3px solid var(--success-pse);
            background: var(--success-pse);
            color: white;
        }

        .niveau-item.incorrect {
            border: 2px solid var(--danger-pse);
            background: #ffebee;
            color: var(--danger-pse);
        }

        .zone-depot {
            background: #e8f5e8;
            border: 2px dashed var(--success-pse);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .zone-depot:hover {
            background: #d4f4d4;
            border-color: #1976d2;
        }

        .zone-depot.active {
            background: var(--warning-pse);
            color: white;
            border-color: var(--warning-pse);
        }

        .instructions-interaction {
            background: #fff3e0;
            border-left: 4px solid var(--warning-pse);
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .instructions-interaction h5 {
            color: var(--warning-pse);
            margin-bottom: 10px;
        }

        .correction-explicite {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            display: none;
        }

        .correction-explicite.show {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .correction-explicite h4 {
            color: #ff6b6b;
            margin-bottom: 15px;
        }

        .bonne-reponse {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .explication-detaillee {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .btn-principal {
            background: linear-gradient(135deg, var(--primary-pse), var(--secondary-pse));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-principal:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .btn-principal:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .score-display {
            background: linear-gradient(135deg, #4caf50, #2196f3);
            color: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            margin: 20px 0;
            font-weight: 600;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 8px;
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, var(--success-pse), #4caf50);
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        .rgpd-notice {
            background: #2c3e50;
            color: white;
            padding: 15px;
            text-align: center;
            margin-top: 40px;
            border-radius: 10px;
            font-size: 0.9em;
        }

        .element-clickable {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .element-clickable:hover {
            transform: scale(1.02);
        }

        .element-clickable.selected {
            border: 3px solid var(--warning-pse);
            background: #FFA726;
            transform: scale(1.1);
        }

        .element-clickable.used {
            opacity: 0.6;
            cursor: default;
        }

        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }

        .feedback-card {
            background: linear-gradient(135deg, #2a2a3e, #1e1e2f);
            color: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 90%;
            max-height: 80%;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .close-feedback {
            float: right;
            background: none;
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            padding: 5px 10px;
        }

        .astuce-bac {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #e65100;
        }

        .astuce-bac::before {
            content: 'üí° ASTUCE BAC : ';
            font-weight: bold;
        }

        /* Styles pour les graphiques de d√©cibels */
        .decibel-chart {
            display: flex;
            align-items: end;
            height: 200px;
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .decibel-bar {
            background: linear-gradient(to top, #ff5722, #ff9800);
            margin: 0 5px;
            border-radius: 4px 4px 0 0;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 40px;
            display: flex;
            flex-direction: column;
            justify-content: end;
        }

        .decibel-bar:hover {
            transform: scaleY(1.05);
            filter: brightness(1.1);
        }

        .decibel-label {
            writing-mode: vertical-rl;
            text-orientation: mixed;
            font-size: 0.8em;
            padding: 5px;
            color: white;
            font-weight: 600;
            text-align: center;
        }

        .decibel-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            white-space: nowrap;
            display: none;
        }

        .decibel-bar:hover .decibel-value {
            display: block;
        }
    </style>
</head>
<body>
    <div class="exercice-container">
        <!-- EN-T√äTE P√âDAGOGIQUE OBLIGATOIRE -->
        <div class="cadre-pedagogique">
            <div class="module-info">
                <h2>Module B.3 : Le bruit au quotidien</h2>
                <div class="objectif">
                    <strong>Objectif :</strong> Mesurer l'incidence du bruit sur la sant√© et la vie sociale pour agir en citoyen responsable
                </div>
            </div>
            
            <div class="competences-travaillees">
                <h3>Comp√©tences travaill√©es dans cet exercice :</h3>
                <ul class="competences-list">
                    <li><strong>C1</strong> - Traiter une information</li>
                    <li><strong>C2</strong> - Appliquer une d√©marche d'analyse dans une situation donn√©e</li>
                    <li><strong>C3</strong> - Expliquer un ph√©nom√®ne physiologique en lien avec une mesure de pr√©vention</li>
                    <li><strong>C4</strong> - Proposer une solution pour r√©soudre un probl√®me</li>
                </ul>
            </div>
            
            <div class="niveau-cible">
                <strong>Niveau :</strong> Bac Pro Premi√®re
            </div>
        </div>

        <!-- EXERCICE PRINCIPAL -->
        <main class="exercice-principal">
            <div class="scenario-intro">
                <h2>üîä DIAGNOSTIC EXPERT : Analyser les risques auditifs en milieu professionnel</h2>
                <p><strong>Vous √™tes consultant(e) en pr√©vention des risques professionnels.</strong><br>
                Votre mission : analyser diff√©rentes situations de travail et √©valuer les risques auditifs pour proposer des mesures de protection adapt√©es.</p>
            </div>

            <div class="instructions-interaction">
                <h5>üì± COMMENT MANIPULER :</h5>
                <p><strong>1.</strong> Cliquez sur un √©l√©ment pour le s√©lectionner (il s'illumine)<br>
                <strong>2.</strong> Cliquez sur la zone de destination appropri√©e<br>
                <strong>3.</strong> L'√©l√©ment se place automatiquement !</p>
            </div>

            <!-- ACTIVIT√â 1 : Classification des niveaux sonores -->
            <div class="activite-section">
                <h3 class="activite-title">üéØ ACTIVIT√â 1 : Classifier les niveaux sonores par dangerosit√©</h3>
                
                <div class="situation-card">
                    <strong>Contexte :</strong> Voici diff√©rents niveaux sonores rencontr√©s en milieu professionnel. Classez-les selon leur dangerosit√© pour l'audition.
                </div>

                <div class="decibel-chart" id="decibelChart">
                    <!-- Les barres seront g√©n√©r√©es dynamiquement -->
                </div>

                <div class="niveaux-sonores" id="niveauxSonores">
                    <div class="niveau-item element-clickable" data-value="45" data-type="aucun">
                        <strong>45 dB(A)</strong><br>
                        Bureau calme
                    </div>
                    <div class="niveau-item element-clickable" data-value="70" data-type="fatigue">
                        <strong>70 dB(A)</strong><br>
                        Restaurant
                    </div>
                    <div class="niveau-item element-clickable" data-value="85" data-type="danger">
                        <strong>85 dB(A)</strong><br>
                        Atelier m√©canique
                    </div>
                    <div class="niveau-item element-clickable" data-value="100" data-type="danger">
                        <strong>100 dB(A)</strong><br>
                        Discoth√®que
                    </div>
                    <div class="niveau-item element-clickable" data-value="120" data-type="douleur">
                        <strong>120 dB(A)</strong><br>
                        Marteau-piqueur
                    </div>
                    <div class="niveau-item element-clickable" data-value="140" data-type="douleur">
                        <strong>140 dB(A)</strong><br>
                        D√©collage d'avion
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 30px;">
                    <div class="zone-depot" data-category="aucun" onclick="placerDansZone(this, 'aucun')">
                        <div style="text-align: center;">
                            <strong>üü¢ AUCUN RISQUE</strong><br>
                            <small>< 70 dB(A)</small>
                        </div>
                    </div>
                    <div class="zone-depot" data-category="fatigue" onclick="placerDansZone(this, 'fatigue')">
                        <div style="text-align: center;">
                            <strong>üü° SEUIL DE FATIGUE</strong><br>
                            <small>70-85 dB(A)</small>
                        </div>
                    </div>
                    <div class="zone-depot" data-category="danger" onclick="placerDansZone(this, 'danger')">
                        <div style="text-align: center;">
                            <strong>üü† SEUIL DE DANGER</strong><br>
                            <small>‚â• 85 dB(A)</small>
                        </div>
                    </div>
                    <div class="zone-depot" data-category="douleur" onclick="placerDansZone(this, 'douleur')">
                        <div style="text-align: center;">
                            <strong>üî¥ SEUIL DE DOULEUR</strong><br>
                            <small>‚â• 120 dB(A)</small>
                        </div>
                    </div>
                </div>

                <button class="btn-principal" onclick="verifierActivite1()" id="verifierBtn1" style="margin-top: 20px;">
                    V√©rifier mes r√©ponses
                </button>

                <div class="correction-explicite" id="correction1">
                    <button class="close-feedback" onclick="fermerCorrection('correction1')">√ó</button>
                    <h4>‚ùå CORRECTION D√âTAILL√âE</h4>
                    <div class="bonne-reponse">
                        <strong>‚úÖ CLASSIFICATION CORRECTE :</strong><br>
                        ‚Ä¢ <strong>AUCUN RISQUE (< 70 dB)</strong> : Bureau calme (45 dB)<br>
                        ‚Ä¢ <strong>SEUIL DE FATIGUE (70-85 dB)</strong> : Restaurant (70 dB)<br>
                        ‚Ä¢ <strong>SEUIL DE DANGER (‚â• 85 dB)</strong> : Atelier m√©canique (85 dB), Discoth√®que (100 dB)<br>
                        ‚Ä¢ <strong>SEUIL DE DOULEUR (‚â• 120 dB)</strong> : Marteau-piqueur (120 dB), D√©collage d'avion (140 dB)
                    </div>
                    <div class="astuce-bac">
                        Le seuil de 85 dB(A) est la limite l√©gale en milieu professionnel pour 8h d'exposition. Au-del√†, des protections auditives deviennent obligatoires !
                    </div>
                    <div class="explication-detaillee">
                        <strong>üí° POURQUOI CETTE CLASSIFICATION ?</strong><br>
                        L'√©chelle des d√©cibels est logarithmique : +3 dB = doublement du niveau sonore, +10 dB = multiplication par 10. 
                        Les seuils sont bas√©s sur des √©tudes √©pid√©miologiques montrant les risques de surdit√© professionnelle.
                    </div>
                </div>
            </div>

            <!-- ACTIVIT√â 2 : Analyse des dur√©es d'exposition -->
            <div class="activite-section">
                <h3 class="activite-title">‚è±Ô∏è ACTIVIT√â 2 : Calculer les dur√©es d'exposition maximales</h3>
                
                <div class="situation-card">
                    <strong>Probl√®me :</strong> Un ouvrier travaille dans un atelier o√π le niveau sonore varie. 
                    D√©terminez la dur√©e d'exposition maximale autoris√©e pour chaque poste de travail selon la r√©glementation INRS.
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 25px 0;">
                    <div class="niveau-item element-clickable" data-duree="8h" data-niveau="80">
                        <strong>80 dB(A)</strong><br>
                        <small>Niveau de base</small>
                    </div>
                    <div class="niveau-item element-clickable" data-duree="4h" data-niveau="83">
                        <strong>83 dB(A)</strong><br>
                        <small>Poste soudure</small>
                    </div>
                    <div class="niveau-item element-clickable" data-duree="2h" data-niveau="86">
                        <strong>86 dB(A)</strong><br>
                        <small>Zone presse</small>
                    </div>
                    <div class="niveau-item element-clickable" data-duree="1h" data-niveau="89">
                        <strong>89 dB(A)</strong><br>
                        <small>Poste de d√©coupe</small>
                    </div>
                    <div class="niveau-item element-clickable" data-duree="30min" data-niveau="92">
                        <strong>92 dB(A)</strong><br>
                        <small>Zone de pon√ßage</small>
                    </div>
                </div>

                <div class="zone-depot" id="calculDuree" onclick="calculerDuree()" style="background: #e3f2fd; border-color: #2196f3;">
                    <strong>üìä CLIQUEZ ICI POUR AFFICHER LE TABLEAU R√âGLEMENTAIRE</strong>
                </div>

                <div id="tableauReglementaire" style="display: none; margin: 20px 0;">
                    <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                        <thead style="background: var(--primary-pse); color: white;">
                            <tr>
                                <th style="padding: 15px; text-align: left;">Niveau sonore</th>
                                <th style="padding: 15px; text-align: left;">Dur√©e maximale d'exposition</th>
                                <th style="padding: 15px; text-align: left;">Votre r√©ponse</th>
                            </tr>
                        </thead>
                        <tbody id="tableauCorps">
                            <!-- Sera rempli dynamiquement -->
                        </tbody>
                    </table>
                </div>

                <button class="btn-principal" onclick="verifierActivite2()" id="verifierBtn2" style="margin-top: 20px;" disabled>
                    V√©rifier le calcul des dur√©es
                </button>
            </div>

            <!-- ACTIVIT√â 3 : Diagnostic des cons√©quences -->
            <div class="activite-section">
                <h3 class="activite-title">ü©∫ ACTIVIT√â 3 : Diagnostiquer les cons√©quences du bruit</h3>
                
                <div class="situation-card">
                    <strong>Cas clinique :</strong> Plusieurs employ√©s pr√©sentent des troubles. 
                    Identifiez si ces sympt√¥mes sont des effets auditifs ou extra-auditifs du bruit.
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 25px 0;">
                    <div class="niveau-item element-clickable" data-type="auditif" data-symptome="acouphenes">
                        <strong>Acouph√®nes</strong><br>
                        <small>Sifflements d'oreille persistants</small>
                    </div>
                    <div class="niveau-item element-clickable" data-type="extra-auditif" data-symptome="tension">
                        <strong>Hypertension</strong><br>
                        <small>√âl√©vation de la tension art√©rielle</small>
                    </div>
                    <div class="niveau-item element-clickable" data-type="auditif" data-symptome="surdite">
                        <strong>Surdit√©</strong><br>
                        <small>Perte auditive progressive</small>
                    </div>
                    <div class="niveau-item element-clickable" data-type="extra-auditif" data-symptome="sommeil">
                        <strong>Troubles du sommeil</strong><br>
                        <small>Insomnie et fatigue</small>
                    </div>
                    <div class="niveau-item element-clickable" data-type="extra-auditif" data-symptome="digestif">
                        <strong>Troubles digestifs</strong><br>
                        <small>Crampes et spasmes</small>
                    </div>
                    <div class="niveau-item element-clickable" data-type="auditif" data-symptome="fatigue">
                        <strong>Fatigue auditive</strong><br>
                        <small>Sensation d'oreille "bouch√©e"</small>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px;">
                    <div class="zone-depot" data-category="auditif" onclick="placerSymptome(this, 'auditif')">
                        <div style="text-align: center;">
                            <strong>üëÇ EFFETS AUDITIFS</strong><br>
                            <small>Touchent directement l'oreille</small>
                        </div>
                    </div>
                    <div class="zone-depot" data-category="extra-auditif" onclick="placerSymptome(this, 'extra-auditif')">
                        <div style="text-align: center;">
                            <strong>ü´Ä EFFETS EXTRA-AUDITIFS</strong><br>
                            <small>Touchent d'autres organes</small>
                        </div>
                    </div>
                </div>

                <button class="btn-principal" onclick="verifierActivite3()" id="verifierBtn3" style="margin-top: 20px;">
                    Diagnostiquer les sympt√¥mes
                </button>
            </div>

            <!-- ACTIVIT√â 4 : Mesures de pr√©vention -->
            <div class="activite-section">
                <h3 class="activite-title">üõ°Ô∏è ACTIVIT√â 4 : Proposer des mesures de pr√©vention</h3>
                
                <div class="situation-card">
                    <strong>Mission finale :</strong> Pour chaque situation professionnelle, proposez les mesures de pr√©vention les plus adapt√©es (individuelles et collectives).
                </div>

                <div id="scenariosPrevention">
                    <!-- Sera g√©n√©r√© dynamiquement -->
                </div>

                <button class="btn-principal" onclick="genererScenarios()" style="margin: 20px 0;">
                    G√©n√©rer les sc√©narios de pr√©vention
                </button>
            </div>

            <!-- Score global -->
            <div class="score-display" id="scoreGlobal" style="display: none;">
                <h3>üéØ BILAN DE VOTRE EXPERTISE</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <p id="messageScore"></p>
            </div>
        </main>

        <!-- Footer RGPD √©pur√© -->
        <div class="rgpd-notice">
            üîí <strong>Conformit√© RGPD :</strong> Cet exercice respecte votre anonymat.
        </div>
    </div>

    <!-- Overlay de feedback -->
    <div class="feedback-overlay" id="feedbackOverlay">
        <div class="feedback-card" id="feedbackCard">
            <!-- Contenu dynamique -->
        </div>
    </div>

    <script>
        // Variables globales
        let elementSelectionne = null;
        let scores = { activite1: 0, activite2: 0, activite3: 0, activite4: 0 };
        let activitesTerminees = { activite1: false, activite2: false, activite3: false, activite4: false };

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            genererGraphiqueDecibels();
            setupInteractions();
        });

        // G√©n√©ration du graphique des d√©cibels
        function genererGraphiqueDecibels() {
            const chart = document.getElementById('decibelChart');
            const donnees = [
                {label: 'Silence', value: 0, color: '#4caf50'},
                {label: 'Chuchotement', value: 30, color: '#8bc34a'},
                {label: 'Bureau', value: 45, color: '#cddc39'},
                {label: 'Conversation', value: 60, color: '#ffeb3b'},
                {label: 'Restaurant', value: 70, color: '#ffc107'},
                {label: 'Circulation', value: 80, color: '#ff9800'},
                {label: 'Atelier', value: 85, color: '#ff5722'},
                {label: 'Discoth√®que', value: 100, color: '#e91e63'},
                {label: 'Marteau-piqueur', value: 120, color: '#9c27b0'},
                {label: 'Avion', value: 140, color: '#673ab7'}
            ];

            chart.innerHTML = donnees.map(item => `
                <div class="decibel-bar" style="height: ${(item.value / 140) * 100}%; background: linear-gradient(to top, ${item.color}, ${item.color}88);">
                    <div class="decibel-label">${item.label}</div>
                    <div class="decibel-value">${item.value} dB</div>
                </div>
            `).join('');
        }

        // Configuration des interactions clic-s√©lection
        function setupInteractions() {
            document.querySelectorAll('.element-clickable').forEach(element => {
                element.addEventListener('click', function() {
                    selectionnerElement(this);
                });
            });
        }

        function selectionnerElement(element) {
            // Retirer la s√©lection pr√©c√©dente
            if (elementSelectionne) {
                elementSelectionne.classList.remove('selected');
            }
            
            // S√©lectionner le nouvel √©l√©ment
            elementSelectionne = element;
            element.classList.add('selected');
            
            // Effet visuel et sonore
            element.style.transform = 'scale(1.1)';
            setTimeout(() => {
                if (!element.classList.contains('used')) {
                    element.style.transform = '';
                }
            }, 200);
        }

        function placerDansZone(zone, categorie) {
            if (!elementSelectionne || elementSelectionne.classList.contains('used')) {
                zone.style.animation = 'shake 0.5s ease-in-out';
                setTimeout(() => zone.style.animation = '', 500);
                return;
            }

            // V√©rification de la cat√©gorie
            const typeElement = elementSelectionne.dataset.type;
            
            // Placer l'√©l√©ment dans la zone
            elementSelectionne.classList.add('used');
            elementSelectionne.classList.remove('selected');
            
            // Effet visuel de succ√®s
            zone.style.background = '#c8e6c9';
            zone.innerHTML += `<div style="margin: 5px; padding: 8px; background: white; border-radius: 6px; font-size: 0.9em;">${elementSelectionne.innerHTML}</div>`;
            
            elementSelectionne.style.opacity = '0.3';
            elementSelectionne = null;
        }

        // V√©rification Activit√© 1
        function verifierActivite1() {
            const corrections = {
                'aucun': ['45'],
                'fatigue': ['70'],
                'danger': ['85', '100'],
                'douleur': ['120', '140']
            };

            let score = 0;
            let total = 6;

            // Marquer visuellement toutes les r√©ponses
            document.querySelectorAll('.niveau-item').forEach(item => {
                const value = item.dataset.value;
                const type = item.dataset.type;
                
                let correct = false;
                Object.entries(corrections).forEach(([category, values]) => {
                    if (values.includes(value) && type === category) {
                        correct = true;
                        score++;
                    }
                });

                if (correct) {
                    item.classList.add('correct');
                    item.innerHTML += ' ‚úÖ';
                } else {
                    item.classList.add('incorrect');
                    item.innerHTML += ' ‚ùå';
                }
            });

            scores.activite1 = (score / total) * 100;
            activitesTerminees.activite1 = true;

            // Afficher la correction
            document.getElementById('correction1').classList.add('show');
            document.getElementById('verifierBtn1').disabled = true;

            mettreAJourScore();
        }

        // Calcul des dur√©es d'exposition
        function calculerDuree() {
            const tableau = document.getElementById('tableauReglementaire');
            const corps = document.getElementById('tableauCorps');
            
            tableau.style.display = 'block';
            
            const donnees = [
                {niveau: '80 dB(A)', duree: '8h', element: document.querySelector('[data-niveau="80"]')},
                {niveau: '83 dB(A)', duree: '4h', element: document.querySelector('[data-niveau="83"]')},
                {niveau: '86 dB(A)', duree: '2h', element: document.querySelector('[data-niveau="86"]')},
                {niveau: '89 dB(A)', duree: '1h', element: document.querySelector('[data-niveau="89"]')},
                {niveau: '92 dB(A)', duree: '30min', element: document.querySelector('[data-niveau="92"]')}
            ];

            corps.innerHTML = donnees.map((item, index) => `
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px; font-weight: 600;">${item.niveau}</td>
                    <td style="padding: 12px;">${item.duree}</td>
                    <td style="padding: 12px;">
                        <select id="duree${index}" onchange="verifierDuree(${index})">
                            <option value="">Choisir...</option>
                            <option value="8h">8 heures</option>
                            <option value="4h">4 heures</option>
                            <option value="2h">2 heures</option>
                            <option value="1h">1 heure</option>
                            <option value="30min">30 minutes</option>
                        </select>
                    </td>
                </tr>
            `).join('');

            document.getElementById('verifierBtn2').disabled = false;
        }

        function verifierDuree(index) {
            const select = document.getElementById(`duree${index}`);
            const donnees = ['8h', '4h', '2h', '1h', '30min'];
            
            if (select.value === donnees[index]) {
                select.style.background = '#c8e6c9';
                select.parentNode.innerHTML += ' ‚úÖ';
            } else {
                select.style.background = '#ffcdd2';
                select.parentNode.innerHTML += ' ‚ùå';
            }
        }

        function verifierActivite2() {
            let correct = 0;
            const selects = document.querySelectorAll('[id^="duree"]');
            const bonnesReponses = ['8h', '4h', '2h', '1h', '30min'];
            
            selects.forEach((select, index) => {
                if (select.value === bonnesReponses[index]) {
                    correct++;
                }
            });

            scores.activite2 = (correct / 5) * 100;
            activitesTerminees.activite2 = true;

            afficherFeedback('Calcul des dur√©es', `Vous avez identifi√© ${correct}/5 dur√©es correctes. La r√®gle INRS : chaque +3dB divise par 2 la dur√©e d'exposition !`);
            
            document.getElementById('verifierBtn2').disabled = true;
            mettreAJourScore();
        }

        // Placement des sympt√¥mes
        function placerSymptome(zone, type) {
            if (!elementSelectionne || elementSelectionne.classList.contains('used')) return;

            const typeSymptome = elementSelectionne.dataset.type;
            elementSelectionne.classList.add('used');
            elementSelectionne.classList.remove('selected');
            
            zone.innerHTML += `<div style="margin: 5px; padding: 8px; background: ${typeSymptome === type ? '#c8e6c9' : '#ffcdd2'}; border-radius: 6px; font-size: 0.9em;">${elementSelectionne.innerHTML} ${typeSymptome === type ? '‚úÖ' : '‚ùå'}</div>`;
            
            elementSelectionne.style.opacity = '0.3';
            elementSelectionne = null;
        }

        function verifierActivite3() {
            let correct = 0;
            document.querySelectorAll('[data-symptome]').forEach(item => {
                const type = item.dataset.type;
                const zone = document.querySelector(`[data-category="${type}"]`);
                if (zone.innerHTML.includes(item.innerHTML) && item.classList.contains('used')) {
                    correct++;
                }
            });

            scores.activite3 = (correct / 6) * 100;
            activitesTerminees.activite3 = true;

            afficherFeedback('Diagnostic des sympt√¥mes', 
                `Score : ${correct}/6. Les effets extra-auditifs du bruit sont souvent m√©connus mais tr√®s nombreux : cardiovasculaires, digestifs, psychologiques...`);
            
            document.getElementById('verifierBtn3').disabled = true;
            mettreAJourScore();
        }

        // G√©n√©ration des sc√©narios de pr√©vention
        function genererScenarios() {
            const scenarios = [
                {
                    titre: 'Atelier de menuiserie',
                    niveau: '95 dB(A)',
                    probleme: 'Exposition prolong√©e aux scies et raboteuses',
                    preventions: {
                        individuelles: ['Bouchons d\'oreille', 'Casques antibruit', 'Formation du personnel'],
                        collectives: ['Capotage des machines', 'Isolation phonique', 'Planification des horaires']
                    }
                },
                {
                    titre: 'Bureau en open-space',
                    niveau: '72 dB(A)',
                    probleme: 'Fatigue auditive et stress chronique',
                    preventions: {
                        individuelles: ['Pauses r√©guli√®res', 'Espaces de repos'],
                        collectives: ['Cloisons acoustiques', 'Rev√™tements absorbants', 'R√©glementation du bruit']
                    }
                }
            ];

            const container = document.getElementById('scenariosPrevention');
            container.innerHTML = scenarios.map((scenario, index) => `
                <div class="situation-card" style="margin: 20px 0;">
                    <h4>${scenario.titre} - ${scenario.niveau}</h4>
                    <p><strong>Probl√®me :</strong> ${scenario.probleme}</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                        <div>
                            <strong>üõ°Ô∏è Mesures individuelles :</strong>
                            <div id="prev-ind-${index}" class="zone-depot" style="min-height: 100px; margin-top: 10px;">
                                Cliquez pour proposer des solutions
                            </div>
                        </div>
                        <div>
                            <strong>üè≠ Mesures collectives :</strong>
                            <div id="prev-col-${index}" class="zone-depot" style="min-height: 100px; margin-top: 10px;">
                                Cliquez pour proposer des solutions
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn-principal" onclick="revelerSolutions(${index})" style="margin-top: 15px;">
                        R√©v√©ler les solutions expertes
                    </button>
                </div>
            `).join('');
        }

        function revelerSolutions(index) {
            const scenarios = [
                {
                    individuelles: ['Bouchons d\'oreille moul√©s', 'Casques antibruit', 'Formation s√©curit√©', 'Contr√¥le audiom√©trique'],
                    collectives: ['Capotage des machines', 'Isolation phonique', 'Maintenance pr√©ventive', 'Planification des horaires']
                },
                {
                    individuelles: ['Pauses r√©guli√®res au calme', 'Espaces de d√©tente', 'Sensibilisation au stress'],
                    collectives: ['Cloisons acoustiques', 'Rev√™tements absorbants', 'R√©glementation du bruit', 'Espaces phoniques']
                }
            ];

            const scenario = scenarios[index];
            document.getElementById(`prev-ind-${index}`).innerHTML = scenario.individuelles.map(item => 
                `<div style="background: #e8f5e8; margin: 5px; padding: 8px; border-radius: 6px;">‚úÖ ${item}</div>`
            ).join('');
            
            document.getElementById(`prev-col-${index}`).innerHTML = scenario.collectives.map(item => 
                `<div style="background: #e3f2fd; margin: 5px; padding: 8px; border-radius: 6px;">‚úÖ ${item}</div>`
            ).join('');

            scores.activite4 = 100;
            activitesTerminees.activite4 = true;
            mettreAJourScore();
        }

        // Affichage des feedbacks
        function afficherFeedback(titre, message) {
            const overlay = document.getElementById('feedbackOverlay');
            const card = document.getElementById('feedbackCard');
            
            card.innerHTML = `
                <button class="close-feedback" onclick="fermerFeedback()">√ó</button>
                <h3>üéØ ${titre}</h3>
                <p style="margin: 15px 0; line-height: 1.6;">${message}</p>
                <div class="astuce-bac">En situation d'examen, pensez toujours aux 3 niveaux de pr√©vention : primaire (√©viter), secondaire (d√©tecter), tertiaire (traiter) !</div>
            `;
            
            overlay.style.display = 'flex';
        }

        function fermerFeedback() {
            document.getElementById('feedbackOverlay').style.display = 'none';
        }

        function fermerCorrection(id) {
            document.getElementById(id).classList.remove('show');
        }

        // Mise √† jour du score global
        function mettreAJourScore() {
            const scoresMoyens = Object.values(scores);
            const moyenne = scoresMoyens.reduce((a, b) => a + b, 0) / scoresMoyens.length;
            
            const scoreDisplay = document.getElementById('scoreGlobal');
            const progressFill = document.getElementById('progressFill');
            const messageScore = document.getElementById('messageScore');
            
            scoreDisplay.style.display = 'block';
            progressFill.style.width = `${moyenne}%`;
            
            let message = '';
            if (moyenne >= 80) {
                message = `üèÜ EXCELLENT (${Math.round(moyenne)}%) - Vous ma√Ætrisez parfaitement les risques auditifs professionnels !`;
            } else if (moyenne >= 60) {
                message = `üëç BIEN (${Math.round(moyenne)}%) - Bonnes bases, quelques r√©visions sur les seuils r√©glementaires √† pr√©voir.`;
            } else {
                message = `üìö √Ä AM√âLIORER (${Math.round(moyenne)}%) - Reprenez les notions de base sur l'acoustique et la pr√©vention.`;
            }
            
            messageScore.innerHTML = message;
        }

        // Animation shake pour les erreurs
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-5px); }
                75% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>